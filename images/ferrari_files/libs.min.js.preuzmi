window.fom=window.fom||{};
window.fom.components=window.fom.components||{};
fom.components.raceCountdown=(function(f,i){var q={DAY:86400000,HOUR:3600000,MIN:60000,SEC:1000},b={SHOW_TITLE_FOR:4.5*q.SEC,SHOW_COUNTDOWN_FOR:6*q.SEC,CSS_ANIMATION_DURATION:400},x={data:"data-datetime",countdown:".countdown-container",days:".days .value",hours:".hours .value",mins:".minutes .value",secs:".seconds .value"},c,a={};
function n(A){var B=(A&&typeof A==="string")?new Date(A):new Date();
return Date.parse(B)
}function l(A){return(typeof A==="number"&&A<10)?("0"+A):A
}function r(E){var C,A,D=["days","hours","mins","secs"],B={};
if(f.isArray(E)){A=E.length;
if(A===D.length){for(C=0;
C<A;
C+=1){B[D[C]]=E[C]
}}else{throw"timeTemplate: Expects an array of values to map exactly to: days, hours, minutes, seconds"
}}return B
}function j(B,D){var A=Math.floor(B/D),C=A*D;
return{result:A,remainder:B-C}
}function w(A){return j(A,q.DAY)
}function g(A){return j(A,q.HOUR)
}function z(A){return j(A,q.MIN)
}function e(A){return j(A,q.SEC)
}function y(B){var E,A,D,C;
E=w(B);
B=E.remainder;
A=g(B);
B=A.remainder;
D=z(B);
B=D.remainder;
C=e(B);
return r([E.result,A.result,D.result,C.result])
}function u(B){var A=n();
return(B>A)
}function h(B){var A=B.elements.secs,D=B.values.secs,C=D;
B.timer=setInterval(function(){if(C>0){C-=1
}else{if(u(B.target.ms)){C=59;
m(B)
}else{p(B)
}}A.text(l(C))
},q.SEC)
}function p(A){if(!u(A.target.ms)){A.elements.container.slideUp()
}clearInterval(A.timer)
}function v(B){var A=B.elements.container.find(".countdown-clock"),D,C=B.elements.container.hasClass("has-title");
if(!C){A.addClass("active");
return false
}D=B.elements.container.find(".countdown-title");
i.setTimeout(function(){k(A,D)
},b.SHOW_TITLE_FOR)
}function k(B,D){var A,C,E;
if(B.hasClass("active")){A=B;
C=D;
E=b.SHOW_TITLE_FOR
}else{A=D;
C=B;
E=b.SHOW_COUNTDOWN_FOR
}A.toggleClass("active");
i.setTimeout(function(){C.toggleClass("active");
i.setTimeout(function(){k(B,D)
},E)
},b.CSS_ANIMATION_DURATION)
}function d(D){var E,C,A=D.length,B;
for(B=0;
B<A;
B+=1){C=f(D[B]);
E={id:"slide"+B,target:{date:C.attr(x.data)},timer:null};
E.elements=r([C.find(x.days),C.find(x.hours),C.find(x.mins),C.find(x.secs)]);
E.elements.container=C;
E.target.ms=n(E.target.date);
if(u(E.target.ms)){E.elements.container.removeClass("hide");
m(E);
h(E);
v(E)
}a[E.id]=E
}}function s(B){var C=B.elements,A=B.values;
C.days.text(l(A.days));
C.hours.text(l(A.hours));
C.mins.text(l(A.mins));
C.secs.text(l(A.secs))
}function m(A){A.now=n();
A.values=y(A.target.ms-A.now);
s(A)
}function t(){c=f(x.countdown);
if(c.length>0){d(c)
}}function o(A){d(f(A))
}f(document).ready(function(){return t()
});
return{initOnEl:o}
}(jQuery,window));
window.fom=window.fom||{};
window.fom.modules=window.fom.modules||{};
window.fom.components=window.fom.components||{};
if(!window.console){window.console={log:function(){}}
}window.log=function(){log.history=log.history||[];
log.history.push(arguments);
if(this.console){console.log(Array.prototype.slice.call(arguments))
}};
jQuery.ajaxSetup({cache:true});
$(document).ready(function(){if($(".content-info.error .btn.resend-email")&&$(".content-info.error .btn.resend-email").length>0){$(".content-info.error .btn.resend-email").on("click",function(g){g.preventDefault();
var c=$(this);
var d=function(){c.removeClass("loading");
setTimeout($.proxy(function(){var e=$(".content-info.error").offset().top-1;
$("html, body").animate({scrollTop:e},"slow")
},this),0)
};
if($.cookie("resend-email-info")){var f=$.cookie("resend-email-info");
if(f!=null){var b=JSON.parse(f);
if(server!=null&&server.requestValidation!=null){c.addClass("loading");
server.requestValidation(b.UID,b.UIDSignature,b.signatureTimestamp).then(function(e){$(".serverside-success").show();
$(".serverside-error").hide();
d()
},function(e){$(".serverside-error").show();
$(".serverside-success").hide();
d()
})
}}}else{console.error("Resend info not found to trigger email validation request")
}})
}$click=$(".see-full");
$defaultLebel=$(".see-full").data("default-cont");
$closeCont=$(".see-full").data("close-cont");
$click.text($defaultLebel);
function a(){$click.toggleClass("open");
$expand=$(".feature-content");
$expand.slideToggle(500,function(){$click.text(function(){return $expand.is(":visible")?$closeCont:$defaultLebel
})
})
}$click.on("click",function(b){a()
});
$(".to-comaprision").on("click",function(d){d.preventDefault();
var b=$click.offset().top,c=400;
$("html, body").stop().animate({scrollTop:b},c);
if(!$click.hasClass("open")){a()
}});
$(".subscription-landing .C8-3-feature-category tr.title").prev().css("border-bottom","none")
});
if(!window.Element){Element=function(){};
var __createElement=document.createElement;
document.createElement=function(c){var b=__createElement(c);
if(b==null){return null
}for(var a in Element.prototype){b[a]=Element.prototype[a]
}return b
};
var __getElementById=document.getElementById;
document.getElementById=function(c){var b=__getElementById(c);
if(b==null){return null
}for(var a in Element.prototype){b[a]=Element.prototype[a]
}return b
}
}(function(){var b=0;
var c=["ms","moz","webkit","o"];
for(var a=0;
a<c.length&&!window.requestAnimationFrame;
++a){window.requestAnimationFrame=window[c[a]+"RequestAnimationFrame"];
window.cancelAnimationFrame=window[c[a]+"CancelAnimationFrame"]||window[c[a]+"CancelRequestAnimationFrame"]
}if(!window.requestAnimationFrame){window.requestAnimationFrame=function(h,e){var d=new Date().getTime();
var f=Math.max(0,16-(d-b));
var g=window.setTimeout(function(){h(d+f)
},f);
b=d+f;
return g
}
}if(!window.cancelAnimationFrame){window.cancelAnimationFrame=function(d){clearTimeout(d)
}
}}());
var Swiper=function(l,a){if(!document.body.outerHTML&&document.body.__defineGetter__){if(HTMLElement){var t=HTMLElement.prototype;
if(t.__defineGetter__){t.__defineGetter__("outerHTML",function(){return new XMLSerializer().serializeToString(this)
})
}}}if(!window.getComputedStyle){window.getComputedStyle=function(i,j){this.el=i;
this.getPropertyValue=function(ag){var p=/(\-([a-z]){1})/g;
if(ag==="float"){ag="styleFloat"
}if(p.test(ag)){ag=ag.replace(p,function(){return arguments[2].toUpperCase()
})
}return i.currentStyle[ag]?i.currentStyle[ag]:null
};
return this
}
}if(!Array.prototype.indexOf){Array.prototype.indexOf=function(ah,ai){for(var ag=(ai||0),p=this.length;
ag<p;
ag++){if(this[ag]===ah){return ag
}}return -1
}
}if(!document.querySelectorAll){if(!window.jQuery){return
}}function R(i,j){if(document.querySelectorAll){return(j||document).querySelectorAll(i)
}else{return jQuery(i,j)
}}if(typeof l==="undefined"){return
}if(!(l.nodeType)){if(R(l).length===0){return
}}var f=this;
f.touches={start:0,startX:0,startY:0,current:0,currentX:0,currentY:0,diff:0,abs:0};
f.positions={start:0,abs:0,diff:0,current:0};
f.times={start:0,end:0};
f.id=(new Date()).getTime();
f.container=(l.nodeType)?l:R(l)[0];
f.isTouched=false;
f.isMoved=false;
f.activeIndex=0;
f.centerIndex=0;
f.activeLoaderIndex=0;
f.activeLoopIndex=0;
f.previousIndex=null;
f.velocity=0;
f.snapGrid=[];
f.slidesGrid=[];
f.imagesToLoad=[];
f.imagesLoaded=0;
f.wrapperLeft=0;
f.wrapperRight=0;
f.wrapperTop=0;
f.wrapperBottom=0;
f.isAndroid=navigator.userAgent.toLowerCase().indexOf("android")>=0;
var z,J,ae,r,b,d;
var G={eventTarget:"wrapper",mode:"horizontal",touchRatio:1,speed:300,freeMode:false,freeModeFluid:false,momentumRatio:1,momentumBounce:true,momentumBounceRatio:1,slidesPerView:1,slidesPerGroup:1,slidesPerViewFit:true,simulateTouch:true,followFinger:true,shortSwipes:true,longSwipesRatio:0.5,moveStartThreshold:false,onlyExternal:false,createPagination:true,pagination:false,paginationElement:"span",paginationClickable:false,paginationAsRange:true,resistance:true,scrollContainer:false,preventLinks:true,preventLinksPropagation:false,noSwiping:false,noSwipingClass:"swiper-no-swiping",initialSlide:0,keyboardControl:false,mousewheelControl:false,mousewheelControlForceToAxis:false,useCSS3Transforms:true,autoplay:false,autoplayDisableOnInteraction:true,autoplayStopOnLast:false,loop:false,loopAdditionalSlides:0,roundLengths:false,calculateHeight:false,cssWidthAndHeight:false,updateOnImagesReady:true,releaseFormElements:true,watchActiveIndex:false,visibilityFullFit:false,offsetPxBefore:0,offsetPxAfter:0,offsetSlidesBefore:0,offsetSlidesAfter:0,centeredSlides:false,queueStartCallbacks:false,queueEndCallbacks:false,autoResize:true,resizeReInit:false,DOMAnimation:true,loader:{slides:[],slidesHTMLType:"inner",surroundGroups:1,logic:"reload",loadAllSlides:false},swipeToPrev:true,swipeToNext:true,slideElement:"div",slideClass:"swiper-slide",slideActiveClass:"swiper-slide-active",slideVisibleClass:"swiper-slide-visible",slideDuplicateClass:"swiper-slide-duplicate",wrapperClass:"swiper-wrapper",paginationElementClass:"swiper-pagination-switch",paginationActiveClass:"swiper-active-switch",paginationVisibleClass:"swiper-visible-switch"};
a=a||{};
for(var x in G){if(x in a&&typeof a[x]==="object"){for(var e in G[x]){if(!(e in a[x])){a[x][e]=G[x][e]
}}}else{if(!(x in a)){a[x]=G[x]
}}}f.params=a;
if(a.scrollContainer){a.freeMode=true;
a.freeModeFluid=true
}if(a.loop){a.resistance="100%"
}var D=a.mode==="horizontal";
var v=["mousedown","mousemove","mouseup"];
if(f.browser.ie10){v=["MSPointerDown","MSPointerMove","MSPointerUp"]
}if(f.browser.ie11){v=["pointerdown","pointermove","pointerup"]
}f.touchEvents={touchStart:f.support.touch||!a.simulateTouch?"touchstart":v[0],touchMove:f.support.touch||!a.simulateTouch?"touchmove":v[1],touchEnd:f.support.touch||!a.simulateTouch?"touchend":v[2]};
for(var V=f.container.childNodes.length-1;
V>=0;
V--){if(f.container.childNodes[V].className){var s=f.container.childNodes[V].className.split(/\s+/);
for(var S=0;
S<s.length;
S++){if(s[S]===a.wrapperClass){z=f.container.childNodes[V]
}}}}f.wrapper=z;
f._extendSwiperSlide=function(i){i.append=function(){if(a.loop){i.insertAfter(f.slides.length-f.loopedSlides)
}else{f.wrapper.appendChild(i);
f.reInit()
}return i
};
i.prepend=function(){if(a.loop){f.wrapper.insertBefore(i,f.slides[f.loopedSlides]);
f.removeLoopedSlides();
f.calcSlides();
f.createLoop()
}else{f.wrapper.insertBefore(i,f.wrapper.firstChild)
}f.reInit();
return i
};
i.insertAfter=function(j){if(typeof j==="undefined"){return false
}var p;
if(a.loop){p=f.slides[j+1+f.loopedSlides];
if(p){f.wrapper.insertBefore(i,p)
}else{f.wrapper.appendChild(i)
}f.removeLoopedSlides();
f.calcSlides();
f.createLoop()
}else{p=f.slides[j+1];
f.wrapper.insertBefore(i,p)
}f.reInit();
return i
};
i.clone=function(){return f._extendSwiperSlide(i.cloneNode(true))
};
i.remove=function(){f.wrapper.removeChild(i);
f.reInit()
};
i.html=function(j){if(typeof j==="undefined"){return i.innerHTML
}else{i.innerHTML=j;
return i
}};
i.index=function(){var j;
for(var p=f.slides.length-1;
p>=0;
p--){if(i===f.slides[p]){j=p
}}return j
};
i.isActive=function(){if(i.index()===f.activeIndex){return true
}else{return false
}};
if(!i.swiperSlideDataStorage){i.swiperSlideDataStorage={}
}i.getData=function(j){return i.swiperSlideDataStorage[j]
};
i.setData=function(j,p){i.swiperSlideDataStorage[j]=p;
return i
};
i.data=function(j,p){if(typeof p==="undefined"){return i.getAttribute("data-"+j)
}else{i.setAttribute("data-"+j,p);
return i
}};
i.getWidth=function(p,j){return f.h.getWidth(i,p,j)
};
i.getHeight=function(p,j){return f.h.getHeight(i,p,j)
};
i.getOffset=function(){return f.h.getOffset(i)
};
return i
};
f.calcSlides=function(ah){var aj=f.slides?f.slides.length:false;
f.slides=[];
f.displaySlides=[];
for(var ai=0;
ai<f.wrapper.childNodes.length;
ai++){if(f.wrapper.childNodes[ai].className){var ak=f.wrapper.childNodes[ai].className;
var p=ak.split(/\s+/);
for(var ag=0;
ag<p.length;
ag++){if(p[ag]===a.slideClass){f.slides.push(f.wrapper.childNodes[ai])
}}}}for(ai=f.slides.length-1;
ai>=0;
ai--){f._extendSwiperSlide(f.slides[ai])
}if(aj===false){return
}if(aj!==f.slides.length||ah){o();
q();
f.updateActiveSlide();
if(f.params.pagination){f.createPagination()
}f.callPlugins("numberOfSlidesChanged")
}};
f.createSlide=function(p,j,ag){j=j||f.params.slideClass;
ag=ag||a.slideElement;
var i=document.createElement(ag);
i.innerHTML=p||"";
i.className=j;
return f._extendSwiperSlide(i)
};
f.appendSlide=function(j,i,p){if(!j){return
}if(j.nodeType){return f._extendSwiperSlide(j).append()
}else{return f.createSlide(j,i,p).append()
}};
f.prependSlide=function(j,i,p){if(!j){return
}if(j.nodeType){return f._extendSwiperSlide(j).prepend()
}else{return f.createSlide(j,i,p).prepend()
}};
f.insertSlideAfter=function(j,p,i,ag){if(typeof j==="undefined"){return false
}if(p.nodeType){return f._extendSwiperSlide(p).insertAfter(j)
}else{return f.createSlide(p,i,ag).insertAfter(j)
}};
f.removeSlide=function(i){if(f.slides[i]){if(a.loop){if(!f.slides[i+f.loopedSlides]){return false
}f.slides[i+f.loopedSlides].remove();
f.removeLoopedSlides();
f.calcSlides();
f.createLoop()
}else{f.slides[i].remove()
}return true
}else{return false
}};
f.removeLastSlide=function(){if(f.slides.length>0){if(a.loop){f.slides[f.slides.length-1-f.loopedSlides].remove();
f.removeLoopedSlides();
f.calcSlides();
f.createLoop()
}else{f.slides[f.slides.length-1].remove()
}return true
}else{return false
}};
f.removeAllSlides=function(){for(var j=f.slides.length-1;
j>=0;
j--){f.slides[j].remove()
}};
f.getSlide=function(i){return f.slides[i]
};
f.getLastSlide=function(){return f.slides[f.slides.length-1]
};
f.getFirstSlide=function(){return f.slides[0]
};
f.activeSlide=function(){return f.slides[f.activeIndex]
};
f.fireCallback=function(){var p=arguments[0];
if(Object.prototype.toString.call(p)==="[object Array]"){for(var j=0;
j<p.length;
j++){if(typeof p[j]==="function"){p[j](arguments[1],arguments[2],arguments[3],arguments[4],arguments[5])
}}}else{if(Object.prototype.toString.call(p)==="[object String]"){if(a["on"+p]){f.fireCallback(a["on"+p],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5])
}}else{p(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5])
}}};
function B(i){if(Object.prototype.toString.apply(i)==="[object Array]"){return true
}return false
}f.addCallback=function(ag,i){var p=this,j;
if(p.params["on"+ag]){if(B(this.params["on"+ag])){return this.params["on"+ag].push(i)
}else{if(typeof this.params["on"+ag]==="function"){j=this.params["on"+ag];
this.params["on"+ag]=[];
this.params["on"+ag].push(j);
return this.params["on"+ag].push(i)
}}}else{this.params["on"+ag]=[];
return this.params["on"+ag].push(i)
}};
f.removeCallbacks=function(i){if(f.params["on"+i]){f.params["on"+i]=null
}};
var A=[];
for(var ac in f.plugins){if(a[ac]){var P=f.plugins[ac](f,a[ac]);
if(P){A.push(P)
}}}f.callPlugins=function(ag,j){if(!j){j={}
}for(var p=0;
p<A.length;
p++){if(ag in A[p]){A[p][ag](j)
}}};
if((f.browser.ie10||f.browser.ie11)&&!a.onlyExternal){f.wrapper.classList.add("swiper-wp8-"+(D?"horizontal":"vertical"))
}if(a.freeMode){f.container.className+=" swiper-free-mode"
}f.initialized=false;
f.init=function(aj,ai){var an=f.h.getWidth(f.container,false,a.roundLengths);
var aA=f.h.getHeight(f.container,false,a.roundLengths);
if(an===f.width&&aA===f.height&&!aj){return
}f.width=an;
f.height=aA;
var ao,aq,ax,ak,au,az;
var aw;
d=D?an:aA;
var ap=f.wrapper;
if(aj){f.calcSlides(ai)
}if(a.slidesPerView==="auto"){var al=0;
var ag=0;
if(a.slidesOffset>0){ap.style.paddingLeft="";
ap.style.paddingRight="";
ap.style.paddingTop="";
ap.style.paddingBottom=""
}ap.style.width="";
ap.style.height="";
if(a.offsetPxBefore>0){if(D){f.wrapperLeft=a.offsetPxBefore
}else{f.wrapperTop=a.offsetPxBefore
}}if(a.offsetPxAfter>0){if(D){f.wrapperRight=a.offsetPxAfter
}else{f.wrapperBottom=a.offsetPxAfter
}}if(a.centeredSlides){if(D){f.wrapperLeft=(d-this.slides[0].getWidth(true,a.roundLengths))/2;
f.wrapperRight=(d-f.slides[f.slides.length-1].getWidth(true,a.roundLengths))/2
}else{f.wrapperTop=(d-f.slides[0].getHeight(true,a.roundLengths))/2;
f.wrapperBottom=(d-f.slides[f.slides.length-1].getHeight(true,a.roundLengths))/2
}}if(D){if(f.wrapperLeft>=0){ap.style.paddingLeft=f.wrapperLeft+"px"
}if(f.wrapperRight>=0){ap.style.paddingRight=f.wrapperRight+"px"
}}else{if(f.wrapperTop>=0){ap.style.paddingTop=f.wrapperTop+"px"
}if(f.wrapperBottom>=0){ap.style.paddingBottom=f.wrapperBottom+"px"
}}az=0;
var ay=0;
f.snapGrid=[];
f.slidesGrid=[];
ax=0;
for(aw=0;
aw<f.slides.length;
aw++){ao=f.slides[aw].getWidth(true,a.roundLengths);
aq=f.slides[aw].getHeight(true,a.roundLengths);
if(a.calculateHeight){ax=Math.max(ax,aq)
}var at=D?ao:aq;
if(a.centeredSlides){var p=aw===f.slides.length-1?0:f.slides[aw+1].getWidth(true,a.roundLengths);
var ah=aw===f.slides.length-1?0:f.slides[aw+1].getHeight(true,a.roundLengths);
var am=D?p:ah;
if(at>d){if(a.slidesPerViewFit){f.snapGrid.push(az+f.wrapperLeft);
f.snapGrid.push(az+at-d+f.wrapperLeft)
}else{for(var av=0;
av<=Math.floor(at/(d+f.wrapperLeft));
av++){if(av===0){f.snapGrid.push(az+f.wrapperLeft)
}else{f.snapGrid.push(az+f.wrapperLeft+d*av)
}}}f.slidesGrid.push(az+f.wrapperLeft)
}else{f.snapGrid.push(ay);
f.slidesGrid.push(ay)
}ay+=at/2+am/2
}else{if(at>d){if(a.slidesPerViewFit){f.snapGrid.push(az);
f.snapGrid.push(az+at-d)
}else{if(d!==0){for(var ar=0;
ar<=Math.floor(at/d);
ar++){f.snapGrid.push(az+d*ar)
}}else{f.snapGrid.push(az)
}}}else{f.snapGrid.push(az)
}f.slidesGrid.push(az)
}az+=at;
al+=ao;
ag+=aq
}if(a.calculateHeight){f.height=ax
}if(D){ae=al+f.wrapperRight+f.wrapperLeft;
ap.style.width=(al)+"px";
ap.style.height=(f.height)+"px"
}else{ae=ag+f.wrapperTop+f.wrapperBottom;
ap.style.width=(f.width)+"px";
ap.style.height=(ag)+"px"
}}else{if(a.scrollContainer){ap.style.width="";
ap.style.height="";
ak=f.slides[0].getWidth(true,a.roundLengths);
au=f.slides[0].getHeight(true,a.roundLengths);
ae=D?ak:au;
ap.style.width=ak+"px";
ap.style.height=au+"px";
J=D?ak:au
}else{if(a.calculateHeight){ax=0;
au=0;
if(!D){f.container.style.height=""
}ap.style.height="";
for(aw=0;
aw<f.slides.length;
aw++){f.slides[aw].style.height="";
ax=Math.max(f.slides[aw].getHeight(true),ax);
if(!D){au+=f.slides[aw].getHeight(true)
}}aq=ax;
f.height=aq;
if(D){au=aq
}else{d=aq;
f.container.style.height=d+"px"
}}else{aq=D?f.height:f.height/a.slidesPerView;
if(a.roundLengths){aq=Math.ceil(aq)
}au=D?f.height:f.slides.length*aq
}ao=D?f.width/a.slidesPerView:f.width;
if(a.roundLengths){ao=Math.ceil(ao)
}ak=D?f.slides.length*ao:f.width;
J=D?ao:aq;
if(a.offsetSlidesBefore>0){if(D){f.wrapperLeft=J*a.offsetSlidesBefore
}else{f.wrapperTop=J*a.offsetSlidesBefore
}}if(a.offsetSlidesAfter>0){if(D){f.wrapperRight=J*a.offsetSlidesAfter
}else{f.wrapperBottom=J*a.offsetSlidesAfter
}}if(a.offsetPxBefore>0){if(D){f.wrapperLeft=a.offsetPxBefore
}else{f.wrapperTop=a.offsetPxBefore
}}if(a.offsetPxAfter>0){if(D){f.wrapperRight=a.offsetPxAfter
}else{f.wrapperBottom=a.offsetPxAfter
}}if(a.centeredSlides){if(D){f.wrapperLeft=(d-J)/2;
f.wrapperRight=(d-J)/2
}else{f.wrapperTop=(d-J)/2;
f.wrapperBottom=(d-J)/2
}}if(D){if(f.wrapperLeft>0){ap.style.paddingLeft=f.wrapperLeft+"px"
}if(f.wrapperRight>0){ap.style.paddingRight=f.wrapperRight+"px"
}}else{if(f.wrapperTop>0){ap.style.paddingTop=f.wrapperTop+"px"
}if(f.wrapperBottom>0){ap.style.paddingBottom=f.wrapperBottom+"px"
}}ae=D?ak+f.wrapperRight+f.wrapperLeft:au+f.wrapperTop+f.wrapperBottom;
if(parseFloat(ak)>0&&(!a.cssWidthAndHeight||a.cssWidthAndHeight==="height")){ap.style.width=ak+"px"
}if(parseFloat(au)>0&&(!a.cssWidthAndHeight||a.cssWidthAndHeight==="width")){ap.style.height=au+"px"
}az=0;
f.snapGrid=[];
f.slidesGrid=[];
for(aw=0;
aw<f.slides.length;
aw++){f.snapGrid.push(az);
f.slidesGrid.push(az);
az+=J;
if(parseFloat(ao)>0&&(!a.cssWidthAndHeight||a.cssWidthAndHeight==="height")){f.slides[aw].style.width=ao+"px"
}if(parseFloat(aq)>0&&(!a.cssWidthAndHeight||a.cssWidthAndHeight==="width")){f.slides[aw].style.height=aq+"px"
}}}}if(!f.initialized){f.callPlugins("onFirstInit");
if(a.onFirstInit){f.fireCallback(a.onFirstInit,f)
}}else{f.callPlugins("onInit");
if(a.onInit){f.fireCallback(a.onInit,f)
}}f.initialized=true
};
f.reInit=function(i){f.init(true,i)
};
f.resizeFix=function(i){f.callPlugins("beforeResizeFix");
f.init(a.resizeReInit||i);
if(!a.freeMode){f.swipeTo((a.loop?f.activeLoopIndex:f.activeIndex),0,false);
if(a.autoplay){if(f.support.transitions&&typeof K!=="undefined"){if(typeof K!=="undefined"){clearTimeout(K);
K=undefined;
f.startAutoplay()
}}else{if(typeof X!=="undefined"){clearInterval(X);
X=undefined;
f.startAutoplay()
}}}}else{if(f.getWrapperTranslate()<-ab()){f.setWrapperTransition(0);
f.setWrapperTranslate(-ab())
}}f.callPlugins("afterResizeFix")
};
function ab(){var i=(ae-d);
if(a.freeMode){i=ae-d
}if(a.slidesPerView>f.slides.length&&!a.centeredSlides){i=0
}if(i<0){i=0
}return i
}function m(){var ai=f.h.addEventListener;
var ah=a.eventTarget==="wrapper"?f.wrapper:f.container;
if(!(f.browser.ie10||f.browser.ie11)){if(f.support.touch){ai(ah,"touchstart",U);
ai(ah,"touchmove",aa);
ai(ah,"touchend",N)
}if(a.simulateTouch){ai(ah,"mousedown",U);
ai(document,"mousemove",aa);
ai(document,"mouseup",N)
}}else{ai(ah,f.touchEvents.touchStart,U);
ai(document,f.touchEvents.touchMove,aa);
ai(document,f.touchEvents.touchEnd,N)
}if(a.autoResize){ai(window,"resize",f.resizeFix)
}q();
f._wheelEvent=false;
if(a.mousewheelControl){if(document.onmousewheel!==undefined){f._wheelEvent="mousewheel"
}if(!f._wheelEvent){try{new WheelEvent("wheel");
f._wheelEvent="wheel"
}catch(ag){}}if(!f._wheelEvent){f._wheelEvent="DOMMouseScroll"
}if(f._wheelEvent){ai(f.container,f._wheelEvent,c)
}}function p(aj){var i=new Image();
i.onload=function(){if(typeof f==="undefined"||f===null){return
}if(f.imagesLoaded!==undefined){f.imagesLoaded++
}if(f.imagesLoaded===f.imagesToLoad.length){f.reInit();
if(a.onImagesReady){f.fireCallback(a.onImagesReady,f)
}}};
i.src=aj
}if(a.keyboardControl){ai(document,"keydown",F)
}if(a.updateOnImagesReady){f.imagesToLoad=R("img",f.container);
for(var j=0;
j<f.imagesToLoad.length;
j++){p(f.imagesToLoad[j].getAttribute("src"))
}}}f.destroy=function(){var i=f.h.removeEventListener;
var j=a.eventTarget==="wrapper"?f.wrapper:f.container;
if(!(f.browser.ie10||f.browser.ie11)){if(f.support.touch){i(j,"touchstart",U);
i(j,"touchmove",aa);
i(j,"touchend",N)
}if(a.simulateTouch){i(j,"mousedown",U);
i(document,"mousemove",aa);
i(document,"mouseup",N)
}}else{i(j,f.touchEvents.touchStart,U);
i(document,f.touchEvents.touchMove,aa);
i(document,f.touchEvents.touchEnd,N)
}if(a.autoResize){i(window,"resize",f.resizeFix)
}o();
if(a.paginationClickable){C()
}if(a.mousewheelControl&&f._wheelEvent){i(f.container,f._wheelEvent,c)
}if(a.keyboardControl){i(document,"keydown",F)
}if(a.autoplay){f.stopAutoplay()
}f.callPlugins("onDestroy");
f=null
};
function q(){var ah=f.h.addEventListener,ag;
if(a.preventLinks){var j=R("a",f.container);
for(ag=0;
ag<j.length;
ag++){ah(j[ag],"click",O)
}}if(a.releaseFormElements){var p=R("input, textarea, select",f.container);
for(ag=0;
ag<p.length;
ag++){ah(p[ag],f.touchEvents.touchStart,y,true)
}}if(a.onSlideClick){for(ag=0;
ag<f.slides.length;
ag++){ah(f.slides[ag],"click",W)
}}if(a.onSlideTouch){for(ag=0;
ag<f.slides.length;
ag++){ah(f.slides[ag],f.touchEvents.touchStart,k)
}}}function o(){var ah=f.h.removeEventListener,ag;
if(a.onSlideClick){for(ag=0;
ag<f.slides.length;
ag++){ah(f.slides[ag],"click",W)
}}if(a.onSlideTouch){for(ag=0;
ag<f.slides.length;
ag++){ah(f.slides[ag],f.touchEvents.touchStart,k)
}}if(a.releaseFormElements){var p=R("input, textarea, select",f.container);
for(ag=0;
ag<p.length;
ag++){ah(p[ag],f.touchEvents.touchStart,y,true)
}}if(a.preventLinks){var j=R("a",f.container);
for(ag=0;
ag<j.length;
ag++){ah(j[ag],"click",O)
}}}function F(am){var ak=am.keyCode||am.charCode;
if(am.shiftKey||am.altKey||am.ctrlKey||am.metaKey){return
}if(ak===37||ak===39||ak===38||ak===40){var an=false;
var al=f.h.getOffset(f.container);
var ai=f.h.windowScroll().left;
var ag=f.h.windowScroll().top;
var ah=f.h.windowWidth();
var j=f.h.windowHeight();
var p=[[al.left,al.top],[al.left+f.width,al.top],[al.left,al.top+f.height],[al.left+f.width,al.top+f.height]];
for(var aj=0;
aj<p.length;
aj++){var ao=p[aj];
if(ao[0]>=ai&&ao[0]<=ai+ah&&ao[1]>=ag&&ao[1]<=ag+j){an=true
}}if(!an){return
}}if(D){if(ak===37||ak===39){if(am.preventDefault){am.preventDefault()
}else{am.returnValue=false
}}if(ak===39){f.swipeNext()
}if(ak===37){f.swipePrev()
}}else{if(ak===38||ak===40){if(am.preventDefault){am.preventDefault()
}else{am.returnValue=false
}}if(ak===40){f.swipeNext()
}if(ak===38){f.swipePrev()
}}}f.disableKeyboardControl=function(){a.keyboardControl=false;
f.h.removeEventListener(document,"keydown",F)
};
f.enableKeyboardControl=function(){a.keyboardControl=true;
f.h.addEventListener(document,"keydown",F)
};
var T=(new Date()).getTime();
function c(p){var j=f._wheelEvent;
var ag=0;
if(p.detail){ag=-p.detail
}else{if(j==="mousewheel"){if(a.mousewheelControlForceToAxis){if(D){if(Math.abs(p.wheelDeltaX)>Math.abs(p.wheelDeltaY)){ag=p.wheelDeltaX
}else{return
}}else{if(Math.abs(p.wheelDeltaY)>Math.abs(p.wheelDeltaX)){ag=p.wheelDeltaY
}else{return
}}}else{ag=p.wheelDelta
}}else{if(j==="DOMMouseScroll"){ag=-p.detail
}else{if(j==="wheel"){if(a.mousewheelControlForceToAxis){if(D){if(Math.abs(p.deltaX)>Math.abs(p.deltaY)){ag=-p.deltaX
}else{return
}}else{if(Math.abs(p.deltaY)>Math.abs(p.deltaX)){ag=-p.deltaY
}else{return
}}}else{ag=Math.abs(p.deltaX)>Math.abs(p.deltaY)?-p.deltaX:-p.deltaY
}}}}}if(!a.freeMode){if((new Date()).getTime()-T>60){if(ag<0){f.swipeNext()
}else{f.swipePrev()
}}T=(new Date()).getTime()
}else{var i=f.getWrapperTranslate()+ag;
if(i>0){i=0
}if(i<-ab()){i=-ab()
}f.setWrapperTransition(0);
f.setWrapperTranslate(i);
f.updateActiveSlide(i);
if(i===0||i===-ab()){return
}}if(a.autoplay){f.stopAutoplay(true)
}if(p.preventDefault){p.preventDefault()
}else{p.returnValue=false
}return false
}f.disableMousewheelControl=function(){if(!f._wheelEvent){return false
}a.mousewheelControl=false;
f.h.removeEventListener(f.container,f._wheelEvent,c);
return true
};
f.enableMousewheelControl=function(){if(!f._wheelEvent){return false
}a.mousewheelControl=true;
f.h.addEventListener(f.container,f._wheelEvent,c);
return true
};
if(a.grabCursor){var g=f.container.style;
g.cursor="move";
g.cursor="grab";
g.cursor="-moz-grab";
g.cursor="-webkit-grab"
}f.allowSlideClick=true;
function W(i){if(f.allowSlideClick){E(i);
f.fireCallback(a.onSlideClick,f,i)
}}function k(i){E(i);
f.fireCallback(a.onSlideTouch,f,i)
}function E(j){if(!j.currentTarget){var i=j.srcElement;
do{if(i.className.indexOf(a.slideClass)>-1){break
}i=i.parentNode
}while(i);
f.clickedSlide=i
}else{f.clickedSlide=j.currentTarget
}f.clickedSlideIndex=f.slides.indexOf(f.clickedSlide);
f.clickedSlideLoopIndex=f.clickedSlideIndex-(f.loopedSlides||0)
}f.allowLinks=true;
function O(i){if(!f.allowLinks){if(i.preventDefault){i.preventDefault()
}else{i.returnValue=false
}if(a.preventLinksPropagation&&"stopPropagation" in i){i.stopPropagation()
}return false
}}function y(i){if(i.stopPropagation){i.stopPropagation()
}else{i.returnValue=false
}return false
}var w=false;
var L;
var ad=true;
function U(ag){if(a.preventLinks){f.allowLinks=true
}if(f.isTouched||a.onlyExternal){return false
}var ah=ag.target||ag.srcElement;
if(document.activeElement){if(document.activeElement!==ah){document.activeElement.blur()
}}var p=("input select textarea").split(" ");
if(a.noSwiping&&(ah)&&I(ah)){return false
}ad=false;
f.isTouched=true;
w=ag.type==="touchstart";
if(!w&&"which" in ag&&ag.which===3){return false
}if(!w||ag.targetTouches.length===1){f.callPlugins("onTouchStartBegin");
if(!w&&!f.isAndroid&&p.indexOf(ah.tagName.toLowerCase())<0){if(ag.preventDefault){ag.preventDefault()
}else{ag.returnValue=false
}}var j=w?ag.targetTouches[0].pageX:(ag.pageX||ag.clientX);
var i=w?ag.targetTouches[0].pageY:(ag.pageY||ag.clientY);
f.touches.startX=f.touches.currentX=j;
f.touches.startY=f.touches.currentY=i;
f.touches.start=f.touches.current=D?j:i;
f.setWrapperTransition(0);
f.positions.start=f.positions.current=f.getWrapperTranslate();
f.setWrapperTranslate(f.positions.start);
f.times.start=(new Date()).getTime();
b=undefined;
if(a.moveStartThreshold>0){L=false
}if(a.onTouchStart){f.fireCallback(a.onTouchStart,f,ag)
}f.callPlugins("onTouchStartEnd")
}}var h,H;
function aa(ah){if(!f.isTouched||a.onlyExternal){return
}if(w&&ah.type==="mousemove"){return
}var ag=w?ah.targetTouches[0].pageX:(ah.pageX||ah.clientX);
var j=w?ah.targetTouches[0].pageY:(ah.pageY||ah.clientY);
if(typeof b==="undefined"&&D){b=!!(b||Math.abs(j-f.touches.startY)>Math.abs(ag-f.touches.startX))
}if(typeof b==="undefined"&&!D){b=!!(b||Math.abs(j-f.touches.startY)<Math.abs(ag-f.touches.startX))
}if(b){f.isTouched=false;
return
}if(D){if((!a.swipeToNext&&ag<f.touches.startX)||((!a.swipeToPrev&&ag>f.touches.startX))){return
}}else{if((!a.swipeToNext&&j<f.touches.startY)||((!a.swipeToPrev&&j>f.touches.startY))){return
}}if(ah.assignedToSwiper){f.isTouched=false;
return
}ah.assignedToSwiper=true;
if(a.preventLinks){f.allowLinks=false
}if(a.onSlideClick){f.allowSlideClick=false
}if(a.autoplay){f.stopAutoplay(true)
}if(!w||ah.touches.length===1){if(!f.isMoved){f.callPlugins("onTouchMoveStart");
if(a.loop){f.fixLoop();
f.positions.start=f.getWrapperTranslate()
}if(a.onTouchMoveStart){f.fireCallback(a.onTouchMoveStart,f)
}}f.isMoved=true;
if(ah.preventDefault){ah.preventDefault()
}else{ah.returnValue=false
}f.touches.current=D?ag:j;
f.positions.current=(f.touches.current-f.touches.start)*a.touchRatio+f.positions.start;
if(f.positions.current>0&&a.onResistanceBefore){f.fireCallback(a.onResistanceBefore,f,f.positions.current)
}if(f.positions.current<-ab()&&a.onResistanceAfter){f.fireCallback(a.onResistanceAfter,f,Math.abs(f.positions.current+ab()))
}if(a.resistance&&a.resistance!=="100%"){var p;
if(f.positions.current>0){p=1-f.positions.current/d/2;
if(p<0.5){f.positions.current=(d/2)
}else{f.positions.current=f.positions.current*p
}}if(f.positions.current<-ab()){var ai=(f.touches.current-f.touches.start)*a.touchRatio+(ab()+f.positions.start);
p=(d+ai)/(d);
var i=f.positions.current-ai*(1-p)/2;
var aj=-ab()-d/2;
if(i<aj||p<=0){f.positions.current=aj
}else{f.positions.current=i
}}}if(a.resistance&&a.resistance==="100%"){if(f.positions.current>0&&!(a.freeMode&&!a.freeModeFluid)){f.positions.current=0
}if(f.positions.current<-ab()&&!(a.freeMode&&!a.freeModeFluid)){f.positions.current=-ab()
}}if(!a.followFinger){return
}if(!a.moveStartThreshold){f.setWrapperTranslate(f.positions.current)
}else{if(Math.abs(f.touches.current-f.touches.start)>a.moveStartThreshold||L){if(!L){L=true;
f.touches.start=f.touches.current;
return
}f.setWrapperTranslate(f.positions.current)
}else{f.positions.current=f.positions.start
}}if(a.freeMode||a.watchActiveIndex){f.updateActiveSlide(f.positions.current)
}if(a.grabCursor){f.container.style.cursor="move";
f.container.style.cursor="grabbing";
f.container.style.cursor="-moz-grabbin";
f.container.style.cursor="-webkit-grabbing"
}if(!h){h=f.touches.current
}if(!H){H=(new Date()).getTime()
}f.velocity=(f.touches.current-h)/((new Date()).getTime()-H)/2;
if(Math.abs(f.touches.current-h)<2){f.velocity=0
}h=f.touches.current;
H=(new Date()).getTime();
f.callPlugins("onTouchMoveEnd");
if(a.onTouchMove){f.fireCallback(a.onTouchMove,f,ah)
}return false
}}function N(p){if(b){f.swipeReset()
}if(a.onlyExternal||!f.isTouched){return
}f.isTouched=false;
if(a.grabCursor){f.container.style.cursor="move";
f.container.style.cursor="grab";
f.container.style.cursor="-moz-grab";
f.container.style.cursor="-webkit-grab"
}if(!f.positions.current&&f.positions.current!==0){f.positions.current=f.positions.start
}if(a.followFinger){f.setWrapperTranslate(f.positions.current)
}f.times.end=(new Date()).getTime();
f.touches.diff=f.touches.current-f.touches.start;
f.touches.abs=Math.abs(f.touches.diff);
f.positions.diff=f.positions.current-f.positions.start;
f.positions.abs=Math.abs(f.positions.diff);
var aq=f.positions.diff;
var au=f.positions.abs;
var j=f.times.end-f.times.start;
if(au<5&&(j)<300&&f.allowLinks===false){if(!a.freeMode&&au!==0){f.swipeReset()
}if(a.preventLinks){f.allowLinks=true
}if(a.onSlideClick){f.allowSlideClick=true
}}setTimeout(function(){if(typeof f==="undefined"||f===null){return
}if(a.preventLinks){f.allowLinks=true
}if(a.onSlideClick){f.allowSlideClick=true
}},100);
var am=ab();
if(!f.isMoved&&a.freeMode){f.isMoved=false;
if(a.onTouchEnd){f.fireCallback(a.onTouchEnd,f,p)
}f.callPlugins("onTouchEnd");
return
}if(!f.isMoved||f.positions.current>0||f.positions.current<-am){f.swipeReset();
if(a.onTouchEnd){f.fireCallback(a.onTouchEnd,f,p)
}f.callPlugins("onTouchEnd");
return
}f.isMoved=false;
if(a.freeMode){if(a.freeModeFluid){var an=1000*a.momentumRatio;
var aj=f.velocity*an;
var ai=f.positions.current+aj;
var ah=false;
var ao;
var at=Math.abs(f.velocity)*20*a.momentumBounceRatio;
if(ai<-am){if(a.momentumBounce&&f.support.transitions){if(ai+am<-at){ai=-am-at
}ao=-am;
ah=true;
ad=true
}else{ai=-am
}}if(ai>0){if(a.momentumBounce&&f.support.transitions){if(ai>at){ai=at
}ao=0;
ah=true;
ad=true
}else{ai=0
}}if(f.velocity!==0){an=Math.abs((ai-f.positions.current)/f.velocity)
}f.setWrapperTranslate(ai);
f.setWrapperTransition(an);
if(a.momentumBounce&&ah){f.wrapperTransitionEnd(function(){if(!ad){return
}if(a.onMomentumBounce){f.fireCallback(a.onMomentumBounce,f)
}f.callPlugins("onMomentumBounce");
f.setWrapperTranslate(ao);
f.setWrapperTransition(300)
})
}f.updateActiveSlide(ai)
}if(!a.freeModeFluid||j>=300){f.updateActiveSlide(f.positions.current)
}if(a.onTouchEnd){f.fireCallback(a.onTouchEnd,f,p)
}f.callPlugins("onTouchEnd");
return
}r=aq<0?"toNext":"toPrev";
if(r==="toNext"&&(j<=300)){if(au<30||!a.shortSwipes){f.swipeReset()
}else{f.swipeNext(true)
}}if(r==="toPrev"&&(j<=300)){if(au<30||!a.shortSwipes){f.swipeReset()
}else{f.swipePrev(true)
}}var ar=0;
if(a.slidesPerView==="auto"){var ag=Math.abs(f.getWrapperTranslate());
var ap=0;
var al;
for(var ak=0;
ak<f.slides.length;
ak++){al=D?f.slides[ak].getWidth(true,a.roundLengths):f.slides[ak].getHeight(true,a.roundLengths);
ap+=al;
if(ap>ag){ar=al;
break
}}if(ar>d){ar=d
}}else{ar=J*a.slidesPerView
}if(r==="toNext"&&(j>300)){if(au>=ar*a.longSwipesRatio){f.swipeNext(true)
}else{f.swipeReset()
}}if(r==="toPrev"&&(j>300)){if(au>=ar*a.longSwipesRatio){f.swipePrev(true)
}else{f.swipeReset()
}}if(a.onTouchEnd){f.fireCallback(a.onTouchEnd,f,p)
}f.callPlugins("onTouchEnd")
}function I(j){var i=false;
do{if(j.className.indexOf(a.noSwipingClass)>-1){i=true
}j=j.parentElement
}while(!i&&j.parentElement&&j.className.indexOf(a.wrapperClass)===-1);
if(!i&&j.className.indexOf(a.wrapperClass)>-1&&j.className.indexOf(a.noSwipingClass)>-1){i=true
}return i
}function M(i,j){var p=document.createElement("div");
var ag;
p.innerHTML=j;
ag=p.firstChild;
ag.className+=" "+i;
return ag.outerHTML
}f.swipeNext=function(p){if(!p&&a.loop){f.fixLoop()
}if(!p&&a.autoplay){f.stopAutoplay(true)
}f.callPlugins("onSwipeNext");
var ai=f.getWrapperTranslate();
var ah=ai;
if(a.slidesPerView==="auto"){for(var ag=0;
ag<f.snapGrid.length;
ag++){if(-ai>=f.snapGrid[ag]&&-ai<f.snapGrid[ag+1]){ah=-f.snapGrid[ag+1];
break
}}}else{var j=J*a.slidesPerGroup;
ah=-(Math.floor(Math.abs(ai)/Math.floor(j))*j+j)
}if(ah<-ab()){ah=-ab()
}if(ah===ai){return false
}n(ah,"next");
return true
};
f.swipePrev=function(p){if(!p&&a.loop){f.fixLoop()
}if(!p&&a.autoplay){f.stopAutoplay(true)
}f.callPlugins("onSwipePrev");
var ai=Math.ceil(f.getWrapperTranslate());
var ah;
if(a.slidesPerView==="auto"){ah=0;
for(var ag=1;
ag<f.snapGrid.length;
ag++){if(-ai===f.snapGrid[ag]){ah=-f.snapGrid[ag-1];
break
}if(-ai>f.snapGrid[ag]&&-ai<f.snapGrid[ag+1]){ah=-f.snapGrid[ag];
break
}}}else{var j=J*a.slidesPerGroup;
ah=-(Math.ceil(-ai/j)-1)*j
}if(ah>0){ah=0
}if(ah===ai){return false
}n(ah,"prev");
return true
};
f.swipeReset=function(){f.callPlugins("onSwipeReset");
var ah=f.getWrapperTranslate();
var j=J*a.slidesPerGroup;
var ag;
var ai=-ab();
if(a.slidesPerView==="auto"){ag=0;
for(var p=0;
p<f.snapGrid.length;
p++){if(-ah===f.snapGrid[p]){return
}if(-ah>=f.snapGrid[p]&&-ah<f.snapGrid[p+1]){if(f.positions.diff>0){ag=-f.snapGrid[p+1]
}else{ag=-f.snapGrid[p]
}break
}}if(-ah>=f.snapGrid[f.snapGrid.length-1]){ag=-f.snapGrid[f.snapGrid.length-1]
}if(ah<=-ab()){ag=-ab()
}}else{ag=ah<0?Math.round(ah/j)*j:0;
if(ah<=-ab()){ag=-ab()
}}if(a.scrollContainer){ag=ah<0?ah:0
}if(ag<-ab()){ag=-ab()
}if(a.scrollContainer&&(d>J)){ag=0
}if(ag===ah){return false
}n(ag,"reset");
return true
};
f.swipeTo=function(i,ag,ah){i=parseInt(i,10);
f.callPlugins("onSwipeTo",{index:i,speed:ag});
if(a.loop){i=i+f.loopedSlides
}var p=f.getWrapperTranslate();
if(i>(f.slides.length-1)||i<0){return
}var j;
if(a.slidesPerView==="auto"){j=-f.slidesGrid[i]
}else{j=-i*J
}if(j<-ab()){j=-ab()
}if(j===p){return false
}ah=ah===false?false:true;
n(j,"to",{index:i,speed:ag,runCallbacks:ah});
return true
};
function n(ag,ah,am){var j=(ah==="to"&&am.speed>=0)?am.speed:a.speed;
var aj=+new Date();
function ai(){var an=+new Date();
var ao=an-aj;
p+=ak*ao/(1000/60);
i=al==="toNext"?p>ag:p<ag;
if(i){f.setWrapperTranslate(Math.ceil(p));
f._DOMAnimating=true;
window.setTimeout(function(){ai()
},1000/60)
}else{if(a.onSlideChangeEnd){if(ah==="to"){if(am.runCallbacks===true){f.fireCallback(a.onSlideChangeEnd,f,al)
}}else{f.fireCallback(a.onSlideChangeEnd,f,al)
}}f.setWrapperTranslate(ag);
f._DOMAnimating=false
}}if(f.support.transitions||!a.DOMAnimation){f.setWrapperTranslate(ag);
f.setWrapperTransition(j)
}else{var p=f.getWrapperTranslate();
var ak=Math.ceil((ag-p)/j*(1000/60));
var al=p>ag?"toNext":"toPrev";
var i=al==="toNext"?p>ag:p<ag;
if(f._DOMAnimating){return
}ai()
}f.updateActiveSlide(ag);
if(a.onSlideNext&&ah==="next"){f.fireCallback(a.onSlideNext,f,ag)
}if(a.onSlidePrev&&ah==="prev"){f.fireCallback(a.onSlidePrev,f,ag)
}if(a.onSlideReset&&ah==="reset"){f.fireCallback(a.onSlideReset,f,ag)
}if(ah==="next"||ah==="prev"||(ah==="to"&&am.runCallbacks===true)){af(ah)
}}f._queueStartCallbacks=false;
f._queueEndCallbacks=false;
function af(i){f.callPlugins("onSlideChangeStart");
if(a.onSlideChangeStart){if(a.queueStartCallbacks&&f.support.transitions){if(f._queueStartCallbacks){return
}f._queueStartCallbacks=true;
f.fireCallback(a.onSlideChangeStart,f,i);
f.wrapperTransitionEnd(function(){f._queueStartCallbacks=false
})
}else{f.fireCallback(a.onSlideChangeStart,f,i)
}}if(a.onSlideChangeEnd){if(f.support.transitions){if(a.queueEndCallbacks){if(f._queueEndCallbacks){return
}f._queueEndCallbacks=true;
f.wrapperTransitionEnd(function(j){f.fireCallback(a.onSlideChangeEnd,j,i)
})
}else{f.wrapperTransitionEnd(function(j){f.fireCallback(a.onSlideChangeEnd,j,i)
})
}}else{if(!a.DOMAnimation){setTimeout(function(){f.fireCallback(a.onSlideChangeEnd,f,i)
},10)
}}}}f.updateActiveSlide=function(aj){if(!f.initialized){return
}if(f.slides.length===0){return
}f.previousIndex=f.activeIndex;
if(typeof aj==="undefined"){aj=f.getWrapperTranslate()
}if(aj>0){aj=0
}var ai;
if(a.slidesPerView==="auto"){var am=0;
f.activeIndex=f.slidesGrid.indexOf(-aj);
if(f.activeIndex<0){for(ai=0;
ai<f.slidesGrid.length-1;
ai++){if(-aj>f.slidesGrid[ai]&&-aj<f.slidesGrid[ai+1]){break
}}var ag=Math.abs(f.slidesGrid[ai]+aj);
var p=Math.abs(f.slidesGrid[ai+1]+aj);
if(ag<=p){f.activeIndex=ai
}else{f.activeIndex=ai+1
}}}else{f.activeIndex=Math[a.visibilityFullFit?"ceil":"round"](-aj/J)
}if(f.activeIndex===f.slides.length){f.activeIndex=f.slides.length-1
}if(f.activeIndex<0){f.activeIndex=0
}if(!f.slides[f.activeIndex]){return
}f.calcVisibleSlides(aj);
if(f.support.classList){var ak;
for(ai=0;
ai<f.slides.length;
ai++){ak=f.slides[ai];
ak.classList.remove(a.slideActiveClass);
if(f.visibleSlides.indexOf(ak)>=0){ak.classList.add(a.slideVisibleClass)
}else{ak.classList.remove(a.slideVisibleClass)
}}f.slides[f.activeIndex].classList.add(a.slideActiveClass)
}else{var al=new RegExp("\\s*"+a.slideActiveClass);
var j=new RegExp("\\s*"+a.slideVisibleClass);
for(ai=0;
ai<f.slides.length;
ai++){f.slides[ai].className=f.slides[ai].className.replace(al,"").replace(j,"");
if(f.visibleSlides.indexOf(f.slides[ai])>=0){f.slides[ai].className+=" "+a.slideVisibleClass
}}f.slides[f.activeIndex].className+=" "+a.slideActiveClass
}if(a.loop){var ah=f.loopedSlides;
f.activeLoopIndex=f.activeIndex-ah;
if(f.activeLoopIndex>=f.slides.length-ah*2){f.activeLoopIndex=f.slides.length-ah*2-f.activeLoopIndex
}if(f.activeLoopIndex<0){f.activeLoopIndex=f.slides.length-ah*2+f.activeLoopIndex
}if(f.activeLoopIndex<0){f.activeLoopIndex=0
}}else{f.activeLoopIndex=f.activeIndex
}if(a.pagination){f.updatePagination(aj)
}};
f.createPagination=function(p){if(a.paginationClickable&&f.paginationButtons){C()
}f.paginationContainer=a.pagination.nodeType?a.pagination:R(a.pagination)[0];
if(a.createPagination){var j="";
var ai=f.slides.length;
var ah=ai;
if(a.loop){ah-=f.loopedSlides*2
}for(var ag=0;
ag<ah;
ag++){j+="<"+a.paginationElement+' class="'+a.paginationElementClass+'"></'+a.paginationElement+">"
}f.paginationContainer.innerHTML=j
}f.paginationButtons=R("."+a.paginationElementClass,f.paginationContainer);
if(!p){f.updatePagination()
}f.callPlugins("onCreatePagination");
if(a.paginationClickable){Y()
}};
function C(){var j=f.paginationButtons;
if(j){for(var p=0;
p<j.length;
p++){f.h.removeEventListener(j[p],"click",u)
}}}function Y(){var j=f.paginationButtons;
if(j){for(var p=0;
p<j.length;
p++){f.h.addEventListener(j[p],"click",u)
}}}function u(ai){var p;
var ah=ai.target||ai.srcElement;
var j=f.paginationButtons;
for(var ag=0;
ag<j.length;
ag++){if(ah===j[ag]){p=ag
}}if(a.autoplay){f.stopAutoplay(true)
}f.swipeTo(p)
}f.updatePagination=function(p){if(!a.pagination){return
}if(f.slides.length<1){return
}var ak=R("."+a.paginationActiveClass,f.paginationContainer);
if(!ak){return
}var ai=f.paginationButtons;
if(ai.length===0){return
}for(var aj=0;
aj<ai.length;
aj++){ai[aj].className=a.paginationElementClass
}var am=a.loop?f.loopedSlides:0;
if(a.paginationAsRange){if(!f.visibleSlides){f.calcVisibleSlides(p)
}var ag=[];
var ah;
for(ah=0;
ah<f.visibleSlides.length;
ah++){var al=f.slides.indexOf(f.visibleSlides[ah])-am;
if(a.loop&&al<0){al=f.slides.length-f.loopedSlides*2+al
}if(a.loop&&al>=f.slides.length-f.loopedSlides*2){al=f.slides.length-f.loopedSlides*2-al;
al=Math.abs(al)
}ag.push(al)
}for(ah=0;
ah<ag.length;
ah++){if(ai[ag[ah]]){ai[ag[ah]].className+=" "+a.paginationVisibleClass
}}if(a.loop){if(ai[f.activeLoopIndex]!==undefined){ai[f.activeLoopIndex].className+=" "+a.paginationActiveClass
}}else{ai[f.activeIndex].className+=" "+a.paginationActiveClass
}}else{if(a.loop){if(ai[f.activeLoopIndex]){ai[f.activeLoopIndex].className+=" "+a.paginationActiveClass+" "+a.paginationVisibleClass
}}else{ai[f.activeIndex].className+=" "+a.paginationActiveClass+" "+a.paginationVisibleClass
}}};
f.calcVisibleSlides=function(j){var ai=[];
var ak=0,ah=0,aj=0;
if(D&&f.wrapperLeft>0){j=j+f.wrapperLeft
}if(!D&&f.wrapperTop>0){j=j+f.wrapperTop
}for(var ag=0;
ag<f.slides.length;
ag++){ak+=ah;
if(a.slidesPerView==="auto"){ah=D?f.h.getWidth(f.slides[ag],true,a.roundLengths):f.h.getHeight(f.slides[ag],true,a.roundLengths)
}else{ah=J
}aj=ak+ah;
var p=false;
if(a.visibilityFullFit){if(ak>=-j&&aj<=-j+d){p=true
}if(ak<=-j&&aj>=-j+d){p=true
}}else{if(aj>-j&&aj<=((-j+d))){p=true
}if(ak>=-j&&ak<((-j+d))){p=true
}if(ak<-j&&aj>((-j+d))){p=true
}}if(p){ai.push(f.slides[ag])
}}if(ai.length===0){ai=[f.slides[f.activeIndex]]
}f.visibleSlides=ai
};
var K,X;
f.startAutoplay=function(){if(f.support.transitions){if(typeof K!=="undefined"){return false
}if(!a.autoplay){return
}f.callPlugins("onAutoplayStart");
if(a.onAutoplayStart){f.fireCallback(a.onAutoplayStart,f)
}Z()
}else{if(typeof X!=="undefined"){return false
}if(!a.autoplay){return
}f.callPlugins("onAutoplayStart");
if(a.onAutoplayStart){f.fireCallback(a.onAutoplayStart,f)
}X=setInterval(function(){if(a.loop){f.fixLoop();
f.swipeNext(true)
}else{if(!f.swipeNext(true)){if(!a.autoplayStopOnLast){f.swipeTo(0)
}else{clearInterval(X);
X=undefined
}}}},a.autoplay)
}};
f.stopAutoplay=function(i){if(f.support.transitions){if(!K){return
}if(K){clearTimeout(K)
}K=undefined;
if(i&&!a.autoplayDisableOnInteraction){f.wrapperTransitionEnd(function(){Z()
})
}f.callPlugins("onAutoplayStop");
if(a.onAutoplayStop){f.fireCallback(a.onAutoplayStop,f)
}}else{if(X){clearInterval(X)
}X=undefined;
f.callPlugins("onAutoplayStop");
if(a.onAutoplayStop){f.fireCallback(a.onAutoplayStop,f)
}}};
function Z(){K=setTimeout(function(){if(a.loop){f.fixLoop();
f.swipeNext(true)
}else{if(!f.swipeNext(true)){if(!a.autoplayStopOnLast){f.swipeTo(0)
}else{clearTimeout(K);
K=undefined
}}}f.wrapperTransitionEnd(function(){if(typeof K!=="undefined"){Z()
}})
},a.autoplay)
}f.loopCreated=false;
f.removeLoopedSlides=function(){if(f.loopCreated){for(var j=0;
j<f.slides.length;
j++){if(f.slides[j].getData("looped")===true){f.wrapper.removeChild(f.slides[j])
}}}};
f.createLoop=function(){if(f.slides.length===0){return
}if(a.slidesPerView==="auto"){f.loopedSlides=a.loopedSlides||1
}else{f.loopedSlides=a.slidesPerView+a.loopAdditionalSlides
}if(f.loopedSlides>f.slides.length){f.loopedSlides=f.slides.length
}var an="",ak="",aj;
var ai="";
var ao=f.slides.length;
var ag=Math.floor(f.loopedSlides/ao);
var am=f.loopedSlides%ao;
for(aj=0;
aj<(ag*ao);
aj++){var ah=aj;
if(aj>=ao){var al=Math.floor(aj/ao);
ah=aj-(ao*al)
}ai+=f.slides[ah].outerHTML
}for(aj=0;
aj<am;
aj++){ak+=M(a.slideDuplicateClass,f.slides[aj].outerHTML)
}for(aj=ao-am;
aj<ao;
aj++){an+=M(a.slideDuplicateClass,f.slides[aj].outerHTML)
}var p=an+ai+z.innerHTML+ai+ak;
z.innerHTML=p;
f.loopCreated=true;
f.calcSlides();
for(aj=0;
aj<f.slides.length;
aj++){if(aj<f.loopedSlides||aj>=f.slides.length-f.loopedSlides){f.slides[aj].setData("looped",true)
}}f.callPlugins("onCreateLoop")
};
f.fixLoop=function(){var i;
if(f.activeIndex<f.loopedSlides){i=f.slides.length-f.loopedSlides*3+f.activeIndex;
f.swipeTo(i,0,false)
}else{if((a.slidesPerView==="auto"&&f.activeIndex>=f.loopedSlides*2)||(f.activeIndex>f.slides.length-a.slidesPerView*2)){i=-f.slides.length+f.activeIndex+f.loopedSlides;
f.swipeTo(i,0,false)
}}};
f.loadSlides=function(){var ag="";
f.activeLoaderIndex=0;
var p=a.loader.slides;
var ah=a.loader.loadAllSlides?p.length:a.slidesPerView*(1+a.loader.surroundGroups);
for(var j=0;
j<ah;
j++){if(a.loader.slidesHTMLType==="outer"){ag+=p[j]
}else{ag+="<"+a.slideElement+' class="'+a.slideClass+'" data-swiperindex="'+j+'">'+p[j]+"</"+a.slideElement+">"
}}f.wrapper.innerHTML=ag;
f.calcSlides(true);
if(!a.loader.loadAllSlides){f.wrapperTransitionEnd(f.reloadSlides,true)
}};
f.reloadSlides=function(){var j=a.loader.slides;
var am=parseInt(f.activeSlide().data("swiperindex"),10);
if(am<0||am>j.length-1){return
}f.activeLoaderIndex=am;
var p=Math.max(0,am-a.slidesPerView*a.loader.surroundGroups);
var ak=Math.min(am+a.slidesPerView*(1+a.loader.surroundGroups)-1,j.length-1);
if(am>0){var ag=-J*(am-p);
f.setWrapperTranslate(ag);
f.setWrapperTransition(0)
}var aj;
if(a.loader.logic==="reload"){f.wrapper.innerHTML="";
var an="";
for(aj=p;
aj<=ak;
aj++){an+=a.loader.slidesHTMLType==="outer"?j[aj]:"<"+a.slideElement+' class="'+a.slideClass+'" data-swiperindex="'+aj+'">'+j[aj]+"</"+a.slideElement+">"
}f.wrapper.innerHTML=an
}else{var ah=1000;
var ai=0;
for(aj=0;
aj<f.slides.length;
aj++){var al=f.slides[aj].data("swiperindex");
if(al<p||al>ak){f.wrapper.removeChild(f.slides[aj])
}else{ah=Math.min(al,ah);
ai=Math.max(al,ai)
}}for(aj=p;
aj<=ak;
aj++){var ao;
if(aj<ah){ao=document.createElement(a.slideElement);
ao.className=a.slideClass;
ao.setAttribute("data-swiperindex",aj);
ao.innerHTML=j[aj];
f.wrapper.insertBefore(ao,f.wrapper.firstChild)
}if(aj>ai){ao=document.createElement(a.slideElement);
ao.className=a.slideClass;
ao.setAttribute("data-swiperindex",aj);
ao.innerHTML=j[aj];
f.wrapper.appendChild(ao)
}}}f.reInit(true)
};
function Q(){f.calcSlides();
if(a.loader.slides.length>0&&f.slides.length===0){f.loadSlides()
}if(a.loop){f.createLoop()
}f.init();
m();
if(a.pagination){f.createPagination(true)
}if(a.loop||a.initialSlide>0){f.swipeTo(a.initialSlide,0,false)
}else{f.updateActiveSlide(0)
}if(a.autoplay){f.startAutoplay()
}f.centerIndex=f.activeIndex;
if(a.onSwiperCreated){f.fireCallback(a.onSwiperCreated,f)
}f.callPlugins("onSwiperCreated")
}Q()
};
Swiper.prototype={plugins:{},wrapperTransitionEnd:function(h,f){var b=this,e=b.wrapper,d=["webkitTransitionEnd","transitionend","oTransitionEnd","MSTransitionEnd","msTransitionEnd"],c;
function g(a){if(a.target!==e){return
}h(b);
if(b.params.queueEndCallbacks){b._queueEndCallbacks=false
}if(!f){for(c=0;
c<d.length;
c++){b.h.removeEventListener(e,d[c],g)
}}}if(h){for(c=0;
c<d.length;
c++){b.h.addEventListener(e,d[c],g)
}}},getWrapperTranslate:function(e){var d=this.wrapper,a,c,f,b;
if(typeof e==="undefined"){e=this.params.mode==="horizontal"?"x":"y"
}if(this.support.transforms&&this.params.useCSS3Transforms){f=window.getComputedStyle(d,null);
if(window.WebKitCSSMatrix){b=new WebKitCSSMatrix(f.webkitTransform==="none"?"":f.webkitTransform)
}else{b=f.MozTransform||f.OTransform||f.MsTransform||f.msTransform||f.transform||f.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,");
a=b.toString().split(",")
}if(e==="x"){if(window.WebKitCSSMatrix){c=b.m41
}else{if(a.length===16){c=parseFloat(a[12])
}else{c=parseFloat(a[4])
}}}if(e==="y"){if(window.WebKitCSSMatrix){c=b.m42
}else{if(a.length===16){c=parseFloat(a[13])
}else{c=parseFloat(a[5])
}}}}else{if(e==="x"){c=parseFloat(d.style.left,10)||0
}if(e==="y"){c=parseFloat(d.style.top,10)||0
}}return c||0
},setWrapperTranslate:function(a,f,e){var d=this.wrapper.style,b={x:0,y:0,z:0},c;
if(arguments.length===3){b.x=a;
b.y=f;
b.z=e
}else{if(typeof f==="undefined"){f=this.params.mode==="horizontal"?"x":"y"
}b[f]=a
}if(this.support.transforms&&this.params.useCSS3Transforms){c=this.support.transforms3d?"translate3d("+b.x+"px, "+b.y+"px, "+b.z+"px)":"translate("+b.x+"px, "+b.y+"px)";
d.webkitTransform=d.MsTransform=d.msTransform=d.MozTransform=d.OTransform=d.transform=c
}else{d.left=b.x+"px";
d.top=b.y+"px"
}this.callPlugins("onSetWrapperTransform",b);
if(this.params.onSetWrapperTransform){this.fireCallback(this.params.onSetWrapperTransform,this,b)
}},setWrapperTransition:function(a){var b=this.wrapper.style;
b.webkitTransitionDuration=b.MsTransitionDuration=b.msTransitionDuration=b.MozTransitionDuration=b.OTransitionDuration=b.transitionDuration=(a/1000)+"s";
this.callPlugins("onSetWrapperTransition",{duration:a});
if(this.params.onSetWrapperTransition){this.fireCallback(this.params.onSetWrapperTransition,this,a)
}},h:{getWidth:function(e,c,a){var d=window.getComputedStyle(e,null).getPropertyValue("width");
var b=parseFloat(d);
if(isNaN(b)||d.indexOf("%")>0||b<0){b=e.offsetWidth-parseFloat(window.getComputedStyle(e,null).getPropertyValue("padding-left"))-parseFloat(window.getComputedStyle(e,null).getPropertyValue("padding-right"))
}if(c){b+=parseFloat(window.getComputedStyle(e,null).getPropertyValue("padding-left"))+parseFloat(window.getComputedStyle(e,null).getPropertyValue("padding-right"))
}if(a){return Math.ceil(b)
}else{return b
}},getHeight:function(d,c,b){if(c){return d.offsetHeight
}var a=window.getComputedStyle(d,null).getPropertyValue("height");
var e=parseFloat(a);
if(isNaN(e)||a.indexOf("%")>0||e<0){e=d.offsetHeight-parseFloat(window.getComputedStyle(d,null).getPropertyValue("padding-top"))-parseFloat(window.getComputedStyle(d,null).getPropertyValue("padding-bottom"))
}if(c){e+=parseFloat(window.getComputedStyle(d,null).getPropertyValue("padding-top"))+parseFloat(window.getComputedStyle(d,null).getPropertyValue("padding-bottom"))
}if(b){return Math.ceil(e)
}else{return e
}},getOffset:function(b){var c=b.getBoundingClientRect();
var a=document.body;
var g=b.clientTop||a.clientTop||0;
var f=b.clientLeft||a.clientLeft||0;
var d=window.pageYOffset||b.scrollTop;
var e=window.pageXOffset||b.scrollLeft;
if(document.documentElement&&!window.pageYOffset){d=document.documentElement.scrollTop;
e=document.documentElement.scrollLeft
}return{top:c.top+d-g,left:c.left+e-f}
},windowWidth:function(){if(window.innerWidth){return window.innerWidth
}else{if(document.documentElement&&document.documentElement.clientWidth){return document.documentElement.clientWidth
}}},windowHeight:function(){if(window.innerHeight){return window.innerHeight
}else{if(document.documentElement&&document.documentElement.clientHeight){return document.documentElement.clientHeight
}}},windowScroll:function(){if(typeof pageYOffset!=="undefined"){return{left:window.pageXOffset,top:window.pageYOffset}
}else{if(document.documentElement){return{left:document.documentElement.scrollLeft,top:document.documentElement.scrollTop}
}}},addEventListener:function(b,c,d,a){if(typeof a==="undefined"){a=false
}if(b.addEventListener){b.addEventListener(c,d,a)
}else{if(b.attachEvent){b.attachEvent("on"+c,d)
}}},removeEventListener:function(b,c,d,a){if(typeof a==="undefined"){a=false
}if(b.removeEventListener){b.removeEventListener(c,d,a)
}else{if(b.detachEvent){b.detachEvent("on"+c,d)
}}}},setTransform:function(b,a){var c=b.style;
c.webkitTransform=c.MsTransform=c.msTransform=c.MozTransform=c.OTransform=c.transform=a
},setTranslate:function(b,d){var c=b.style;
var e={x:d.x||0,y:d.y||0,z:d.z||0};
var a=this.support.transforms3d?"translate3d("+(e.x)+"px,"+(e.y)+"px,"+(e.z)+"px)":"translate("+(e.x)+"px,"+(e.y)+"px)";
c.webkitTransform=c.MsTransform=c.msTransform=c.MozTransform=c.OTransform=c.transform=a;
if(!this.support.transforms){c.left=e.x+"px";
c.top=e.y+"px"
}},setTransition:function(a,b){var c=a.style;
c.webkitTransitionDuration=c.MsTransitionDuration=c.msTransitionDuration=c.MozTransitionDuration=c.OTransitionDuration=c.transitionDuration=b+"ms"
},support:{touch:(window.Modernizr&&Modernizr.touch===true)||(function(){return !!(("ontouchstart" in window)||window.DocumentTouch&&document instanceof DocumentTouch)
})(),transforms3d:(window.Modernizr&&Modernizr.csstransforms3d===true)||(function(){var a=document.createElement("div").style;
return("webkitPerspective" in a||"MozPerspective" in a||"OPerspective" in a||"MsPerspective" in a||"perspective" in a)
})(),transforms:(window.Modernizr&&Modernizr.csstransforms===true)||(function(){var a=document.createElement("div").style;
return("transform" in a||"WebkitTransform" in a||"MozTransform" in a||"msTransform" in a||"MsTransform" in a||"OTransform" in a)
})(),transitions:(window.Modernizr&&Modernizr.csstransitions===true)||(function(){var a=document.createElement("div").style;
return("transition" in a||"WebkitTransition" in a||"MozTransition" in a||"msTransition" in a||"MsTransition" in a||"OTransition" in a)
})(),classList:(function(){var a=document.createElement("div");
return"classList" in a
})()},browser:{ie8:(function(){var c=-1;
if(navigator.appName==="Microsoft Internet Explorer"){var a=navigator.userAgent;
var b=new RegExp(/MSIE ([0-9]{1,}[\.0-9]{0,})/);
if(b.exec(a)!==null){c=parseFloat(RegExp.$1)
}}return c!==-1&&c<9
})(),ie10:window.navigator.msPointerEnabled,ie11:window.navigator.pointerEnabled}};
if(window.jQuery||window.Zepto){(function(a){a.fn.swiper=function(c){var b;
this.each(function(d){var f=a(this);
if(!f.data("swiper")){var e=new Swiper(f[0],c);
if(!d){b=e
}f.data("swiper",e)
}});
return b
}
})(window.jQuery||window.Zepto)
}if(typeof(module)!=="undefined"){module.exports=Swiper
}if(typeof define==="function"&&define.amd){define([],function(){return Swiper
});
/*! A fix for the iOS orientationchange zoom bug.
 Script by @scottjehl, rebound by @wilto.
 MIT / GPLv2 License.
 https://github.com/scottjehl/iOS-Orientationchange-Fix/blob/master/ios-orientationchange-fix.js
*/
}(function(n){var d=navigator.userAgent;
if(!(/iPhone|iPad|iPod/.test(navigator.platform)&&/OS [1-5]_[0-9_]* like Mac OS X/i.test(d)&&d.indexOf("AppleWebKit")>-1)){return
}var m=n.document;
if(!m.querySelector){return
}var o=m.querySelector("meta[name=viewport]"),a=o&&o.getAttribute("content"),l=a+",maximum-scale=1",e=a+",maximum-scale=10",h=true,k,j,i,c;
if(!o){return
}function g(){o.setAttribute("content",e);
h=true
}function b(){o.setAttribute("content",l);
h=false
}function f(p){c=p.accelerationIncludingGravity;
k=Math.abs(c.x);
j=Math.abs(c.y);
i=Math.abs(c.z);
if((!n.orientation||n.orientation===180)&&(k>7||((i>6&&j<8||i<8&&j>6)&&k>5))){if(h){b()
}}else{if(!h){g()
}}}n.addEventListener("orientationchange",g,false);
n.addEventListener("devicemotion",f,false);
$(window).on("load",function(){g()
})
})(this);
/*!
 * jQuery Cookie Plugin v1.4.1
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2006, 2014 Klaus Hartl
 * Released under the MIT license
 */
(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)
}else{if(typeof exports==="object"){a(require("jquery"))
}else{a(jQuery)
}}}(function(f){var a=/\+/g;
function d(i){return b.raw?i:encodeURIComponent(i)
}function g(i){return b.raw?i:decodeURIComponent(i)
}function h(i){return d(b.json?JSON.stringify(i):String(i))
}function c(i){if(i.indexOf('"')===0){i=i.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\")
}try{i=decodeURIComponent(i.replace(a," "));
return b.json?JSON.parse(i):i
}catch(j){}}function e(j,i){var k=b.raw?j:c(j);
return f.isFunction(i)?i(k):k
}var b=f.cookie=function(q,p,v){if(arguments.length>1&&!f.isFunction(p)){v=f.extend({},b.defaults,v);
if(typeof v.expires==="number"){var r=v.expires,u=v.expires=new Date();
u.setTime(+u+r*86400000)
}return(document.cookie=[d(q),"=",h(p),v.expires?"; expires="+v.expires.toUTCString():"",v.path?"; path="+v.path:"",v.domain?"; domain="+v.domain:"",v.secure?"; secure":""].join(""))
}var w=q?undefined:{};
var s=document.cookie?document.cookie.split("; "):[];
for(var o=0,m=s.length;
o<m;
o++){var n=s[o].split("=");
var j=g(n.shift());
var k=n.join("=");
if(q&&q===j){w=e(k,p);
break
}if(!q&&(k=e(k))!==undefined){w[j]=k
}}return w
};
b.defaults={};
f.removeCookie=function(j,i){if(f.cookie(j)===undefined){return false
}f.cookie(j,"",f.extend({},i,{expires:-1}));
return !f.cookie(j)
}
}));
/*! http://mths.be/placeholder v2.1.0 by @mathias */
(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)
}else{a(jQuery)
}}(function(g){var b=Object.prototype.toString.call(window.operamini)=="[object OperaMini]";
var a="placeholder" in document.createElement("input")&&!b;
var h="placeholder" in document.createElement("textarea")&&!b;
var f=g.valHooks;
var c=g.propHooks;
var l;
var k;
if(a&&h){k=g.fn.placeholder=function(){return this
};
k.input=k.textarea=true
}else{var e={};
k=g.fn.placeholder=function(n){var p={customClass:"placeholder"};
e=g.extend({},p,n);
var o=this;
o.filter((a?"textarea":":input")+"[placeholder]").not("."+e.customClass).bind({"focus.placeholder":d,"blur.placeholder":i}).data("placeholder-enabled",true).trigger("blur.placeholder");
return o
};
k.input=a;
k.textarea=h;
l={get:function(o){var n=g(o);
var p=n.data("placeholder-password");
if(p){return p[0].value
}return n.data("placeholder-enabled")&&n.hasClass(e.customClass)?"":o.value
},set:function(o,q){var n=g(o);
var p=n.data("placeholder-password");
if(p){return p[0].value=q
}if(!n.data("placeholder-enabled")){return o.value=q
}if(q===""){o.value=q;
if(o!=m()){i.call(o)
}}else{if(n.hasClass(e.customClass)){d.call(o,true,q)||(o.value=q)
}else{o.value=q
}}return n
}};
if(!a){f.input=l;
c.value=l
}if(!h){f.textarea=l;
c.value=l
}g(function(){g(document).delegate("form","submit.placeholder",function(){var n=g("."+e.customClass,this).each(d);
setTimeout(function(){n.each(i)
},10)
})
});
g(window).bind("beforeunload.placeholder",function(){g("."+e.customClass).each(function(){this.value=""
})
})
}function j(o){var n={};
var p=/^jQuery\d+$/;
g.each(o.attributes,function(r,q){if(q.specified&&!p.test(q.name)){n[q.name]=q.value
}});
return n
}function d(o,p){var n=this;
var q=g(n);
if(n.value==q.attr("placeholder")&&q.hasClass(e.customClass)){if(q.data("placeholder-password")){q=q.hide().nextAll('input[type="password"]:first').show().attr("id",q.removeAttr("id").data("placeholder-id"));
if(o===true){return q[0].value=p
}q.focus()
}else{n.value="";
q.removeClass(e.customClass);
n==m()&&n.select()
}}}function i(){var r;
var n=this;
var q=g(n);
var p=this.id;
if(n.value===""){if(n.type==="password"){if(!q.data("placeholder-textinput")){try{r=q.clone().attr({type:"text"})
}catch(o){r=g("<input>").attr(g.extend(j(this),{type:"text"}))
}r.removeAttr("name").data({"placeholder-password":q,"placeholder-id":p}).bind("focus.placeholder",d);
q.data({"placeholder-textinput":r,"placeholder-id":p}).before(r)
}q=q.removeAttr("id").hide().prevAll('input[type="text"]:first').attr("id",p).show()
}q.addClass(e.customClass);
q[0].value=q.attr("placeholder")
}else{q.removeClass(e.customClass)
}}function m(){try{return document.activeElement
}catch(n){}}}));
/*!
 * Packery PACKAGED v1.3.2
 * bin-packing layout library
 * http://packery.metafizzy.co
 *
 * Commercial use requires one-time purchase of a commercial license
 * http://packery.metafizzy.co/license.html
 *
 * Non-commercial use is licensed under the GPL v3 License
 *
 * Copyright 2015 Metafizzy
 */
(function(c){var d=Array.prototype.slice;
function b(){}function a(f){if(!f){return
}function h(i){if(i.prototype.option){return
}i.prototype.option=function(j){if(!f.isPlainObject(j)){return
}this.options=f.extend(true,this.options,j)
}
}var e=typeof console==="undefined"?b:function(i){console.error(i)
};
function g(i,j){f.fn[i]=function(n){if(typeof n==="string"){var m=d.call(arguments,1);
for(var o=0,l=this.length;
o<l;
o++){var q=this[o];
var k=f.data(q,i);
if(!k){e("cannot call methods on "+i+" prior to initialization; attempted to call '"+n+"'");
continue
}if(!f.isFunction(k[n])||n.charAt(0)==="_"){e("no such method '"+n+"' for "+i+" instance");
continue
}var p=k[n].apply(k,m);
if(p!==undefined){return p
}}return this
}else{return this.each(function(){var r=f.data(this,i);
if(r){r.option(n);
r._init()
}else{r=new j(this,n);
f.data(this,i,r)
}})
}}
}f.bridget=function(i,j){h(j);
g(i,j)
};
return f.bridget
}if(typeof define==="function"&&define.amd){define("jquery-bridget/jquery.bridget",["jquery"],a)
}else{if(typeof exports==="object"){a(require("jquery"))
}else{a(c.jQuery)
}}})(window);
/*!
 * classie v1.0.1
 * class helper functions
 * from bonzo https://github.com/ded/bonzo
 * MIT license
 * 
 * classie.has( elem, 'my-class' ) -> true/false
 * classie.add( elem, 'my-new-class' )
 * classie.remove( elem, 'my-unwanted-class' )
 * classie.toggle( elem, 'my-class' )
 */
(function(e){function a(h){return new RegExp("(^|\\s+)"+h+"(\\s+|$)")
}var d,f,g;
if("classList" in document.documentElement){d=function(h,i){return h.classList.contains(i)
};
f=function(h,i){h.classList.add(i)
};
g=function(h,i){h.classList.remove(i)
}
}else{d=function(h,i){return a(i).test(h.className)
};
f=function(h,i){if(!d(h,i)){h.className=h.className+" "+i
}};
g=function(h,i){h.className=h.className.replace(a(i)," ")
}
}function b(i,j){var h=d(i,j)?g:f;
h(i,j)
}var c={hasClass:d,addClass:f,removeClass:g,toggleClass:b,has:d,add:f,remove:g,toggle:b};
if(typeof define==="function"&&define.amd){define("classie/classie",c)
}else{if(typeof exports==="object"){module.exports=c
}else{e.classie=c
}}})(window);
/*!
 * getStyleProperty v1.0.4
 * original by kangax
 * http://perfectionkills.com/feature-testing-css-properties/
 * MIT license
 */
(function(c){var d="Webkit Moz ms Ms O".split(" ");
var b=document.documentElement.style;
function a(h){if(!h){return
}if(typeof b[h]==="string"){return h
}h=h.charAt(0).toUpperCase()+h.slice(1);
var f;
for(var g=0,e=d.length;
g<e;
g++){f=d[g]+h;
if(typeof b[f]==="string"){return f
}}}if(typeof define==="function"&&define.amd){define("get-style-property/get-style-property",[],function(){return a
})
}else{if(typeof exports==="object"){module.exports=a
}else{c.getStyleProperty=a
}}})(window);
/*!
 * getSize v1.2.2
 * measure size of elements
 * MIT license
 */
(function(e,g){function b(j){var i=parseFloat(j);
var k=j.indexOf("%")===-1&&!isNaN(i);
return k&&i
}function d(){}var c=typeof console==="undefined"?d:function(i){console.error(i)
};
var a=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"];
function f(){var l={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0};
for(var k=0,j=a.length;
k<j;
k++){var m=a[k];
l[m]=0
}return l
}function h(o){var m=false;
var k,l,n;
function j(){if(m){return
}m=true;
var s=e.getComputedStyle;
k=(function(){var v=s?function(w){return s(w,null)
}:function(w){return w.currentStyle
};
return function u(x){var w=v(x);
if(!w){c("Style returned "+w+". Are you running this code in a hidden iframe on Firefox? See http://bit.ly/getsizebug1")
}return w
}
})();
l=o("boxSizing");
if(l){var t=document.createElement("div");
t.style.width="200px";
t.style.padding="1px 2px 3px 4px";
t.style.borderStyle="solid";
t.style.borderWidth="1px 2px 3px 4px";
t.style[l]="border-box";
var q=document.body||document.documentElement;
q.appendChild(t);
var r=k(t);
n=b(r.width)===200;
q.removeChild(t)
}}function p(F){j();
if(typeof F==="string"){F=document.querySelector(F)
}if(!F||typeof F!=="object"||!F.nodeType){return
}var D=k(F);
if(D.display==="none"){return f()
}var w={};
w.width=F.offsetWidth;
w.height=F.offsetHeight;
var E=w.isBorderBox=!!(l&&D[l]&&D[l]==="border-box");
for(var A=0,B=a.length;
A<B;
A++){var y=a[A];
var z=D[y];
z=i(F,z);
var q=parseFloat(z);
w[y]=!isNaN(q)?q:0
}var C=w.paddingLeft+w.paddingRight;
var v=w.paddingTop+w.paddingBottom;
var H=w.marginLeft+w.marginRight;
var t=w.marginTop+w.marginBottom;
var G=w.borderLeftWidth+w.borderRightWidth;
var s=w.borderTopWidth+w.borderBottomWidth;
var r=E&&n;
var u=b(D.width);
if(u!==false){w.width=u+(r?0:C+G)
}var x=b(D.height);
if(x!==false){w.height=x+(r?0:v+s)
}w.innerWidth=w.width-(C+G);
w.innerHeight=w.height-(v+s);
w.outerWidth=w.width+H;
w.outerHeight=w.height+t;
return w
}function i(t,u){if(e.getComputedStyle||u.indexOf("%")===-1){return u
}var s=t.style;
var v=s.left;
var r=t.runtimeStyle;
var q=r&&r.left;
if(q){r.left=t.currentStyle.left
}s.left=u;
u=s.pixelLeft;
s.left=v;
if(q){r.left=q
}return u
}return p
}if(typeof define==="function"&&define.amd){define("get-size/get-size",["get-style-property/get-style-property"],h)
}else{if(typeof exports==="object"){module.exports=h(require("desandro-get-style-property"))
}else{e.getSize=h(e.getStyleProperty)
}}})(window);
/*!
 * eventie v1.0.6
 * event binding helper
 *   eventie.bind( elem, 'click', myFn )
 *   eventie.unbind( elem, 'click', myFn )
 * MIT license
 */
(function(e){var b=document.documentElement;
var f=function(){};
function a(h){var g=e.event;
g.target=g.target||g.srcElement||h;
return g
}if(b.addEventListener){f=function(i,h,g){i.addEventListener(h,g,false)
}
}else{if(b.attachEvent){f=function(i,h,g){i[h+g]=g.handleEvent?function(){var j=a(i);
g.handleEvent.call(g,j)
}:function(){var j=a(i);
g.call(i,j)
};
i.attachEvent("on"+h,i[h+g])
}
}}var d=function(){};
if(b.removeEventListener){d=function(i,h,g){i.removeEventListener(h,g,false)
}
}else{if(b.detachEvent){d=function(j,h,g){j.detachEvent("on"+h,j[h+g]);
try{delete j[h+g]
}catch(i){j[h+g]=undefined
}}
}}var c={bind:f,unbind:d};
if(typeof define==="function"&&define.amd){define("eventie/eventie",c)
}else{if(typeof exports==="object"){module.exports=c
}else{e.eventie=c
}}})(window);
/*!
 * docReady v1.0.4
 * Cross browser DOMContentLoaded event emitter
 * MIT license
 */
(function(e){var b=e.document;
var a=[];
function d(h){if(typeof h!=="function"){return
}if(d.isReady){h()
}else{a.push(h)
}}d.isReady=false;
function g(i){var h=i.type==="readystatechange"&&b.readyState!=="complete";
if(d.isReady||h){return
}c()
}function c(){d.isReady=true;
for(var j=0,h=a.length;
j<h;
j++){var k=a[j];
k()
}}function f(h){if(b.readyState==="complete"){c()
}else{h.bind(b,"DOMContentLoaded",g);
h.bind(b,"readystatechange",g);
h.bind(e,"load",g)
}return d
}if(typeof define==="function"&&define.amd){define("doc-ready/doc-ready",["eventie/eventie"],f)
}else{if(typeof exports==="object"){module.exports=f(require("eventie"))
}else{e.docReady=f(e.eventie)
}}})(window);
/*!
 * EventEmitter v4.2.11 - git.io/ee
 * Unlicense - http://unlicense.org/
 * Oliver Caldwell - http://oli.me.uk/
 * @preserve
 */
(function(){function c(){}var l=c.prototype;
var v=this;
var x=v.EventEmitter;
function h(z,A){var y=z.length;
while(y--){if(z[y].listener===A){return y
}}return -1
}function j(y){return function z(){return this[y].apply(this,arguments)
}
}l.getListeners=function t(y){var B=this._getEvents();
var z;
var A;
if(y instanceof RegExp){z={};
for(A in B){if(B.hasOwnProperty(A)&&y.test(A)){z[A]=B[A]
}}}else{z=B[y]||(B[y]=[])
}return z
};
l.flattenListeners=function r(A){var y=[];
var z;
for(z=0;
z<A.length;
z+=1){y.push(A[z].listener)
}return y
};
l.getListenersAsObject=function e(y){var A=this.getListeners(y);
var z;
if(A instanceof Array){z={};
z[y]=A
}return z||A
};
l.addListener=function f(y,B){var A=this.getListenersAsObject(y);
var C=typeof B==="object";
var z;
for(z in A){if(A.hasOwnProperty(z)&&h(A[z],B)===-1){A[z].push(C?B:{listener:B,once:false})
}}return this
};
l.on=j("addListener");
l.addOnceListener=function a(y,z){return this.addListener(y,{listener:z,once:true})
};
l.once=j("addOnceListener");
l.defineEvent=function p(y){this.getListeners(y);
return this
};
l.defineEvents=function q(y){for(var z=0;
z<y.length;
z+=1){this.defineEvent(y[z])
}return this
};
l.removeListener=function b(y,C){var B=this.getListenersAsObject(y);
var z;
var A;
for(A in B){if(B.hasOwnProperty(A)){z=h(B[A],C);
if(z!==-1){B[A].splice(z,1)
}}}return this
};
l.off=j("removeListener");
l.addListeners=function m(y,z){return this.manipulateListeners(false,y,z)
};
l.removeListeners=function s(y,z){return this.manipulateListeners(true,y,z)
};
l.manipulateListeners=function g(z,A,C){var B;
var D;
var E=z?this.removeListener:this.addListener;
var y=z?this.removeListeners:this.addListeners;
if(typeof A==="object"&&!(A instanceof RegExp)){for(B in A){if(A.hasOwnProperty(B)&&(D=A[B])){if(typeof D==="function"){E.call(this,B,D)
}else{y.call(this,B,D)
}}}}else{B=C.length;
while(B--){E.call(this,A,C[B])
}}return this
};
l.removeEvent=function o(y){var B=typeof y;
var A=this._getEvents();
var z;
if(B==="string"){delete A[y]
}else{if(y instanceof RegExp){for(z in A){if(A.hasOwnProperty(z)&&y.test(z)){delete A[z]
}}}else{delete this._events
}}return this
};
l.removeAllListeners=j("removeEvent");
l.emitEvent=function u(y,A){var D=this.getListenersAsObject(y);
var E;
var C;
var B;
var z;
for(B in D){if(D.hasOwnProperty(B)){C=D[B].length;
while(C--){E=D[B][C];
if(E.once===true){this.removeListener(y,E.listener)
}z=E.listener.apply(this,A||[]);
if(z===this._getOnceReturnValue()){this.removeListener(y,E.listener)
}}}}return this
};
l.trigger=j("emitEvent");
l.emit=function k(y){var z=Array.prototype.slice.call(arguments,1);
return this.emitEvent(y,z)
};
l.setOnceReturnValue=function i(y){this._onceReturnValue=y;
return this
};
l._getOnceReturnValue=function n(){if(this.hasOwnProperty("_onceReturnValue")){return this._onceReturnValue
}else{return true
}};
l._getEvents=function d(){return this._events||(this._events={})
};
c.noConflict=function w(){v.EventEmitter=x;
return c
};
if(typeof define==="function"&&define.amd){define("eventEmitter/EventEmitter",[],function(){return c
})
}else{if(typeof module==="object"&&module.exports){module.exports=c
}else{v.EventEmitter=c
}}}.call(this));
(function(h){var f=(function(){if(h.matchesSelector){return"matchesSelector"
}var m=["webkit","moz","ms","o"];
for(var k=0,j=m.length;
k<j;
k++){var l=m[k];
var n=l+"MatchesSelector";
if(h[n]){return n
}}})();
function d(k,j){return k[f](j)
}function g(k){if(k.parentNode){return
}var j=document.createDocumentFragment();
j.appendChild(k)
}function e(n,k){g(n);
var l=n.parentNode.querySelectorAll(k);
for(var m=0,j=l.length;
m<j;
m++){if(l[m]===n){return true
}}return false
}function c(k,j){g(k);
return d(k,j)
}var i;
if(f){var a=document.createElement("div");
var b=d(a,"div");
i=b?d:c
}else{i=e
}if(typeof define==="function"&&define.amd){define("matches-selector/matches-selector",[],function(){return i
})
}else{if(typeof exports==="object"){module.exports=i
}else{window.matchesSelector=i
}}})(Element.prototype);
(function(c){var e=c.getComputedStyle;
var b=e?function(h){return e(h,null)
}:function(h){return h.currentStyle
};
function g(i,h){for(var j in h){i[j]=h[j]
}return i
}function a(h){for(var i in h){return false
}i=null;
return true
}function d(h){return h.replace(/([A-Z])/g,function(i){return"-"+i.toLowerCase()
})
}function f(v,u,k){var t=k("transition");
var q=k("transform");
var r=t&&q;
var o=!!k("perspective");
var h={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"otransitionend",transition:"transitionend"}[t];
var m=["transform","transition","transitionDuration","transitionProperty"];
var s=(function(){var x={};
for(var y=0,w=m.length;
y<w;
y++){var A=m[y];
var z=k(A);
if(z&&z!==A){x[A]=z
}}return x
})();
function j(w,x){if(!w){return
}this.element=w;
this.layout=x;
this.position={x:0,y:0};
this._create()
}g(j.prototype,v.prototype);
j.prototype._create=function(){this._transn={ingProperties:{},clean:{},onEnd:{}};
this.css({position:"absolute"})
};
j.prototype.handleEvent=function(w){var x="on"+w.type;
if(this[x]){this[x](w)
}};
j.prototype.getSize=function(){this.size=u(this.element)
};
j.prototype.css=function(y){var w=this.element.style;
for(var z in y){var x=s[z]||z;
w[x]=y[z]
}};
j.prototype.getPosition=function(){var B=b(this.element);
var z=this.layout.options;
var E=z.isOriginLeft;
var D=z.isOriginTop;
var w=parseInt(B[E?"left":"right"],10);
var C=parseInt(B[D?"top":"bottom"],10);
w=isNaN(w)?0:w;
C=isNaN(C)?0:C;
var A=this.layout.size;
w-=E?A.paddingLeft:A.paddingRight;
C-=D?A.paddingTop:A.paddingBottom;
this.position.x=w;
this.position.y=C
};
j.prototype.layoutPosition=function(){var x=this.layout.size;
var w=this.layout.options;
var y={};
if(w.isOriginLeft){y.left=(this.position.x+x.paddingLeft)+"px";
y.right=""
}else{y.right=(this.position.x+x.paddingRight)+"px";
y.left=""
}if(w.isOriginTop){y.top=(this.position.y+x.paddingTop)+"px";
y.bottom=""
}else{y.bottom=(this.position.y+x.paddingBottom)+"px";
y.top=""
}this.css(y);
this.emitEvent("layout",[this])
};
var i=o?function(w,z){return"translate3d("+w+"px, "+z+"px, 0)"
}:function(w,z){return"translate("+w+"px, "+z+"px)"
};
j.prototype._transitionTo=function(H,G){this.getPosition();
var z=this.position.x;
var w=this.position.y;
var F=parseInt(H,10);
var E=parseInt(G,10);
var D=F===this.position.x&&E===this.position.y;
this.setPosition(H,G);
if(D&&!this.isTransitioning){this.layoutPosition();
return
}var C=H-z;
var B=G-w;
var A={};
var I=this.layout.options;
C=I.isOriginLeft?C:-C;
B=I.isOriginTop?B:-B;
A.transform=i(C,B);
this.transition({to:A,onTransitionEnd:{transform:this.layoutPosition},isCleaning:true})
};
j.prototype.goTo=function(w,z){this.setPosition(w,z);
this.layoutPosition()
};
j.prototype.moveTo=r?j.prototype._transitionTo:j.prototype.goTo;
j.prototype.setPosition=function(w,z){this.position.x=parseInt(w,10);
this.position.y=parseInt(z,10)
};
j.prototype._nonTransition=function(w){this.css(w.to);
if(w.isCleaning){this._removeStyles(w.to)
}for(var x in w.onTransitionEnd){w.onTransitionEnd[x].call(this)
}};
j.prototype._transition=function(w){if(!parseFloat(this.layout.options.transitionDuration)){this._nonTransition(w);
return
}var y=this._transn;
for(var z in w.onTransitionEnd){y.onEnd[z]=w.onTransitionEnd[z]
}for(z in w.to){y.ingProperties[z]=true;
if(w.isCleaning){y.clean[z]=true
}}if(w.from){this.css(w.from);
var x=this.element.offsetHeight;
x=null
}this.enableTransition(w.to);
this.css(w.to);
this.isTransitioning=true
};
var l=q&&(d(q)+",opacity");
j.prototype.enableTransition=function(){if(this.isTransitioning){return
}this.css({transitionProperty:l,transitionDuration:this.layout.options.transitionDuration});
this.element.addEventListener(h,this,false)
};
j.prototype.transition=j.prototype[t?"_transition":"_nonTransition"];
j.prototype.onwebkitTransitionEnd=function(w){this.ontransitionend(w)
};
j.prototype.onotransitionend=function(w){this.ontransitionend(w)
};
var n={"-webkit-transform":"transform","-moz-transform":"transform","-o-transform":"transform"};
j.prototype.ontransitionend=function(z){if(z.target!==this.element){return
}var y=this._transn;
var w=n[z.propertyName]||z.propertyName;
delete y.ingProperties[w];
if(a(y.ingProperties)){this.disableTransition()
}if(w in y.clean){this.element.style[z.propertyName]="";
delete y.clean[w]
}if(w in y.onEnd){var x=y.onEnd[w];
x.call(this);
delete y.onEnd[w]
}this.emitEvent("transitionEnd",[this])
};
j.prototype.disableTransition=function(){this.removeTransitionStyles();
this.element.removeEventListener(h,this,false);
this.isTransitioning=false
};
j.prototype._removeStyles=function(x){var w={};
for(var y in x){w[y]=""
}this.css(w)
};
var p={transitionProperty:"",transitionDuration:""};
j.prototype.removeTransitionStyles=function(){this.css(p)
};
j.prototype.removeElem=function(){this.element.parentNode.removeChild(this.element);
this.emitEvent("remove",[this])
};
j.prototype.remove=function(){if(!t||!parseFloat(this.layout.options.transitionDuration)){this.removeElem();
return
}var w=this;
this.on("transitionEnd",function(){w.removeElem();
return true
});
this.hide()
};
j.prototype.reveal=function(){delete this.isHidden;
this.css({display:""});
var w=this.layout.options;
this.transition({from:w.hiddenStyle,to:w.visibleStyle,isCleaning:true})
};
j.prototype.hide=function(){this.isHidden=true;
this.css({display:""});
var w=this.layout.options;
this.transition({from:w.visibleStyle,to:w.hiddenStyle,isCleaning:true,onTransitionEnd:{opacity:function(){if(this.isHidden){this.css({display:"none"})
}}}})
};
j.prototype.destroy=function(){this.css({position:"",left:"",right:"",top:"",bottom:"",transition:"",transform:""})
};
return j
}if(typeof define==="function"&&define.amd){define("outlayer/item",["eventEmitter/EventEmitter","get-size/get-size","get-style-property/get-style-property"],f)
}else{if(typeof exports==="object"){module.exports=f(require("wolfy87-eventemitter"),require("get-size"),require("desandro-get-style-property"))
}else{c.Outlayer={};
c.Outlayer.Item=f(c.EventEmitter,c.getSize,c.getStyleProperty)
}}})(window);
/*!
 * Outlayer v1.3.0
 * the brains and guts of a layout library
 * MIT license
 */
(function(f){var i=f.document;
var c=f.console;
var o=f.jQuery;
var n=function(){};
function h(r,q){for(var s in q){r[s]=q[s]
}return r
}var p=Object.prototype.toString;
function d(q){return p.call(q)==="[object Array]"
}function a(t){var s=[];
if(d(t)){s=t
}else{if(t&&typeof t.length==="number"){for(var r=0,q=t.length;
r<q;
r++){s.push(t[r])
}}else{s.push(t)
}}return s
}var g=(typeof HTMLElement==="function"||typeof HTMLElement==="object")?function e(q){return q instanceof HTMLElement
}:function b(q){return q&&typeof q==="object"&&q.nodeType===1&&typeof q.nodeName==="string"
};
var j=Array.prototype.indexOf?function(q,r){return q.indexOf(r)
}:function(s,t){for(var r=0,q=s.length;
r<q;
r++){if(s[r]===t){return r
}}return -1
};
function l(s,r){var q=j(r,s);
if(q!==-1){r.splice(q,1)
}}function k(q){return q.replace(/(.)([A-Z])/g,function(s,r,t){return r+"-"+t
}).toLowerCase()
}function m(v,r,x,w,y,s){var u=0;
var q={};
function t(A,z){if(typeof A==="string"){A=i.querySelector(A)
}if(!A||!g(A)){if(c){c.error("Bad "+this.constructor.namespace+" element: "+A)
}return
}this.element=A;
this.options=h({},this.constructor.defaults);
this.option(z);
var B=++u;
this.element.outlayerGUID=B;
q[B]=this;
this._create();
if(this.options.isInitLayout){this.layout()
}}t.namespace="outlayer";
t.Item=s;
t.defaults={containerStyle:{position:"relative"},isInitLayout:true,isOriginLeft:true,isOriginTop:true,isResizeBound:true,isResizingContainer:true,transitionDuration:"0.4s",hiddenStyle:{opacity:0,transform:"scale(0.001)"},visibleStyle:{opacity:1,transform:"scale(1)"}};
h(t.prototype,x.prototype);
t.prototype.option=function(z){h(this.options,z)
};
t.prototype._create=function(){this.reloadItems();
this.stamps=[];
this.stamp(this.options.stamp);
h(this.element.style,this.options.containerStyle);
if(this.options.isResizeBound){this.bindResize()
}};
t.prototype.reloadItems=function(){this.items=this._itemize(this.element.children)
};
t.prototype._itemize=function(B){var E=this._filterFindItemElements(B);
var C=this.constructor.Item;
var A=[];
for(var D=0,z=E.length;
D<z;
D++){var G=E[D];
var F=new C(G,this);
A.push(F)
}return A
};
t.prototype._filterFindItemElements=function(z){z=a(z);
var A=this.options.itemSelector;
var E=[];
for(var D=0,F=z.length;
D<F;
D++){var B=z[D];
if(!g(B)){continue
}if(A){if(y(B,A)){E.push(B)
}var G=B.querySelectorAll(A);
for(var C=0,H=G.length;
C<H;
C++){E.push(G[C])
}}else{E.push(B)
}}return E
};
t.prototype.getItemElements=function(){var A=[];
for(var B=0,z=this.items.length;
B<z;
B++){A.push(this.items[B].element)
}return A
};
t.prototype.layout=function(){this._resetLayout();
this._manageStamps();
var z=this.options.isLayoutInstant!==undefined?this.options.isLayoutInstant:!this._isLayoutInited;
this.layoutItems(this.items,z);
this._isLayoutInited=true
};
t.prototype._init=t.prototype.layout;
t.prototype._resetLayout=function(){this.getSize()
};
t.prototype.getSize=function(){this.size=w(this.element)
};
t.prototype._getMeasurement=function(B,z){var A=this.options[B];
var C;
if(!A){this[B]=0
}else{if(typeof A==="string"){C=this.element.querySelector(A)
}else{if(g(A)){C=A
}}this[B]=C?w(C)[z]:A
}};
t.prototype.layoutItems=function(z,A){z=this._getItemsForLayout(z);
this._layoutItems(z,A);
this._postLayout()
};
t.prototype._getItemsForLayout=function(A){var D=[];
for(var B=0,z=A.length;
B<z;
B++){var C=A[B];
if(!C.isIgnored){D.push(C)
}}return D
};
t.prototype._layoutItems=function(G,F){var D=this;
function z(){D.emitEvent("layoutComplete",[D,G])
}if(!G||!G.length){z();
return
}this._itemsOn(G,"layout",z);
var C=[];
for(var A=0,E=G.length;
A<E;
A++){var H=G[A];
var B=this._getItemLayoutPosition(H);
B.item=H;
B.isInstant=F||H.isLayoutInstant;
C.push(B)
}this._processLayoutQueue(C)
};
t.prototype._getItemLayoutPosition=function(){return{x:0,y:0}
};
t.prototype._processLayoutQueue=function(A){for(var B=0,z=A.length;
B<z;
B++){var C=A[B];
this._positionItem(C.item,C.x,C.y,C.isInstant)
}};
t.prototype._positionItem=function(A,z,C,B){if(B){A.goTo(z,C)
}else{A.moveTo(z,C)
}};
t.prototype._postLayout=function(){this.resizeContainer()
};
t.prototype.resizeContainer=function(){if(!this.options.isResizingContainer){return
}var z=this._getContainerSize();
if(z){this._setContainerMeasure(z.width,true);
this._setContainerMeasure(z.height,false)
}};
t.prototype._getContainerSize=n;
t.prototype._setContainerMeasure=function(z,A){if(z===undefined){return
}var B=this.size;
if(B.isBorderBox){z+=A?B.paddingLeft+B.paddingRight+B.borderLeftWidth+B.borderRightWidth:B.paddingBottom+B.paddingTop+B.borderTopWidth+B.borderBottomWidth
}z=Math.max(z,0);
this.element.style[A?"width":"height"]=z+"px"
};
t.prototype._itemsOn=function(G,C,H){var z=0;
var F=G.length;
var E=this;
function B(){z++;
if(z===F){H.call(E)
}return true
}for(var A=0,D=G.length;
A<D;
A++){var I=G[A];
I.on(C,B)
}};
t.prototype.ignore=function(A){var z=this.getItem(A);
if(z){z.isIgnored=true
}};
t.prototype.unignore=function(A){var z=this.getItem(A);
if(z){delete z.isIgnored
}};
t.prototype.stamp=function(A){A=this._find(A);
if(!A){return
}this.stamps=this.stamps.concat(A);
for(var B=0,z=A.length;
B<z;
B++){var C=A[B];
this.ignore(C)
}};
t.prototype.unstamp=function(A){A=this._find(A);
if(!A){return
}for(var B=0,z=A.length;
B<z;
B++){var C=A[B];
l(C,this.stamps);
this.unignore(C)
}};
t.prototype._find=function(z){if(!z){return
}if(typeof z==="string"){z=this.element.querySelectorAll(z)
}z=a(z);
return z
};
t.prototype._manageStamps=function(){if(!this.stamps||!this.stamps.length){return
}this._getBoundingRect();
for(var B=0,z=this.stamps.length;
B<z;
B++){var A=this.stamps[B];
this._manageStamp(A)
}};
t.prototype._getBoundingRect=function(){var z=this.element.getBoundingClientRect();
var A=this.size;
this._boundingRect={left:z.left+A.paddingLeft+A.borderLeftWidth,top:z.top+A.paddingTop+A.borderTopWidth,right:z.right-(A.paddingRight+A.borderRightWidth),bottom:z.bottom-(A.paddingBottom+A.borderBottomWidth)}
};
t.prototype._manageStamp=n;
t.prototype._getElementOffset=function(C){var z=C.getBoundingClientRect();
var B=this._boundingRect;
var A=w(C);
var D={left:z.left-B.left-A.marginLeft,top:z.top-B.top-A.marginTop,right:B.right-z.right-A.marginRight,bottom:B.bottom-z.bottom-A.marginBottom};
return D
};
t.prototype.handleEvent=function(z){var A="on"+z.type;
if(this[A]){this[A](z)
}};
t.prototype.bindResize=function(){if(this.isResizeBound){return
}v.bind(f,"resize",this);
this.isResizeBound=true
};
t.prototype.unbindResize=function(){if(this.isResizeBound){v.unbind(f,"resize",this)
}this.isResizeBound=false
};
t.prototype.onresize=function(){if(this.resizeTimeout){clearTimeout(this.resizeTimeout)
}var A=this;
function z(){A.resize();
delete A.resizeTimeout
}this.resizeTimeout=setTimeout(z,100)
};
t.prototype.resize=function(){if(!this.isResizeBound||!this.needsResizeLayout()){return
}this.layout()
};
t.prototype.needsResizeLayout=function(){var A=w(this.element);
var z=this.size&&A;
return z&&A.innerWidth!==this.size.innerWidth
};
t.prototype.addItems=function(A){var z=this._itemize(A);
if(z.length){this.items=this.items.concat(z)
}return z
};
t.prototype.appended=function(A){var z=this.addItems(A);
if(!z.length){return
}this.layoutItems(z,true);
this.reveal(z)
};
t.prototype.prepended=function(A){var z=this._itemize(A);
if(!z.length){return
}var B=this.items.slice(0);
this.items=z.concat(B);
this._resetLayout();
this._manageStamps();
this.layoutItems(z,true);
this.reveal(z);
this.layoutItems(B)
};
t.prototype.reveal=function(A){var z=A&&A.length;
if(!z){return
}for(var B=0;
B<z;
B++){var C=A[B];
C.reveal()
}};
t.prototype.hide=function(A){var z=A&&A.length;
if(!z){return
}for(var B=0;
B<z;
B++){var C=A[B];
C.hide()
}};
t.prototype.getItem=function(C){for(var A=0,z=this.items.length;
A<z;
A++){var B=this.items[A];
if(B.element===C){return B
}}};
t.prototype.getItems=function(B){if(!B||!B.length){return
}var A=[];
for(var C=0,z=B.length;
C<z;
C++){var E=B[C];
var D=this.getItem(E);
if(D){A.push(D)
}}return A
};
t.prototype.remove=function(A){A=a(A);
var C=this.getItems(A);
if(!C||!C.length){return
}this._itemsOn(C,"remove",function(){this.emitEvent("removeComplete",[this,C])
});
for(var B=0,z=C.length;
B<z;
B++){var D=C[B];
D.remove();
l(D,this.items)
}};
t.prototype.destroy=function(){var B=this.element.style;
B.height="";
B.position="";
B.width="";
for(var A=0,z=this.items.length;
A<z;
A++){var C=this.items[A];
C.destroy()
}this.unbindResize();
var D=this.element.outlayerGUID;
delete q[D];
delete this.element.outlayerGUID;
if(o){o.removeData(this.element,this.constructor.namespace)
}};
t.data=function(z){var A=z&&z.outlayerGUID;
return A&&q[A]
};
t.create=function(C,A){function B(){t.apply(this,arguments)
}if(Object.create){B.prototype=Object.create(t.prototype)
}else{h(B.prototype,t.prototype)
}B.prototype.constructor=B;
B.defaults=h({},t.defaults);
h(B.defaults,A);
B.prototype.settings={};
B.namespace=C;
B.data=t.data;
B.Item=function z(){s.apply(this,arguments)
};
B.Item.prototype=new s();
r(function(){var J=k(C);
var D=i.querySelectorAll(".js-"+J);
var K="data-"+J+"-options";
for(var F=0,G=D.length;
F<G;
F++){var E=D[F];
var H=E.getAttribute(K);
var M;
try{M=H&&JSON.parse(H)
}catch(I){if(c){c.error("Error parsing "+K+" on "+E.nodeName.toLowerCase()+(E.id?"#"+E.id:"")+": "+I)
}continue
}var L=new B(E,M);
if(o){o.data(E,C,L)
}}});
if(o&&o.bridget){o.bridget(C,B)
}return B
};
t.Item=s;
return t
}if(typeof define==="function"&&define.amd){define("outlayer/outlayer",["eventie/eventie","doc-ready/doc-ready","eventEmitter/EventEmitter","get-size/get-size","matches-selector/matches-selector","./item"],m)
}else{if(typeof exports==="object"){module.exports=m(require("eventie"),require("doc-ready"),require("wolfy87-eventemitter"),require("get-size"),require("desandro-matches-selector"),require("./item"))
}else{f.Outlayer=m(f.eventie,f.docReady,f.EventEmitter,f.getSize,f.matchesSelector,f.Outlayer.Item)
}}})(window);
(function(b){var c=b.Packery=function(){};
function a(){function d(e){for(var f in d.defaults){this[f]=d.defaults[f]
}for(f in e){this[f]=e[f]
}}c.Rect=d;
d.defaults={x:0,y:0,width:0,height:0};
d.prototype.contains=function(g){var e=g.width||0;
var f=g.height||0;
return this.x<=g.x&&this.y<=g.y&&this.x+this.width>=g.x+e&&this.y+this.height>=g.y+f
};
d.prototype.overlaps=function(h){var i=this.x+this.width;
var e=this.y+this.height;
var f=h.x+h.width;
var g=h.y+h.height;
return this.x<f&&i>h.x&&this.y<g&&e>h.y
};
d.prototype.getMaximalFreeRects=function(j){if(!this.overlaps(j)){return false
}var g=[];
var f;
var k=this.x+this.width;
var e=this.y+this.height;
var h=j.x+j.width;
var i=j.y+j.height;
if(this.y<j.y){f=new d({x:this.x,y:this.y,width:this.width,height:j.y-this.y});
g.push(f)
}if(k>h){f=new d({x:h,y:this.y,width:k-h,height:this.height});
g.push(f)
}if(e>i){f=new d({x:this.x,y:i,width:this.width,height:e-i});
g.push(f)
}if(this.x<j.x){f=new d({x:this.x,y:this.y,width:j.x-this.x,height:this.height});
g.push(f)
}return g
};
d.prototype.canFit=function(e){return this.width>=e.width&&this.height>=e.height
};
return d
}if(typeof define==="function"&&define.amd){define("packery/js/rect",a)
}else{if(typeof exports==="object"){module.exports=a()
}else{b.Packery=b.Packery||{};
b.Packery.Rect=a()
}}})(window);
(function(a){function c(d){function f(h,g,i){this.width=h||0;
this.height=g||0;
this.sortDirection=i||"downwardLeftToRight";
this.reset()
}f.prototype.reset=function(){this.spaces=[];
this.newSpaces=[];
var g=new d({x:0,y:0,width:this.width,height:this.height});
this.spaces.push(g);
this.sorter=e[this.sortDirection]||e.downwardLeftToRight
};
f.prototype.pack=function(j){for(var h=0,g=this.spaces.length;
h<g;
h++){var k=this.spaces[h];
if(k.canFit(j)){this.placeInSpace(j,k);
break
}}};
f.prototype.placeInSpace=function(g,h){g.x=h.x;
g.y=h.y;
this.placed(g)
};
f.prototype.placed=function(l){var h=[];
for(var k=0,g=this.spaces.length;
k<g;
k++){var m=this.spaces[k];
var j=m.getMaximalFreeRects(l);
if(j){h.push.apply(h,j)
}else{h.push(m)
}}this.spaces=h;
this.mergeSortSpaces()
};
f.prototype.mergeSortSpaces=function(){f.mergeRects(this.spaces);
this.spaces.sort(this.sorter)
};
f.prototype.addSpace=function(g){this.spaces.push(g);
this.mergeSortSpaces()
};
f.mergeRects=function(q){for(var k=0,m=q.length;
k<m;
k++){var n=q[k];
if(!n){continue
}var g=q.slice(0);
g.splice(k,1);
var o=0;
for(var h=0,r=g.length;
h<r;
h++){var l=g[h];
var p=k>h?0:1;
if(n.contains(l)){q.splice(h+p-o,1);
o++
}}}return q
};
var e={downwardLeftToRight:function(h,g){return h.y-g.y||h.x-g.x
},rightwardTopToBottom:function(h,g){return h.x-g.x||h.y-g.y
}};
return f
}if(typeof define==="function"&&define.amd){define("packery/js/packer",["./rect"],c)
}else{if(typeof exports==="object"){module.exports=c(require("./rect"))
}else{var b=a.Packery=a.Packery||{};
b.Packer=c(b.Rect)
}}})(window);
(function(b){function a(h,f,e){var g=h("transform");
var d=function i(){f.Item.apply(this,arguments)
};
d.prototype=new f.Item();
var c=d.prototype._create;
d.prototype._create=function(){c.call(this);
this.rect=new e();
this.placeRect=new e()
};
d.prototype.dragStart=function(){this.getPosition();
this.removeTransitionStyles();
if(this.isTransitioning&&g){this.element.style[g]="none"
}this.getSize();
this.isPlacing=true;
this.needsPositioning=false;
this.positionPlaceRect(this.position.x,this.position.y);
this.isTransitioning=false;
this.didDrag=false
};
d.prototype.dragMove=function(j,l){this.didDrag=true;
var k=this.layout.size;
j-=k.paddingLeft;
l-=k.paddingTop;
this.positionPlaceRect(j,l)
};
d.prototype.dragStop=function(){this.getPosition();
var k=this.position.x!==this.placeRect.x;
var j=this.position.y!==this.placeRect.y;
this.needsPositioning=k||j;
this.didDrag=false
};
d.prototype.positionPlaceRect=function(j,l,k){this.placeRect.x=this.getPlaceRectCoord(j,true);
this.placeRect.y=this.getPlaceRectCoord(l,false,k)
};
d.prototype.getPlaceRectCoord=function(o,r,q){var j=r?"Width":"Height";
var s=this.size["outer"+j];
var n=this.layout[r?"columnWidth":"rowHeight"];
var k=this.layout.size["inner"+j];
if(!r){k=Math.max(k,this.layout.maxY);
if(!this.layout.rowHeight){k-=this.layout.gutter
}}var p;
if(n){n+=this.layout.gutter;
k+=r?this.layout.gutter:0;
o=Math.round(o/n);
var m;
if(this.layout.options.isHorizontal){m=!r?"floor":"ceil"
}else{m=r?"floor":"ceil"
}var l=Math[m](k/n);
l-=Math.ceil(s/n);
p=l
}else{p=k-s
}o=q?o:Math.min(o,p);
o*=n||1;
return Math.max(0,o)
};
d.prototype.copyPlaceRectPosition=function(){this.rect.x=this.placeRect.x;
this.rect.y=this.placeRect.y
};
d.prototype.removeElem=function(){this.element.parentNode.removeChild(this.element);
this.layout.packer.addSpace(this.rect);
this.emitEvent("remove",[this])
};
return d
}if(typeof define==="function"&&define.amd){define("packery/js/item",["get-style-property/get-style-property","outlayer/outlayer","./rect"],a)
}else{if(typeof exports==="object"){module.exports=a(require("desandro-get-style-property"),require("outlayer"),require("./rect"))
}else{b.Packery.Item=a(b.getStyleProperty,b.Outlayer,b.Packery.Rect)
}}})(window);
/*!
 * Packery v1.3.2
 * bin-packing layout library
 * http://packery.metafizzy.co
 *
 * Commercial use requires one-time purchase of a commercial license
 * http://packery.metafizzy.co/license.html
 *
 * Non-commercial use is licensed under the GPL v3 License
 *
 * Copyright 2015 Metafizzy
 */
(function(b){function a(h,k,g,c,f,e){c.prototype.canFit=function(l){return this.width>=l.width-1&&this.height>=l.height-1
};
var j=g.create("packery");
j.Item=e;
j.prototype._create=function(){g.prototype._create.call(this);
this.packer=new f();
this.stamp(this.options.stamped);
var o=this;
this.handleDraggabilly={dragStart:function(p){o.itemDragStart(p.element)
},dragMove:function(p){o.itemDragMove(p.element,p.position.x,p.position.y)
},dragEnd:function(p){o.itemDragEnd(p.element)
}};
this.handleUIDraggable={start:function n(p){o.itemDragStart(p.currentTarget)
},drag:function m(p,q){o.itemDragMove(p.currentTarget,q.position.left,q.position.top)
},stop:function l(p){o.itemDragEnd(p.currentTarget)
}}
};
j.prototype._resetLayout=function(){this.getSize();
this._getMeasurements();
var l=this.packer;
if(this.options.isHorizontal){l.width=Number.POSITIVE_INFINITY;
l.height=this.size.innerHeight+this.gutter;
l.sortDirection="rightwardTopToBottom"
}else{l.width=this.size.innerWidth+this.gutter;
l.height=Number.POSITIVE_INFINITY;
l.sortDirection="downwardLeftToRight"
}l.reset();
this.maxY=0;
this.maxX=0
};
j.prototype._getMeasurements=function(){this._getMeasurement("columnWidth","width");
this._getMeasurement("rowHeight","height");
this._getMeasurement("gutter","width")
};
j.prototype._getItemLayoutPosition=function(l){this._packItem(l);
return l.rect
};
j.prototype._packItem=function(l){this._setRectSize(l.element,l.rect);
this.packer.pack(l.rect);
this._setMaxXY(l.rect)
};
j.prototype._setMaxXY=function(l){this.maxX=Math.max(l.x+l.width,this.maxX);
this.maxY=Math.max(l.y+l.height,this.maxY)
};
j.prototype._setRectSize=function(p,o){var m=k(p);
var l=m.outerWidth;
var n=m.outerHeight;
if(l||n){l=this._applyGridGutter(l,this.columnWidth);
n=this._applyGridGutter(n,this.rowHeight)
}o.width=Math.min(l,this.packer.width);
o.height=Math.min(n,this.packer.height)
};
j.prototype._applyGridGutter=function(m,l){if(!l){return m+this.gutter
}l+=this.gutter;
var o=m%l;
var n=o&&o<1?"round":"ceil";
m=Math[n](m/l)*l;
return m
};
j.prototype._getContainerSize=function(){if(this.options.isHorizontal){return{width:this.maxX-this.gutter}
}else{return{height:this.maxY-this.gutter}
}};
j.prototype._manageStamp=function(n){var m=this.getItem(n);
var l;
if(m&&m.isPlacing){l=m.placeRect
}else{var o=this._getElementOffset(n);
l=new c({x:this.options.isOriginLeft?o.left:o.right,y:this.options.isOriginTop?o.top:o.bottom})
}this._setRectSize(n,l);
this.packer.placed(l);
this._setMaxXY(l)
};
function i(m,l){return m.position.y-l.position.y||m.position.x-l.position.x
}function d(m,l){return m.position.x-l.position.x||m.position.y-l.position.y
}j.prototype.sortItemsByPosition=function(){var l=this.options.isHorizontal?d:i;
this.items.sort(l)
};
j.prototype.fit=function(n,l,o){var m=this.getItem(n);
if(!m){return
}this._getMeasurements();
this.stamp(m.element);
m.getSize();
m.isPlacing=true;
l=l===undefined?m.rect.x:l;
o=o===undefined?m.rect.y:o;
m.positionPlaceRect(l,o,true);
this._bindFitEvents(m);
m.moveTo(m.placeRect.x,m.placeRect.y);
this.layout();
this.unstamp(m.element);
this.sortItemsByPosition();
m.isPlacing=false;
m.copyPlaceRectPosition()
};
j.prototype._bindFitEvents=function(n){var o=this;
var m=0;
function l(){m++;
if(m!==2){return
}o.emitEvent("fitComplete",[o,n])
}n.on("layout",function(){l();
return true
});
this.on("layoutComplete",function(){l();
return true
})
};
j.prototype.resize=function(){var n=k(this.element);
var m=this.size&&n;
var l=this.options.isHorizontal?"innerHeight":"innerWidth";
if(m&&n[l]===this.size[l]){return
}this.layout()
};
j.prototype.itemDragStart=function(m){this.stamp(m);
var l=this.getItem(m);
if(l){l.dragStart()
}};
j.prototype.itemDragMove=function(o,l,q){var n=this.getItem(o);
if(n){n.dragMove(l,q)
}var p=this;
function m(){p.layout();
delete p.dragTimeout
}this.clearDragTimeout();
this.dragTimeout=setTimeout(m,40)
};
j.prototype.clearDragTimeout=function(){if(this.dragTimeout){clearTimeout(this.dragTimeout)
}};
j.prototype.itemDragEnd=function(n){var m=this.getItem(n);
var l;
if(m){l=m.didDrag;
m.dragStop()
}if(!m||(!l&&!m.needsPositioning)){this.unstamp(n);
return
}h.add(m.element,"is-positioning-post-drag");
var o=this._getDragEndLayoutComplete(n,m);
if(m.needsPositioning){m.on("layout",o);
m.moveTo(m.placeRect.x,m.placeRect.y)
}else{if(m){m.copyPlaceRectPosition()
}}this.clearDragTimeout();
this.on("layoutComplete",o);
this.layout()
};
j.prototype._getDragEndLayoutComplete=function(p,o){var n=o&&o.needsPositioning;
var l=0;
var m=n?2:1;
var r=this;
return function q(){l++;
if(l!==m){return true
}if(o){h.remove(o.element,"is-positioning-post-drag");
o.isPlacing=false;
o.copyPlaceRectPosition()
}r.unstamp(p);
r.sortItemsByPosition();
if(n){r.emitEvent("dragItemPositioned",[r,o])
}return true
}
};
j.prototype.bindDraggabillyEvents=function(l){l.on("dragStart",this.handleDraggabilly.dragStart);
l.on("dragMove",this.handleDraggabilly.dragMove);
l.on("dragEnd",this.handleDraggabilly.dragEnd)
};
j.prototype.bindUIDraggableEvents=function(l){l.on("dragstart",this.handleUIDraggable.start).on("drag",this.handleUIDraggable.drag).on("dragstop",this.handleUIDraggable.stop)
};
j.Rect=c;
j.Packer=f;
return j
}if(typeof define==="function"&&define.amd){define(["classie/classie","get-size/get-size","outlayer/outlayer","packery/js/rect","packery/js/packer","packery/js/item"],a)
}else{if(typeof exports==="object"){module.exports=a(require("desandro-classie"),require("get-size"),require("outlayer"),require("./rect"),require("./packer"),require("./item"))
}else{b.Packery=a(b.classie,b.getSize,b.Outlayer,b.Packery.Rect,b.Packery.Packer,b.Packery.Item)
}}})(window);
(function(){var a=typeof module!=="undefined"&&module.exports;
var b=typeof Element!=="undefined"&&"ALLOW_KEYBOARD_INPUT" in Element;
var c=(function(){var k;
var j;
var e=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]];
var h=0;
var f=e.length;
var g={};
for(;
h<f;
h++){k=e[h];
if(k&&k[1] in document){for(h=0,j=k.length;
h<j;
h++){g[e[0][h]]=k[h]
}return g
}}return false
})();
var d={request:function(f){var e=c.requestFullscreen;
f=f||document.documentElement;
if(/5\.1[\.\d]* Safari/.test(navigator.userAgent)){f[e]()
}else{f[e](b&&Element.ALLOW_KEYBOARD_INPUT)
}},exit:function(){document[c.exitFullscreen]()
},toggle:function(e){if(this.isFullscreen){this.exit()
}else{this.request(e)
}},raw:c};
if(!c){if(a){module.exports=false
}else{window.screenfull=false
}return
}Object.defineProperties(d,{isFullscreen:{get:function(){return !!document[c.fullscreenElement]
}},element:{enumerable:true,get:function(){return document[c.fullscreenElement]
}},enabled:{enumerable:true,get:function(){return !!document[c.fullscreenEnabled]
}}});
if(a){module.exports=d
}else{window.screenfull=d
}})();
(function(h,o,g){var j={messages:{required:"The %s field is required.",matches:"Your %s entries do not match","default":"Please enter a valid %s.",valid_email:"The %s field must contain a valid email address.",valid_emails:"The %s field must contain all valid email addresses.",min_length:"Please enter a valid %s with a minimum of %s characters.",max_length:"The %s field must not exceed %s characters in length.",exact_length:"The %s field must be exactly %s characters in length.",greater_than:"The %s field must contain a number greater than %s.",less_than:"The %s field must contain a number less than %s.",alpha:"The %s field must only contain alphabetical characters.",alpha_numeric:"The %s field must only contain alpha-numeric characters.",alpha_dash:"The %s field must only contain alpha-numeric characters, underscores, and dashes.",numeric:"The %s field must contain only numbers.",integer:"The %s field must contain an integer.",decimal:"The %s field must contain a decimal number.",is_natural:"The %s field must contain only positive numbers.",is_natural_no_zero:"The %s field must contain a number greater than zero.",valid_ip:"The %s field must contain a valid IP.",valid_base64:"The %s field must contain a base64 string.",valid_credit_card:"The %s field must contain a valid credit card number.",is_file_type:"The %s field must contain only %s files.",valid_url:"The %s field must contain a valid URL."},callback:function(u){}};
var m=/^(.+?)\[(.+)\]$/,c=/^[0-9]+$/,a=/^\-?[0-9]+$/,t=/^\-?[0-9]*\.?[0-9]+$/,n=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,b=/^[a-z]+$/i,l=/^[a-z0-9]+$/i,p=/^[a-z0-9_\-]+$/i,q=/^[0-9]+$/i,k=/^[1-9][0-9]*$/i,s=/^((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){3}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})$/i,i=/[^a-zA-Z0-9\/\+=]/i,f=/^[\d\-\s]+$/,d=/^((http|https):\/\/(\w+:{0,1}\w*@)?(\S+)|)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/;
var r=function(u,y,C,B){this.callback=C||j.callback;
this.errors=[];
this.fields={};
this.form=this._formByNameOrNode(u)||{};
this.messages={};
this.handlers={};
this.conditionals={};
this.beforeCallback=B||function(){return true
};
for(var x=0,w=y.length;
x<w;
x++){var A=y[x];
if((!A.name&&!A.names)||!A.rules){continue
}if(A.names){for(var v=0,z=A.names.length;
v<z;
v++){this._addField(A,A.names[v])
}}else{this._addField(A,A.name)
}}this.originalSubmit=this.form.onsubmit;
this.form.onsubmit=$.proxy(this.submit,this)
},e=function(w,u){var v;
if((w.length>0)&&(w[0].type==="radio"||w[0].type==="checkbox")){for(v=0,elementLength=w.length;
v<elementLength;
v++){if(w[v].checked){return w[v][u]
}}return
}if(u==="value"){return $(w).val()
}return w[u]
};
r.prototype.submit=function(u){if(u&&u.preventDefault){u.preventDefault()
}else{if(event){event.returnValue=false
}}if(this.beforeCallback&&!this.beforeCallback()){return false
}try{return this._validateForm(u)&&(this.originalSubmit===g||this.originalSubmit())
}catch(v){}};
r.prototype.setMessage=function(v,u){this.messages[v]=u;
return this
};
r.prototype.AddField=function(w){if(w.names){for(var u=0,v=w.names.length;
u<v;
u++){this._addField(w,w.names[u])
}}else{this._addField(w,w.name)
}};
r.prototype.RemoveField=function(u){delete this.fields[u]
};
r.prototype.registerCallback=function(u,v){if(u&&typeof u==="string"&&v&&typeof v==="function"){this.handlers[u]=v
}return this
};
r.prototype.registerConditional=function(v,u){if(v&&typeof v==="string"&&u&&typeof u==="function"){this.conditionals[v]=u
}return this
};
r.prototype._formByNameOrNode=function(u){return(typeof u==="object")?u:o.forms[u]
};
r.prototype._addField=function(v,u){this.fields[u]={name:u,display:v.display||u,rules:v.rules,depends:v.depends,id:null,element:null,type:null,value:null,checked:null}
};
r.prototype._validateForm=function(u){this.errors=[];
for(var w in this.fields){if(this.fields.hasOwnProperty(w)){var x=this.fields[w]||{},v=this.form[x.name];
if(v&&v!==g){x.id=e(v,"id");
x.element=v;
x.type=(v.length>0)?v[0].type:v.type;
x.value=e(v,"value");
x.checked=e(v,"checked");
if(x.depends&&typeof x.depends==="function"){if(x.depends.call(this,x)){this._validateField(x)
}}else{if(x.depends&&typeof x.depends==="string"&&this.conditionals[x.depends]){if(this.conditionals[x.depends].call(this,x)){this._validateField(x)
}}else{this._validateField(x)
}}}}}if(typeof this.callback==="function"){this.callback(this.errors,u)
}if(this.errors.length>0){if(u&&u.preventDefault){u.preventDefault();
return false
}else{if(event){event.returnValue=false;
return false
}}}return true
};
r.prototype._validateField=function(D){var E=D.rules.split("|"),w=D.rules.indexOf("required"),A=(!D.value||D.value===""||D.value===g);
for(var B=0,x=E.length;
B<x;
B++){var v=E[B],y=null,C=false,z=m.exec(v);
if(w===-1&&v.indexOf("!callback_")===-1&&A){continue
}if(z){v=z[1];
y=z[2]
}if(v.charAt(0)==="!"){v=v.substring(1,v.length)
}if(typeof this._hooks[v]==="function"){if(!this._hooks[v].apply(this,[D,y])){C=true
}}else{if(v.substring(0,9)==="callback_"){v=v.substring(9,v.length);
if(typeof this.handlers[v]==="function"){if(this.handlers[v].apply(this,[D.value,y,D])===false){C=true
}}}}if(C){var u=this.messages[D.name+"."+v]||this.messages[v]||j.messages[v],F="An error has occurred with the "+D.display+" field.";
if(u){F=u.replace("%s",D.display);
if(y){F=F.replace("%s",(this.fields[y])?this.fields[y].display:y)
}}this.errors.push({id:D.id,element:D.element,name:D.name,message:F,rule:v});
break
}}};
r.prototype._hooks={required:function(v){var u=v.value;
if((v.type==="checkbox")||(v.type==="radio")){return(v.checked===true)
}return(u!==null&&u!=="")
},"default":function(v,u){return v.value!==u
},matches:function(w,v){var u=this.form[v];
if(u){return w.value===u.value
}return false
},valid_email:function(u){return n.test(u.value)
},valid_emails:function(w){var u=w.value.split(",");
for(var v=0,x=u.length;
v<x;
v++){if(!n.test(u[v])){return false
}}return true
},min_length:function(v,u){if(!c.test(u)){return false
}return(v.value.length>=parseInt(u,10))
},max_length:function(v,u){if(!c.test(u)){return false
}return(v.value.length<=parseInt(u,10))
},exact_length:function(v,u){if(!c.test(u)){return false
}return(v.value.length===parseInt(u,10))
},greater_than:function(u,v){if(!t.test(u.value)){return false
}return(parseFloat(u.value)>parseFloat(v))
},less_than:function(u,v){if(!t.test(u.value)){return false
}return(parseFloat(u.value)<parseFloat(v))
},alpha:function(u){return(b.test(u.value))
},alpha_numeric:function(u){return(l.test(u.value))
},alpha_dash:function(u){return(p.test(u.value))
},numeric:function(u){return(c.test(u.value))
},integer:function(u){return(a.test(u.value))
},decimal:function(u){return(t.test(u.value))
},is_natural:function(u){return(q.test(u.value))
},is_natural_no_zero:function(u){return(k.test(u.value))
},valid_ip:function(u){return(s.test(u.value))
},valid_base64:function(u){return(i.test(u.value))
},valid_url:function(u){return(d.test(u.value))
},valid_credit_card:function(y){if(!f.test(y.value)){return false
}var z=0,x=0,u=false;
var v=y.value.replace(/\D/g,"");
for(var A=v.length-1;
A>=0;
A--){var w=v.charAt(A);
x=parseInt(w,10);
if(u){if((x*=2)>9){x-=9
}}z+=x;
u=!u
}return(z%10)===0
},is_file_type:function(z,x){if(z.type!=="file"){return true
}var w=z.value.substr((z.value.lastIndexOf(".")+1)),A=x.split(","),y=false,v=0,u=A.length;
for(v;
v<u;
v++){if(w==A[v]){y=true
}}return y
}};
h.FormValidator=r
})(window,document);
var swfobject=function(){var aq="undefined",aD="object",ab="Shockwave Flash",X="ShockwaveFlash.ShockwaveFlash",aE="application/x-shockwave-flash",ac="SWFObjectExprInst",ax="onreadystatechange",af=window,aL=document,aB=navigator,aa=false,Z=[aN],aG=[],ag=[],al=[],aJ,ad,ap,at,ak=false,aU=false,aH,an,aI=true,ah=function(){var a=typeof aL.getElementById!=aq&&typeof aL.getElementsByTagName!=aq&&typeof aL.createElement!=aq,e=aB.userAgent.toLowerCase(),c=aB.platform.toLowerCase(),h=c?/win/.test(c):/win/.test(e),j=c?/mac/.test(c):/mac/.test(e),g=/webkit/.test(e)?parseFloat(e.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,d=!+"\v1",f=[0,0,0],k=null;
if(typeof aB.plugins!=aq&&typeof aB.plugins[ab]==aD){k=aB.plugins[ab].description;
if(k&&!(typeof aB.mimeTypes!=aq&&aB.mimeTypes[aE]&&!aB.mimeTypes[aE].enabledPlugin)){aa=true;
d=false;
k=k.replace(/^.*\s+(\S+\s+\S+$)/,"$1");
f[0]=parseInt(k.replace(/^(.*)\..*$/,"$1"),10);
f[1]=parseInt(k.replace(/^.*\.(.*)\s.*$/,"$1"),10);
f[2]=/[a-zA-Z]/.test(k)?parseInt(k.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0
}}else{if(typeof af.ActiveXObject!=aq){try{var i=new ActiveXObject(X);
if(i){k=i.GetVariable("$version");
if(k){d=true;
k=k.split(" ")[1].split(",");
f=[parseInt(k[0],10),parseInt(k[1],10),parseInt(k[2],10)]
}}}catch(b){}}}return{w3:a,pv:f,wk:g,ie:d,win:h,mac:j}
}(),aK=function(){if(!ah.w3){return
}if((typeof aL.readyState!=aq&&aL.readyState=="complete")||(typeof aL.readyState==aq&&(aL.getElementsByTagName("body")[0]||aL.body))){aP()
}if(!ak){if(typeof aL.addEventListener!=aq){aL.addEventListener("DOMContentLoaded",aP,false)
}if(ah.ie&&ah.win){aL.attachEvent(ax,function(){if(aL.readyState=="complete"){aL.detachEvent(ax,arguments.callee);
aP()
}});
if(af==top){(function(){if(ak){return
}try{aL.documentElement.doScroll("left")
}catch(a){setTimeout(arguments.callee,0);
return
}aP()
})()
}}if(ah.wk){(function(){if(ak){return
}if(!/loaded|complete/.test(aL.readyState)){setTimeout(arguments.callee,0);
return
}aP()
})()
}aC(aP)
}}();
function aP(){if(ak){return
}try{var b=aL.getElementsByTagName("body")[0].appendChild(ar("span"));
b.parentNode.removeChild(b)
}catch(a){return
}ak=true;
var d=Z.length;
for(var c=0;
c<d;
c++){Z[c]()
}}function aj(a){if(ak){a()
}else{Z[Z.length]=a
}}function aC(a){if(typeof af.addEventListener!=aq){af.addEventListener("load",a,false)
}else{if(typeof aL.addEventListener!=aq){aL.addEventListener("load",a,false)
}else{if(typeof af.attachEvent!=aq){aM(af,"onload",a)
}else{if(typeof af.onload=="function"){var b=af.onload;
af.onload=function(){b();
a()
}
}else{af.onload=a
}}}}}function aN(){if(aa){Y()
}else{am()
}}function Y(){var d=aL.getElementsByTagName("body")[0];
var b=ar(aD);
b.setAttribute("type",aE);
var a=d.appendChild(b);
if(a){var c=0;
(function(){if(typeof a.GetVariable!=aq){var e=a.GetVariable("$version");
if(e){e=e.split(" ")[1].split(",");
ah.pv=[parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10)]
}}else{if(c<10){c++;
setTimeout(arguments.callee,10);
return
}}d.removeChild(b);
a=null;
am()
})()
}else{am()
}}function am(){var g=aG.length;
if(g>0){for(var h=0;
h<g;
h++){var c=aG[h].id;
var l=aG[h].callbackFn;
var a={success:false,id:c};
if(ah.pv[0]>0){var i=aS(c);
if(i){if(ao(aG[h].swfVersion)&&!(ah.wk&&ah.wk<312)){ay(c,true);
if(l){a.success=true;
a.ref=av(c);
l(a)
}}else{if(aG[h].expressInstall&&au()){var e={};
e.data=aG[h].expressInstall;
e.width=i.getAttribute("width")||"0";
e.height=i.getAttribute("height")||"0";
if(i.getAttribute("class")){e.styleclass=i.getAttribute("class")
}if(i.getAttribute("align")){e.align=i.getAttribute("align")
}var f={};
var d=i.getElementsByTagName("param");
var k=d.length;
for(var j=0;
j<k;
j++){if(d[j].getAttribute("name").toLowerCase()!="movie"){f[d[j].getAttribute("name")]=d[j].getAttribute("value")
}}ae(e,f,c,l)
}else{aF(i);
if(l){l(a)
}}}}}else{ay(c,true);
if(l){var b=av(c);
if(b&&typeof b.SetVariable!=aq){a.success=true;
a.ref=b
}l(a)
}}}}}function av(b){var d=null;
var c=aS(b);
if(c&&c.nodeName=="OBJECT"){if(typeof c.SetVariable!=aq){d=c
}else{var a=c.getElementsByTagName(aD)[0];
if(a){d=a
}}}return d
}function au(){return !aU&&ao("6.0.65")&&(ah.win||ah.mac)&&!(ah.wk&&ah.wk<312)
}function ae(f,d,h,e){aU=true;
ap=e||null;
at={success:false,id:h};
var a=aS(h);
if(a){if(a.nodeName=="OBJECT"){aJ=aO(a);
ad=null
}else{aJ=a;
ad=h
}f.id=ac;
if(typeof f.width==aq||(!/%$/.test(f.width)&&parseInt(f.width,10)<310)){f.width="310"
}if(typeof f.height==aq||(!/%$/.test(f.height)&&parseInt(f.height,10)<137)){f.height="137"
}aL.title=aL.title.slice(0,47)+" - Flash Player Installation";
var b=ah.ie&&ah.win?"ActiveX":"PlugIn",c="MMredirectURL="+af.location.toString().replace(/&/g,"%26")+"&MMplayerType="+b+"&MMdoctitle="+aL.title;
if(typeof d.flashvars!=aq){d.flashvars+="&"+c
}else{d.flashvars=c
}if(ah.ie&&ah.win&&a.readyState!=4){var g=ar("div");
h+="SWFObjectNew";
g.setAttribute("id",h);
a.parentNode.insertBefore(g,a);
a.style.display="none";
(function(){if(a.readyState==4){a.parentNode.removeChild(a)
}else{setTimeout(arguments.callee,10)
}})()
}aA(f,d,h)
}}function aF(a){if(ah.ie&&ah.win&&a.readyState!=4){var b=ar("div");
a.parentNode.insertBefore(b,a);
b.parentNode.replaceChild(aO(a),b);
a.style.display="none";
(function(){if(a.readyState==4){a.parentNode.removeChild(a)
}else{setTimeout(arguments.callee,10)
}})()
}else{a.parentNode.replaceChild(aO(a),a)
}}function aO(b){var d=ar("div");
if(ah.win&&ah.ie){d.innerHTML=b.innerHTML
}else{var e=b.getElementsByTagName(aD)[0];
if(e){var a=e.childNodes;
if(a){var f=a.length;
for(var c=0;
c<f;
c++){if(!(a[c].nodeType==1&&a[c].nodeName=="PARAM")&&!(a[c].nodeType==8)){d.appendChild(a[c].cloneNode(true))
}}}}}return d
}function aA(e,g,c){var d,a=aS(c);
if(ah.wk&&ah.wk<312){return d
}if(a){if(typeof e.id==aq){e.id=c
}if(ah.ie&&ah.win){var f="";
for(var i in e){if(e[i]!=Object.prototype[i]){if(i.toLowerCase()=="data"){g.movie=e[i]
}else{if(i.toLowerCase()=="styleclass"){f+=' class="'+e[i]+'"'
}else{if(i.toLowerCase()!="classid"){f+=" "+i+'="'+e[i]+'"'
}}}}}var h="";
for(var j in g){if(g[j]!=Object.prototype[j]){h+='<param name="'+j+'" value="'+g[j]+'" />'
}}a.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+f+">"+h+"</object>";
ag[ag.length]=e.id;
d=aS(e.id)
}else{var b=ar(aD);
b.setAttribute("type",aE);
for(var k in e){if(e[k]!=Object.prototype[k]){if(k.toLowerCase()=="styleclass"){b.setAttribute("class",e[k])
}else{if(k.toLowerCase()!="classid"){b.setAttribute(k,e[k])
}}}}for(var l in g){if(g[l]!=Object.prototype[l]&&l.toLowerCase()!="movie"){aQ(b,l,g[l])
}}a.parentNode.replaceChild(b,a);
d=b
}}return d
}function aQ(b,d,c){var a=ar("param");
a.setAttribute("name",d);
a.setAttribute("value",c);
b.appendChild(a)
}function aw(a){var b=aS(a);
if(b&&b.nodeName=="OBJECT"){if(ah.ie&&ah.win){b.style.display="none";
(function(){if(b.readyState==4){aT(a)
}else{setTimeout(arguments.callee,10)
}})()
}else{b.parentNode.removeChild(b)
}}}function aT(a){var b=aS(a);
if(b){for(var c in b){if(typeof b[c]=="function"){b[c]=null
}}b.parentNode.removeChild(b)
}}function aS(a){var c=null;
try{c=aL.getElementById(a)
}catch(b){}return c
}function ar(a){return aL.createElement(a)
}function aM(a,c,b){a.attachEvent(c,b);
al[al.length]=[a,c,b]
}function ao(a){var b=ah.pv,c=a.split(".");
c[0]=parseInt(c[0],10);
c[1]=parseInt(c[1],10)||0;
c[2]=parseInt(c[2],10)||0;
return(b[0]>c[0]||(b[0]==c[0]&&b[1]>c[1])||(b[0]==c[0]&&b[1]==c[1]&&b[2]>=c[2]))?true:false
}function az(b,f,a,c){if(ah.ie&&ah.mac){return
}var e=aL.getElementsByTagName("head")[0];
if(!e){return
}var g=(a&&typeof a=="string")?a:"screen";
if(c){aH=null;
an=null
}if(!aH||an!=g){var d=ar("style");
d.setAttribute("type","text/css");
d.setAttribute("media",g);
aH=e.appendChild(d);
if(ah.ie&&ah.win&&typeof aL.styleSheets!=aq&&aL.styleSheets.length>0){aH=aL.styleSheets[aL.styleSheets.length-1]
}an=g
}if(ah.ie&&ah.win){if(aH&&typeof aH.addRule==aD){aH.addRule(b,f)
}}else{if(aH&&typeof aL.createTextNode!=aq){aH.appendChild(aL.createTextNode(b+" {"+f+"}"))
}}}function ay(a,c){if(!aI){return
}var b=c?"visible":"hidden";
if(ak&&aS(a)){aS(a).style.visibility=b
}else{az("#"+a,"visibility:"+b)
}}function ai(b){var a=/[\\\"<>\.;]/;
var c=a.exec(b)!=null;
return c&&typeof encodeURIComponent!=aq?encodeURIComponent(b):b
}var aR=function(){if(ah.ie&&ah.win){window.attachEvent("onunload",function(){var a=al.length;
for(var b=0;
b<a;
b++){al[b][0].detachEvent(al[b][1],al[b][2])
}var d=ag.length;
for(var c=0;
c<d;
c++){aw(ag[c])
}for(var e in ah){ah[e]=null
}ah=null;
for(var f in swfobject){swfobject[f]=null
}swfobject=null
})
}}();
return{registerObject:function(a,e,c,b){if(ah.w3&&a&&e){var d={};
d.id=a;
d.swfVersion=e;
d.expressInstall=c;
d.callbackFn=b;
aG[aG.length]=d;
ay(a,false)
}else{if(b){b({success:false,id:a})
}}},getObjectById:function(a){if(ah.w3){return av(a)
}},embedSWF:function(k,e,h,f,c,a,b,i,g,j){var d={success:false,id:e};
if(ah.w3&&!(ah.wk&&ah.wk<312)&&k&&e&&h&&f&&c){ay(e,false);
aj(function(){h+="";
f+="";
var q={};
if(g&&typeof g===aD){for(var o in g){q[o]=g[o]
}}q.data=k;
q.width=h;
q.height=f;
var n={};
if(i&&typeof i===aD){for(var p in i){n[p]=i[p]
}}if(b&&typeof b===aD){for(var l in b){if(typeof n.flashvars!=aq){n.flashvars+="&"+l+"="+b[l]
}else{n.flashvars=l+"="+b[l]
}}}if(ao(c)){var m=aA(q,n,e);
if(q.id==e){ay(e,true)
}d.success=true;
d.ref=m
}else{if(a&&au()){q.data=a;
ae(q,n,e,j);
return
}else{ay(e,true)
}}if(j){j(d)
}})
}else{if(j){j(d)
}}},switchOffAutoHideShow:function(){aI=false
},ua:ah,getFlashPlayerVersion:function(){return{major:ah.pv[0],minor:ah.pv[1],release:ah.pv[2]}
},hasFlashPlayerVersion:ao,createSWF:function(a,b,c){if(ah.w3){return aA(a,b,c)
}else{return undefined
}},showExpressInstall:function(b,a,d,c){if(ah.w3&&au()){ae(b,a,d,c)
}},removeSWF:function(a){if(ah.w3){aw(a)
}},createCSS:function(b,a,c,d){if(ah.w3){az(b,a,c,d)
}},addDomLoadEvent:aj,addLoadEvent:aC,getQueryParamValue:function(b){var a=aL.location.search||aL.location.hash;
if(a){if(/\?/.test(a)){a=a.split("?")[1]
}if(b==null){return ai(a)
}var c=a.split("&");
for(var d=0;
d<c.length;
d++){if(c[d].substring(0,c[d].indexOf("="))==b){return ai(c[d].substring((c[d].indexOf("=")+1)))
}}}return""
},expressInstallCallback:function(){if(aU){var a=aS(ac);
if(a&&aJ){a.parentNode.replaceChild(aJ,a);
if(ad){ay(ad,true);
if(ah.ie&&ah.win){aJ.style.display="block"
}}if(ap){ap(at)
}}aU=false
}}}
}();
if(typeof JSON!=="object"){JSON={}
}(function(){function f(n){return n<10?"0"+n:n
}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null
};
String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()
}
}var cx,escapable,gap,indent,meta,rep;
function quote(string){escapable.lastIndex=0;
return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];
return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)
})+'"':'"'+string+'"'
}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];
if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)
}if(typeof rep==="function"){value=rep.call(holder,key,value)
}switch(typeof value){case"string":return quote(value);
case"number":return isFinite(value)?String(value):"null";
case"boolean":case"null":return String(value);
case"object":if(!value){return"null"
}gap+=indent;
partial=[];
if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;
for(i=0;
i<length;
i+=1){partial[i]=str(i,value)||"null"
}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";
gap=mind;
return v
}if(rep&&typeof rep==="object"){length=rep.length;
for(i=0;
i<length;
i+=1){if(typeof rep[i]==="string"){k=rep[i];
v=str(k,value);
if(v){partial.push(quote(k)+(gap?": ":":")+v)
}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);
if(v){partial.push(quote(k)+(gap?": ":":")+v)
}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";
gap=mind;
return v
}}if(typeof JSON.stringify!=="function"){escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};
JSON.stringify=function(value,replacer,space){var i;
gap="";
indent="";
if(typeof space==="number"){for(i=0;
i<space;
i+=1){indent+=" "
}}else{if(typeof space==="string"){indent=space
}}rep=replacer;
if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")
}return str("",{"":value})
}
}if(typeof JSON.parse!=="function"){cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
JSON.parse=function(text,reviver){var j;
function walk(holder,key){var k,v,value=holder[key];
if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);
if(v!==undefined){value[k]=v
}else{delete value[k]
}}}}return reviver.call(holder,key,value)
}text=String(text);
cx.lastIndex=0;
if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)
})
}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");
return typeof reviver==="function"?walk({"":j},""):j
}throw new SyntaxError("JSON.parse")
}
}}());
var Events=[{city:"Melbourne",local:"Your Time",startDate:20160101,endDate:20170326,offset:10,dst:"AUSTRALIA"},{city:"Shanghai",local:"Your Time",startDate:20170327,endDate:20170409,offset:8,dst:0},{city:"Sakhir",local:"Your Time",startDate:20170410,endDate:20170416,offset:3,dst:0},{city:"Sochi",local:"Your Time",startDate:20170417,endDate:20170430,offset:2,dst:"EUROPE"},{city:"Catalunya",local:"Your Time",startDate:20170501,endDate:20170514,offset:1,dst:"EUROPE"},{city:"Monte Carlo",local:"Your Time",startDate:20170515,endDate:20170528,offset:1,dst:"EUROPE"},{city:"Montral",local:"Your Time",startDate:20170529,endDate:20170611,offset:-5,dst:"USA"},{city:"Baku",local:"Your Time",startDate:20170612,endDate:20170625,offset:4,dst:0},{city:"Spielberg",local:"Your Time",startDate:20170626,endDate:20170709,offset:1,dst:"EUROPE"},{city:"Silverstone",local:"Your Time",startDate:20170710,endDate:20170716,offset:1,dst:0},{city:"Budapest",local:"Your Time",startDate:20170717,endDate:20170730,offset:1,dst:"EUROPE"},{city:"Spa-Francorchamps",local:"Your Time",startDate:20170731,endDate:20170827,offset:1,dst:"EUROPE"},{city:"Monza",local:"Your Time",startDate:20170828,endDate:20170903,offset:1,dst:"EUROPE"},{city:"Singapore",local:"Your Time",startDate:20170904,endDate:20170917,offset:8,dst:0},{city:"Kuala Lumpur",local:"Your Time",startDate:20170918,endDate:20171001,offset:8,dst:0},{city:"Suzuka",local:"Your Time",startDate:20171002,endDate:20171008,offset:9,dst:0},{city:"Austin",local:"Your Time",startDate:20171009,endDate:20171022,offset:-6,dst:"USA"},{city:"Mexico City",local:"Your Time",startDate:20171023,endDate:20171029,offset:-6,dst:"USA"},{city:"So Paulo",local:"Your Time",startDate:20171030,endDate:20171112,offset:-3,dst:"BRAZIL"},{city:"Yas Marina",local:"Your Time",startDate:20171113,endDate:20171126,offset:4,dst:0}];
"use strict";
var SUN=0;
var MON=1;
var TUE=2;
var WED=3;
var THU=4;
var FRI=5;
var SAT=6;
var EUROPE=10;
var USA=20;
var MEXICO=21;
var GUATEMALA=22;
var CUBA=23;
var BRAZIL=30;
var CHILE=31;
var PARAGUAY=32;
var URUGUAY=33;
var ARGENTINA=34;
var EGYPT=40;
var NAMIBIA=41;
var MOROCCO=42;
var JORDAN=50;
var SYRIA=51;
var IRAQ=52;
var ISRAEL=53;
var PAKISTAN=54;
var AUSTRALIA=60;
var AUSTRALIA_WESTERN=61;
var NEW_ZEALAND=62;
function TimezoneUtil(){}function dstToComponents(a){var c={hour:0,minute:0,minutes:0};
if(a!==null){var e=Math.floor(Math.abs(a)/100);
if(a<0){e=-e
}var b=a%100;
var d=e*60+b;
c={hour:e,minute:b,minutes:d}
}return c
}function firstWeekday(d,c){var e=null;
if((c!==null)&&(d!==null)&&(d>=0)){d=d%7;
var b=new Date(c.getFullYear(),c.getMonth(),1);
var a=b.getDay();
e=b.getDate();
if(a!==d){if(a>d){a-=7
}e-=(a-d)
}}return e
}function lastWeekday(e,d){var a=null;
if((d!==null)&&(e!==null)&&(e>=0)){e=e%7;
var c=new Date(d.getFullYear(),d.getMonth()+1,0);
var b=c.getDay();
a=c.getDate();
if(b!==e){if(b<e){b+=7
}a-=(b-e)
}}return a
}function getDST(c,a){var e=0;
var d=c.getUTCMonth()+1;
var b=c.getUTCDate();
switch(a){case"EUROPE":if((d>3)&&(d<10)){e=+100
}else{if((d===3)&&(b>=lastWeekday(SUN,c))){e=+100
}else{if((d===10)&&(b<lastWeekday(SUN,c))){e=+100
}}}break;
case"USA":if((d>3)&&(d<11)){e=+100
}else{if((d===3)&&(b>=firstWeekday(SUN,c)+7)){e=+100
}else{if((d===11)&&(b<firstWeekday(SUN,c))){e=+100
}}}break;
case"MEXICO":if((d>4)&&(d<10)){e=+100
}else{if((d===4)&&(b>=firstWeekday(SUN,c))){e=+100
}else{if((d===10)&&(b<lastWeekday(SUN,c))){e=+100
}}}break;
case"GUATEMALA":break;
case"CUBA":if((d>3)&&(d<10)){e=+100
}else{if((d===3)&&(b>=firstWeekday(SUN,c)+7)){e=+100
}else{if((d===10)&&(b<lastWeekday(SUN,c))){e=+100
}}}break;
case"BRAZIL":if((d>10)||(d<2)){e=+100
}else{if((d===10)&&(b>=firstWeekday(SUN,c)+14)){e=+100
}else{if((d===2)&&(b<firstWeekday(SUN,c)+14)){e=+100
}}}break;
case"CHILE":if((d>10)||(d<4)){e=+100
}else{if((d===10)&&(b>=firstWeekday(SUN,c)+7)){e=+100
}else{if((d===4)&&(b<firstWeekday(SUN,c))){e=+100
}}}break;
case"PARAGUAY":if((d>10)||(d<4)){e=+100
}else{if((d===10)&&(b>=firstWeekday(SUN,c))){e=+100
}else{if((d===4)&&(b<firstWeekday(SUN,c)+7)){e=+100
}}}break;
case"URUGUAY":if((d>10)||(d<3)){e=+100
}else{if((d===10)&&(b>=firstWeekday(SUN,c))){e=+100
}else{if((d===3)&&(b<firstWeekday(SUN,c)+7)){e=+100
}}}break;
case"ARGENTINA":break;
case"EGYPT":if((d>4)&&(d<8)){e=+100
}else{if((d===4)&&(b>=lastWeekday(FRI,c))){e=+100
}else{if((d===8)&&(b<firstWeekday(FRI,c))){e=+100
}}}break;
case"NAMIBIA":if((d>9)||(d<4)){e=+100
}else{if((d===9)&&(b>=firstWeekday(SUN,c))){e=+100
}else{if((d===4)&&(b<firstWeekday(SUN,c))){e=+100
}}}break;
case"MOROCCO":break;
case"JORDAN":if((d>3)&&(d<10)){e=+100
}else{if((d===3)&&(b>=lastWeekday(FRI,c))){e=+100
}else{if((d===10)&&(b<lastWeekday(FRI,c))){e=+100
}}}break;
case"SYRIA":if((d>4)&&(d<10)){e=+100
}else{if((d===4)&&(b>=firstWeekday(FRI,c))){e=+100
}else{if((d===10)&&(b<lastWeekday(FRI,c))){e=+100
}}}break;
case"IRAQ":break;
case"ISRAEL":switch(c.getUTCFullYear()){case 2010:if((d>3)&&(d<9)){e=+100
}else{if((d===3)&&(b>=26)){e=+100
}else{if((d===9)&&(b<12)){e=+100
}}}break;
case 2011:if((d>4)&&(d<10)){e=+100
}else{if((d===4)&&(b>=1)){e=+100
}else{if((d===10)&&(b<2)){e=+100
}}}break;
case 2012:if((d>3)&&(d<9)){e=+100
}else{if((d===3)&&(b>=30)){e=+100
}else{if((d===9)&&(b<23)){e=+100
}}}break;
case 2013:if((d>3)&&(d<9)){e=+100
}else{if((d===3)&&(b>=29)){e=+100
}else{if((d===9)&&(b<8)){e=+100
}}}break;
case 2014:if((d>3)&&(d<9)){e=+100
}else{if((d===3)&&(b>=28)){e=+100
}else{if((d===9)&&(b<28)){e=+100
}}}break;
case 2015:if((d>3)&&(d<9)){e=+100
}else{if((d===3)&&(b>=27)){e=+100
}else{if((d===9)&&(b<20)){e=+100
}}}break;
default:if((d>3)&&(d<9)){e=+100
}else{if((d===3)&&(b>=lastWeekday(FRI,c))){e=+100
}else{if((d===9)&&(b<20)){e=+100
}}}break
}break;
case"PAKISTAN":if((d>4)&&(d<11)){e=+100
}else{if((d===4)&&(b>=firstWeekday(THU,c)+14)){e=+100
}else{if((d===11)&&(b<firstWeekday(MON,c))){e=+100
}}}break;
case"AUSTRALIA":if((d>10)||(d<4)){e=+100
}else{if((d===10)&&(b>=firstWeekday(SUN,c))){e=+100
}else{if((d===4)&&(b<firstWeekday(SUN,c))){e=+100
}}}break;
case"AUSTRALIA_WESTERN":break;
case"NEW_ZEALAND":if((d>9)||(d<4)){e=+100
}else{if((d===9)&&(b>=lastWeekday(SUN,c))){e=+100
}else{if((d===4)&&(b<firstWeekday(SUN,c))){e=+100
}}}break
}return e
}function foreignToLocal(d,b,c){var a=dstToComponents(b+getDST(d,c));
return new Date(d.getTime()-((d.getTimezoneOffset()+a.minutes)*60000))
}function localToForeign(d,b,c){var a=dstToComponents(b+getDST(d,c));
return new Date(d.getTime()+((d.getTimezoneOffset()+a.minutes)*60000))
}
/*!
 * AKQA patched version for use in the Race calendar component. Deviations in
 * the code are marked as below and fix issues regarding memory leaks when
 * removing the plugin
 *
 *    [AKQA]-------------------------------------------------------------------
 *    // Original code commented out at top of block
 *    ...additional code statements...
 *    [/AKQA]------------------------------------------------------------------
 */
(function($){var imgFolder="img";
if(Modernizr.retina==true){}var imageExtension="png";
if(Modernizr.svg==true){imageExtension="svg"
}$.fn.rolexClock=function(options,theCityId){var __killSwitches={to_raf_shim:0,to_time_display:0,to_engine:0,to_static_watch:0,raf_engine:0,raf_round_time:0};
var params={LANG:"en",contentWidth:0,contentHeight:0,flashname:"",fallback:"",trackingurl:"",leadingZeros:true,amPm:false,time24hours:true,showText:true,showTime:false,showDay:false,selectedCityId:theCityId,clockWidth:0,clockHeight:0,globalXcenter:0,globalYcenter:0,globalXscale:0,globalYscale:0,handsFolder:"css/images/hands/green/",watchContainerID:"clock",handsParams:{svg:{hour:{width:3},minute:{width:3},second:{width:2,xrotation:2}},png:{hour:{width:5},minute:{width:5},second:{width:3,xrotation:1.5}}},forceFlash:false,forceFallback:false,clocktimeAtEvent:false,isCountdownClock:false,countdownNumbersOnly:false,onclickCity:function(){},onclickYourtime:function(){},showDefaultCity:false,showLocalOnly:false,dateList:Events,isCompetitionWithCarousel:false,competitionParams:{interval:1000,tag:"div"},blockClass:"block",activeClass:"active"};
var methods={activeBlock:function(){if(typeof arguments[0]==="string"){var target=$(".block#"+arguments[0]);
if(target.length>0){target.trigger("click")
}}}};
var _competition={index:-1,isAnimationActive:true,timer:undefined,data:[]};
if(options&&typeof options==="string"&&methods[options]){return methods[options].apply(this,Array.prototype.slice.call(arguments,1))
}else{if(options&&typeof options==="object"){params=$.extend({},params,options)
}}function init(){var defaultEvent;
if(params.isCountdownClock){defaultEvent={city:params.selectedCityId,local:"Your Time",startDate:"19700101",endDate:"99990101",offset:0,dst:"EUROPE",cdtext:"ROLEX COUNTDOWN",cdyear:"1970",cdmonth:"11",cdday:"29",cdhour:"09",cdmin:"00"}
}else{defaultEvent={city:params.selectedCityId,local:"Your Time",startDate:"19700101",endDate:"99990101",offset:0,dst:"EUROPE"}
}if(params.isCompetitionWithCarousel){defaultEvent.competition={}
}if(params.dateList===undefined){params.dateList=[defaultEvent]
}else{params.dateList.push(defaultEvent)
}}init();
function showClock(){$(".ui-loader").hide();
$("#fallback").hide();
$(".content").show()
}window.requestAnimFrame=(function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){__killSwitches.to_raf_shim=window.setTimeout(callback,1000/10)
}
})();
var image_folder=params.handsFolder;
var all_parts=new Array("hours","minutes","seconds","top_center");
var hours_p=new Array;
hours_p.url="hours."+imageExtension+"";
hours_p.update_mode="hours_base_12";
hours_p.width=params.handsParams[imageExtension].hour.width;
hours_p.height=25;
hours_p.xrotation=2;
hours_p.yrotation=20;
hours_p.xcenteroffset=0;
hours_p.ycenteroffset=0;
var minutes_p=new Array;
minutes_p.url="minutes."+imageExtension+"";
minutes_p.update_mode="minutes_base_60";
minutes_p.width=params.handsParams[imageExtension].minute.width;
minutes_p.height=32;
minutes_p.xrotation=1.5;
minutes_p.yrotation=27;
minutes_p.xcenteroffset=0;
minutes_p.ycenteroffset=0;
var seconds_p=new Array;
seconds_p.url="seconds."+imageExtension+"";
seconds_p.update_mode="seconds_base_60";
seconds_p.width=params.handsParams[imageExtension].second.width;
seconds_p.height=39;
seconds_p.xrotation=params.handsParams[imageExtension].second.xrotation;
seconds_p.yrotation=31;
seconds_p.xcenteroffset=0;
seconds_p.ycenteroffset=0;
seconds_p.watch_x_center=0;
seconds_p.watch_y_center=0;
var top_center_p=new Array;
top_center_p.url="center.png";
top_center_p.width=5;
top_center_p.height=5;
top_center_p.xcenteroffset=-2.5;
top_center_p.ycenteroffset=-2.5;
var cyclop_mask_p=new Array;
var global_watch_p=new Array;
global_watch_p.rotation_angle=0;
global_watch_p.width=params.clockWidth;
global_watch_p.height=params.clockHeight;
global_watch_p.xscale=params.globalXscale;
global_watch_p.yscale=params.globalYscale;
function countProperties(a){var b=0;
for(var c in a){if(a.hasOwnProperty(c)){++b
}}return b
}var partsContainer=document.createElement("div");
partsContainer.style.position="absolute";
partsContainer.style.width="1px";
partsContainer.style.height="1px";
partsContainer.style.padding="0";
partsContainer.style.margin="-1px";
partsContainer.style.overflow="hidden";
partsContainer.style.clip="rect(0, 0, 0, 0)";
partsContainer.style.border="0";
document.getElementsByTagName("body")[0].appendChild(partsContainer);
var loadSpriteErrors=[];
function loadSprite(i,src){var deferred=$.Deferred();
all_p[i]["image"]=document.createElement("img");
all_p[i]["image"].id="p_"+all_parts[i];
all_p[i]["image"].onload=function(){deferred.resolve()
};
all_p[i]["image"].onerror=function(){loadSpriteErrors.push(src);
$(".content").hide();
$(".fallback").show()
};
partsContainer.appendChild(all_p[i]["image"]);
all_p[i]["image"].src=src;
return deferred.promise()
}var all_p=new Array;
var all_p_to_be_loaded=all_parts.length;
for(i=0;
i<all_parts.length;
i++){all_p[i]=eval(all_parts[i]+"_p")
}var loaders=[];
for(var i=0;
i<all_parts.length;
i++){if(all_p[i]["url"]!=null){loaders.push(loadSprite(i,image_folder+all_p[i]["url"]));
if(!all_p[i]["fileformat"]){all_p[i]["fileformat"]=all_p[i]["url"].substring(all_p[i]["url"].length-3,all_p[i]["url"].length)
}}else{all_p_to_be_loaded--
}if(!all_p[i]["xcenteroffset"]){all_p[i]["xcenteroffset"]=0
}if(!all_p[i]["ycenteroffset"]){all_p[i]["ycenteroffset"]=0
}if(!all_p[i]["xoriginoffset"]){all_p[i]["xoriginoffset"]=null
}if(!all_p[i]["yoriginoffset"]){all_p[i]["yoriginoffset"]=null
}if(!all_p[i]["xcenter"]){all_p[i]["xcenter"]=0
}if(!all_p[i]["ycenter"]){all_p[i]["ycenter"]=0
}if(!all_p[i]["update_mode"]){all_p[i]["update_mode"]=null
}if(!all_p[i]["watch_x_center"]){all_p[i]["offset_alternate_x_center"]=0
}else{all_p[i]["offset_alternate_x_center"]=global_watch_p[all_p[i]["watch_x_center"]]-global_watch_p.xcenter
}if(!all_p[i]["watch_y_center"]){all_p[i]["offset_alternate_y_center"]=0
}else{all_p[i]["offset_alternate_y_center"]=global_watch_p[all_p[i]["watch_y_center"]]-global_watch_p.ycenter
}}$.when.apply(null,loaders).done(function(){all_p_to_be_loaded-=loaders.length
});
function f_calculate_additional_vars(){if(GLOBAL_LIGHT_SOURCE!=undefined){TOP_LIGHT_START=GLOBAL_LIGHT_SOURCE-90;
TOP_LIGHT_END=GLOBAL_LIGHT_SOURCE+90;
BOTTOM_LIGHT_START=GLOBAL_LIGHT_SOURCE-90;
BOTTOM_LIGHT_END=GLOBAL_LIGHT_SOURCE+90;
TOP_SHADE_START=GLOBAL_LIGHT_SOURCE+90;
TOP_SHADE_END=GLOBAL_LIGHT_SOURCE-90;
BOTTOM_SHADE_START=GLOBAL_LIGHT_SOURCE+90;
BOTTOM_SHADE_END=GLOBAL_LIGHT_SOURCE-90;
LEFT_LIGHT_START=GLOBAL_LIGHT_SOURCE;
LEFT_LIGHT_END=GLOBAL_LIGHT_SOURCE+180;
RIGHT_LIGHT_START=GLOBAL_LIGHT_SOURCE+180;
RIGHT_LIGHT_END=GLOBAL_LIGHT_SOURCE;
LEFT_SHADE_START=GLOBAL_LIGHT_SOURCE+180;
LEFT_SHADE_END=GLOBAL_LIGHT_SOURCE;
RIGHT_SHADE_START=GLOBAL_LIGHT_SOURCE;
RIGHT_SHADE_END=GLOBAL_LIGHT_SOURCE+180
}if(GLOBAL_MIN_ALPHA!=undefined){TOP_LIGHT_MIN=BOTTOM_LIGHT_MIN=TOP_SHADE_MIN=BOTTOM_SHADE_MIN=LEFT_LIGHT_MIN=RIGHT_LIGHT_MIN=LEFT_SHADE_MIN=RIGHT_SHADE_MIN=GLOBAL_MIN_ALPHA
}if(GLOBAL_MAX_ALPHA!=undefined){TOP_LIGHT_MAX=BOTTOM_LIGHT_MAX=TOP_SHADE_MAX=BOTTOM_SHADE_MAX=LEFT_LIGHT_MAX=RIGHT_LIGHT_MAX=LEFT_SHADE_MAX=RIGHT_SHADE_MAX=GLOBAL_MAX_ALPHA
}while(TOP_LIGHT_START>TOP_LIGHT_END){TOP_LIGHT_END+=360
}while(BOTTOM_LIGHT_START>BOTTOM_LIGHT_END){BOTTOM_LIGHT_END+=360
}while(TOP_SHADE_START>TOP_SHADE_END){TOP_SHADE_END+=360
}while(BOTTOM_SHADE_START>BOTTOM_SHADE_END){BOTTOM_SHADE_END+=360
}while(LEFT_LIGHT_START>LEFT_LIGHT_END){LEFT_LIGHT_END+=360
}while(RIGHT_LIGHT_START>RIGHT_LIGHT_END){RIGHT_LIGHT_END+=360
}while(LEFT_SHADE_START>LEFT_SHADE_END){LEFT_SHADE_END+=360
}while(RIGHT_SHADE_START>RIGHT_SHADE_END){RIGHT_SHADE_END+=360
}while(TOP_LIGHT_END>360){TOP_LIGHT_START-=360;
TOP_LIGHT_END-=360
}while(BOTTOM_LIGHT_END>360){BOTTOM_LIGHT_START-=360;
BOTTOM_LIGHT_END-=360
}while(TOP_SHADE_END>360){TOP_SHADE_START-=360;
TOP_SHADE_END-=360
}while(BOTTOM_SHADE_END>360){BOTTOM_SHADE_START-=360;
BOTTOM_SHADE_END-=360
}while(LEFT_LIGHT_END>360){LEFT_LIGHT_START-=360;
LEFT_LIGHT_END-=360
}while(RIGHT_LIGHT_END>360){RIGHT_LIGHT_START-=360;
RIGHT_LIGHT_END-=360
}while(LEFT_SHADE_END>360){LEFT_SHADE_START-=360;
LEFT_SHADE_END-=360
}while(RIGHT_SHADE_END>360){RIGHT_SHADE_START-=360;
RIGHT_SHADE_END-=360
}if(TOP_LIGHT_START<TOP_LIGHT_END){top_light_max_point=(TOP_LIGHT_START+TOP_LIGHT_END)/2%360;
top_light_range=TOP_LIGHT_END-TOP_LIGHT_START
}else{top_light_max_point=(TOP_LIGHT_START+TOP_LIGHT_END)%360/2;
top_light_range=360+TOP_LIGHT_END-TOP_LIGHT_START
}top_light_mid_range=top_light_range/2;
if(BOTTOM_LIGHT_START<BOTTOM_LIGHT_END){bottom_light_max_point=(BOTTOM_LIGHT_START+BOTTOM_LIGHT_END)/2%360;
bottom_light_range=BOTTOM_LIGHT_END-BOTTOM_LIGHT_START
}else{bottom_light_max_point=(BOTTOM_LIGHT_START+BOTTOM_LIGHT_END)%360/2;
bottom_light_range=360+BOTTOM_LIGHT_END-BOTTOM_LIGHT_START
}bottom_light_mid_range=bottom_light_range/2;
if(TOP_SHADE_START<TOP_SHADE_END){top_shade_max_point=(TOP_SHADE_START+TOP_SHADE_END)/2%360;
top_shade_range=TOP_SHADE_END-TOP_SHADE_START
}else{top_shade_max_point=(TOP_SHADE_START+TOP_SHADE_END)%360/2;
top_shade_range=360+TOP_SHADE_END-TOP_SHADE_START
}top_shade_mid_range=top_shade_range/2;
if(BOTTOM_SHADE_START<BOTTOM_SHADE_END){bottom_shade_max_point=(BOTTOM_SHADE_START+BOTTOM_SHADE_END)/2%360;
bottom_shade_range=BOTTOM_SHADE_END-BOTTOM_SHADE_START
}else{bottom_shade_max_point=(BOTTOM_SHADE_START+BOTTOM_SHADE_END)%360/2;
bottom_shade_range=360+BOTTOM_SHADE_END-BOTTOM_SHADE_START
}bottom_shade_mid_range=bottom_shade_range/2;
if(LEFT_LIGHT_START<LEFT_LIGHT_END){left_light_max_point=(LEFT_LIGHT_START+LEFT_LIGHT_END)/2%360;
left_light_range=LEFT_LIGHT_END-LEFT_LIGHT_START
}else{left_light_max_point=(LEFT_LIGHT_START+LEFT_LIGHT_END)%360/2;
left_light_range=360+LEFT_LIGHT_END-LEFT_LIGHT_START
}left_light_mid_range=left_light_range/2;
if(RIGHT_LIGHT_START<RIGHT_LIGHT_END){right_light_max_point=(RIGHT_LIGHT_START+RIGHT_LIGHT_END)/2%360;
right_light_range=RIGHT_LIGHT_END-RIGHT_LIGHT_START
}else{right_light_max_point=(RIGHT_LIGHT_START+RIGHT_LIGHT_END)%360/2;
right_light_range=360+RIGHT_LIGHT_END-RIGHT_LIGHT_START
}right_light_mid_range=right_light_range/2;
if(LEFT_SHADE_START<LEFT_SHADE_END){left_shade_max_point=(LEFT_SHADE_START+LEFT_SHADE_END)/2%360;
left_shade_range=LEFT_SHADE_END-LEFT_SHADE_START
}else{left_shade_max_point=(LEFT_SHADE_START+LEFT_SHADE_END)%360/2;
left_shade_range=360+LEFT_SHADE_END-LEFT_SHADE_START
}left_shade_mid_range=left_shade_range/2;
if(RIGHT_SHADE_START<RIGHT_SHADE_END){right_shade_max_point=(RIGHT_SHADE_START+RIGHT_SHADE_END)/2%360;
right_shade_range=RIGHT_SHADE_END-RIGHT_SHADE_START
}else{right_shade_max_point=(RIGHT_SHADE_START+RIGHT_SHADE_END)%360/2;
right_shade_range=360+RIGHT_SHADE_END-RIGHT_SHADE_START
}right_shade_mid_range=right_shade_range/2
}function getAlphaForRotation(a,b,c){b=180*b/Math.PI+90;
subf_find_distance_to_max_point=function(a){var c=Math.abs(a-b);
if(c>180){c=Math.abs(180-(c-180))
}return c
};
var d;
if(a=="top_light"){if(c=="reverse"){this_hand_distance_to_top_light_point=subf_find_distance_to_max_point(-top_light_max_point)
}else{this_hand_distance_to_top_light_point=subf_find_distance_to_max_point(top_light_max_point)
}if(this_hand_distance_to_top_light_point<=top_light_mid_range){d=TOP_LIGHT_MIN+(1-this_hand_distance_to_top_light_point/top_light_mid_range)*(TOP_LIGHT_MAX-TOP_LIGHT_MIN)
}else{d=TOP_LIGHT_MIN
}}else{if(a=="bottom_light"){if(c=="reverse"){this_hand_distance_to_bottom_light_point=subf_find_distance_to_max_point(-bottom_light_max_point)
}else{this_hand_distance_to_bottom_light_point=subf_find_distance_to_max_point(bottom_light_max_point)
}if(180-this_hand_distance_to_bottom_light_point<=bottom_light_mid_range){d=BOTTOM_LIGHT_MIN+(1-(180-this_hand_distance_to_bottom_light_point)/bottom_light_mid_range)*(BOTTOM_LIGHT_MAX-BOTTOM_LIGHT_MIN)
}else{d=BOTTOM_LIGHT_MIN
}}else{if(a=="top_shade"){if(c=="reverse"){this_hand_distance_to_top_shade_point=subf_find_distance_to_max_point(-top_shade_max_point)
}else{this_hand_distance_to_top_shade_point=subf_find_distance_to_max_point(top_shade_max_point)
}if(this_hand_distance_to_top_shade_point<=top_shade_mid_range){d=TOP_SHADE_MIN+(1-this_hand_distance_to_top_shade_point/top_shade_mid_range)*(TOP_SHADE_MAX-TOP_SHADE_MIN)
}else{d=TOP_SHADE_MIN
}}else{if(a=="bottom_shade"){if(c=="reverse"){this_hand_distance_to_bottom_shade_point=subf_find_distance_to_max_point(-bottom_shade_max_point)
}else{this_hand_distance_to_bottom_shade_point=subf_find_distance_to_max_point(bottom_shade_max_point)
}if(180-this_hand_distance_to_bottom_shade_point<=bottom_shade_mid_range){d=BOTTOM_SHADE_MIN+(1-(180-this_hand_distance_to_bottom_shade_point)/bottom_shade_mid_range)*(BOTTOM_SHADE_MAX-BOTTOM_SHADE_MIN)
}else{d=BOTTOM_SHADE_MIN
}}}}}if(c=="reverse"){if(a=="left_light"){this_hand_distance_to_left_light_point=subf_find_distance_to_max_point(-left_light_max_point);
if(this_hand_distance_to_left_light_point<=left_light_mid_range){d=LEFT_LIGHT_MIN+(1-this_hand_distance_to_left_light_point/left_light_mid_range)*(LEFT_LIGHT_MAX-LEFT_LIGHT_MIN)
}else{d=LEFT_LIGHT_MIN
}}else{if(a=="right_light"){if(this_hand_distance_to_right_light_point<=right_light_mid_range){d=RIGHT_LIGHT_MIN+(1-this_hand_distance_to_right_light_point/right_light_mid_range)*(RIGHT_LIGHT_MAX-RIGHT_LIGHT_MIN)
}else{d=RIGHT_LIGHT_MIN
}}else{if(a=="left_shade"){this_hand_distance_to_left_shade_point=subf_find_distance_to_max_point(-left_shade_max_point);
if(this_hand_distance_to_left_shade_point<=left_shade_mid_range){d=(1-this_hand_distance_to_left_shade_point/left_shade_mid_range)*(LEFT_SHADE_MAX-LEFT_SHADE_MIN)
}else{d=LEFT_SHADE_MIN
}}else{if(a=="right_shade"){this_hand_distance_to_right_shade_point=subf_find_distance_to_max_point(-right_shade_max_point);
if(this_hand_distance_to_right_shade_point<=right_shade_mid_range){d=(1-this_hand_distance_to_right_shade_point/right_shade_mid_range)*(RIGHT_SHADE_MAX-RIGHT_SHADE_MIN)
}else{d=RIGHT_SHADE_MIN
}}}}}}else{if(a=="left_light"){this_hand_distance_to_left_light_point=subf_find_distance_to_max_point(left_light_max_point);
if(this_hand_distance_to_left_light_point<=left_light_mid_range){d=LEFT_LIGHT_MIN+(1-this_hand_distance_to_left_light_point/left_light_mid_range)*(LEFT_LIGHT_MAX-LEFT_LIGHT_MIN)
}else{d=LEFT_LIGHT_MIN
}}else{if(a=="right_light"){this_hand_distance_to_right_light_point=subf_find_distance_to_max_point(-right_light_max_point);
this_hand_distance_to_right_light_point=subf_find_distance_to_max_point(right_light_max_point);
if(this_hand_distance_to_right_light_point<=right_light_mid_range){d=RIGHT_LIGHT_MIN+(1-this_hand_distance_to_right_light_point/right_light_mid_range)*(RIGHT_LIGHT_MAX-RIGHT_LIGHT_MIN)
}else{d=RIGHT_LIGHT_MIN
}}else{if(a=="left_shade"){this_hand_distance_to_left_shade_point=subf_find_distance_to_max_point(left_shade_max_point);
if(this_hand_distance_to_left_shade_point<=left_shade_mid_range){d=LEFT_SHADE_MIN+(1-this_hand_distance_to_left_shade_point/left_shade_mid_range)*(LEFT_SHADE_MAX-LEFT_SHADE_MIN)
}else{d=LEFT_SHADE_MIN
}}else{if(a=="right_shade"){this_hand_distance_to_right_shade_point=subf_find_distance_to_max_point(right_shade_max_point);
if(this_hand_distance_to_right_shade_point<=right_shade_mid_range){d=RIGHT_SHADE_MIN+(1-this_hand_distance_to_right_shade_point/right_shade_mid_range)*(RIGHT_SHADE_MAX-RIGHT_SHADE_MIN)
}else{d=RIGHT_SHADE_MIN
}}}}}}return d/100
}var GLOBAL_LIGHT_SOURCE=360;
var GLOBAL_MIN_ALPHA=0;
var GLOBAL_MAX_ALPHA=100;
var TOP_LIGHT_START=0;
var TOP_LIGHT_END=0;
var BOTTOM_LIGHT_START=0;
var BOTTOM_LIGHT_END=0;
var TOP_SHADE_START=0;
var TOP_SHADE_END=0;
var BOTTOM_SHADE_START=0;
var BOTTOM_SHADE_END=0;
var LEFT_LIGHT_START=0;
var LEFT_LIGHT_END=0;
var RIGHT_LIGHT_START=0;
var RIGHT_LIGHT_END=0;
var LEFT_SHADE_START=0;
var LEFT_SHADE_END=0;
var RIGHT_SHADE_START=0;
var RIGHT_SHADE_END=0;
var TOP_LIGHT_MIN=0;
var TOP_LIGHT_MAX=0;
var BOTTOM_LIGHT_MIN=0;
var BOTTOM_LIGHT_MAX=0;
var TOP_SHADE_MIN=0;
var TOP_SHADE_MAX=0;
var BOTTOM_SHADE_MIN=0;
var BOTTOM_SHADE_MAX=0;
var LEFT_LIGHT_MIN=0;
var LEFT_LIGHT_MAX=0;
var RIGHT_LIGHT_MIN=0;
var RIGHT_LIGHT_MAX=0;
var LEFT_SHADE_MIN=0;
var LEFT_SHADE_MAX=0;
var RIGHT_SHADE_MIN=0;
var RIGHT_SHADE_MAX=0;
var top_light_max_point=0;
var top_light_range=0;
var top_light_mid_range=0;
var bottom_light_max_point=0;
var bottom_light_range=0;
var bottom_light_mid_range=0;
var top_shade_max_point=0;
var top_shade_range=0;
var top_shade_mid_range=0;
var bottom_shade_max_point=0;
var bottom_shade_range=0;
var bottom_shade_mid_range=0;
f_calculate_additional_vars();
var updated;
function getHiddenProp(){var prefixes=["webkit","moz","ms","o"];
if("hidden" in document){return"hidden"
}for(var i=0;
i<prefixes.length;
i++){if((prefixes[i]+"Hidden") in document){return prefixes[i]+"Hidden"
}}return null
}function isHidden(){var prop=getHiddenProp();
if(!prop){return false
}return document[prop]
}var visProp=getHiddenProp();
if(visProp){var evtname=visProp.replace(/[H|h]idden/,"")+"visibilitychange";
document.addEventListener(evtname,visChange)
}function visChange(){if(isHidden()){updated=false
}else{updateTime()
}}function updateTime(){if(params.isCountdownClock){if(updated==true){current_seconds+=1000/10;
if(current_seconds>=60){currentTime=new Date;
currentTime.setHours(currentTime.getHours()+hoursOffset);
currentTime.setMinutes(currentTime.getMinutes()+minutesOffset);
currentTime.setSeconds(currentTime.getSeconds()+secondsOffset);
current_hours=currentTime.getHours();
current_minutes=currentTime.getMinutes();
current_seconds=currentTime.getSeconds();
current_milliseconds=currentTime.getMilliseconds()
}}else{currentTime=new Date;
currentTime.setHours(currentTime.getHours()+hoursOffset);
currentTime.setMinutes(currentTime.getMinutes()+minutesOffset);
currentTime.setSeconds(currentTime.getSeconds()+secondsOffset);
monthdate=currentTime.getDate();
weekday_num=currentTime.getDay();
current_hours=currentTime.getHours();
current_minutes=currentTime.getMinutes();
current_seconds=currentTime.getSeconds();
current_milliseconds=currentTime.getMilliseconds();
updated=true
}}else{currentTime=new Date;
currentTime.setHours(currentTime.getHours()+hoursOffset);
currentTime.setMinutes(currentTime.getMinutes()+minutesOffset);
currentTime.setSeconds(currentTime.getSeconds()+secondsOffset);
monthdate=currentTime.getDate();
weekday_num=currentTime.getDay();
current_seconds=currentTime.getSeconds();
current_minutes=currentTime.getMinutes();
current_hours=currentTime.getHours();
current_milliseconds=currentTime.getMilliseconds()
}}function setTimeToDefaultTime(){currentTime=new Date;
currentTime.setHours(10);
currentTime.setMinutes(11);
currentTime.setSeconds(31);
monthdate=currentTime.getDate();
weekday_num=currentTime.getDay();
current_seconds=currentTime.getSeconds();
current_minutes=currentTime.getMinutes();
current_hours=currentTime.getHours();
current_milliseconds=currentTime.getMilliseconds()
}function updateTimeCalculations(){var a=current_hours;
weekday_num++;
if(a>12){a-=12
}display_calculation.seconds_base_60=current_seconds*timeSlice;
display_calculation.seconds_base_60+=current_milliseconds*timeSlice/1000;
display_calculation.seconds_base_60+=rotCorrect;
display_calculation.minutes_base_60=current_minutes*timeSlice;
display_calculation.minutes_base_60+=current_seconds*timeSlice/60;
display_calculation.minutes_base_60+=rotCorrect;
display_calculation.minutes_base_30=current_minutes*timeSlice*2;
display_calculation.minutes_base_30+=current_seconds*timeSlice*2/60;
display_calculation.minutes_base_30+=rotCorrect;
display_calculation.hours_base_12=a*timeSlice*5;
display_calculation.hours_base_12+=current_minutes*timeSlice/12;
display_calculation.hours_base_12+=rotCorrect;
display_calculation.monthdate_base_31=monthdate*(timeSlice/6)*(360/31);
display_calculation.monthdate_base_31+=rotCorrect
}function easeInOutQuad(a,b,c,d){if(a<d/2){return 2*c*a*a/(d*d)+b
}ts=a-d/2;
return -2*c*ts*ts/(d*d)+2*c*ts/d+c/2+b
}function setHoursOffset(a){hoursOffset=a
}function setMinutesOffset(a){minutesOffset=a
}function setSecondsOffset(a){secondsOffset=a
}function getCurrentShownTime(){var a="";
if(current_hours<10){a+="0"
}a+=current_hours;
a+=":";
if(current_minutes<10){a+="0"
}a+=current_minutes;
return a
}function updateOnTimeDisplayOnce(){updateTimeCalculations();
updateDisplay()
}function updateOnTimeDisplayOvertime(){updateTime();
updateOnTimeDisplayOnce();
__killSwitches.to_time_display=setTimeout(updateOnTimeDisplayOvertime,tickDelay)
}var ticks_per_seconds=10;
var parts_starting_z_index=23;
var tickDelay=1000/ticks_per_seconds;
var timeSlice=Math.PI*2/60;
var rotCorrect=global_watch_p.rotation_angle*(timeSlice/6);
var display_calculation=new Array;
var currentTime=null;
var hoursOffset=0;
var minutesOffset=0;
var secondsOffset=0;
var monthdate=null;
var weekday_num=null;
var current_seconds=null;
var current_minutes=null;
var current_hours=null;
var current_milliseconds=null;
var canvasId="regular_timepiece_canvas";
var watchContainer=params.watchContainerID;
var canvasParent=document.getElementById(canvasId);
function prepareTimepieceElements(){if(prepareTimepieceElementsIsDone==false){for(i=0;
i<all_parts.length;
i++){if(all_p[i]["update_mode"]=="monthdate"||all_p[i]["update_mode"]=="weekday"){if(all_p[i]["url"]==null){var a=document.createElement("DIV")
}else{var a=document.createElement("CANVAS")
}document.getElementById(watchContainer).appendChild(a);
if(typeof G_vmlCanvasManager!="undefined"){a=G_vmlCanvasManager.initElement(a)
}a.setAttribute("id",all_parts[i]+"_div");
a.style.position="absolute";
a.style.width=all_p[i]["width"]+"px";
a.style.height=all_p[i]["height"]+"px";
a.style.left=all_p[i]["xoriginoffset"]+"px";
a.style.top=all_p[i]["yoriginoffset"]+"px";
if(all_p[i]["url"]==null){a.style.color="#"+all_p[i]["txt_color"];
a.style.fontSize=all_p[i]["txt_fontSize"];
a.style.fontFamily="Arial";
a.style.textAlign="center"
}parts_starting_z_index+=i;
a.style.zIndex=parts_starting_z_index
}}var b=document.createElement("CANVAS");
document.getElementById(watchContainer).appendChild(b);
if(typeof G_vmlCanvasManager!="undefined"){b=G_vmlCanvasManager.initElement(b)
}b.setAttribute("id","regular_timepiece_canvas");
b.style.position="absolute";
b.setAttribute("width",global_watch_p.width);
b.setAttribute("height",global_watch_p.height);
b.style.zIndex=parts_starting_z_index;
if(cyclop_mask_p.url){var b=document.createElement("CANVAS");
document.getElementById(watchContainer).appendChild(b);
if(typeof G_vmlCanvasManager!="undefined"){b=G_vmlCanvasManager.initElement(b)
}b.setAttribute("id","magnified_timepiece_canvas");
b.style.position="absolute";
b.setAttribute("width",global_watch_p.width);
b.setAttribute("height",global_watch_p.height);
b.style.zIndex=parts_starting_z_index+1
}prepareTimepieceElementsIsDone=true
}}function placeCanvas(a,b,c){a.clearRect(-global_watch_p.width,-global_watch_p.height,global_watch_p.width*2,global_watch_p.height*2);
if(b==false){}else{a.save();
if(c){a.translate(global_watch_p[c.watch_x_center],global_watch_p[c.watch_y_center])
}else{a.translate(global_watch_p.xcenter,global_watch_p.ycenter)
}}}function updateDisplay(){if(cyclop_mask_p.url){var a=document.getElementById(canvasId);
var b=a.getContext("2d");
placeCanvas(b,true);
drawTimepiece(b,true);
b.save();
b.translate(-global_watch_p.xcenter,-global_watch_p.ycenter);
b.globalCompositeOperation="destination-in";
b.drawImage(cyclop_mask_p.image,0,0,cyclop_mask_p.width,cyclop_mask_p.height);
b.restore();
b.restore()
}var a=document.getElementById(canvasId);
if(a.getContext){var b=a.getContext("2d");
placeCanvas(b,true);
drawTimepiece(b,false);
if(cyclop_mask_p.url){b.save();
b.translate(-global_watch_p.xcenter,-global_watch_p.ycenter);
b.globalCompositeOperation="destination-out";
b.drawImage(cyclop_mask_p.image,0,0,cyclop_mask_p.width,cyclop_mask_p.height);
b.restore()
}b.restore()
}else{alert("no context")
}}function drawTimepiece(a,b){magnify_x_offset=0;
magnify_y_offset=0;
magnify_x_scale=1;
magnify_y_scale=1;
if(b==true){magnify_x_offset=cyclop_mask_p.xcenteroffset;
magnify_y_offset=cyclop_mask_p.ycenteroffset;
magnify_x_scale=cyclop_mask_p.xscale;
magnify_y_scale=cyclop_mask_p.yscale
}a.globalCompositeOperation="source-over";
for(var i=0;
i<all_parts.length;
i++){var c=all_p[i];
a.save();
if(all_p[i]["update_mode"]!=null){if(all_p[i]["update_mode"]=="monthdate"){if(all_p[i]["url"]==null){document.getElementById(all_parts[i]+"_div").innerHTML=monthdate
}else{document.getElementById(all_parts[i]+"_div").style.background="url('"+image_folder+"num_"+monthdate+"."+all_p[i]["fileformat"]+"')"
}}else{if(all_p[i]["update_mode"]=="weekday"){document.getElementById(all_parts[i]+"_div").style.background="url('"+image_folder+"weekday_"+weekday_num+"."+all_p[i]["fileformat"]+"')"
}else{a.translate(c.xcenteroffset,c.ycenteroffset);
a.translate(magnify_x_offset,magnify_y_offset);
a.translate(c.offset_alternate_x_center,c.offset_alternate_y_center);
a.scale(global_watch_p.xscale*magnify_x_scale,global_watch_p.yscale*magnify_y_scale);
a.rotate(display_calculation[c.update_mode]);
a.translate(-c.xrotation,-c.yrotation);
var img=document.getElementById("p_"+all_parts[i]);
a.drawImage(img,0,0,c.width,c.height);
for(var d in all_p[i]["__lightEffects"]){if(all_p[i]["__lightEffects"][d].height>0){a.globalAlpha=getAlphaForRotation(d,display_calculation[c.update_mode],"normal");
a.drawImage(c.__lightEffects[d],0,0,c.width,c.height)
}}}}}else{a.translate(all_p[i]["xcenteroffset"],all_p[i]["ycenteroffset"]);
a.translate(-all_p[i]["xcenter"],-all_p[i]["ycenter"]);
a.drawImage(all_p[i]["image"],0,0,all_p[i]["width"],all_p[i]["height"])
}a.restore()
}}function startWatchEngineWhenReady(){if(all_p_to_be_loaded<1){prepareTimepieceElements();
__killSwitches.to_engine=window.setTimeout(updateOnTimeDisplayOvertime,0)
}else{__killSwitches.raf_engine=requestAnimFrame(startWatchEngineWhenReady)
}}function startWatchEngine(){startWatchEngineWhenReady()
}function showStaticWatchOnTime(){if(all_p_to_be_loaded<1){prepareTimepieceElements();
setTimeToDefaultTime();
updateOnTimeDisplayOnce()
}else{__killSwitches.to_static_watch=timeoutID=window.setTimeout(showStaticWatchOnTime,tickDelay)
}}function spinToCurrentTimeAfterDelay(a){}var prepareTimepieceElementsIsDone=false;
var weekday_displayed=false;
var magnify_x_offset=0;
var magnify_y_offset=0;
var blockLocal=document.getElementById("yourtime");
var blockCity=document.getElementById("city");
var oldIE;
if($("html").is(".ie6, .ie7, .ie8")){oldIE=true
}var liftoffTime=new Date();
liftoffTime.setDate(liftoffTime.getDate());
var rolexClockCountdownCalc;
function removeElement(id){var element=document.getElementById(id);
element.parentNode.removeChild(element)
}function loadListofdates(){var language=params.LANG;
var language=language.toLowerCase();
var now_date=new Date();
var year=now_date.getFullYear();
var month=now_date.getMonth()+1;
var day=now_date.getDate();
if(month<10){month="0"+month
}if(day<10){day="0"+day
}var names=[];
var timezones=[];
var timezone_dst=[];
var timeText=[];
var cdYear=[];
var cdMonth=[];
var cdDay=[];
var cdHour=[];
var cdMin=[];
var ClockRacetext=[];
var todayfull=Number(year+""+month+""+day);
var index=null;
for(var i=0;
i<params.dateList.length;
i++){if(i==params.selectedCityId){index=i;
if(language==""||i==params.dateList.length-1){names.push(params.dateList[index].city);
timeText.push(params.dateList[index].local)
}else{names.push(params.dateList[index].city);
timeText.push(params.dateList[index].local)
}timezones.push(params.dateList[index].offset);
timezone_dst.push(params.dateList[index].dst);
if(params.isCountdownClock){cdYear.push(params.dateList[index].cdyear);
cdMonth.push(params.dateList[index].cdmonth);
cdDay.push(params.dateList[index].cdday);
cdHour.push(params.dateList[index].cdhour);
cdMin.push(params.dateList[index].cdmin);
ClockRacetext.push(params.dateList[index].cdtext)
}if(params.isCompetitionWithCarousel){_competition.data.push(params.dateList[index])
}}}return{names:names,timezones:timezones,timezone_dst:timezone_dst,timeText:timeText,cdYear:cdYear,cdMonth:cdMonth,cdDay:cdDay,cdHour:cdHour,cdMin:cdMin,ClockRacetext:ClockRacetext}
}var competitionBlock=document.getElementById("competition");
function updateCompetition(){if(_competition.isAnimationActive){var index=_competition.index>=(_competition.data.length-2)?0:_competition.index+1;
var cur=_competition.data[index];
if(cur){_competition.index=index;
while(competitionBlock.lastChild){competitionBlock.removeChild(competitionBlock.lastChild)
}var c=cur.competition;
for(var n in c){var e=document.createElement(params.competitionParams.tag);
e.className="competition-"+n;
e.innerHTML=c[n];
competitionBlock.appendChild(e)
}updateClock(cur);
updateAllTextBlock();
__killSwitchs.to_competition=_competition.timer=window.setTimeout(updateCompetition,params.competitionParams.interval)
}}}function activateCompetition(flag){flag=(typeof flag=="boolean")?flag:false;
_competition.isAnimationActive=flag
}function updateClock(data){params.theLocalText=data.timeText[params.LANG];
params.theCityText=data.city[params.LANG];
params.customOffset=data.timezone;
params.theCity=((data.city[params.LANG]).toLowerCase()).trim();
params.customDST=data.dst;
if($(blockCity).hasClass(params.activeClass)){showTimeIn("city",params.theCity,params.customOffset,params.customDST)
}}function updateAllTextBlock(){document.getElementById("cityText").innerHTML=params.theCityText;
document.getElementById("cityText").setAttribute("zone",params.customDST);
document.getElementById("localtext").innerHTML=params.theLocalText;
document.getElementById("city-link").title=params.theCityText.replace('"',"&quot;");
document.getElementById("local-link").title=params.theLocalText.replace('"',"&quot;");
document.getElementById("city-link").href="#"+params.theCityText.replace('"',"&quot;").replace(" ","_");
document.getElementById("local-link").href="#"+params.theLocalText.replace('"',"&quot;").replace(" ","_")
}var _cityParam={tempOffset:0,cityOffset:0};
function showTimeIn(selectorID,cityname,offset,timezone,cdYear,cdMonth,cdDay,cdHour,cdMin){if(params.isCountdownClock){if(cityname!==""){var now=new Date;
var tempOffset=now.getTimezoneOffset();
tempOffset+=60*offset;
var gettimezoneDST=getDST(new Date(),timezone);
if(gettimezoneDST==100){tempOffset+=60
}if(params.clocktimeAtEvent){var dstMinutes=now.dst()?60:0;
rolexClockCountdown=new Date(cdYear,parseInt(cdMonth)-1,cdDay,parseInt(cdHour),parseInt(cdMin)+dstMinutes);
_cityParam.tempOffset=tempOffset;
_cityParam.cityOffset=offset;
cityTime();
rolexClockCountdownCalc=foreignToLocal(rolexClockCountdown,offset*100,timezone);
setMinutesOffset(_cityParam.tempOffset)
}else{var event=foreignToLocal(new Date(cdYear,parseInt(cdMonth)-1,cdDay,parseInt(cdHour),parseInt(cdMin)),offset*100,timezone);
var dstMinutes=now.dst()&&!event.dst()?-60:!now.dst()&&event.dst()?-60:0;
_cityParam.tempOffset=tempOffset;
_cityParam.cityOffset=offset;
cityTime();
rolexClockCountdownCalc=foreignToLocal(new Date(cdYear,parseInt(cdMonth)-1,cdDay,parseInt(cdHour),parseInt(cdMin)+dstMinutes),offset*100,timezone);
setMinutesOffset(_cityParam.tempOffset)
}}}else{var now=new Date;
var tempOffset=now.getTimezoneOffset();
if(params.theCityText!==""){if(cityname){tempOffset+=60*offset;
var gettimezoneDST=getDST(new Date(),timezone);
if(gettimezoneDST==100){tempOffset+=60
}setMinutesOffset(tempOffset);
_cityParam.tempOffset=tempOffset;
_cityParam.cityOffset=offset;
cityTime()
}}}}function yourTime(){var a=new Date;
a.setHours(a.getHours());
a.setMinutes(a.getMinutes());
a.setSeconds(a.getSeconds());
var b=a.getSeconds();
var c=a.getMinutes();
var d=a.getHours();
var e=a.getDay();
if(e==0){var f="Sun"
}else{if(e==1){var f="Mon"
}else{if(e==2){var f="Tue"
}else{if(e==3){var f="Wed"
}else{if(e==4){var f="Thu"
}else{if(e==5){var f="Fri"
}else{if(e==6){var f="Sat"
}}}}}}}if(params.amPm==true){var g=" ";
if(d>=12){g=" PM"
}else{g=" AM"
}}else{g=""
}if(params.time24hours==true){g=""
}else{if(d>=13){d-=12
}}if(params.leadingZeros==true){if(d<10){d="0"+d
}}if(c<10){c="0"+c
}if(params.showText==true){if(params.showDay==true){f=f
}else{f=""
}if(!params.showTime){update=document.getElementById("rolexClockYourTime").innerHTML=f+" "+d+":"+c+""+g
}}}function cityTime(){var cityTime=new Date();
cityTime.setHours(cityTime.getHours());
cityTime.setMinutes(cityTime.getMinutes()+_cityParam.tempOffset);
cityTime.setSeconds(cityTime.getSeconds());
var cityTime_millisecondes=cityTime.getMilliseconds();
var cityTime_seconds=cityTime.getSeconds();
var cityTime_minutes=cityTime.getMinutes();
var cityTime_hours=cityTime.getHours();
var cityTime_day=cityTime.getDay();
if(cityTime_day==0){var f="Sun"
}else{if(cityTime_day==1){var f="Mon"
}else{if(cityTime_day==2){var f="Tue"
}else{if(cityTime_day==3){var f="Wed"
}else{if(cityTime_day==4){var f="Thu"
}else{if(cityTime_day==5){var f="Fri"
}else{if(cityTime_day==6){var f="Sat"
}}}}}}}if(params.amPm==true){var g=" ";
if(cityTime_hours>=12){g=" PM"
}else{g=" AM"
}}else{g=""
}if(params.time24hours==true){g=""
}else{if(cityTime_hours>=13){cityTime_hours-=12
}else{if(cityTime_hours==0){cityTime_hours=12
}}}if(params.leadingZeros==true){if(cityTime_hours<10){cityTime_hours="0"+cityTime_hours
}}if(cityTime_minutes<10){cityTime_minutes="0"+cityTime_minutes
}if(params.showText==true){if(params.showDay==true){f=f
}else{f=""
}}if(cityTime_seconds>=0&&cityTime_seconds<1){update=document.getElementById("rolexClockCityTime").innerHTML=f+" "+cityTime_hours+":"+cityTime_minutes+""+g
}else{if(checked===undefined&&params.showTime==false){update=document.getElementById("rolexClockCityTime").innerHTML=f+" "+cityTime_hours+":"+cityTime_minutes+""+g;
var checked=1
}}}function roundTime(){cityTime();
yourTime();
__killSwitches.raf_round_time=requestAnimFrame(roundTime)
}function getOffsetBase10(offset){var hours=parseInt(offset);
var decimal=offset-hours;
var newDecimal=decimal/0.6;
return hours+newDecimal
}var flashMode=false;
function buildClock(){$("body").addClass(params.LANG);
$(".image-fallback").attr("src","img/"+params.fallback);
var container=document.getElementById("rolexClockWim-container");
if(Modernizr.retina==true){}var blockLocal=document.getElementById("local");
var blockCity=document.getElementById("city");
function changeBg(bg){if(params.isCountdownClock){if(bg=="full"){global_watch_p.xcenter=params.globalXcenter;
global_watch_p.ycenter=params.globalYcenter;
if(Modernizr.retina==true){}}else{global_watch_p.xcenter=params.globalXcenter;
global_watch_p.ycenter=params.globalYcenter;
if(Modernizr.retina==true){}}}else{global_watch_p.xscale=params.globalXscale;
global_watch_p.yscale=params.globalYscale;
global_watch_p.xcenter=params.globalXcenter;
global_watch_p.ycenter=params.globalYcenter;
if(bg=="full"){if(Modernizr.retina==true){}}else{blockLocal.style.display="none";
blockCity.style.display="none";
if(Modernizr.retina==true){}}}}if(!params.forceFallback&&!params.forceFlash&&Modernizr.canvas==true&&document.compatMode!="Quirks"&&oldIE!=true){$(".fallback").remove();
$(".tracker").attr("href",params.trackingurl);
if(!params.showText){$(blockCity).hide();
$(blockLocal).hide();
changeBg("full")
}else{var e=loadListofdates();
var names=e.names,timezones=e.timezones,timezone_dst=e.timezone_dst,timeText=e.timeText;
var cdYear=e.cdYear,cdMonth=e.cdMonth,cdDay=e.cdDay,cdHour=e.cdHour,cdMin=e.cdMin,ClockRacetext=e.ClockRacetext;
if(names.length>0){if(params.isCountdownClock){rolexClockRacetext=ClockRacetext[0];
$("#racetext").html(rolexClockRacetext)
}changeBg("full");
if(params.isCompetitionWithCarousel){if(names.length>1){updateCompetition()
}else{$(".ui-loader").hide();
$(".fallback").show();
return
}}else{params.theLocalText=timeText[0];
params.theCityText=names[0];
params.customOffset=getOffsetBase10(timezones[0]);
params.theCity=(names[0].toLowerCase()).trim();
params.customDST=timezone_dst[0]
}updateAllTextBlock()
}else{if(params.isCompetitionWithCarousel){competitionBlock.style.display="none"
}else{if(params.isCountdownClock){document.getElementById("cityText").innerHTML="&nbsp;";
document.getElementById("cityText").setAttribute("zone","");
document.getElementById("localtext").innerHTML="&nbsp;";
document.getElementById("city-link").title="&nbsp;";
document.getElementById("local-link").title="&nbsp;";
document.getElementById("city-link").href="#";
document.getElementById("local-link").href="#"
}else{changeBg();
if(params.showTime==true){document.getElementById("block-control").removeChild(blockCity);
document.getElementById("block-control").removeChild(blockLocal)
}else{document.getElementById("cityText").innerHTML=params.theCityText;
document.getElementById("cityText").setAttribute("zone",params.customDST);
document.getElementById("localtext").innerHTML=params.theLocalText;
document.getElementById("city-link").title=params.theCityText.replace('"',"&quot;");
document.getElementById("local-link").title=params.theLocalText.replace('"',"&quot;");
document.getElementById("city-link").href="#"+params.theCityText.replace('"',"&quot;").replace(" ","_");
document.getElementById("local-link").href="#"+params.theLocalText.replace('"',"&quot;").replace(" ","_")
}}}}var thenewOffset,customOffset,elem;
blockLocal.onclick=function(){$("."+params.blockClass+"."+params.activeClass).removeClass(params.activeClass);
$(this).addClass(params.activeClass);
showCurrentTime();
return params.onclickYourtime(_cityParam.tempOffset)
};
blockCity.onclick=function(){$("."+params.blockClass+"."+params.activeClass).removeClass(params.activeClass);
$(this).addClass(params.activeClass);
showTimeIn("city",params.theCity,params.customOffset,params.customDST,cdYear,cdMonth,cdDay,cdHour,cdMin);
return params.onclickCity()
};
function updateShownTimeInHTMLComponentOvertime(){updateShownTimeInHTMLComponent();
requestAnimFrame(updateShownTimeInHTMLComponentOvertime())
}function showCurrentTime(){setMinutesOffset(0)
}function updateShownTimeInHTMLComponent(){tempString=getCurrentShownTime()
}if(params.theCity!=""){if(params.isCountdownClock){showTimeIn("city",params.theCity,params.customOffset,params.customDST,cdYear[0],cdMonth[0],cdDay[0],cdHour[0],cdMin[0]);
startCountdownPlugin(rolexClockLanguage,rolexClockCountdownCalc)
}else{showTimeIn("city",params.theCity,params.customOffset,params.customDST)
}}if(params.showLocalOnly){showCurrentTime()
}roundTime()
}startWatchEngine();
showClock()
}}function expiration(){if(!flashMode){$(".countdown").hide()
}$(".content").removeClass("has-countdown").addClass("no-countdown")
}function startCountdownPlugin(lang,expirationTime){if(lang=="fr"){$.countdown.regional.fr={labels:["Annes","Mois","Semaines","Jours","Heures","Min","Sec"],labels1:["Anne","Mois","Semaine","Jour","Heure","Min","Sec"],compactLabels:["a","m","s","j"],whichLabels:function(amount){return(amount>1?0:1)
},timeSeparator:":",isRTL:false};
$.countdown.setDefaults($.countdown.regional.fr)
}else{if(lang=="zhs"){$.countdown.regional["zh-CN"]={labels:["","","","","","",""],labels1:["","","","","","",""],compactLabels:["","","",""],compactLabels1:["","","",""],whichLabels:null,timeSeparator:":",isRTL:false};
$.countdown.setDefaults($.countdown.regional["zh-CN"])
}else{if(lang=="ja"){$.countdown.regional.ja={labels:["","","","","","",""],labels1:["","","","","","",""],compactLabels:["","","",""],whichLabels:null,digits:["0","1","2","3","4","5","6","7","8","9"],timeSeparator:":",isRTL:false};
$.countdown.setDefaults($.countdown.regional.ja)
}else{if(lang=="de"){$.countdown.regional.de={labels:["Jahre","Monate","Wochen","Tage","Stunden","Min","Sek"],labels1:["Jahr","Monat","Woche","Tag","Stunde","Min","Sek"],compactLabels:["J","M","W","T"],whichLabels:null,digits:["0","1","2","3","4","5","6","7","8","9"],timeSeparator:":",isRTL:false};
$.countdown.setDefaults($.countdown.regional.de)
}else{if(lang=="ru"){$.countdown.regional.ru={labels:["???","???????","??????","????","?????","?????","??????"],labels1:["???","?????","??????","????","???","??????","???????"],labels2:["????","??????","??????","???","????","??????","???????"],compactLabels:["?","?","?","?"],compactLabels1:["?","?","?","?"],whichLabels:function(amount){var units=amount%10;
var tens=Math.floor((amount%100)/10);
return(amount==1?1:(units>=2&&units<=4&&tens!=1?2:(units==1&&tens!=1?1:0)))
},digits:["0","1","2","3","4","5","6","7","8","9"],timeSeparator:":",isRTL:false};
$.countdown.setDefaults($.countdown.regional.ru)
}else{if(lang=="es"){$.countdown.regional.es={labels:["Aos","Meses","Semanas","Das","Horas","Minutos","Segundos"],labels1:["Ao","Mes","Semana","Da","Hora","Minuto","Segundo"],compactLabels:["a","m","s","g"],whichLabels:null,digits:["0","1","2","3","4","5","6","7","8","9"],timeSeparator:":",isRTL:false};
$.countdown.setDefaults($.countdown.regional.es)
}else{}}}}}}if(expirationTime!==undefined){$(".content").addClass("has-countdown").removeClass("no-countdown");
var tpl="";
if(params.countdownNumbersOnly){tpl='<ul class="cd-listview">{y<}<li class="cd-years"><span></span>{yn} </li>{y>}{o<}<li class="cd-months"><span></span>{on} </li>{o>}{d<}<li class="cd-days"><span></span>{dnnn} </li>{d>}{h<}<li class="cd-hours"><span></span>{hnn} </li>{h>}{m<}<li class="cd-minutes"><span></span>{mnn} </li>{m>}{s<}<li class="cd-seconds"><span></span>{snn} </li>{s>}</ul>'
}else{tpl='<ul class="cd-listview">{y<}<li class="cd-years"><span></span>{yn} {yl}</li>{y>}{o<}<li class="cd-month"><span></span>{on} {ol}</li>{o>}{d<}<li class="cd-days"><span></span>{dnnn} {dl}</li>{d>}{h<}<li class="cd-hours"><span></span>{hnn} {hl}</li>{h>}{m<}<li class="cd-minutes"><span></span>{mnn} {ml}</li>{m>}{s<}<li class="cd-seconds"><span></span>{snn} {sl}</li>{s>}</ul>'
}$("#watch_countdown").countdown({until:expirationTime,significant:0,format:"DHMS",alwaysExpire:true,layout:tpl,onExpiry:expiration})
}}buildClock(params);
var _cancelAnimationFrame=(function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame
}());
return function(){blockCity=null;
blockLocal=null;
for(var timer in __killSwitches){if(/^to_/.test(timer)){clearTimeout(__killSwitches[timer])
}else{try{_cancelAnimationFrame(__killSwitches[timer])
}catch(ex){}}}}
}
}(jQuery));
Date.prototype.stdTimezoneOffset=function(){var a=new Date(this.getFullYear(),0,1);
var b=new Date(this.getFullYear(),6,1);
return Math.max(a.getTimezoneOffset(),b.getTimezoneOffset())
};
Date.prototype.dst=function(){return this.getTimezoneOffset()<this.stdTimezoneOffset()
}
/*! jPlayer 2.9.2 for jQuery ~ (c) 2009-2014 Happyworm Ltd ~ MIT License */
;
!function(d,c){"function"==typeof define&&define.amd?define(["jquery"],c):c("object"==typeof exports?require("jquery"):d.jQuery?d.jQuery:d.Zepto)
}(this,function(i,h){i.fn.jPlayer=function(q){var p="jPlayer",o="string"==typeof q,b=Array.prototype.slice.call(arguments,1),a=this;
return q=!o&&b.length?i.extend.apply(null,[!0,q].concat(b)):q,o&&"_"===q.charAt(0)?a:(this.each(o?function(){var d=i(this).data(p),c=d&&i.isFunction(d[q])?d[q].apply(d,b):d;
return c!==d&&c!==h?(a=c,!1):void 0
}:function(){var c=i(this).data(p);
c?c.option(q||{}):i(this).data(p,new i.jPlayer(q,this))
}),a)
},i.jPlayer=function(a,f){if(arguments.length){this.element=i(f),this.options=i.extend(!0,{},this.options,a);
var e=this;
this.element.bind("remove.jPlayer",function(){e.destroy()
}),this._init()
}},"function"!=typeof i.fn.stop&&(i.fn.stop=function(){}),i.jPlayer.emulateMethods="load play pause",i.jPlayer.emulateStatus="src readyState networkState currentTime duration paused ended playbackRate",i.jPlayer.emulateOptions="muted volume",i.jPlayer.reservedEvent="ready flashreset resize repeat error warning",i.jPlayer.event={},i.each(["ready","setmedia","flashreset","resize","repeat","click","error","warning","loadstart","progress","suspend","abort","emptied","stalled","play","pause","loadedmetadata","loadeddata","waiting","playing","canplay","canplaythrough","seeking","seeked","timeupdate","ended","ratechange","durationchange","volumechange"],function(){i.jPlayer.event[this]="jPlayer_"+this
}),i.jPlayer.htmlEvent=["loadstart","abort","emptied","stalled","loadedmetadata","canplay","canplaythrough"],i.jPlayer.pause=function(){i.jPlayer.prototype.destroyRemoved(),i.each(i.jPlayer.prototype.instances,function(d,c){c.data("jPlayer").status.srcSet&&c.jPlayer("pause")
})
},i.jPlayer.timeFormat={showHour:!1,showMin:!0,showSec:!0,padHour:!1,padMin:!0,padSec:!0,sepHour:":",sepMin:":",sepSec:""};
var n=function(){this.init()
};
n.prototype={init:function(){this.options={timeFormat:i.jPlayer.timeFormat}
},time:function(w){w=w&&"number"==typeof w?w:0;
var v=new Date(1000*w),u=v.getUTCHours(),t=this.options.timeFormat.showHour?v.getUTCMinutes():v.getUTCMinutes()+60*u,s=this.options.timeFormat.showMin?v.getUTCSeconds():v.getUTCSeconds()+60*t,r=this.options.timeFormat.padHour&&10>u?"0"+u:u,q=this.options.timeFormat.padMin&&10>t?"0"+t:t,p=this.options.timeFormat.padSec&&10>s?"0"+s:s,o="";
return o+=this.options.timeFormat.showHour?r+this.options.timeFormat.sepHour:"",o+=this.options.timeFormat.showMin?q+this.options.timeFormat.sepMin:"",o+=this.options.timeFormat.showSec?p+this.options.timeFormat.sepSec:""
}};
var m=new n;
i.jPlayer.convertTime=function(b){return m.time(b)
},i.jPlayer.uaBrowser=function(p){var o=p.toLowerCase(),u=/(webkit)[ \/]([\w.]+)/,t=/(opera)(?:.*version)?[ \/]([\w.]+)/,s=/(msie) ([\w.]+)/,r=/(mozilla)(?:.*? rv:([\w.]+))?/,q=u.exec(o)||t.exec(o)||s.exec(o)||o.indexOf("compatible")<0&&r.exec(o)||[];
return{browser:q[1]||"",version:q[2]||"0"}
},i.jPlayer.uaPlatform=function(p){var o=p.toLowerCase(),v=/(ipad|iphone|ipod|android|blackberry|playbook|windows ce|webos)/,u=/(ipad|playbook)/,t=/(android)/,s=/(mobile)/,r=v.exec(o)||[],q=u.exec(o)||!s.exec(o)&&t.exec(o)||[];
return r[1]&&(r[1]=r[1].replace(/\s/g,"_")),{platform:r[1]||"",tablet:q[1]||""}
},i.jPlayer.browser={},i.jPlayer.platform={};
var l=i.jPlayer.uaBrowser(navigator.userAgent);
l.browser&&(i.jPlayer.browser[l.browser]=!0,i.jPlayer.browser.version=l.version);
var k=i.jPlayer.uaPlatform(navigator.userAgent);
k.platform&&(i.jPlayer.platform[k.platform]=!0,i.jPlayer.platform.mobile=!k.tablet,i.jPlayer.platform.tablet=!!k.tablet),i.jPlayer.getDocMode=function(){var a;
return i.jPlayer.browser.msie&&(document.documentMode?a=document.documentMode:(a=5,document.compatMode&&"CSS1Compat"===document.compatMode&&(a=7))),a
},i.jPlayer.browser.documentMode=i.jPlayer.getDocMode(),i.jPlayer.nativeFeatures={init:function(){var w,v,u,t=document,s=t.createElement("video"),r={w3c:["fullscreenEnabled","fullscreenElement","requestFullscreen","exitFullscreen","fullscreenchange","fullscreenerror"],moz:["mozFullScreenEnabled","mozFullScreenElement","mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozfullscreenerror"],webkit:["","webkitCurrentFullScreenElement","webkitRequestFullScreen","webkitCancelFullScreen","webkitfullscreenchange",""],webkitVideo:["webkitSupportsFullscreen","webkitDisplayingFullscreen","webkitEnterFullscreen","webkitExitFullscreen","",""],ms:["","msFullscreenElement","msRequestFullscreen","msExitFullscreen","MSFullscreenChange","MSFullscreenError"]},q=["w3c","moz","webkit","webkitVideo","ms"];
for(this.fullscreen=w={support:{w3c:!!t[r.w3c[0]],moz:!!t[r.moz[0]],webkit:"function"==typeof t[r.webkit[3]],webkitVideo:"function"==typeof s[r.webkitVideo[2]],ms:"function"==typeof s[r.ms[2]]},used:{}},v=0,u=q.length;
u>v;
v++){var p=q[v];
if(w.support[p]){w.spec=p,w.used[p]=!0;
break
}}if(w.spec){var o=r[w.spec];
w.api={fullscreenEnabled:!0,fullscreenElement:function(b){return b=b?b:t,b[o[1]]
},requestFullscreen:function(b){return b[o[2]]()
},exitFullscreen:function(b){return b=b?b:t,b[o[3]]()
}},w.event={fullscreenchange:o[4],fullscreenerror:o[5]}
}else{w.api={fullscreenEnabled:!1,fullscreenElement:function(){return null
},requestFullscreen:function(){},exitFullscreen:function(){}},w.event={}
}}},i.jPlayer.nativeFeatures.init(),i.jPlayer.focus=null,i.jPlayer.keyIgnoreElementNames="A INPUT TEXTAREA SELECT BUTTON";
var j=function(a){var f,e=i.jPlayer.focus;
e&&(i.each(i.jPlayer.keyIgnoreElementNames.split(/\s+/g),function(b,c){return a.target.nodeName.toUpperCase()===c.toUpperCase()?(f=!0,!1):void 0
}),f||i.each(e.options.keyBindings,function(d,b){return b&&i.isFunction(b.fn)&&("number"==typeof b.key&&a.which===b.key||"string"==typeof b.key&&a.key===b.key)?(a.preventDefault(),b.fn(e),!1):void 0
}))
};
i.jPlayer.keys=function(a){var d="keydown.jPlayer";
i(document.documentElement).unbind(d),a&&i(document.documentElement).bind(d,j)
},i.jPlayer.keys(!0),i.jPlayer.prototype={count:0,version:{script:"2.9.2",needFlash:"2.9.0",flash:"unknown"},options:{swfPath:"js",solution:"html, flash",supplied:"mp3",auroraFormats:"wav",preload:"metadata",volume:0.8,muted:!1,remainingDuration:!1,toggleDuration:!1,captureDuration:!0,playbackRate:1,defaultPlaybackRate:1,minPlaybackRate:0.5,maxPlaybackRate:4,wmode:"opaque",backgroundColor:"#000000",cssSelectorAncestor:"#jp_container_1",cssSelector:{videoPlay:".jp-video-play",play:".jp-play",pause:".jp-pause",stop:".jp-stop",seekBar:".jp-seek-bar",playBar:".jp-play-bar",mute:".jp-mute",unmute:".jp-unmute",volumeBar:".jp-volume-bar",volumeBarValue:".jp-volume-bar-value",volumeMax:".jp-volume-max",playbackRateBar:".jp-playback-rate-bar",playbackRateBarValue:".jp-playback-rate-bar-value",currentTime:".jp-current-time",duration:".jp-duration",title:".jp-title",fullScreen:".jp-full-screen",restoreScreen:".jp-restore-screen",repeat:".jp-repeat",repeatOff:".jp-repeat-off",gui:".jp-gui",noSolution:".jp-no-solution"},stateClass:{playing:"jp-state-playing",seeking:"jp-state-seeking",muted:"jp-state-muted",looped:"jp-state-looped",fullScreen:"jp-state-full-screen",noVolume:"jp-state-no-volume"},useStateClassSkin:!1,autoBlur:!0,smoothPlayBar:!1,fullScreen:!1,fullWindow:!1,autohide:{restored:!1,full:!0,fadeIn:200,fadeOut:600,hold:1000},loop:!1,repeat:function(a){a.jPlayer.options.loop?i(this).unbind(".jPlayerRepeat").bind(i.jPlayer.event.ended+".jPlayer.jPlayerRepeat",function(){i(this).jPlayer("play")
}):i(this).unbind(".jPlayerRepeat")
},nativeVideoControls:{},noFullWindow:{msie:/msie [0-6]\./,ipad:/ipad.*?os [0-4]\./,iphone:/iphone/,ipod:/ipod/,android_pad:/android [0-3]\.(?!.*?mobile)/,android_phone:/(?=.*android)(?!.*chrome)(?=.*mobile)/,blackberry:/blackberry/,windows_ce:/windows ce/,iemobile:/iemobile/,webos:/webos/},noVolume:{ipad:/ipad/,iphone:/iphone/,ipod:/ipod/,android_pad:/android(?!.*?mobile)/,android_phone:/android.*?mobile/,blackberry:/blackberry/,windows_ce:/windows ce/,iemobile:/iemobile/,webos:/webos/,playbook:/playbook/},timeFormat:{},keyEnabled:!1,audioFullScreen:!1,keyBindings:{play:{key:80,fn:function(b){b.status.paused?b.play():b.pause()
}},fullScreen:{key:70,fn:function(b){(b.status.video||b.options.audioFullScreen)&&b._setOption("fullScreen",!b.options.fullScreen)
}},muted:{key:77,fn:function(b){b._muted(!b.options.muted)
}},volumeUp:{key:190,fn:function(b){b.volume(b.options.volume+0.1)
}},volumeDown:{key:188,fn:function(b){b.volume(b.options.volume-0.1)
}},loop:{key:76,fn:function(b){b._loop(!b.options.loop)
}}},verticalVolume:!1,verticalPlaybackRate:!1,globalVolume:!1,idPrefix:"jp",noConflict:"jQuery",emulateHtml:!1,consoleAlerts:!0,errorAlerts:!1,warningAlerts:!1},optionsAudio:{size:{width:"0px",height:"0px",cssClass:""},sizeFull:{width:"0px",height:"0px",cssClass:""}},optionsVideo:{size:{width:"480px",height:"270px",cssClass:"jp-video-270p"},sizeFull:{width:"100%",height:"100%",cssClass:"jp-video-full"}},instances:{},status:{src:"",media:{},paused:!0,format:{},formatType:"",waitForPlay:!0,waitForLoad:!0,srcSet:!1,video:!1,seekPercent:0,currentPercentRelative:0,currentPercentAbsolute:0,currentTime:0,duration:0,remaining:0,videoWidth:0,videoHeight:0,readyState:0,networkState:0,playbackRate:1,ended:0},internal:{ready:!1},solution:{html:!0,aurora:!0,flash:!0},format:{mp3:{codec:"audio/mpeg",flashCanPlay:!0,media:"audio"},m4a:{codec:'audio/mp4; codecs="mp4a.40.2"',flashCanPlay:!0,media:"audio"},m3u8a:{codec:'application/vnd.apple.mpegurl; codecs="mp4a.40.2"',flashCanPlay:!1,media:"audio"},m3ua:{codec:"audio/mpegurl",flashCanPlay:!1,media:"audio"},oga:{codec:'audio/ogg; codecs="vorbis, opus"',flashCanPlay:!1,media:"audio"},flac:{codec:"audio/x-flac",flashCanPlay:!1,media:"audio"},wav:{codec:'audio/wav; codecs="1"',flashCanPlay:!1,media:"audio"},webma:{codec:'audio/webm; codecs="vorbis"',flashCanPlay:!1,media:"audio"},fla:{codec:"audio/x-flv",flashCanPlay:!0,media:"audio"},rtmpa:{codec:'audio/rtmp; codecs="rtmp"',flashCanPlay:!0,media:"audio"},m4v:{codec:'video/mp4; codecs="avc1.42E01E, mp4a.40.2"',flashCanPlay:!0,media:"video"},m3u8v:{codec:'application/vnd.apple.mpegurl; codecs="avc1.42E01E, mp4a.40.2"',flashCanPlay:!1,media:"video"},m3uv:{codec:"audio/mpegurl",flashCanPlay:!1,media:"video"},ogv:{codec:'video/ogg; codecs="theora, vorbis"',flashCanPlay:!1,media:"video"},webmv:{codec:'video/webm; codecs="vorbis, vp8"',flashCanPlay:!1,media:"video"},flv:{codec:"video/x-flv",flashCanPlay:!0,media:"video"},rtmpv:{codec:'video/rtmp; codecs="rtmp"',flashCanPlay:!0,media:"video"}},_init:function(){var s=this;
if(this.element.empty(),this.status=i.extend({},this.status),this.internal=i.extend({},this.internal),this.options.timeFormat=i.extend({},i.jPlayer.timeFormat,this.options.timeFormat),this.internal.cmdsIgnored=i.jPlayer.platform.ipad||i.jPlayer.platform.iphone||i.jPlayer.platform.ipod,this.internal.domNode=this.element.get(0),this.options.keyEnabled&&!i.jPlayer.focus&&(i.jPlayer.focus=this),this.androidFix={setMedia:!1,play:!1,pause:!1,time:0/0},i.jPlayer.platform.android&&(this.options.preload="auto"!==this.options.preload?"metadata":"auto"),this.formats=[],this.solutions=[],this.require={},this.htmlElement={},this.html={},this.html.audio={},this.html.video={},this.aurora={},this.aurora.formats=[],this.aurora.properties=[],this.flash={},this.css={},this.css.cs={},this.css.jq={},this.ancestorJq=[],this.options.volume=this._limitValue(this.options.volume,0,1),i.each(this.options.supplied.toLowerCase().split(","),function(c,u){var t=u.replace(/^\s+|\s+$/g,"");
if(s.format[t]){var g=!1;
i.each(s.formats,function(e,d){return t===d?(g=!0,!1):void 0
}),g||s.formats.push(t)
}}),i.each(this.options.solution.toLowerCase().split(","),function(c,u){var t=u.replace(/^\s+|\s+$/g,"");
if(s.solution[t]){var g=!1;
i.each(s.solutions,function(e,d){return t===d?(g=!0,!1):void 0
}),g||s.solutions.push(t)
}}),i.each(this.options.auroraFormats.toLowerCase().split(","),function(c,u){var t=u.replace(/^\s+|\s+$/g,"");
if(s.format[t]){var g=!1;
i.each(s.aurora.formats,function(e,d){return t===d?(g=!0,!1):void 0
}),g||s.aurora.formats.push(t)
}}),this.internal.instance="jp_"+this.count,this.instances[this.internal.instance]=this.element,this.element.attr("id")||this.element.attr("id",this.options.idPrefix+"_jplayer_"+this.count),this.internal.self=i.extend({},{id:this.element.attr("id"),jq:this.element}),this.internal.audio=i.extend({},{id:this.options.idPrefix+"_audio_"+this.count,jq:h}),this.internal.video=i.extend({},{id:this.options.idPrefix+"_video_"+this.count,jq:h}),this.internal.flash=i.extend({},{id:this.options.idPrefix+"_flash_"+this.count,jq:h,swf:this.options.swfPath+(".swf"!==this.options.swfPath.toLowerCase().slice(-4)?(this.options.swfPath&&"/"!==this.options.swfPath.slice(-1)?"/":"")+"jquery.jplayer.swf":"")}),this.internal.poster=i.extend({},{id:this.options.idPrefix+"_poster_"+this.count,jq:h}),i.each(i.jPlayer.event,function(c,e){s.options[c]!==h&&(s.element.bind(e+".jPlayer",s.options[c]),s.options[c]=h)
}),this.require.audio=!1,this.require.video=!1,i.each(this.formats,function(d,c){s.require[s.format[c].media]=!0
}),this.options=this.require.video?i.extend(!0,{},this.optionsVideo,this.options):i.extend(!0,{},this.optionsAudio,this.options),this._setSize(),this.status.nativeVideoControls=this._uaBlocklist(this.options.nativeVideoControls),this.status.noFullWindow=this._uaBlocklist(this.options.noFullWindow),this.status.noVolume=this._uaBlocklist(this.options.noVolume),i.jPlayer.nativeFeatures.fullscreen.api.fullscreenEnabled&&this._fullscreenAddEventListeners(),this._restrictNativeVideoControls(),this.htmlElement.poster=document.createElement("img"),this.htmlElement.poster.id=this.internal.poster.id,this.htmlElement.poster.onload=function(){(!s.status.video||s.status.waitForPlay)&&s.internal.poster.jq.show()
},this.element.append(this.htmlElement.poster),this.internal.poster.jq=i("#"+this.internal.poster.id),this.internal.poster.jq.css({width:this.status.width,height:this.status.height}),this.internal.poster.jq.hide(),this.internal.poster.jq.bind("click.jPlayer",function(){s._trigger(i.jPlayer.event.click)
}),this.html.audio.available=!1,this.require.audio&&(this.htmlElement.audio=document.createElement("audio"),this.htmlElement.audio.id=this.internal.audio.id,this.html.audio.available=!!this.htmlElement.audio.canPlayType&&this._testCanPlayType(this.htmlElement.audio)),this.html.video.available=!1,this.require.video&&(this.htmlElement.video=document.createElement("video"),this.htmlElement.video.id=this.internal.video.id,this.html.video.available=!!this.htmlElement.video.canPlayType&&this._testCanPlayType(this.htmlElement.video)),this.flash.available=this._checkForFlash(10.1),this.html.canPlay={},this.aurora.canPlay={},this.flash.canPlay={},i.each(this.formats,function(c,e){s.html.canPlay[e]=s.html[s.format[e].media].available&&""!==s.htmlElement[s.format[e].media].canPlayType(s.format[e].codec),s.aurora.canPlay[e]=i.inArray(e,s.aurora.formats)>-1,s.flash.canPlay[e]=s.format[e].flashCanPlay&&s.flash.available
}),this.html.desired=!1,this.aurora.desired=!1,this.flash.desired=!1,i.each(this.solutions,function(c,u){if(0===c){s[u].desired=!0
}else{var t=!1,g=!1;
i.each(s.formats,function(e,d){s[s.solutions[0]].canPlay[d]&&("video"===s.format[d].media?g=!0:t=!0)
}),s[u].desired=s.require.audio&&!t||s.require.video&&!g
}}),this.html.support={},this.aurora.support={},this.flash.support={},i.each(this.formats,function(d,c){s.html.support[c]=s.html.canPlay[c]&&s.html.desired,s.aurora.support[c]=s.aurora.canPlay[c]&&s.aurora.desired,s.flash.support[c]=s.flash.canPlay[c]&&s.flash.desired
}),this.html.used=!1,this.aurora.used=!1,this.flash.used=!1,i.each(this.solutions,function(c,e){i.each(s.formats,function(f,d){return s[e].support[d]?(s[e].used=!0,!1):void 0
})
}),this._resetActive(),this._resetGate(),this._cssSelectorAncestor(this.options.cssSelectorAncestor),this.html.used||this.aurora.used||this.flash.used?this.css.jq.noSolution.length&&this.css.jq.noSolution.hide():(this._error({type:i.jPlayer.error.NO_SOLUTION,context:"{solution:'"+this.options.solution+"', supplied:'"+this.options.supplied+"'}",message:i.jPlayer.errorMsg.NO_SOLUTION,hint:i.jPlayer.errorHint.NO_SOLUTION}),this.css.jq.noSolution.length&&this.css.jq.noSolution.show()),this.flash.used){var r,q="jQuery="+encodeURI(this.options.noConflict)+"&id="+encodeURI(this.internal.self.id)+"&vol="+this.options.volume+"&muted="+this.options.muted;
if(i.jPlayer.browser.msie&&(Number(i.jPlayer.browser.version)<9||i.jPlayer.browser.documentMode<9)){var p='<object id="'+this.internal.flash.id+'" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" width="0" height="0" tabindex="-1"></object>',o=['<param name="movie" value="'+this.internal.flash.swf+'" />','<param name="FlashVars" value="'+q+'" />','<param name="allowScriptAccess" value="always" />','<param name="bgcolor" value="'+this.options.backgroundColor+'" />','<param name="wmode" value="'+this.options.wmode+'" />'];
r=document.createElement(p);
for(var b=0;
b<o.length;
b++){r.appendChild(document.createElement(o[b]))
}}else{var a=function(f,e,t){var g=document.createElement("param");
g.setAttribute("name",e),g.setAttribute("value",t),f.appendChild(g)
};
r=document.createElement("object"),r.setAttribute("id",this.internal.flash.id),r.setAttribute("name",this.internal.flash.id),r.setAttribute("data",this.internal.flash.swf),r.setAttribute("type","application/x-shockwave-flash"),r.setAttribute("width","1"),r.setAttribute("height","1"),r.setAttribute("tabindex","-1"),a(r,"flashvars",q),a(r,"allowscriptaccess","always"),a(r,"bgcolor",this.options.backgroundColor),a(r,"wmode",this.options.wmode)
}this.element.append(r),this.internal.flash.jq=i(r)
}this.status.playbackRateEnabled=this.html.used&&!this.flash.used?this._testPlaybackRate("audio"):!1,this._updatePlaybackRate(),this.html.used&&(this.html.audio.available&&(this._addHtmlEventListeners(this.htmlElement.audio,this.html.audio),this.element.append(this.htmlElement.audio),this.internal.audio.jq=i("#"+this.internal.audio.id)),this.html.video.available&&(this._addHtmlEventListeners(this.htmlElement.video,this.html.video),this.element.append(this.htmlElement.video),this.internal.video.jq=i("#"+this.internal.video.id),this.internal.video.jq.css(this.status.nativeVideoControls?{width:this.status.width,height:this.status.height}:{width:"0px",height:"0px"}),this.internal.video.jq.bind("click.jPlayer",function(){s._trigger(i.jPlayer.event.click)
}))),this.aurora.used,this.options.emulateHtml&&this._emulateHtmlBridge(),!this.html.used&&!this.aurora.used||this.flash.used||setTimeout(function(){s.internal.ready=!0,s.version.flash="n/a",s._trigger(i.jPlayer.event.repeat),s._trigger(i.jPlayer.event.ready)
},100),this._updateNativeVideoControls(),this.css.jq.videoPlay.length&&this.css.jq.videoPlay.hide(),i.jPlayer.prototype.count++
},destroy:function(){this.clearMedia(),this._removeUiClass(),this.css.jq.currentTime.length&&this.css.jq.currentTime.text(""),this.css.jq.duration.length&&this.css.jq.duration.text(""),i.each(this.css.jq,function(d,c){c.length&&c.unbind(".jPlayer")
}),this.internal.poster.jq.unbind(".jPlayer"),this.internal.video.jq&&this.internal.video.jq.unbind(".jPlayer"),this._fullscreenRemoveEventListeners(),this===i.jPlayer.focus&&(i.jPlayer.focus=null),this.options.emulateHtml&&this._destroyHtmlBridge(),this.element.removeData("jPlayer"),this.element.unbind(".jPlayer"),this.element.empty(),delete this.instances[this.internal.instance]
},destroyRemoved:function(){var a=this;
i.each(this.instances,function(b,d){a.element!==d&&(d.data("jPlayer")||(d.jPlayer("destroy"),delete a.instances[b]))
})
},enable:function(){},disable:function(){},_testCanPlayType:function(d){try{return d.canPlayType(this.format.mp3.codec),!0
}catch(c){return !1
}},_testPlaybackRate:function(f){var e,o=0.5;
f="string"==typeof f?f:"audio",e=document.createElement(f);
try{return"playbackRate" in e?(e.playbackRate=o,e.playbackRate===o):!1
}catch(g){return !1
}},_uaBlocklist:function(a){var f=navigator.userAgent.toLowerCase(),e=!1;
return i.each(a,function(d,c){return c&&c.test(f)?(e=!0,!1):void 0
}),e
},_restrictNativeVideoControls:function(){this.require.audio&&this.status.nativeVideoControls&&(this.status.nativeVideoControls=!1,this.status.noFullWindow=!0)
},_updateNativeVideoControls:function(){this.html.video.available&&this.html.used&&(this.htmlElement.video.controls=this.status.nativeVideoControls,this._updateAutohide(),this.status.nativeVideoControls&&this.require.video?(this.internal.poster.jq.hide(),this.internal.video.jq.css({width:this.status.width,height:this.status.height})):this.status.waitForPlay&&this.status.video&&(this.internal.poster.jq.show(),this.internal.video.jq.css({width:"0px",height:"0px"})))
},_addHtmlEventListeners:function(a,f){var e=this;
a.preload=this.options.preload,a.muted=this.options.muted,a.volume=this.options.volume,this.status.playbackRateEnabled&&(a.defaultPlaybackRate=this.options.defaultPlaybackRate,a.playbackRate=this.options.playbackRate),a.addEventListener("progress",function(){f.gate&&(e.internal.cmdsIgnored&&this.readyState>0&&(e.internal.cmdsIgnored=!1),e._getHtmlStatus(a),e._updateInterface(),e._trigger(i.jPlayer.event.progress))
},!1),a.addEventListener("loadeddata",function(){f.gate&&(e.androidFix.setMedia=!1,e.androidFix.play&&(e.androidFix.play=!1,e.play(e.androidFix.time)),e.androidFix.pause&&(e.androidFix.pause=!1,e.pause(e.androidFix.time)),e._trigger(i.jPlayer.event.loadeddata))
},!1),a.addEventListener("timeupdate",function(){f.gate&&(e._getHtmlStatus(a),e._updateInterface(),e._trigger(i.jPlayer.event.timeupdate))
},!1),a.addEventListener("durationchange",function(){f.gate&&(e._getHtmlStatus(a),e._updateInterface(),e._trigger(i.jPlayer.event.durationchange))
},!1),a.addEventListener("play",function(){f.gate&&(e._updateButtons(!0),e._html_checkWaitForPlay(),e._trigger(i.jPlayer.event.play))
},!1),a.addEventListener("playing",function(){f.gate&&(e._updateButtons(!0),e._seeked(),e._trigger(i.jPlayer.event.playing))
},!1),a.addEventListener("pause",function(){f.gate&&(e._updateButtons(!1),e._trigger(i.jPlayer.event.pause))
},!1),a.addEventListener("waiting",function(){f.gate&&(e._seeking(),e._trigger(i.jPlayer.event.waiting))
},!1),a.addEventListener("seeking",function(){f.gate&&(e._seeking(),e._trigger(i.jPlayer.event.seeking))
},!1),a.addEventListener("seeked",function(){f.gate&&(e._seeked(),e._trigger(i.jPlayer.event.seeked))
},!1),a.addEventListener("volumechange",function(){f.gate&&(e.options.volume=a.volume,e.options.muted=a.muted,e._updateMute(),e._updateVolume(),e._trigger(i.jPlayer.event.volumechange))
},!1),a.addEventListener("ratechange",function(){f.gate&&(e.options.defaultPlaybackRate=a.defaultPlaybackRate,e.options.playbackRate=a.playbackRate,e._updatePlaybackRate(),e._trigger(i.jPlayer.event.ratechange))
},!1),a.addEventListener("suspend",function(){f.gate&&(e._seeked(),e._trigger(i.jPlayer.event.suspend))
},!1),a.addEventListener("ended",function(){f.gate&&(i.jPlayer.browser.webkit||(e.htmlElement.media.currentTime=0),e.htmlElement.media.pause(),e._updateButtons(!1),e._getHtmlStatus(a,!0),e._updateInterface(),e._trigger(i.jPlayer.event.ended))
},!1),a.addEventListener("error",function(){f.gate&&(e._updateButtons(!1),e._seeked(),e.status.srcSet&&(clearTimeout(e.internal.htmlDlyCmdId),e.status.waitForLoad=!0,e.status.waitForPlay=!0,e.status.video&&!e.status.nativeVideoControls&&e.internal.video.jq.css({width:"0px",height:"0px"}),e._validString(e.status.media.poster)&&!e.status.nativeVideoControls&&e.internal.poster.jq.show(),e.css.jq.videoPlay.length&&e.css.jq.videoPlay.show(),e._error({type:i.jPlayer.error.URL,context:e.status.src,message:i.jPlayer.errorMsg.URL,hint:i.jPlayer.errorHint.URL})))
},!1),i.each(i.jPlayer.htmlEvent,function(c,b){a.addEventListener(this,function(){f.gate&&e._trigger(i.jPlayer.event[b])
},!1)
})
},_addAuroraEventListeners:function(a,f){var e=this;
a.volume=100*this.options.volume,a.on("progress",function(){f.gate&&(e.internal.cmdsIgnored&&this.readyState>0&&(e.internal.cmdsIgnored=!1),e._getAuroraStatus(a),e._updateInterface(),e._trigger(i.jPlayer.event.progress),a.duration>0&&e._trigger(i.jPlayer.event.timeupdate))
},!1),a.on("ready",function(){f.gate&&e._trigger(i.jPlayer.event.loadeddata)
},!1),a.on("duration",function(){f.gate&&(e._getAuroraStatus(a),e._updateInterface(),e._trigger(i.jPlayer.event.durationchange))
},!1),a.on("end",function(){f.gate&&(e._updateButtons(!1),e._getAuroraStatus(a,!0),e._updateInterface(),e._trigger(i.jPlayer.event.ended))
},!1),a.on("error",function(){f.gate&&(e._updateButtons(!1),e._seeked(),e.status.srcSet&&(e.status.waitForLoad=!0,e.status.waitForPlay=!0,e.status.video&&!e.status.nativeVideoControls&&e.internal.video.jq.css({width:"0px",height:"0px"}),e._validString(e.status.media.poster)&&!e.status.nativeVideoControls&&e.internal.poster.jq.show(),e.css.jq.videoPlay.length&&e.css.jq.videoPlay.show(),e._error({type:i.jPlayer.error.URL,context:e.status.src,message:i.jPlayer.errorMsg.URL,hint:i.jPlayer.errorHint.URL})))
},!1)
},_getHtmlStatus:function(o,g){var s=0,r=0,q=0,p=0;
isFinite(o.duration)&&(this.status.duration=o.duration),s=o.currentTime,r=this.status.duration>0?100*s/this.status.duration:0,"object"==typeof o.seekable&&o.seekable.length>0?(q=this.status.duration>0?100*o.seekable.end(o.seekable.length-1)/this.status.duration:100,p=this.status.duration>0?100*o.currentTime/o.seekable.end(o.seekable.length-1):0):(q=100,p=r),g&&(s=0,p=0,r=0),this.status.seekPercent=q,this.status.currentPercentRelative=p,this.status.currentPercentAbsolute=r,this.status.currentTime=s,this.status.remaining=this.status.duration-this.status.currentTime,this.status.videoWidth=o.videoWidth,this.status.videoHeight=o.videoHeight,this.status.readyState=o.readyState,this.status.networkState=o.networkState,this.status.playbackRate=o.playbackRate,this.status.ended=o.ended
},_getAuroraStatus:function(o,g){var s=0,r=0,q=0,p=0;
this.status.duration=o.duration/1000,s=o.currentTime/1000,r=this.status.duration>0?100*s/this.status.duration:0,o.buffered>0?(q=this.status.duration>0?o.buffered*this.status.duration/this.status.duration:100,p=this.status.duration>0?s/(o.buffered*this.status.duration):0):(q=100,p=r),g&&(s=0,p=0,r=0),this.status.seekPercent=q,this.status.currentPercentRelative=p,this.status.currentPercentAbsolute=r,this.status.currentTime=s,this.status.remaining=this.status.duration-this.status.currentTime,this.status.readyState=4,this.status.networkState=0,this.status.playbackRate=1,this.status.ended=!1
},_resetStatus:function(){this.status=i.extend({},this.status,i.jPlayer.prototype.status)
},_trigger:function(a,o,g){var f=i.Event(a);
f.jPlayer={},f.jPlayer.version=i.extend({},this.version),f.jPlayer.options=i.extend(!0,{},this.options),f.jPlayer.status=i.extend(!0,{},this.status),f.jPlayer.html=i.extend(!0,{},this.html),f.jPlayer.aurora=i.extend(!0,{},this.aurora),f.jPlayer.flash=i.extend(!0,{},this.flash),o&&(f.jPlayer.error=i.extend({},o)),g&&(f.jPlayer.warning=i.extend({},g)),this.element.trigger(f)
},jPlayerFlashEvent:function(a,o){if(a===i.jPlayer.event.ready){if(this.internal.ready){if(this.flash.gate){if(this.status.srcSet){var g=this.status.currentTime,f=this.status.paused;
this.setMedia(this.status.media),this.volumeWorker(this.options.volume),g>0&&(f?this.pause(g):this.play(g))
}this._trigger(i.jPlayer.event.flashreset)
}}else{this.internal.ready=!0,this.internal.flash.jq.css({width:"0px",height:"0px"}),this.version.flash=o.version,this.version.needFlash!==this.version.flash&&this._error({type:i.jPlayer.error.VERSION,context:this.version.flash,message:i.jPlayer.errorMsg.VERSION+this.version.flash,hint:i.jPlayer.errorHint.VERSION}),this._trigger(i.jPlayer.event.repeat),this._trigger(a)
}}if(this.flash.gate){switch(a){case i.jPlayer.event.progress:this._getFlashStatus(o),this._updateInterface(),this._trigger(a);
break;
case i.jPlayer.event.timeupdate:this._getFlashStatus(o),this._updateInterface(),this._trigger(a);
break;
case i.jPlayer.event.play:this._seeked(),this._updateButtons(!0),this._trigger(a);
break;
case i.jPlayer.event.pause:this._updateButtons(!1),this._trigger(a);
break;
case i.jPlayer.event.ended:this._updateButtons(!1),this._trigger(a);
break;
case i.jPlayer.event.click:this._trigger(a);
break;
case i.jPlayer.event.error:this.status.waitForLoad=!0,this.status.waitForPlay=!0,this.status.video&&this.internal.flash.jq.css({width:"0px",height:"0px"}),this._validString(this.status.media.poster)&&this.internal.poster.jq.show(),this.css.jq.videoPlay.length&&this.status.video&&this.css.jq.videoPlay.show(),this.status.video?this._flash_setVideo(this.status.media):this._flash_setAudio(this.status.media),this._updateButtons(!1),this._error({type:i.jPlayer.error.URL,context:o.src,message:i.jPlayer.errorMsg.URL,hint:i.jPlayer.errorHint.URL});
break;
case i.jPlayer.event.seeking:this._seeking(),this._trigger(a);
break;
case i.jPlayer.event.seeked:this._seeked(),this._trigger(a);
break;
case i.jPlayer.event.ready:break;
default:this._trigger(a)
}}return !1
},_getFlashStatus:function(b){this.status.seekPercent=b.seekPercent,this.status.currentPercentRelative=b.currentPercentRelative,this.status.currentPercentAbsolute=b.currentPercentAbsolute,this.status.currentTime=b.currentTime,this.status.duration=b.duration,this.status.remaining=b.duration-b.currentTime,this.status.videoWidth=b.videoWidth,this.status.videoHeight=b.videoHeight,this.status.readyState=4,this.status.networkState=0,this.status.playbackRate=1,this.status.ended=!1
},_updateButtons:function(b){b===h?b=!this.status.paused:this.status.paused=!b,b?this.addStateClass("playing"):this.removeStateClass("playing"),!this.status.noFullWindow&&this.options.fullWindow?this.addStateClass("fullScreen"):this.removeStateClass("fullScreen"),this.options.loop?this.addStateClass("looped"):this.removeStateClass("looped"),this.css.jq.play.length&&this.css.jq.pause.length&&(b?(this.css.jq.play.hide(),this.css.jq.pause.show()):(this.css.jq.play.show(),this.css.jq.pause.hide())),this.css.jq.restoreScreen.length&&this.css.jq.fullScreen.length&&(this.status.noFullWindow?(this.css.jq.fullScreen.hide(),this.css.jq.restoreScreen.hide()):this.options.fullWindow?(this.css.jq.fullScreen.hide(),this.css.jq.restoreScreen.show()):(this.css.jq.fullScreen.show(),this.css.jq.restoreScreen.hide())),this.css.jq.repeat.length&&this.css.jq.repeatOff.length&&(this.options.loop?(this.css.jq.repeat.hide(),this.css.jq.repeatOff.show()):(this.css.jq.repeat.show(),this.css.jq.repeatOff.hide()))
},_updateInterface:function(){this.css.jq.seekBar.length&&this.css.jq.seekBar.width(this.status.seekPercent+"%"),this.css.jq.playBar.length&&(this.options.smoothPlayBar?this.css.jq.playBar.stop().animate({width:this.status.currentPercentAbsolute+"%"},250,"linear"):this.css.jq.playBar.width(this.status.currentPercentRelative+"%"));
var f="";
this.css.jq.currentTime.length&&(f=this._convertTime(this.status.currentTime),f!==this.css.jq.currentTime.text()&&this.css.jq.currentTime.text(this._convertTime(this.status.currentTime)));
var e="",o=this.status.duration,g=this.status.remaining;
this.css.jq.duration.length&&("string"==typeof this.status.media.duration?e=this.status.media.duration:("number"==typeof this.status.media.duration&&(o=this.status.media.duration,g=o-this.status.currentTime),e=this.options.remainingDuration?(g>0?"-":"")+this._convertTime(g):this._convertTime(o)),e!==this.css.jq.duration.text()&&this.css.jq.duration.text(e))
},_convertTime:n.prototype.time,_seeking:function(){this.css.jq.seekBar.length&&this.css.jq.seekBar.addClass("jp-seeking-bg"),this.addStateClass("seeking")
},_seeked:function(){this.css.jq.seekBar.length&&this.css.jq.seekBar.removeClass("jp-seeking-bg"),this.removeStateClass("seeking")
},_resetGate:function(){this.html.audio.gate=!1,this.html.video.gate=!1,this.aurora.gate=!1,this.flash.gate=!1
},_resetActive:function(){this.html.active=!1,this.aurora.active=!1,this.flash.active=!1
},_escapeHtml:function(b){return b.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;").split('"').join("&quot;")
},_qualifyURL:function(d){var c=document.createElement("div");
return c.innerHTML='<a href="'+this._escapeHtml(d)+'">x</a>',c.firstChild.href
},_absoluteMediaUrls:function(a){var d=this;
return i.each(a,function(b,c){c&&d.format[b]&&"data:"!==c.substr(0,5)&&(a[b]=d._qualifyURL(c))
}),a
},addStateClass:function(b){this.ancestorJq.length&&this.ancestorJq.addClass(this.options.stateClass[b])
},removeStateClass:function(b){this.ancestorJq.length&&this.ancestorJq.removeClass(this.options.stateClass[b])
},setMedia:function(a){var o=this,g=!1,f=this.status.media.poster!==a.poster;
this._resetMedia(),this._resetGate(),this._resetActive(),this.androidFix.setMedia=!1,this.androidFix.play=!1,this.androidFix.pause=!1,a=this._absoluteMediaUrls(a),i.each(this.formats,function(d,c){var b="video"===o.format[c].media;
return i.each(o.solutions,function(s,r){if(o[r].support[c]&&o._validString(a[c])){var q="html"===r,p="aurora"===r;
return b?(q?(o.html.video.gate=!0,o._html_setVideo(a),o.html.active=!0):(o.flash.gate=!0,o._flash_setVideo(a),o.flash.active=!0),o.css.jq.videoPlay.length&&o.css.jq.videoPlay.show(),o.status.video=!0):(q?(o.html.audio.gate=!0,o._html_setAudio(a),o.html.active=!0,i.jPlayer.platform.android&&(o.androidFix.setMedia=!0)):p?(o.aurora.gate=!0,o._aurora_setAudio(a),o.aurora.active=!0):(o.flash.gate=!0,o._flash_setAudio(a),o.flash.active=!0),o.css.jq.videoPlay.length&&o.css.jq.videoPlay.hide(),o.status.video=!1),g=!0,!1
}}),g?!1:void 0
}),g?(this.status.nativeVideoControls&&this.html.video.gate||this._validString(a.poster)&&(f?this.htmlElement.poster.src=a.poster:this.internal.poster.jq.show()),"string"==typeof a.title&&(this.css.jq.title.length&&this.css.jq.title.html(a.title),this.htmlElement.audio&&this.htmlElement.audio.setAttribute("title",a.title),this.htmlElement.video&&this.htmlElement.video.setAttribute("title",a.title)),this.status.srcSet=!0,this.status.media=i.extend({},a),this._updateButtons(!1),this._updateInterface(),this._trigger(i.jPlayer.event.setmedia)):this._error({type:i.jPlayer.error.NO_SUPPORT,context:"{supplied:'"+this.options.supplied+"'}",message:i.jPlayer.errorMsg.NO_SUPPORT,hint:i.jPlayer.errorHint.NO_SUPPORT})
},_resetMedia:function(){this._resetStatus(),this._updateButtons(!1),this._updateInterface(),this._seeked(),this.internal.poster.jq.hide(),clearTimeout(this.internal.htmlDlyCmdId),this.html.active?this._html_resetMedia():this.aurora.active?this._aurora_resetMedia():this.flash.active&&this._flash_resetMedia()
},clearMedia:function(){this._resetMedia(),this.html.active?this._html_clearMedia():this.aurora.active?this._aurora_clearMedia():this.flash.active&&this._flash_clearMedia(),this._resetGate(),this._resetActive()
},load:function(){this.status.srcSet?this.html.active?this._html_load():this.aurora.active?this._aurora_load():this.flash.active&&this._flash_load():this._urlNotSetError("load")
},focus:function(){this.options.keyEnabled&&(i.jPlayer.focus=this)
},play:function(d){var c="object"==typeof d;
c&&this.options.useStateClassSkin&&!this.status.paused?this.pause(d):(d="number"==typeof d?d:0/0,this.status.srcSet?(this.focus(),this.html.active?this._html_play(d):this.aurora.active?this._aurora_play(d):this.flash.active&&this._flash_play(d)):this._urlNotSetError("play"))
},videoPlay:function(){this.play()
},pause:function(b){b="number"==typeof b?b:0/0,this.status.srcSet?this.html.active?this._html_pause(b):this.aurora.active?this._aurora_pause(b):this.flash.active&&this._flash_pause(b):this._urlNotSetError("pause")
},tellOthers:function(a,q){var p=this,o="function"==typeof q,g=Array.prototype.slice.call(arguments);
"string"==typeof a&&(o&&g.splice(1,1),i.jPlayer.prototype.destroyRemoved(),i.each(this.instances,function(){p.element!==this&&(!o||q.call(this.data("jPlayer"),p))&&this.jPlayer.apply(this,g)
}))
},pauseOthers:function(b){this.tellOthers("pause",function(){return this.status.srcSet
},b)
},stop:function(){this.status.srcSet?this.html.active?this._html_pause(0):this.aurora.active?this._aurora_pause(0):this.flash.active&&this._flash_pause(0):this._urlNotSetError("stop")
},playHead:function(b){b=this._limitValue(b,0,100),this.status.srcSet?this.html.active?this._html_playHead(b):this.aurora.active?this._aurora_playHead(b):this.flash.active&&this._flash_playHead(b):this._urlNotSetError("playHead")
},_muted:function(b){this.mutedWorker(b),this.options.globalVolume&&this.tellOthers("mutedWorker",function(){return this.options.globalVolume
},b)
},mutedWorker:function(a){this.options.muted=a,this.html.used&&this._html_setProperty("muted",a),this.aurora.used&&this._aurora_mute(a),this.flash.used&&this._flash_mute(a),this.html.video.gate||this.html.audio.gate||(this._updateMute(a),this._updateVolume(this.options.volume),this._trigger(i.jPlayer.event.volumechange))
},mute:function(b){var d="object"==typeof b;
d&&this.options.useStateClassSkin&&this.options.muted?this._muted(!1):(b=b===h?!0:!!b,this._muted(b))
},unmute:function(b){b=b===h?!0:!!b,this._muted(!b)
},_updateMute:function(b){b===h&&(b=this.options.muted),b?this.addStateClass("muted"):this.removeStateClass("muted"),this.css.jq.mute.length&&this.css.jq.unmute.length&&(this.status.noVolume?(this.css.jq.mute.hide(),this.css.jq.unmute.hide()):b?(this.css.jq.mute.hide(),this.css.jq.unmute.show()):(this.css.jq.mute.show(),this.css.jq.unmute.hide()))
},volume:function(b){this.volumeWorker(b),this.options.globalVolume&&this.tellOthers("volumeWorker",function(){return this.options.globalVolume
},b)
},volumeWorker:function(a){a=this._limitValue(a,0,1),this.options.volume=a,this.html.used&&this._html_setProperty("volume",a),this.aurora.used&&this._aurora_volume(a),this.flash.used&&this._flash_volume(a),this.html.video.gate||this.html.audio.gate||(this._updateVolume(a),this._trigger(i.jPlayer.event.volumechange))
},volumeBar:function(a){if(this.css.jq.volumeBar.length){var t=i(a.currentTarget),s=t.offset(),r=a.pageX-s.left,q=t.width(),p=t.height()-a.pageY+s.top,o=t.height();
this.volume(this.options.verticalVolume?p/o:r/q)
}this.options.muted&&this._muted(!1)
},_updateVolume:function(b){b===h&&(b=this.options.volume),b=this.options.muted?0:b,this.status.noVolume?(this.addStateClass("noVolume"),this.css.jq.volumeBar.length&&this.css.jq.volumeBar.hide(),this.css.jq.volumeBarValue.length&&this.css.jq.volumeBarValue.hide(),this.css.jq.volumeMax.length&&this.css.jq.volumeMax.hide()):(this.removeStateClass("noVolume"),this.css.jq.volumeBar.length&&this.css.jq.volumeBar.show(),this.css.jq.volumeBarValue.length&&(this.css.jq.volumeBarValue.show(),this.css.jq.volumeBarValue[this.options.verticalVolume?"height":"width"](100*b+"%")),this.css.jq.volumeMax.length&&this.css.jq.volumeMax.show())
},volumeMax:function(){this.volume(1),this.options.muted&&this._muted(!1)
},_cssSelectorAncestor:function(a){var d=this;
this.options.cssSelectorAncestor=a,this._removeUiClass(),this.ancestorJq=a?i(a):[],a&&1!==this.ancestorJq.length&&this._warning({type:i.jPlayer.warning.CSS_SELECTOR_COUNT,context:a,message:i.jPlayer.warningMsg.CSS_SELECTOR_COUNT+this.ancestorJq.length+" found for cssSelectorAncestor.",hint:i.jPlayer.warningHint.CSS_SELECTOR_COUNT}),this._addUiClass(),i.each(this.options.cssSelector,function(e,c){d._cssSelector(e,c)
}),this._updateInterface(),this._updateButtons(),this._updateAutohide(),this._updateVolume(),this._updateMute()
},_cssSelector:function(a,o){var g=this;
if("string"==typeof o){if(i.jPlayer.prototype.options.cssSelector[a]){if(this.css.jq[a]&&this.css.jq[a].length&&this.css.jq[a].unbind(".jPlayer"),this.options.cssSelector[a]=o,this.css.cs[a]=this.options.cssSelectorAncestor+" "+o,this.css.jq[a]=o?i(this.css.cs[a]):[],this.css.jq[a].length&&this[a]){var f=function(b){b.preventDefault(),g[a](b),g.options.autoBlur?i(this).blur():i(this).focus()
};
this.css.jq[a].bind("click.jPlayer",f)
}o&&1!==this.css.jq[a].length&&this._warning({type:i.jPlayer.warning.CSS_SELECTOR_COUNT,context:this.css.cs[a],message:i.jPlayer.warningMsg.CSS_SELECTOR_COUNT+this.css.jq[a].length+" found for "+a+" method.",hint:i.jPlayer.warningHint.CSS_SELECTOR_COUNT})
}else{this._warning({type:i.jPlayer.warning.CSS_SELECTOR_METHOD,context:a,message:i.jPlayer.warningMsg.CSS_SELECTOR_METHOD,hint:i.jPlayer.warningHint.CSS_SELECTOR_METHOD})
}}else{this._warning({type:i.jPlayer.warning.CSS_SELECTOR_STRING,context:o,message:i.jPlayer.warningMsg.CSS_SELECTOR_STRING,hint:i.jPlayer.warningHint.CSS_SELECTOR_STRING})
}},duration:function(b){this.options.toggleDuration&&(this.options.captureDuration&&b.stopPropagation(),this._setOption("remainingDuration",!this.options.remainingDuration))
},seekBar:function(a){if(this.css.jq.seekBar.length){var s=i(a.currentTarget),r=s.offset(),q=a.pageX-r.left,p=s.width(),o=100*q/p;
this.playHead(o)
}},playbackRate:function(b){this._setOption("playbackRate",b)
},playbackRateBar:function(v){if(this.css.jq.playbackRateBar.length){var u,t,s=i(v.currentTarget),r=s.offset(),q=v.pageX-r.left,p=s.width(),o=s.height()-v.pageY+r.top,a=s.height();
u=this.options.verticalPlaybackRate?o/a:q/p,t=u*(this.options.maxPlaybackRate-this.options.minPlaybackRate)+this.options.minPlaybackRate,this.playbackRate(t)
}},_updatePlaybackRate:function(){var d=this.options.playbackRate,c=(d-this.options.minPlaybackRate)/(this.options.maxPlaybackRate-this.options.minPlaybackRate);
this.status.playbackRateEnabled?(this.css.jq.playbackRateBar.length&&this.css.jq.playbackRateBar.show(),this.css.jq.playbackRateBarValue.length&&(this.css.jq.playbackRateBarValue.show(),this.css.jq.playbackRateBarValue[this.options.verticalPlaybackRate?"height":"width"](100*c+"%"))):(this.css.jq.playbackRateBar.length&&this.css.jq.playbackRateBar.hide(),this.css.jq.playbackRateBarValue.length&&this.css.jq.playbackRateBarValue.hide())
},repeat:function(d){var c="object"==typeof d;
this._loop(c&&this.options.useStateClassSkin&&this.options.loop?!1:!0)
},repeatOff:function(){this._loop(!1)
},_loop:function(a){this.options.loop!==a&&(this.options.loop=a,this._updateButtons(),this._trigger(i.jPlayer.event.repeat))
},option:function(t,s){var r=t;
if(0===arguments.length){return i.extend(!0,{},this.options)
}if("string"==typeof t){var q=t.split(".");
if(s===h){for(var p=i.extend(!0,{},this.options),o=0;
o<q.length;
o++){if(p[q[o]]===h){return this._warning({type:i.jPlayer.warning.OPTION_KEY,context:t,message:i.jPlayer.warningMsg.OPTION_KEY,hint:i.jPlayer.warningHint.OPTION_KEY}),h
}p=p[q[o]]
}return p
}r={};
for(var b=r,a=0;
a<q.length;
a++){a<q.length-1?(b[q[a]]={},b=b[q[a]]):b[q[a]]=s
}}return this._setOptions(r),this
},_setOptions:function(a){var d=this;
return i.each(a,function(e,c){d._setOption(e,c)
}),this
},_setOption:function(a,o){var g=this;
switch(a){case"volume":this.volume(o);
break;
case"muted":this._muted(o);
break;
case"globalVolume":this.options[a]=o;
break;
case"cssSelectorAncestor":this._cssSelectorAncestor(o);
break;
case"cssSelector":i.each(o,function(d,c){g._cssSelector(d,c)
});
break;
case"playbackRate":this.options[a]=o=this._limitValue(o,this.options.minPlaybackRate,this.options.maxPlaybackRate),this.html.used&&this._html_setProperty("playbackRate",o),this._updatePlaybackRate();
break;
case"defaultPlaybackRate":this.options[a]=o=this._limitValue(o,this.options.minPlaybackRate,this.options.maxPlaybackRate),this.html.used&&this._html_setProperty("defaultPlaybackRate",o),this._updatePlaybackRate();
break;
case"minPlaybackRate":this.options[a]=o=this._limitValue(o,0.1,this.options.maxPlaybackRate-0.1),this._updatePlaybackRate();
break;
case"maxPlaybackRate":this.options[a]=o=this._limitValue(o,this.options.minPlaybackRate+0.1,16),this._updatePlaybackRate();
break;
case"fullScreen":if(this.options[a]!==o){var f=i.jPlayer.nativeFeatures.fullscreen.used.webkitVideo;
(!f||f&&!this.status.waitForPlay)&&(f||(this.options[a]=o),o?this._requestFullscreen():this._exitFullscreen(),f||this._setOption("fullWindow",o))
}break;
case"fullWindow":this.options[a]!==o&&(this._removeUiClass(),this.options[a]=o,this._refreshSize());
break;
case"size":this.options.fullWindow||this.options[a].cssClass===o.cssClass||this._removeUiClass(),this.options[a]=i.extend({},this.options[a],o),this._refreshSize();
break;
case"sizeFull":this.options.fullWindow&&this.options[a].cssClass!==o.cssClass&&this._removeUiClass(),this.options[a]=i.extend({},this.options[a],o),this._refreshSize();
break;
case"autohide":this.options[a]=i.extend({},this.options[a],o),this._updateAutohide();
break;
case"loop":this._loop(o);
break;
case"remainingDuration":this.options[a]=o,this._updateInterface();
break;
case"toggleDuration":this.options[a]=o;
break;
case"nativeVideoControls":this.options[a]=i.extend({},this.options[a],o),this.status.nativeVideoControls=this._uaBlocklist(this.options.nativeVideoControls),this._restrictNativeVideoControls(),this._updateNativeVideoControls();
break;
case"noFullWindow":this.options[a]=i.extend({},this.options[a],o),this.status.nativeVideoControls=this._uaBlocklist(this.options.nativeVideoControls),this.status.noFullWindow=this._uaBlocklist(this.options.noFullWindow),this._restrictNativeVideoControls(),this._updateButtons();
break;
case"noVolume":this.options[a]=i.extend({},this.options[a],o),this.status.noVolume=this._uaBlocklist(this.options.noVolume),this._updateVolume(),this._updateMute();
break;
case"emulateHtml":this.options[a]!==o&&(this.options[a]=o,o?this._emulateHtmlBridge():this._destroyHtmlBridge());
break;
case"timeFormat":this.options[a]=i.extend({},this.options[a],o);
break;
case"keyEnabled":this.options[a]=o,o||this!==i.jPlayer.focus||(i.jPlayer.focus=null);
break;
case"keyBindings":this.options[a]=i.extend(!0,{},this.options[a],o);
break;
case"audioFullScreen":this.options[a]=o;
break;
case"autoBlur":this.options[a]=o
}return this
},_refreshSize:function(){this._setSize(),this._addUiClass(),this._updateSize(),this._updateButtons(),this._updateAutohide(),this._trigger(i.jPlayer.event.resize)
},_setSize:function(){this.options.fullWindow?(this.status.width=this.options.sizeFull.width,this.status.height=this.options.sizeFull.height,this.status.cssClass=this.options.sizeFull.cssClass):(this.status.width=this.options.size.width,this.status.height=this.options.size.height,this.status.cssClass=this.options.size.cssClass),this.element.css({width:this.status.width,height:this.status.height})
},_addUiClass:function(){this.ancestorJq.length&&this.ancestorJq.addClass(this.status.cssClass)
},_removeUiClass:function(){this.ancestorJq.length&&this.ancestorJq.removeClass(this.status.cssClass)
},_updateSize:function(){this.internal.poster.jq.css({width:this.status.width,height:this.status.height}),!this.status.waitForPlay&&this.html.active&&this.status.video||this.html.video.available&&this.html.used&&this.status.nativeVideoControls?this.internal.video.jq.css({width:this.status.width,height:this.status.height}):!this.status.waitForPlay&&this.flash.active&&this.status.video&&this.internal.flash.jq.css({width:this.status.width,height:this.status.height})
},_updateAutohide:function(){var g=this,f="mousemove.jPlayer",q=".jPlayerAutohide",p=f+q,o=function(a){var t,s,r=!1;
"undefined"!=typeof g.internal.mouse?(t=g.internal.mouse.x-a.pageX,s=g.internal.mouse.y-a.pageY,r=Math.floor(t)>0||Math.floor(s)>0):r=!0,g.internal.mouse={x:a.pageX,y:a.pageY},r&&g.css.jq.gui.fadeIn(g.options.autohide.fadeIn,function(){clearTimeout(g.internal.autohideId),g.internal.autohideId=setTimeout(function(){g.css.jq.gui.fadeOut(g.options.autohide.fadeOut)
},g.options.autohide.hold)
})
};
this.css.jq.gui.length&&(this.css.jq.gui.stop(!0,!0),clearTimeout(this.internal.autohideId),delete this.internal.mouse,this.element.unbind(q),this.css.jq.gui.unbind(q),this.status.nativeVideoControls?this.css.jq.gui.hide():this.options.fullWindow&&this.options.autohide.full||!this.options.fullWindow&&this.options.autohide.restored?(this.element.bind(p,o),this.css.jq.gui.bind(p,o),this.css.jq.gui.hide()):this.css.jq.gui.show())
},fullScreen:function(d){var c="object"==typeof d;
c&&this.options.useStateClassSkin&&this.options.fullScreen?this._setOption("fullScreen",!1):this._setOption("fullScreen",!0)
},restoreScreen:function(){this._setOption("fullScreen",!1)
},_fullscreenAddEventListeners:function(){var a=this,d=i.jPlayer.nativeFeatures.fullscreen;
d.api.fullscreenEnabled&&d.event.fullscreenchange&&("function"!=typeof this.internal.fullscreenchangeHandler&&(this.internal.fullscreenchangeHandler=function(){a._fullscreenchange()
}),document.addEventListener(d.event.fullscreenchange,this.internal.fullscreenchangeHandler,!1))
},_fullscreenRemoveEventListeners:function(){var a=i.jPlayer.nativeFeatures.fullscreen;
this.internal.fullscreenchangeHandler&&document.removeEventListener(a.event.fullscreenchange,this.internal.fullscreenchangeHandler,!1)
},_fullscreenchange:function(){this.options.fullScreen&&!i.jPlayer.nativeFeatures.fullscreen.api.fullscreenElement()&&this._setOption("fullScreen",!1)
},_requestFullscreen:function(){var a=this.ancestorJq.length?this.ancestorJq[0]:this.element[0],d=i.jPlayer.nativeFeatures.fullscreen;
d.used.webkitVideo&&(a=this.htmlElement.video),d.api.fullscreenEnabled&&d.api.requestFullscreen(a)
},_exitFullscreen:function(){var a,d=i.jPlayer.nativeFeatures.fullscreen;
d.used.webkitVideo&&(a=this.htmlElement.video),d.api.fullscreenEnabled&&d.api.exitFullscreen(a)
},_html_initMedia:function(a){var d=i(this.htmlElement.media).empty();
i.each(a.track||[],function(e,c){var f=document.createElement("track");
f.setAttribute("kind",c.kind?c.kind:""),f.setAttribute("src",c.src?c.src:""),f.setAttribute("srclang",c.srclang?c.srclang:""),f.setAttribute("label",c.label?c.label:""),c.def&&f.setAttribute("default",c.def),d.append(f)
}),this.htmlElement.media.src=this.status.src,"none"!==this.options.preload&&this._html_load(),this._trigger(i.jPlayer.event.timeupdate)
},_html_setFormat:function(a){var d=this;
i.each(this.formats,function(b,c){return d.html.support[c]&&a[c]?(d.status.src=a[c],d.status.format[c]=!0,d.status.formatType=c,!1):void 0
})
},_html_setAudio:function(b){this._html_setFormat(b),this.htmlElement.media=this.htmlElement.audio,this._html_initMedia(b)
},_html_setVideo:function(b){this._html_setFormat(b),this.status.nativeVideoControls&&(this.htmlElement.video.poster=this._validString(b.poster)?b.poster:""),this.htmlElement.media=this.htmlElement.video,this._html_initMedia(b)
},_html_resetMedia:function(){this.htmlElement.media&&(this.htmlElement.media.id!==this.internal.video.id||this.status.nativeVideoControls||this.internal.video.jq.css({width:"0px",height:"0px"}),this.htmlElement.media.pause())
},_html_clearMedia:function(){this.htmlElement.media&&(this.htmlElement.media.src="about:blank",this.htmlElement.media.load())
},_html_load:function(){this.status.waitForLoad&&(this.status.waitForLoad=!1,this.htmlElement.media.load()),clearTimeout(this.internal.htmlDlyCmdId)
},_html_play:function(f){var e=this,o=this.htmlElement.media;
if(this.androidFix.pause=!1,this._html_load(),this.androidFix.setMedia){this.androidFix.play=!0,this.androidFix.time=f
}else{if(isNaN(f)){o.play()
}else{this.internal.cmdsIgnored&&o.play();
try{if(o.seekable&&!("object"==typeof o.seekable&&o.seekable.length>0)){throw 1
}o.currentTime=f,o.play()
}catch(g){return void (this.internal.htmlDlyCmdId=setTimeout(function(){e.play(f)
},250))
}}}this._html_checkWaitForPlay()
},_html_pause:function(f){var e=this,o=this.htmlElement.media;
if(this.androidFix.play=!1,f>0?this._html_load():clearTimeout(this.internal.htmlDlyCmdId),o.pause(),this.androidFix.setMedia){this.androidFix.pause=!0,this.androidFix.time=f
}else{if(!isNaN(f)){try{if(o.seekable&&!("object"==typeof o.seekable&&o.seekable.length>0)){throw 1
}o.currentTime=f
}catch(g){return void (this.internal.htmlDlyCmdId=setTimeout(function(){e.pause(f)
},250))
}}}f>0&&this._html_checkWaitForPlay()
},_html_playHead:function(f){var e=this,o=this.htmlElement.media;
this._html_load();
try{if("object"==typeof o.seekable&&o.seekable.length>0){o.currentTime=f*o.seekable.end(o.seekable.length-1)/100
}else{if(!(o.duration>0)||isNaN(o.duration)){throw"e"
}o.currentTime=f*o.duration/100
}}catch(g){return void (this.internal.htmlDlyCmdId=setTimeout(function(){e.playHead(f)
},250))
}this.status.waitForLoad||this._html_checkWaitForPlay()
},_html_checkWaitForPlay:function(){this.status.waitForPlay&&(this.status.waitForPlay=!1,this.css.jq.videoPlay.length&&this.css.jq.videoPlay.hide(),this.status.video&&(this.internal.poster.jq.hide(),this.internal.video.jq.css({width:this.status.width,height:this.status.height})))
},_html_setProperty:function(d,c){this.html.audio.available&&(this.htmlElement.audio[d]=c),this.html.video.available&&(this.htmlElement.video[d]=c)
},_aurora_setAudio:function(a){var d=this;
i.each(this.formats,function(b,c){return d.aurora.support[c]&&a[c]?(d.status.src=a[c],d.status.format[c]=!0,d.status.formatType=c,!1):void 0
}),this.aurora.player=new AV.Player.fromURL(this.status.src),this._addAuroraEventListeners(this.aurora.player,this.aurora),"auto"===this.options.preload&&(this._aurora_load(),this.status.waitForLoad=!1)
},_aurora_resetMedia:function(){this.aurora.player&&this.aurora.player.stop()
},_aurora_clearMedia:function(){},_aurora_load:function(){this.status.waitForLoad&&(this.status.waitForLoad=!1,this.aurora.player.preload())
},_aurora_play:function(a){this.status.waitForLoad||isNaN(a)||this.aurora.player.seek(a),this.aurora.player.playing||this.aurora.player.play(),this.status.waitForLoad=!1,this._aurora_checkWaitForPlay(),this._updateButtons(!0),this._trigger(i.jPlayer.event.play)
},_aurora_pause:function(a){isNaN(a)||this.aurora.player.seek(1000*a),this.aurora.player.pause(),a>0&&this._aurora_checkWaitForPlay(),this._updateButtons(!1),this._trigger(i.jPlayer.event.pause)
},_aurora_playHead:function(b){this.aurora.player.duration>0&&this.aurora.player.seek(b*this.aurora.player.duration/100),this.status.waitForLoad||this._aurora_checkWaitForPlay()
},_aurora_checkWaitForPlay:function(){this.status.waitForPlay&&(this.status.waitForPlay=!1)
},_aurora_volume:function(b){this.aurora.player.volume=100*b
},_aurora_mute:function(b){b?(this.aurora.properties.lastvolume=this.aurora.player.volume,this.aurora.player.volume=0):this.aurora.player.volume=this.aurora.properties.lastvolume,this.aurora.properties.muted=b
},_flash_setAudio:function(a){var f=this;
try{i.each(this.formats,function(b,c){if(f.flash.support[c]&&a[c]){switch(c){case"m4a":case"fla":f._getMovie().fl_setAudio_m4a(a[c]);
break;
case"mp3":f._getMovie().fl_setAudio_mp3(a[c]);
break;
case"rtmpa":f._getMovie().fl_setAudio_rtmp(a[c])
}return f.status.src=a[c],f.status.format[c]=!0,f.status.formatType=c,!1
}}),"auto"===this.options.preload&&(this._flash_load(),this.status.waitForLoad=!1)
}catch(e){this._flashError(e)
}},_flash_setVideo:function(a){var f=this;
try{i.each(this.formats,function(b,c){if(f.flash.support[c]&&a[c]){switch(c){case"m4v":case"flv":f._getMovie().fl_setVideo_m4v(a[c]);
break;
case"rtmpv":f._getMovie().fl_setVideo_rtmp(a[c])
}return f.status.src=a[c],f.status.format[c]=!0,f.status.formatType=c,!1
}}),"auto"===this.options.preload&&(this._flash_load(),this.status.waitForLoad=!1)
}catch(e){this._flashError(e)
}},_flash_resetMedia:function(){this.internal.flash.jq.css({width:"0px",height:"0px"}),this._flash_pause(0/0)
},_flash_clearMedia:function(){try{this._getMovie().fl_clearMedia()
}catch(b){this._flashError(b)
}},_flash_load:function(){try{this._getMovie().fl_load()
}catch(b){this._flashError(b)
}this.status.waitForLoad=!1
},_flash_play:function(d){try{this._getMovie().fl_play(d)
}catch(c){this._flashError(c)
}this.status.waitForLoad=!1,this._flash_checkWaitForPlay()
},_flash_pause:function(d){try{this._getMovie().fl_pause(d)
}catch(c){this._flashError(c)
}d>0&&(this.status.waitForLoad=!1,this._flash_checkWaitForPlay())
},_flash_playHead:function(d){try{this._getMovie().fl_play_head(d)
}catch(c){this._flashError(c)
}this.status.waitForLoad||this._flash_checkWaitForPlay()
},_flash_checkWaitForPlay:function(){this.status.waitForPlay&&(this.status.waitForPlay=!1,this.css.jq.videoPlay.length&&this.css.jq.videoPlay.hide(),this.status.video&&(this.internal.poster.jq.hide(),this.internal.flash.jq.css({width:this.status.width,height:this.status.height})))
},_flash_volume:function(d){try{this._getMovie().fl_volume(d)
}catch(c){this._flashError(c)
}},_flash_mute:function(d){try{this._getMovie().fl_mute(d)
}catch(c){this._flashError(c)
}},_getMovie:function(){return document[this.internal.flash.id]
},_getFlashPluginVersion:function(){var f,e=0;
if(window.ActiveXObject){try{if(f=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")){var o=f.GetVariable("$version");
o&&(o=o.split(" ")[1].split(","),e=parseInt(o[0],10)+"."+parseInt(o[1],10))
}}catch(g){}}else{navigator.plugins&&navigator.mimeTypes.length>0&&(f=navigator.plugins["Shockwave Flash"],f&&(e=navigator.plugins["Shockwave Flash"].description.replace(/.*\s(\d+\.\d+).*/,"$1")))
}return 1*e
},_checkForFlash:function(d){var c=!1;
return this._getFlashPluginVersion()>=d&&(c=!0),c
},_validString:function(b){return b&&"string"==typeof b
},_limitValue:function(e,d,f){return d>e?d:e>f?f:e
},_urlNotSetError:function(a){this._error({type:i.jPlayer.error.URL_NOT_SET,context:a,message:i.jPlayer.errorMsg.URL_NOT_SET,hint:i.jPlayer.errorHint.URL_NOT_SET})
},_flashError:function(a){var d;
d=this.internal.ready?"FLASH_DISABLED":"FLASH",this._error({type:i.jPlayer.error[d],context:this.internal.flash.swf,message:i.jPlayer.errorMsg[d]+a.message,hint:i.jPlayer.errorHint[d]}),this.internal.flash.jq.css({width:"1px",height:"1px"})
},_error:function(a){this._trigger(i.jPlayer.event.error,a),this.options.errorAlerts&&this._alert("Error!"+(a.message?"\n"+a.message:"")+(a.hint?"\n"+a.hint:"")+"\nContext: "+a.context)
},_warning:function(a){this._trigger(i.jPlayer.event.warning,h,a),this.options.warningAlerts&&this._alert("Warning!"+(a.message?"\n"+a.message:"")+(a.hint?"\n"+a.hint:"")+"\nContext: "+a.context)
},_alert:function(d){var c="jPlayer "+this.version.script+" : id='"+this.internal.self.id+"' : "+d;
this.options.consoleAlerts?window.console&&window.console.log&&window.console.log(c):alert(c)
},_emulateHtmlBridge:function(){var a=this;
i.each(i.jPlayer.emulateMethods.split(/\s+/g),function(b,d){a.internal.domNode[d]=function(c){a[d](c)
}
}),i.each(i.jPlayer.event,function(g,f){var b=!0;
i.each(i.jPlayer.reservedEvent.split(/\s+/g),function(d,c){return c===g?(b=!1,!1):void 0
}),b&&a.element.bind(f+".jPlayer.jPlayerHtml",function(){a._emulateHtmlUpdate();
var c=document.createEvent("Event");
c.initEvent(g,!1,!0),a.internal.domNode.dispatchEvent(c)
})
})
},_emulateHtmlUpdate:function(){var a=this;
i.each(i.jPlayer.emulateStatus.split(/\s+/g),function(b,d){a.internal.domNode[d]=a.status[d]
}),i.each(i.jPlayer.emulateOptions.split(/\s+/g),function(b,d){a.internal.domNode[d]=a.options[d]
})
},_destroyHtmlBridge:function(){var a=this;
this.element.unbind(".jPlayerHtml");
var d=i.jPlayer.emulateMethods+" "+i.jPlayer.emulateStatus+" "+i.jPlayer.emulateOptions;
i.each(d.split(/\s+/g),function(b,e){delete a.internal.domNode[e]
})
}},i.jPlayer.error={FLASH:"e_flash",FLASH_DISABLED:"e_flash_disabled",NO_SOLUTION:"e_no_solution",NO_SUPPORT:"e_no_support",URL:"e_url",URL_NOT_SET:"e_url_not_set",VERSION:"e_version"},i.jPlayer.errorMsg={FLASH:"jPlayer's Flash fallback is not configured correctly, or a command was issued before the jPlayer Ready event. Details: ",FLASH_DISABLED:"jPlayer's Flash fallback has been disabled by the browser due to the CSS rules you have used. Details: ",NO_SOLUTION:"No solution can be found by jPlayer in this browser. Neither HTML nor Flash can be used.",NO_SUPPORT:"It is not possible to play any media format provided in setMedia() on this browser using your current options.",URL:"Media URL could not be loaded.",URL_NOT_SET:"Attempt to issue media playback commands, while no media url is set.",VERSION:"jPlayer "+i.jPlayer.prototype.version.script+" needs Jplayer.swf version "+i.jPlayer.prototype.version.needFlash+" but found "},i.jPlayer.errorHint={FLASH:"Check your swfPath option and that Jplayer.swf is there.",FLASH_DISABLED:"Check that you have not display:none; the jPlayer entity or any ancestor.",NO_SOLUTION:"Review the jPlayer options: support and supplied.",NO_SUPPORT:"Video or audio formats defined in the supplied option are missing.",URL:"Check media URL is valid.",URL_NOT_SET:"Use setMedia() to set the media URL.",VERSION:"Update jPlayer files."},i.jPlayer.warning={CSS_SELECTOR_COUNT:"e_css_selector_count",CSS_SELECTOR_METHOD:"e_css_selector_method",CSS_SELECTOR_STRING:"e_css_selector_string",OPTION_KEY:"e_option_key"},i.jPlayer.warningMsg={CSS_SELECTOR_COUNT:"The number of css selectors found did not equal one: ",CSS_SELECTOR_METHOD:"The methodName given in jPlayer('cssSelector') is not a valid jPlayer method.",CSS_SELECTOR_STRING:"The methodCssSelector given in jPlayer('cssSelector') is not a String or is empty.",OPTION_KEY:"The option requested in jPlayer('option') is undefined."},i.jPlayer.warningHint={CSS_SELECTOR_COUNT:"Check your css selector and the ancestor.",CSS_SELECTOR_METHOD:"Check your method name.",CSS_SELECTOR_STRING:"Check your css selector is a string.",OPTION_KEY:"Check your option name."}
});
fom.tracking=(function(c){function b(d){if(typeof dataLayer!=="undefined"&&c.isArray(dataLayer)){return dataLayer.push({event:d})
}}function a(d){if(typeof dataLayer!=="undefined"&&c.isArray(dataLayer)){return dataLayer.push(d)
}}return{fireCustomEvent:b,addProperty:a}
})($);
fom.utils=(function(u,v,C){var d={WIDEST_LAYOUT:1440,MEDIUM_LAYOUT:768,TRANSITION_END_EVENT:"webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend"},t=v.flexbox,k=v.touch,m=v.cssvhunit,p=v.picture,O=u(".js-main-logo").first().attr("href")||"",D=(function(){return location.port=="3000"||location.port=="3001"||location.hostname.indexOf("static-frontend")!==-1
})(),n=(function(){return("platform" in navigator&&(/iphone|ipod|ipad/gi).test(navigator.platform))
})(),I=(function(){var Q=C.navigator,P=Q.appVersion.match(/OS (\d+_\d+)/i);
P=P&&P[1]?+P[1].replace("_","."):null;
return P||null
})(),J=(function(){return(/android (\d+\.\d+)/i.test(navigator.userAgent))
})(),K=(function(){var P=C.navigator.userAgent;
if(P.indexOf("Android")>=0){return parseFloat(P.slice(P.indexOf("Android")+8))
}else{return null
}})(),z=(function(){return(/IEMobile/.test(navigator.userAgent))
})(),h=(function(){return(/win/i.test(C.navigator.platform))
})(),o=(function(){var R=0,P,Q;
if(navigator.appName==="Microsoft Internet Explorer"){P=navigator.userAgent;
Q=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");
if(Q.exec(P)!==null){R=parseFloat(RegExp.$1)
}}else{if(navigator.userAgent.indexOf("Trident")>0){R=parseFloat(11)
}}return R
})(),L=u("html").hasClass("editmode-true")||false,s=function(){return v.touch||"ontouchstart" in C||(C.DocumentTouch&&document instanceof DocumentTouch)
},H=function(){return v.mq("only screen and (max-width: 767px)")
},E=function(){return v.mq("only screen and (min-width: 768px) and (max-width: 1023px)")
},B=function(){return v.mq("only screen and (min-width: 1024px)")
},g=function(){return v.csstransitions
},i="",M=function(){var P={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};
if(!i.length){i=P[v.prefixed("transition")]
}return i
},l=function(Q,P){P=P||document;
if(P.getElementsByClassName){return P.getElementsByClassName(Q)
}else{return(function R(Z,X){if(!X){X=C.document
}var W=[],V=X.getElementsByTagName("*"),S=V.length,Y=new RegExp("(^|\\s)"+Z+"(\\s|$)"),U,T;
for(U=0,T=0;
U<S;
U++){if(Y.test(V[U].className)){W[T]=V[U];
T++
}}return W
})(Q,P)
}},c=(function(){var S,Q,U,P=[{name:"loader",selector:"#tmpl-loader",preload:true}],R={},T=function(W){var V=this,Y="",X=function(){Y=u(V.selector).html()||""
};
V.name=W.name;
V.selector=W.selector;
V.preload=W.preload;
V.get=function(){if(Y!==""){return Y
}else{X();
return Y
}};
if(V.preload){X()
}};
for(S=0,Q=P.length;
S<Q;
S++){U=P[S];
R[U.name]=new T(U)
}return R
})(),f=(function(){function Q(){this.size=this.getSizeCategory();
this._events={};
this._$window=u(C);
this.prevRatio=1;
this._$window.on("resize",u.proxy(this.onResize,this));
this._$window.on("ontouchend",u.proxy(this.onZoom,this))
}var P=Q.prototype;
P.sizes={NARROW:"narrow",MEDIUM:"medium",WIDE:"wide"};
P.events={RESIZE:"resize",CHANGE:"change",ZOOM:"zoom"};
P.on=function(T,S,R){if(!S||!T){return
}if(!this._events[T]){this._events[T]=[]
}this._events[T].push({event:T,handler:S,scope:R})
};
P.off=function(U,T){if(!U||!T){return
}var S=this._events[U];
if(!S){return
}var R=S.length,V;
while(R--){V=S[R];
if(V.handler===T){this._events[U].splice(R,1)
}}};
P.onResize=function(){var R=this.size;
this.size=this.getSizeCategory();
this.trigger(P.events.RESIZE,[this.size]);
if(R!==this.size){this.onChange()
}};
P.onZoom=function(){this.currentRatio=this.getZoomRatio();
this.size=this.getSizeCategory();
if(this.prevRatio!==this.currentRatio){this.prevRatio=_playersthis.currentRatio;
this.trigger(P.events.ZOOM,[this.size]);
this.trigger(P.events.RESIZE,[this.size])
}};
P.getSizeCategory=function(){if(H()){return P.sizes.NARROW
}else{if(E()){return P.sizes.MEDIUM
}else{return P.sizes.WIDE
}}};
P.getZoomRatio=function(){return document.documentElement.clientWidth/C.innerWidth
};
P.onChange=function(){this.trigger(P.events.CHANGE,[this.size])
};
P.trigger=function(T,V){var S=this._events[T];
if(!S){return
}var R=S.length,U;
while(R--){U=S[R];
U.handler.apply(U.scope,V)
}};
P.isNarrow=function(){return this.size===this.sizes.NARROW
};
P.isMedium=function(){return this.size===this.sizes.MEDIUM
};
P.isWide=function(){return this.size===this.sizes.WIDE
};
return new Q()
})(),G=function(P){P.filter(".swiper-slide-duplicate").remove();
P.removeClass(function(Q,R){var S=[];
u.each(R.split(" "),function(T,U){if(/swiper-slide-.*/.test(U)){S.push(U)
}});
return S.join(" ")
}).removeAttr("style");
return P
},e=function(){return !(this.ieVersion&&this.ieVersion<=9)||!(this.androidVersion&&parseFloat(this.androidVersion)<=4.3)
},F=function(){var Q=null,P=500,S=5000,T=".parbase.teaser";
function R(){return clearInterval(Q)
}return{elements:T,update:function(U,W){var V=0;
if(typeof CQ_Analytics==="object"&&CQ_Analytics.hasOwnProperty("CCM")){if(CQ_Analytics.CCM.areStoresInitialized){W.call()
}else{CQ_Analytics.CCM.addListener("storesinitialize",function(){Q=setInterval(function(){if(V>=S){R()
}else{if(u(U).length>0){W.call();
R()
}V+=P
}},P)
})
}}}}
},j=function(R,T,Q){var P;
var S=null;
return function(){var X=this,W=arguments;
var V=function(){S=null;
if(!Q){P=R.apply(X,W)
}};
var U=Q&&!S;
clearTimeout(S);
S=setTimeout(V,T);
if(U){P=R.apply(X,W)
}return P
}
},b=function(P){return P.replace(/-|\s|\(|\)/g,"")
},N=function(P){return P.replace(/\D/ig,"")
},q=function(Q,P){P||(P="-");
return(Q+"").toLowerCase().replace(/\s+/g,P)
},a={location:{get:function(){return C.location
},set:function(P){C.location=P
},search:{get:function(){return C.location.search
},set:function(P){var Q;
if(P!==""){C.location.search=P
}else{Q=C.location.href;
C.location=Q.substring(0,Q.indexOf("?"))
}}}}},w=(function(){var Q={},R={},P="",S=function(){P=decodeURI(a.location.search.get());
if(P){P=P.substring(1);
var U=P.split("&");
for(var T=0;
T<U.length;
T++){var V=U[T].split("=");
R[V[0]]=V[1]
}}};
Q.toString=function(){var U="";
for(var T in R){if(R.hasOwnProperty(T)){U=U+(U!==""?"&":"?");
U=U+T+"="+R[T]
}}return U
};
Q.get=function(T){if(T){return R[T]?R[T]:null
}else{return R
}};
Q.remove=function(Y,W){var U;
Y=Y||"";
U=Y.constructor===Array;
if(U){for(var V=0,T=Y.length;
V<T;
V++){var X=Y[V];
if(R[X]){delete R[X]
}}}else{if(R[Y]){delete R[Y]
}}if(W){Q.reload()
}};
Q.clear=function(T){R={};
if(T){Q.reload()
}};
Q.add=function(V,U){V=V||{};
for(var T in V){if(V.hasOwnProperty(T)){R[T]=V[T]
}}if(U){Q.reload()
}};
Q.reload=function(){a.location.search.set(Q.toString())
};
S();
return Q
})(),r=function(P,S){var R,T,Q;
if(P.indexOf("?")===0){P=P.substr(1)
}R=P.split("&");
for(Q=0;
Q<R.length;
Q+=1){T=R[Q].split("=");
if(T[0]===S){return T[1]
}}return null
},y=function(T){var S={strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},P=S.parser[S.strictMode?"strict":"loose"].exec(T),R={},Q=14;
while(Q--){R[S.key[Q]]=P[Q]||""
}R[S.q.name]={};
R[S.key[12]].replace(S.q.parser,function(V,U,W){if(U){R[S.q.name][U]=W
}});
R.extention="."+R.file.split(".").pop();
R.filename=R.file.replace(R.extention,"");
return R
},x=function(){return u.ajax({url:"//www.softpauer.com/whereami.html",dataType:"html"})
},A=u("html");
if(h){A.addClass("is-win")
}else{A.addClass("not-win")
}if(n){A.addClass("ios ios-"+String(I).replace(".","-"))
}if(J){A.addClass("android android-"+String(K).replace(".","-"))
}if(o){A.addClass("ie")
}return{window:a,isTouch:k,hasCssvhunit:m,hasFlexbox:t,hasPictureElement:p,isStaticServer:D,isIOS:n,iosVersion:I,isAndroid:J,androidVersion:K,isWindowsPhone:z,isWindows:h,ieVersion:o,isEditMode:L,homeUrl:O,getTransitionEndEventName:M,hasCssTransitions:g,isMobile:s,isNarrowLayout:H,isMediumLayout:E,isWideLayout:B,removeSwiperClasses:G,getElementsByClassName:l,resizeManager:f,adobeCampaignManager:F,debounce:j,stripSpacesHyphensBrackets:b,formatPhoneNumber:N,slugify:q,queryString:w,getQueryStringVariable:r,parseUri:y,browserSupportsPremium:e,CONST:d,templates:c,getISO2:x,interpolate:function(Q,P){return Q.replace(/\{:([\w\d-]+)\}/g,function(S,R){return P[R]
})
},getNonCachedScript:function(P,Q){u.ajax({type:"GET",url:P,success:Q,dataType:"script",cache:false})
}}
})($,Modernizr,window);
(function(l){var c=[],b=$(window),k=false,f=0;
function e(){if(!k){k=true;
b.on("scroll",d)
}}function i(){k=false;
b.off("scroll",d)
}function g(){if(c.length===0){i()
}}function d(){clearTimeout(f);
f=setTimeout(a,20)
}function a(){var m=0,p=b.scrollTop(),o=p+b.innerHeight(),n;
while(m<c.length){n=c[m];
if(h(n,o,p)){c.splice(m,1);
continue
}m+=1
}g()
}function h(m,n,o){return m.checkScrollIntoView(n,o)
}function j(n,m){n=$.isArray(n)?n:[n];
[].push.apply(c,n);
e()
}l.scrollWatcher={add:function(m){j(m,false);
a()
},remove:function(n){var m=$.inArray(n,c);
if(m!==-1){c.splice(m,1);
g()
}}}
}(fom.utils));
(function(a){var c=typeof window.JSON!=="undefined",b=function(){var g="test",f=window.localStorage;
try{f.setItem(g,"1");
f.removeItem(g);
return true
}catch(e){return false
}},d=b()?window.localStorage:(function(){var e={};
return{getItem:function(f){return e[f]
},setItem:function(f,g){e[f]=g
},removeItem:function(f){delete e[f]
},clear:function(){e={}
}}
}());
a.localStorage={setItem:function(e,f){if(c){d.setItem(e,JSON.stringify(f))
}},getItem:function(e){if(c){return JSON.parse(d.getItem(e))
}},removeItem:$.proxy(d.removeItem,d),clear:$.proxy(d.clear,d)}
}(fom.utils));
(function(b){var a={AUD:"AUD $",CAD:"CAD $",DKK:"kr",EUR:"",GBP:"",JPY:"",USD:"$"};
b.getCurrencySymbol=function(c){return a[c]||c
}
})(fom.utils);
(function(c){function e(){}e.prototype.on=a;
e.prototype.off=d;
e.prototype.trigger=b;
var f={on:a,off:d,trigger:b};
function a(i,h,g){if(!this._events){this._events={}
}if(!h||!i){return
}if(!this._events[i]){this._events[i]=[]
}this._events[i].push({event:i,handler:h,scope:g});
return this
}function b(j,l){if(!this._events){this._events={}
}var h=this._events[j];
if(!h){return
}var g=h.length,k;
while(g--){k=h[g];
k.handler.apply(k.scope,l)
}}function d(k,j){if(!this._events){this._events={}
}if(!k){this._events={};
return
}if(!j){this._events[k]=[];
return this
}var h=this._events[k];
if(!h){return
}var g=h.length,l;
while(g--){l=h[g];
if(l.handler===j){this._events[k].splice(g,1)
}}}c.eventDispatcher={prototypal:e,object:f}
})(fom.utils);
(function(b,d,a){fom.modules.modal=function c(k,w,s){var r=k||{},t=w||[],e=s||{},f={SHIM:".fom-modal-shim",MODAL:".fom-modal",HEADER:".premium-title",FOOTER:"footer",BODY:".content",CLOSE:".icon-close",DOC_BODY:"body"},u={OPEN:"is-visible",SUCCESS:"icon-tick",INFO:"icon-info-on",WARN:"icon-error",TALLFIX:"turnoff-fixed",MODAL_ACTIVE:"modal_active"},K,M,B,l,A,z,F;
function g(){G();
N();
o();
L()
}function J(){B.empty();
A.empty();
l.empty()
}function G(){return B.html(r.header||"")
}function N(){A.html(n());
if(r.title){A.prepend('<h5 class="sml-title">'+p()+r.title+"</h5>")
}}function n(){var Q,O,P=[];
if(d.isArray(r.content)){O=r.content.length;
for(Q=0;
Q<O;
Q+=1){P.push("<p>"+r.content[Q]+"</p>")
}return P.join("")
}else{if(typeof(r.content)==="string"){return("<p>"+r.content+"</p>")
}}return""
}function o(){var P=t.length,R,Q,S,O;
if(P===0){return
}Q=A.append('<p class="btns"></p>').find("p.btns");
for(R=0;
R<P;
R+=1){O=t[R];
S=d("<a/>").attr({href:O.url||"#",target:O.target||"_self","class":C(O.css,R)}).text(j(O.text,R));
S.on("click",(O.callback&&typeof(O.callback)==="function")?O.callback:E);
Q.append(S)
}}function L(){if(r.footer){l.html("<p>"+r.footer+"</p>");
l.show()
}else{l.hide()
}return l
}function j(P,O){if(P){return P
}else{if(O<2){return["OK","Cancel"][O]
}}return"Button"
}function C(Q,O){var P=(O===0)?"btn":"";
if(Q){P+=(" "+Q)
}return P
}function y(){F.one("click",function(O){O.preventDefault();
E();
if(e.xclose&&e.xclose.callback){v(e.xclose.callback)
}})
}function H(){if(e.xclose&&e.xclose.disable){F.hide()
}else{F.show()
}}function p(){var O;
if(e.messagetype){O=e.messagetype.toUpperCase();
if(u[O]){return'<span class="'+u[O]+'"></span>'
}}return""
}function v(S,O,Q){var R=O||null,P=Q||[];
if(S&&typeof(S)==="function"){return S.apply(R,P)
}}function D(){return(M.height()>d(b).height())
}function m(){if(D()){M.addClass(u.TALLFIX).css("top",d(b).scrollTop())
}}function h(){return M.removeClass(u.TALLFIX).removeAttr("style")
}function x(){var O="reloadicons";
if(a.ieVersion==8){M.addClass(O);
setTimeout(function(){M.removeClass(O)
},10)
}}function q(Q,O,P){J();
y();
H();
if(r.content){g();
x();
m();
K.addClass(u.OPEN);
M.addClass(u.OPEN);
z.addClass(u.MODAL_ACTIVE)
}v(Q,O,P)
}function E(Q,O,P){M.removeClass(u.OPEN);
K.removeClass(u.OPEN);
z.removeClass(u.MODAL_ACTIVE);
setTimeout(function(){h();
v(Q,O,P)
},600)
}function i(){return((M.hasClass(u.OPEN))?"open":"closed")
}function I(){K=d(f.SHIM);
M=d(f.MODAL);
B=d(f.HEADER,M);
l=d(f.FOOTER,M);
A=d(f.BODY,M);
F=d(f.CLOSE,M);
z=d(f.DOC_BODY)
}I();
return{open:q,close:E,status:i}
}
}(window,jQuery,fom.utils));
fom.modules.modals=function(d,b,a,c){return{loginServerBusy:function(e){var g=function(){f.close()
},f=b({content:"We're sorry, but the servers are experiencing heavy traffic at the moment. Please try again later.",title:"Login currently unavailable",header:"F1Access"},[],{xclose:{disable:false},messagetype:"warn"});
f.open()
},expiredPremium:function(e){if(e){e.preventDefault();
e.stopPropagation()
}var i={DATA_LOCATION:".site-header"},f={ACCOUNTPAGE:"data-accountmanagement",PREMIUMPAGE:"data-premiumsales",PREMIUMPAGE_TARGET:"data-premiumsalestarget"},h=["There is a problem with your F1 Access account which may be due to entering incorrect payment details or your account may have expired.","Please go to Account Management and update your details.",'If this problem continues after updating your details, please contact <a href="mailto:billing@formula1.com">billing@formula1.com</a> or continue to browse the rest of formula1.com'],g;
g=b({content:h,title:"There is an issue with your account",header:"F1Access"},[{text:"Account Management",url:d(i.DATA_LOCATION).attr(f.ACCOUNTPAGE)},{text:"Continue"}],{messagetype:"warn"});
g.open()
},loginThrottled:function(f){var g=function(){e.close()
},e=b({content:"Sorry, but we are experiencing high volumes of logins. Please try again at "+f+".",title:"Login currently unavailable",header:"F1Access"},[{text:"Ok",callback:d.proxy(g,this)}],{xclose:{disable:false},messagetype:"warn"});
e.open()
},unsupportedBrowser:function(g){var f=function(){e.close();
if(g){g()
}},e=b({content:"F1 Access is not supported in your browser, please upgrade to view the full experience.",title:"Browser not supported",header:"F1Access"},[{text:"Back",callback:d.proxy(f,this)}],{xclose:{disable:true},messagetype:"warn"});
if((c.androidVersion&&parseFloat(c.androidVersion)<=4.3)){window.location=a.siteStructure.unsupportedBrowserPage
}else{e.open()
}},confirmCancelSubscription:function(g){var e=function(){f.close();
if(g.confirm){g.confirm()
}},h=function(){f.close();
if(g.cancel){g.cancel()
}},f=b({title:"Sorry to see you go",content:["Are you sure you want to cancel your subscription?","Turning off 'Auto-renew' means we will no longer bill your preferred method of payment. You will continue to have access to premium content until your current subscription period ends."],header:"F1Access"},[{text:"Yes, cancel it",callback:d.proxy(e,this)},{text:"No, keep it",callback:d.proxy(h,this)}],{messagetype:"warn"});
f.open();
return f
}}
}(jQuery,fom.modules.modal,fom.config,fom.utils);
(function(e,k,b,o,c){var h=b(e),f="simpleParallax",r=!o.isTouch&&(o.resizeManager.size===o.resizeManager.sizes.WIDE),p=[],a=0,q=h.height(),n="background-position",l="background-position-y",m="top";
function d(){if(r){a=h.scrollTop();
e.requestAnimationFrame(g)
}}function s(){o.resizeManager.on(o.resizeManager.events.RESIZE,function(){q=h.height()
});
o.resizeManager.on(o.resizeManager.events.CHANGE,function(){if(o.isTouch||o.resizeManager.size!==o.resizeManager.sizes.WIDE){r=false;
g(0,true)
}else{r=true;
g()
}})
}function g(w,y){var u,t=0,v=p.length,x;
for(;
t<v;
t++){u=p[t];
if(typeof y!=="undefined"){x=0
}else{if(u.bg){x=Math.round(u.top+((a-u.offsetTop)*u.speed))+"px"
}else{x=Math.round(u.top+((a-u.offsetTop)*u.speed))
}}if(u.offsetTop<a+q&&u.offsetTop+u.elem.height()>a){if(u.bg&&typeof u.left!=="undefined"){u.elem.css(n,u.left+" "+x)
}else{if(u.bg){u.elem.css(l,x)
}else{u.elem.css(m,x)
}}}}}function j(t){p.push(t);
if(!o.isTouch){d()
}}function i(I,u){var w=b(I),v=u.bg,E=(v?w.css(l):w.css(m))||0,A=w.css("backgroundImage").replace(/(url\()|(\))/g,""),K,z=w.height(),G=w.offset().top,x=z+G,t,F,C=v?w:w.parent(),D=w.is("img"),J=w.attr("src"),H=(u.scrollFactor||0.2)*(-10);
if(v&&typeof E==="undefined"){F=w.css(n).split(" ");
E=F.pop();
t=F.pop()
}function B(O,M,N,L){K=new Image();
K.onload=function(){y(O,M,L,this)
};
K.src=N
}function y(V,Q,T,N){var R=N?N.width:Q.width(),P=N?N.height:Q.height(),S=T?Q.width():V.width(),W=T?Q.height():V.height(),O=S/R,L=W/P,M=O>L?O:L,U={};
P=parseInt(P*M,10);
G=V.offset().top;
E=E.indexOf("%")>=0?-parseInt(+E.replace("%","")/100*(T?(P-W):(N?W:P)),10):+E.replace("px","");
if(E===0){E=-(P-W)/2
}U={elem:Q,bg:T,top:E,offsetTop:G,height:z,bottom:x,left:t,speed:H*(E/P)};
j(U)
}if(v){B(C,w,A,true)
}else{if(D){B(C,w,J,false)
}else{h.on("load",function(){y(C,w,false,null)
})
}}return{options:u}
}h.on("scroll",d);
s();
b.fn[f]=function(t){t=t||{bg:true};
b(this).each(function(){this[f]=new i(this,t)
})
}
}(window,document,window.jQuery,fom.utils));
var gigya=gigya||{accounts:{addEventHandlers:function(){}}};
fom.modules.gigyaRaas=(function(f,o,a,i){this.isShowingModal=false;
var x=this,E="signInLoad",j="signInSubmit",w="signInSuccess",D="signInFail",g="forgotPasswordLoad",l="forgotPasswordSubmit",C="forgotPasswordSuccess",b="forgotPasswordFail",u=function(){},r=function(){f("#raas-modal").removeClass("md-show");
setTimeout(function(){gigya.accounts.hideScreenSet({screenSet:"Responsive-RegistrationLogin",containerID:"screen"})
},1000)
},B=function(F){},e=function(F){},t=function(F){if(F&&F.length>0){var G=F.find("[data-switch-screen='gigya-login-screen']");
G.off("click");
G.on("click",function(H){H.preventDefault();
fom.modules.user.login()
})
}},A=function(F){if(f("#raas-modal").hasClass("md-show")){f("#raas-modal").removeClass("md-show");
setTimeout(function(){f("#raas-modal").addClass("md-show")
},500)
}else{f("#raas-modal").addClass("md-show")
}},h=function(I){var H=f("#"+I.currentScreen),J=m();
if(I.currentScreen==="gigya-login-screen"||I.currentScreen=="gigya-forgot-password-screen"){var F="";
try{F=I.response.requestParams.loginID
}catch(G){F=""
}if(F!==""){H.find("input.gigya-input-text.email").val(F)
}}if(J){H.find('input[name="passwordResetToken"]').val(J)
}if(I.currentScreen==="gigya-custom-error-screen"&&I.context){p(I,I.context)
}t(H);
if(I.currentScreen){switch(I.currentScreen){case"gigya-login-screen":i.fireCustomEvent(E);
break;
case"gigya-forgot-password-screen":i.fireCustomEvent(g);
break
}}},n=function(F){f("#raas-modal").removeClass("md-show");
x.isShowingModal=false;
if(x.onCloseHandler){x.onCloseHandler()
}},p=function(K,H){var L="hidden",J="",I=f("#"+K.currentScreen),G=I.find(".backlink"),F=G.filter('a[data-switch-screen="'+H.screen+'"]');
switch(String(H.errorCode)){case"403042":J="The email address and password that you entered have not been recognised, please review your details and try again.";
break;
case"403047":J="The email address that you entered has not been recognised, please review your details and try again.";
break;
default:J=H.errorMessage;
break
}if(J!==""){I.find("h5").after('<label class="gigya-label"><span class="gigya-label-text">'+J+"</span></label>")
}G.addClass(L);
F.removeClass(L)
},z=function(F){if(F.response.errorCode!=0&&(F.screen==="gigya-login-screen"||F.screen==="gigya-forgot-password-screen")){gigya.accounts.showScreenSet({context:F,screenSet:"Responsive-RegistrationLogin",startScreen:"gigya-custom-error-screen",containerID:"screen",onBeforeScreenLoad:A,onAfterScreenLoad:h,onHide:n,onError:z,onBeforeSubmit:d,onAfterSubmit:c});
return false
}},d=function(G){var F=f("#"+G.screen);
if(G.screen){switch(G.screen){case"gigya-login-screen":i.fireCustomEvent(j);
break;
case"gigya-forgot-password-screen":i.fireCustomEvent(l);
break
}}if(!q(G.formData.loginID)){f("#"+G.screen+" span.gigya-error-display.email").addClass("gigya-error-display-active");
f("#"+G.screen+" input.gigya-input-text.email").addClass("gigya-error");
return false
}else{f("#"+G.screen+" span.gigya-error-display.email").removeClass("gigya-error-display-active");
f("#"+G.screen+" input.gigya-input-text.email").removeClass("gigya-error")
}},c=function(H){var G="",F=false;
H.response.sessionInfo;
if(H.screen){F=(H.response.status.toLowerCase()==="fail");
switch(H.screen){case"gigya-login-screen":G=F?D:w;
i.fireCustomEvent(G);
break;
case"gigya-forgot-password-screen":G=F?b:C;
i.fireCustomEvent(G);
break
}}if(H.response.errorCode!=0){gigya.accounts.showScreenSet({screenSet:"Responsive-RegistrationLogin",startScreen:"gigya-custom-error-screen",containerID:"screen",onBeforeScreenLoad:A,onAfterScreenLoad:h,onHide:n,onError:z,onBeforeSubmit:d,onAfterSubmit:c})
}},y=function(){f("span.gigya-error-msg").each(function(){if(f(this).hasClass("gigya-error-msg-active")){f(this).siblings(".gigya-label-text").hide()
}else{f(this).siblings(".gigya-label-text").show()
}});
f("span.gigya-error-display").each(function(){if(f(this).hasClass("gigya-error-display-active")){f(this).siblings(".gigya-label-text").hide()
}else{f(this).siblings(".gigya-label-text").show()
}});
setTimeout(y,100)
},q=function(G){var F=new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i);
return F.test(G)
},m=function(){return a.queryString.get("pwrt")
},s=function(G,N){var M=G.split("#");
var I=M[0].split("?");
if(I.length>=2){var K=I.shift();
var F=I.join("?");
var L=encodeURIComponent(N)+"=";
var H=F.split(/[&;]/g);
for(var J=H.length;
J-->0;
){if(H[J].lastIndexOf(L,0)!==-1){H.splice(J,1)
}}G=K+"?"+H.join("&");
if(M[1]){G+="#"+M[1]
}}return G
},k=function(){var F=f("#gigya-reset-password-screen"),H=F.find('input[name="newPassword"]'),G=F.find('input[name="passwordRetype"]');
if(H.val()==""||G.val()==""||(H.val()!==G.val())){return false
}gigya.accounts.resetPassword({passwordResetToken:m(),newPassword:H.val(),callback:v})
},v=function(H){var N=H.errorCode;
if(N!=0){var J="gigya-reset-password-custom-error-screen";
var G="";
var M=H.errorDetails;
var L=H.errorMessage;
var K=Math.round(N/1000);
var I=(M!=null&&M.length>0)?M:L;
var F={screenSet:"Responsive-RegistrationLogin",screen:J,containerID:"screen"};
if(I.indexOf("invalid password - minimum length")>-1){I="Please enter a password with a minimum of 8 characters.";
G="invalid"
}if(I.indexOf("Reset password link expired")>-1){I="The reset password link has expired. Please request the password to be reset again to receive a new link.";
G="expired"
}gigya.accounts.switchScreen(F);
if(I!=""){f("#"+J+" h5").after('<label class="gigya-label"><span class="gigya-label-text">'+I+"</span></label>")
}if(G==="expired"){f('[data-switch-screen="gigya-reset-password-screen"]').attr("data-switch-screen","gigya-forgot-password-screen")
}}else{var F={screenSet:"Responsive-RegistrationLogin",screen:"gigya-reset-password-success-screen",containerID:"screen"};
gigya.accounts.switchScreen(F)
}};
o.hideModal=r;
o.resetPassword=k;
f("#loginButton").click(function(){gigya.accounts.showScreenSet({screenSet:"Responsive-RegistrationLogin",containerID:"screen",onBeforeScreenLoad:A,onAfterScreenLoad:h,onHide:n,onError:z,onBeforeSubmit:d,onAfterSubmit:c})
});
f("#logoutButton").click(function(){gigya.accounts.logout()
});
f(y);
if(m()){gigya.accounts.showScreenSet({screenSet:"Responsive-RegistrationLogin",startScreen:"gigya-reset-password-screen",containerID:"screen",onBeforeScreenLoad:A,onAfterScreenLoad:h,onHide:n,onError:z,onBeforeSubmit:d,onAfterSubmit:c})
}gigya.accounts.addEventHandlers({onLogin:B,onLogout:e});
return{instance:this,hideModal:r,resetPassword:k,onBeforeScreenLoadHandler:A,onAfterScreenLoadHandler:h,onBeforeSubmitHandler:d,onAfterSubmitHandler:c,onHideHandler:n,onErrorHandler:z,onCloseHandler:u}
})(jQuery,window,fom.utils,fom.tracking);
fom.modules.gigya=(function(f,j,b,c,e){var a="/bin/fom-website/gigya/update",d="/bin/fom-website/gigya/init_registration",l="/bin/fom-website/gigya/registration",i="/bin/fom-website/gigya/login",h="/etc/designs/fom-website/static/gigya/css/component.min.css",k="Responsive-RegistrationLogin",g=f.extend({init:function(){if(!b){return this.onApiLoadError()
}var m=j.createElement("link");
m.type="text/css";
m.rel="stylesheet";
m.href=h;
j.querySelector("head").appendChild(m);
b.accounts.addEventHandlers({onLogin:f.proxy(this._onLogin,this),onLogout:f.proxy(this._onLogout,this)});
return this
},initAccount:function(m){f.ajax({dataType:"json",error:m.fail,success:m.success,type:"POST",url:d})
},createAccount:function(m){f.ajax({data:m.data,dataType:"json",error:m.fail,success:m.success,type:"POST",url:l})
},setAccountInfo:function(m){f.ajax({data:m.data,dataType:"json",error:m.fail,success:m.success,type:"POST",url:a})
},getAccountInfo:function(m){b.accounts.getAccountInfo({include:"profile, data",callback:m.complete})
},login:function(m){if(!m){return console.log("Error: No opts parameter passed through to fom.modules.gigya.login()")
}this._loginCallback=m.success;
if(m.email&&m.password){f.ajax({data:{email:m.email,password:m.password,include:"data,profile"},success:f.proxy(this._onLogin,this),error:m.fail,type:"POST",dataType:"json",url:i})
}else{c.instance.onCloseHandler=m.onCloseHandler;
this.showScreenSet(k);
c.instance.isShowingModal=true
}},showScreenSet:function(m){b.accounts.showScreenSet({screenSet:m,containerID:"screen",onBeforeScreenLoad:c.onBeforeScreenLoadHandler,onAfterScreenLoad:c.onAfterScreenLoadHandler,onHide:c.onHideHandler,onError:c.onErrorHandler,onBeforeSubmit:c.onBeforeSubmitHandler,onAfterSubmit:c.onAfterSubmitHandler})
},logout:function(m){this._logoutCallback=m;
b.accounts.logout(f.proxy(this._onLogout,this))
},_onLogin:function(m){if(!m){return false
}this._loginCallback(m)
},_onLogout:function(m){this._logoutCallback(m)
},onApiLoadError:function(){console.error("Gigya module failed to initialise");
return false
}},e.object);
return g.init()
})(jQuery,document,window.gigya,fom.modules.gigyaRaas,fom.utils.eventDispatcher);
if(window.overrideGigya){window.overrideGigya(fom.modules.gigya,fom.modules.gigyaRaas)
}fom.modules.mpp=(function(l,f){var E="/bin/fom-website/mpp/serviceinfoall",x="/bin/fom-website/mpp/cancel_subscription",m="/bin/fom-website/mpp/create_id_existing_user",s="/bin/fom-website/mpp/create_id_add_subscription",b="F1 Subscriptions",B=function(){var H="test",G=window.sessionStorage;
try{G.setItem(H,"1");
G.removeItem(H);
return true
}catch(F){return false
}},A=(function(){var F={};
return{getItem:function(G){return F[G]
},setItem:function(G,H){F[G]=H
},removeItem:function(G){delete F[G]
},clear:function(){F={}
}}
}()),d="",e=B()?window.sessionStorage:A,j={},t=false,o=[],c=false,p=false,v=function(G,I){var F=I.data,J=I.onSuccess,L=I.onFail,H=function(M){if((M.success&&M.success==="false")||(!M.sessionId||M.sessionId==="")||(!M.xTokenId||M.xTokenId==="")){return L(M)
}e.setItem("sessionId",M.sessionId);
e.setItem("tokenId",M.xTokenId);
return J(M)
},K=function(M){return L(M)
};
l.ajax({data:F,dataType:"json",error:l.proxy(K,this),success:l.proxy(H,this),type:"POST",url:G})
},u=function(I){var F=I.methodName,G=z(I.requestData),K=I.onSuccess,M=I.onFail,J={"X-SessionId":e.getItem("sessionId"),"X-TokenId":e.getItem("tokenId"),"Content-Type":"application/json"},H=function(N){if(typeof N==="object"){if(N.GUID){e.setItem("sessionId",N.GUID)
}return K(N)
}else{return M(N)
}},L=function(N){return M(N)
};
if(!d){d=l(".js-mpp-api-url").first().val()
}if(!d||d===""){throw new Error("fom.modules.mpp - MPP API URL not set");
return L()
}if(!e.getItem("sessionId")){throw new Error("fom.modules.mpp - createSession must be called before an API call can be made");
return L()
}l.ajax({type:"POST",url:d+F,data:G,error:L,headers:J,success:H,dataType:"json"})
},C=function(F){l.ajax({type:"POST",url:x,error:F.onFail,data:F.data,success:F.onSuccess,dataType:"json"})
},r=function(H){var G=function(K){var L=o.length;
c=true;
p=true;
var M=D(K.ServiceInfoData);
var N=K;
e.setItem("serviceInfoAll",JSON.stringify(N));
e.setItem("serviceInfoParsed",JSON.stringify(M));
j.serviceInfoAll=N;
j.serviceInfoParsed=M;
while(L--){o[L].onSuccess(M)
}},J=function(K){var L=o.length;
c=true;
while(L--){o[L].onFail(K)
}},I=e.getItem("serviceInfoAll"),F=e.getItem("serviceInfoParsed");
if(I){j.serviceInfoParsed=JSON.parse(F);
j.serviceInfoAll=JSON.parse(I);
G(j.serviceInfoAll);
return j.serviceInfoAll
}else{l.ajax({dataType:"json",error:J,success:G,type:"GET",url:E})
}},D=function(F){F=w(F);
F=n(F);
return F
},n=function(F){return{minutes:f.isEditMode?g(F,"Minutes")[0]:{},month:g(F,"Months")[0],year:g(F,"Years")[0]}
},w=function(F){return l.grep(F,function(H,G){return H.ServiceGroup===b
})
},g=function(G,F){return l.grep(G,function(I,H){return(I.Active==="Active"&&I.SubscriptionUnit===F)
})
},z=function(F){return typeof F==="string"?F:JSON.stringify(F)
},a=function(F){if(!F||!F.ServiceInformation){return false
}F=F.ServiceInformation;
return l.grep(F,function(H,G){return(H.ServiceStatus.toLowerCase()==="active"&&["active","cancelledbyuser"].indexOf(H.SubscriptionInformation["SubscriptionStatus"].toLowerCase())>-1)
})
},i=function(G,K){if(!e.getItem("serviceInfoParsed")){throw new Error("fom.modules.mpp - Trying to call getPrice before getServiceInfoAll");
return false
}var F=JSON.parse(e.getItem("serviceInfoParsed"))[K],H=F.SentinelRolePriceMaps["SentinelRolePriceMap"],I=f.getCurrencySymbol(G),J=l.grep(H,function(M,L){return M.Currency===G
})[0];
return{string:I+String(J.RenewalPrice.toFixed(2)),data:J}
},y=function(G){var F=function(K,J){var I=K.ServicePriceId.toString()===String(G);
return I
};
var H=JSON.parse(e.getItem("serviceInfoParsed"));
if(!H){return false
}if(l.grep(H.month.SentinelRolePriceMaps["SentinelRolePriceMap"],F).length){return H.month.ServiceId
}else{if(l.grep(H.year.SentinelRolePriceMaps["SentinelRolePriceMap"],F).length){return H.year.ServiceId
}else{if(f.isEditMode&&l.grep(H.minutes.SentinelRolePriceMaps["SentinelRolePriceMap"],F).length){return H.minutes.ServiceId
}}}},k=function(H){var F=function(J,I){return J.ServicePriceId.toString()===H.toString()
};
var G=JSON.parse(e.getItem("serviceInfoParsed"));
if(!G){return false
}if(l.grep(G.month.SentinelRolePriceMaps["SentinelRolePriceMap"],F).length){return"month"
}else{if(l.grep(G.year.SentinelRolePriceMaps["SentinelRolePriceMap"],F).length){return"year"
}}},h=function(F){return F.replace(/\'|\|\|\|\|\|\|\|\|\|\|\|\|\|\|\|\|\|\|\|\|\|\!|\|\$|\%|\&|\|\(|\)|\*|\+|\,|\:|\;|\<|\=|\>|\?|\[|\\|\]|\`|\{|\||\}|\~|\|\|\|\|\|\|\|\|\|\|\|\|\|\|\|\|\|\|\|\|\|\|\|\|\|\|\|\|\|\|\|\/g,"")
},q=function(F){if(c){if(p){F.onSuccess()
}else{F.onFail()
}}else{if(!c&&!t){o.push(F);
t=true;
r()
}else{if(t){o.push(F)
}}}};
return{CREATE_SESSION_NEW_USER_URL:s,CREATE_SESSION_EXISTING_USER_URL:m,api:u,cancelSubscription:C,cleanIllegalCharacters:h,createSession:v,getCategoryById:k,getServiceIdFromServicePriceId:y,getServiceInfoAll:r,sessionStorage:j,getPrice:i,hasActiveSubscription:a,ready:q}
})(jQuery,fom.utils);
fom.modules.responsiveElements=(function(h,j,m,s){var e="responsive-element",t="data-respond",n=5,k={start:256,end:1024,interval:32},d={},r,f=function(w){var y=w.split(/\s+/),v=[];
for(var x=0,u=y.length;
x<u;
x++){if(y[x].match(/^gt\d+|lt\d+$/)){v.push(y[x])
}}return v
},a=function(y){var v=f(y.getAttribute("class")),x=h(y);
for(var w=0,u=v.length;
w<u;
w++){x.removeClass(v[w])
}},l=function(z,w){var A=w.start,u=w.end,v=w.interval,y=v>A?v:~~(A/v)*v,x=[];
while(y<=u){if(y>z){x.push("lt"+y)
}else{if(y===z){x.push("is"+y)
}}y+=v
}return x
},c=function(x){var v=[],w={};
if(!x){return false
}r=r||{};
if(r[x]){return r[x]
}v=x.replace(/\s+/g,"").split(";");
for(var A=0,u=v.length;
A<u;
A++){if(!v[A]){continue
}var z=v[A].split(":"),y=z[0],B=z[1];
B=B.replace("px","");
if(!isNaN(B)){B=parseInt(B,10)
}w[y]=B
}r[x]=w;
return w
},i=function(A){var v=A.getAttribute(t),w=c(v)||k,z=l(A.clientWidth,w),y=h(A);
a(A);
for(var x=0,u=z.length;
x<u;
x++){y.addClass(z[x])
}},g=function(){for(var v=0,u=d.responsive_elements.length;
v<u;
v++){i(d.responsive_elements[v])
}},q=function(u){i(u)
},p=function(u){u.each(function(){q(h(this).get(0))
})
},b=function(){g();
j.onresize=s.debounce(g,n)
},o=function(){function u(){d.responsive_elements=s.getElementsByClassName(e);
b()
}h(m).ready(function(){u()
})
};
o();
return{recalculate:q,recalculate$Elements:p}
})($,window,window.document,fom.utils);
fom.modules.tabGroups=(function(b){var e="data-tab-title",d="data-id",c="active",a=$(".tab-group"),h=function(j){var i=$('<nav class="tab-group-nav group"></nav>'),k=function(l){var o=l.attr(d),m=l.attr(e),n=l.hasClass(c)?" "+c:"";
return $('<a href="#'+o+'" title="'+m+'" class="tab-'+o+n+'">'+m+"</a>")
};
j.each(function(){var m=$(this),l=k(m);
i.append(l)
});
return i
},f=function(k){var j=k.children(),i=h(j);
k.prepend(i);
i.on("click","a",function(o){var n=$(this),l=n.attr("href").substring(1),m=k.find('[data-id="'+l+'"]'),p=m.find(".responsive-element");
o.preventDefault();
k.find("."+c).removeClass(c);
n.addClass(c);
m.addClass(c);
if(p.length>0){p.each(function(){b.responsiveElements.recalculate($(this)[0])
})
}})
},g=function(){a.each(function(){var i=$(this);
f(i)
})
};
g();
return{$elems:a}
})(fom.modules);
fom.modules.videoPlayer=(function(i,e,j,l){var m={autoplay:false,controls:true,elapsed:0,isMuted:false,loop:false,preload:true,bitrates:{s:300,sd:900,hd:1500}},h,f="//player.ooyala.com/v3/90c1c7c50a2a4ffda5ebbfbe9bc11ff6?platform=html5-fallback&tweaks=android-enable-hls";
var b=[],k=(function(){var n=0;
return function(o){var p=++n+"";
return o?o+p:p
}
})(),g=false;
function a(n,p,o){this.$elem=n;
this.id=p;
this.settings=i.extend({},m,o);
this.elapsed=0;
this.init()
}a.events={ON_PLAY:"onPlay",ON_PAUSE:"onPause",ON_TIME_CHANGED:"onTimeChanged"};
a.prototype={init:function(){OO.ready(i.proxy(function(){this.setPlayerDimensions();
j.on(j.events.RESIZE,this.setPlayerDimensions,this);
this.getToken(this.settings.videoid);
this.cacheElements();
this._events=[]
},this))
},setPlayerDimensions:function(){var p=16/9;
var n=0;
var o="100%";
this.$elem.css("width",o);
o=this.$elem.width();
n=Math.ceil(o/p);
this.$elem.css("height",n)
},createPlayer:function(p,o){var n=this;
var q=this.$elem.parent();
n.player=OO.Player.create(n.id,p,{autoplay:n.settings.autoplay,embedToken:o,initialTime:n.duration,layout:"chromeless",prebuffering:n.settings.preload,wmode:"opaque",onCreate:function(r){r.subscribe(OO.EVENTS.PLAYER_CREATED,"customUi",function(){n.onPlayerCreated()
});
r.subscribe(OO.EVENTS.PLAYBACK_READY,"customUi",function(s,t){n.setDuration(r.getDuration());
if(n.settings.autoplay){n.playVideo()
}n.$elem.removeClass("hide-controls")
});
r.subscribe(OO.EVENTS.SEEKED,"customUi",function(s,t){if(n.player.isPlaying){n.playVideo()
}if(!n.$elem.is(":visible")){n.pauseVideo()
}});
r.subscribe(OO.EVENTS.PLAYHEAD_TIME_CHANGED,"customUi",function(s,t){n.setProgress(t)
});
r.subscribe(OO.EVENTS.PLAYED,"customUi",function(s,t){n.pauseVideo();
n.player.isPlaying=false
});
if(l.isIOS){r.subscribe(OO.EVENTS.FULLSCREEN_CHANGED,"customUi",function(s,t){if(!n.player.fullscreen){n.pauseVideo();
n.player.isPlaying=false;
n.showPreview()
}})
}}})
},createDefaultPlayer:function(p,o){var n=this;
var q=this.$elem.parent();
n.player=OO.Player.create(n.id,p,{autoplay:n.settings.autoplay,embedToken:o,initialTime:n.duration,prebuffering:n.settings.preload,wmode:"opaque",onCreate:function(r){}})
},getToken:function(p){var n=this;
var o=n.$elem.attr("data-path");
if(o.indexOf("/content/fom-website")==0){o=o.replace("/content/fom-website","")
}i.post(o+".token.html?embedCodes="+p).done(function(q){q=i.trim(q);
if(q.length>0){if(h){n.createPlayer(p,q)
}else{n.createDefaultPlayer(p,q)
}}else{n.showError("TOKEN-EMPTY")
}}).fail(function(q){n.showError("NO-TOKEN");
if(h){n.createPlayer(p,"A5eXRtcjpb6AEKizxldiaThNBmL9GWGU")
}else{n.createDefaultPlayer(p,"A5eXRtcjpb6AEKizxldiaThNBmL9GWGU")
}})
},hidePreview:function(){this.$preview.hide();
this.$partnerPreview.hide();
this.$display.show();
this.$scrubber.show();
this.$controls.show()
},showPreview:function(){this.$preview.show();
this.$partnerPreview.show();
this.$display.hide();
this.$scrubber.hide();
this.$controls.hide()
},setPreview:function(){if(this.settings.autoplay){this.playVideo(true)
}else{this.showPreview()
}},showError:function(o){var n=this.$elem.find(".video-error");
this.$preview.hide();
this.$partnerPreview.hide();
this.$scrubber.hide();
this.$controls.hide();
n.show();
n.append("<p>Unfortunately, we are unable to play the video at this time.</p>",'<p>Error Code: <span class="error-code">UNKNOWN</span></p>');
n.find(".error-code").text(o)
},attachShowControls:function(){var p=this,o=p.$elem,q="show-controls",r=4000,n;
if(e.touch){o.on("click",function(){clearTimeout(n);
o.addClass(q);
n=setTimeout(function(){o.removeClass(q)
},r)
})
}},setDuration:function(o){var n=this.$controls.find(".duration");
this.duration=parseInt(o,10);
if(this.duration>10000){this.duration=parseInt(this.duration/1000,10)
}n.html(this.convertTime(this.duration))
},setProgress:function(o){var n=this;
n.elapsed=parseInt(o,10);
if(typeof n.duration==="undefined"){n.setDuration(n.player.getDuration())
}n.$elapsedTimer.html(n.convertTime(n.elapsed));
n.$elapsedProgress.width(((100/n.duration)*n.elapsed)+"%")
},convertTime:function(p){var n=0;
var o=0;
var q=0;
p=parseInt(p,10);
n=Math.floor(p/3600)||0;
o=Math.floor((p-(n*3600))/60)||0;
q=p-(n*3600)-(o*60)||0;
if(q<10){q="0"+q
}if(n>0){if(o<10){o="0"+o
}return n+":"+o+":"+q
}return o+":"+q
},dragTime:function(p){var n=0;
var q=this.duration;
var o=this.$scrubber.width();
n=1/(o/p);
if(n<=1){q=this.duration*n
}this.player.setPlayheadTime(q)
},playVideo:function(n){var o=i(window);
this.hidePreview();
this.$playBtn.addClass("is-playing");
if(!this.player.isPlaying){this.player.play();
this.player.isPlaying=true
}o.trigger("video-playing",{id:this.id})
},pauseVideo:function(){this.$playBtn.removeClass("is-playing");
if(this.player.isPlaying){this.player.pause();
this.player.isPlaying=false
}},resetVideoPlayback:function(){if(this.player){this.player.seek(0);
this.pauseVideo()
}},attachPlayButton:function(){var n=this;
n.$playBtn.on("click",function(o){o.preventDefault();
if(n.player.isPlaying){n.pauseVideo()
}else{n.playVideo()
}});
n.$preview.find("a").on("click",function(o){o.preventDefault();
n.playVideo.call(n)
});
n.$partnerPreview.find("a").on("click",function(o){o.preventDefault();
if(n.player.isPlaying){n.pauseVideo()
}else{n.playVideo()
}})
},attachVideoOptionsMenus:function(){var o=this,n=o.$videoOptTrigs,p="is-shown",q=function(A,w){var v=A.find(".video-options"),C=!l.isTouch&&A.attr("data-mouseover-toggle"),t=false,r=undefined,x=100,u=function(){y();
v.addClass(p)
},B=function(){if(t||v.attr("data-stay-open")==="true"){return
}y();
v.removeClass(p)
},z=function(){if(r){return
}r=setInterval(B,x)
},y=function(){clearInterval(r);
r=undefined
},s=function(){var D=v.hasClass(p);
if(D){B()
}else{u()
}};
v.on("mouseenter",function(D){t=true
});
v.on("mouseleave",function(D){t=false;
z()
});
A.on("mouseenter",function(D){if(C){u()
}});
A.on("mouseleave",function(D){z()
});
A.on("mouseup",function(D){var E=i(this);
D.preventDefault();
if(v.attr("data-stay-open")==="true"){return
}if(!l.isTouch){switch(E.attr("data-click-action")){case"toggle-mute":return o.toggleMute()
}}s()
})
};
n.each(function(r){q(i(this),r)
})
},soundUniqueIconClass:"sound-icon",soundCurrentIconClass:"icon-volume-high",soundVolumeCache:1,volumeSliderVerticalPadding:10,volumeSliderContainerHeight:0,volume:1,getVolumeIcon:function(n){return n<=0?"icon-volume-mute":"icon-volume"
},setVolume:function(q){var n=this,o=n.$soundBtn.find("."+n.soundUniqueIconClass),p=n.getVolumeIcon(q);
if(q>0){n.soundVolumeCache=q
}n.player.setVolume(q);
n.volume=q;
o.removeClass(o.attr("data-icon"));
o.addClass(p);
o.attr("data-icon",p)
},toggleMute:function(){var n=this.volume===0?this.soundVolumeCache:0;
this.updateVolume(0,n)
},attachSoundButtons:function(){var o=this,n=o.$soundBtn;
o.volumeSliderContainerHeight=o.$soundSlider.outerHeight();
if(e.volume){n.show();
o.$soundSlider.on("mousedown",i.proxy(o.volumeSliderClick,this));
o.updateVolume(0,1)
}},volumeSliderClick:function(n){var o=this;
o.volumeSliderStartDrag(n);
this.$soundSlider.parent().attr("data-stay-open","true");
i(document.body).on("mousemove.volumeSlider",i.proxy(o.volumeSliderStartDrag,this));
i(document.body).on("mouseup.volumeSlider",i.proxy(o.volumeSliderStopDrag,this))
},volumeSliderStartDrag:function(n){this.updateVolume(n.pageY-this.$soundSlider.offset().top)
},volumeSliderStopDrag:function(n){i(document.body).off(".volumeSlider");
this.$soundSlider.parent().attr("data-stay-open","false")
},updateVolume:function(p,q){var o=this,n=o.volumeSliderContainerHeight-(o.volumeSliderVerticalPadding*2);
if(q!==undefined){p=(n*(1-q))+o.volumeSliderVerticalPadding
}p=Math.min(Math.max(o.volumeSliderVerticalPadding,p),o.volumeSliderContainerHeight-o.volumeSliderVerticalPadding);
o.$soundSliderHead.css("top",p+"px");
o.$soundSliderBG.css("height",(o.volumeSliderContainerHeight-p-(o.$soundSliderHead.outerHeight()*2)-1)+"px");
q=1-((p-o.volumeSliderVerticalPadding)/n);
o.setVolume(q)
},setStream:function(q,n){var o=this,p=o.$qualityBtn,r;
o.player.setTargetBitrate(q);
p.find(".quality-text span").html(n.attr("data-icon"));
p.find(".stream").removeClass("active");
n.addClass("active");
r=setInterval(function(){var s=o.player.getTargetBitrate();
if(s&&q===s.toString()){clearInterval(r);
o.player.setPlayheadTime(o.player.getPlayheadTime()-1)
}},20)
},attachQualityButtons:function(){var n=this;
n.$qualityOpts.on("click",".stream",function(o){var p=i(o.currentTarget);
n.setStream(p.attr("data-quality"),p)
})
},attachFullScreenButton:function(){var n=this;
if(screenfull.enabled){n.$fullscreenBtn.show();
n.$fullscreenBtn.on("click",function(o){screenfull.toggle(n.$elem[0]);
n.$elem.toggleClass("full-screen-mode")
})
}},attachControls:function(){this.attachShowControls();
this.attachPlayButton();
this.attachVideoOptionsMenus();
this.attachFullScreenButton();
this.attachSoundButtons();
this.attachQualityButtons()
},attachScrubber:function(){var o=this;
var n=false;
var p=i(window);
o.$elem.on("mousedown",".video-progress",function(r){var q=function(s){var t=s.pageX-o.$scrubber.offset().left;
if(t<0){t=0
}o.dragTime(t)
};
o.dragTime(r.offsetX);
n=o.player.isPlaying;
o.player.pause();
p.on("mousemove",q);
p.one("mouseup",function(s){p.off("mousemove",q);
if(n){o.player.play()
}})
})
},subscribe:function(){var n=this;
var o=i(window);
o.on("video-playing",function(q,p){if(n.id!==p.id){n.pauseVideo()
}})
},cacheElements:function(){this.$preview=this.$elem.find(".video-preview");
this.$partnerPreview=this.$elem.find(".partner-video-preview");
this.$scrubber=this.$elem.find(".video-progress");
this.$display=this.$elem.find(".video-display");
this.$controls=this.$elem.find(".video-controls");
this.$playBtn=this.$controls.find(".playback");
this.$videoOptTrigs=this.$controls.find(".video-options-trigger");
this.$videoOpts=this.$controls.find(".video-options");
this.$soundBtn=this.$controls.find(".sound");
this.$soundOpts=this.$soundBtn.find(".sound-options");
this.$soundSlider=this.$soundOpts.find(".sound-slider-container");
this.$soundSliderHead=this.$soundSlider.find(".sound-slider-head");
this.$soundSliderBG=this.$soundSlider.find(".sound-slider-bg");
this.$qualityBtn=this.$controls.find(".quality");
this.$qualityOpts=this.$qualityBtn.find(".quality-options");
this.$streamBtns=this.$qualityOpts.find(".stream");
this.$fullscreenBtn=this.$controls.find(".fullscreen");
this.$elapsedTimer=this.$controls.find(".elapsed");
this.$elapsedProgress=this.$scrubber.find(".elapsed")
},setupVideoPlayback:function(){if(this.settings.isMuted){muteVideo()
}if(this.settings.elapsed>0){self.player.seek(this.settings.elapsed)
}},onPlayerCreated:function(){this.attachControls();
this.attachScrubber();
this.setupVideoPlayback();
this.setPreview();
this.subscribe()
},on:function(p,o,n){if(!this._events[p]){this._events[p]=[]
}this._events[p].push({scope:n,fn:o})
},trigger:function(o,p){var n=0;
if(!this._events[o]){return
}n=this._events[o].length;
while(n--){this._events[o][n].fn.apply(this._events[o][n].scope,p)
}}};
function d(n){if(i('input[name="ooyala-player-id"]').length>0){var o=i('input[name="ooyala-player-id"]').val();
if(o==="90c1c7c50a2a4ffda5ebbfbe9bc11ff6"){h=true
}else{h=false;
i("body").addClass("hide-chromeless-controls")
}f="//player.ooyala.com/v3/"+o+"?platform=html5-fallback&tweaks=android-enable-hls"
}if(!g){l.getNonCachedScript(f,function(){g=true;
if(n){n()
}})
}else{if(n){n()
}}}function c(o,n,p){d(i.proxy(function(){if(typeof OO!=="undefined"){OO.ready(function(){var q={};
o.each(function(){var t=k("video-player-");
var r={};
var s=i(this);
n=i.extend({},n,s.data());
s.children(".video-display").attr("id",t);
r=new a(s,t,n);
r.holderId=t;
b.push(r);
q[t]=r
});
p(q)
})
}},this))
}c(i(".video-player.js-init"));
return{Player:a,players:b,initPlayers:c}
})(jQuery,Modernizr,fom.utils.resizeManager,fom.utils);
fom.modules.breakouts=(function(h,k,e,i){var m={PULLQUOTE_MAX_OFFSET:38},d=false,j=[],f=k.CONST.WIDEST_LAYOUT,b=function(n,o){j.push({el:n,direction:o,justQuote:n.hasClass("quote")?n.find("img").length?false:n.find("blockquote"):false})
},a=function(){var o=e(h).width(),n;
for(n=0;
n<j.length;
n++){c(j[n],o)
}},c=function(o,p){var n=o.el;
if(p>=k.CONST.MEDIUM_LAYOUT){if(o.justQuote){o.justQuote.css({margin:25+"px"})
}if(p>f){n.css(o.direction,-((n.parent().offset().left))+(Math.floor((p-f)/2))+"px")
}else{n.css(o.direction,-(n.parent().offset().left)+"px")
}}else{n.attr("style","")
}},g=function(){i.off(i.events.RESIZE,a);
e(".breakout-left").attr("style","");
e(".breakout-right").attr("style","");
j=[];
d=true
},l=function(){var n=e("main");
d=!(n.hasClass("go-full-width"));
if(!d){e(".breakout-left").each(function(){b(e(this),"marginLeft")
});
e(".breakout-right").each(function(){b(e(this),"marginRight")
});
if(j.length){a=k.debounce(a,50);
i.on(i.events.RESIZE,a);
i.on(i.events.ZOOM,a);
a()
}}return{disableBreakouts:g}
};
return l()
}(window,fom.utils,jQuery,fom.utils.resizeManager));
fom.modules.authenticator=(function(b,a){var c=b.extend({opts:{AUTH_URL:"/authentication/login",AUTH_VALIDATOR_URL:"/bin/fom-website/login_status",COOKIE_AEM_SESSION:"login-token",COOKIE_NO_AUTH_RETRY:"noauthretry"},init:function(){var d=b.cookie(this.opts.COOKIE_AEM_SESSION);
this.hasLoginToken=(d&&d!=="");
return this
},authenticate:function(e,f,d){if(b.cookie(this.opts.COOKIE_NO_AUTH_RETRY)){return
}e=e||fom.modules.user.accountInfo;
b.ajax({complete:b.proxy(function(g){if(!d){return f(g)
}switch(g.status){case 503:return setTimeout(b.proxy(function(){this.authenticate(e,f,d*2)
},this),d);
case 403:return b.cookie(this.opts.COOKIE_NO_AUTH_RETRY,"true",{path:"/",expires:1});
case 307:default:f(g);
return
}},this),data:this._getAuthObjectFromAccountInfo(e),dataType:"json",type:"POST",url:this.opts.AUTH_URL})
},deauthenticate:function(){b.removeCookie(this.opts.COOKIE_NO_AUTH_RETRY,{path:"/"});
b.removeCookie(this.opts.COOKIE_AEM_SESSION,{path:"/"})
},validate:function(f){var e=b.cookie(this.opts.COOKIE_AEM_SESSION),d=function(g){this._parseAuthenticatorResponseAndCallback(g,f)
};
if(!e||e===""){return f(false)
}b.ajax({complete:b.proxy(d,this),dataType:"json",type:"GET",url:this.opts.AUTH_VALIDATOR_URL})
},_parseAuthenticatorResponseAndCallback:function(d,f){var e=d.responseText?b.trim(d.responseText):"";
switch(e){case"subscribed":case"notsubscribed":f(true,e);
break;
case"anonymous":case"session_timed_out":default:f(false,e)
}},_getAuthObjectFromAccountInfo:function(d){return{data:JSON.stringify({signatureTimestamp:d.signatureTimestamp,UIDSignature:d.UIDSignature,UID:d.UID,data:{subscriptionStatus:d.data.subscriptionStatus,subscriptionToken:d.data.subscriptionToken}})}
}},a.object);
return c.init()
})(jQuery,fom.utils.eventDispatcher,fom.modules.user);
fom.modules.user=(function(i,r,a,f,w,t,e,m,j,o,k){var v="account-info",h="throttle-login",s="/etc/designs/fom-website/static/status.json",d="/system/sling/logout?resource=",u="signInThrottled",n=3,g="expiry-account-info",q="resend-email-info",p=1,c="/content/fom-website/en/validation-error.html",l=".sp_modalDismiss",b=i.extend({login:function(A,z,y,x){if(!e.browserSupportsPremium()){t.unsupportedBrowser();
return false
}if(y){this._onLoginUrl=y
}this._doPageReload=(A||A===k);
if(z&&!i.isEmptyObject(z)&&z.email&&z.password){return r.login({password:z.password,email:z.email,fail:z.fail,success:i.proxy(function(B){this.setAccountInfoCookie(B,z);
z.success(B)
},this)})
}if(a.instance.isShowingModal){return
}this._serverStatusCheck(i.proxy(function(C,B){if(C){r.login({success:i.proxy(this._onLoginGigya,this),onCloseHandler:x});
if(z&&!i.isEmptyObject(z)&&z.hideCloseIcon){setTimeout(i.proxy(function(){i(l).hide()
},this),0)
}}else{m.fireCustomEvent(u);
if(B&&(B.minBlockSeconds||B.maxBlockSeconds)){this._setLoginThrottleCookie(B.minBlockSeconds,B.maxBlockSeconds)
}t.loginThrottled(i.cookie(h));
this._onLoginAuthFail()
}},this))
},logout:function(x){this.accountInfo=false;
this.isLoggedIn=false;
this.isPremium=false;
i.removeCookie(j.opts.COOKIE_NO_AUTH_RETRY,{path:"/"});
i.removeCookie(v,{path:"/"});
if(o.sessionStorage){o.sessionStorage.removeItem("promptedAccountExpiration")
}r.logout(function(){if(x){return x()
}e.window.location.set(d+i(".site-header .sign-out").first().data("redirect"))
})
},get:function(x){switch(x){case"fullName":return[this.accountInfo.profile.firstName,this.accountInfo.profile.lastName].join(" ")
}},setAccountInfoGigya:function(x){r.setAccountInfo(x)
},setAccountInfoMPP:function(x){f.api({methodName:"UserAmend",onSuccess:x.success,onFail:x.fail,requestData:x.data})
},addSubscription:function(x){f.api({methodName:"AddSubscription",onSuccess:x.success,onFail:x.fail,requestData:x.data})
},manageCardDetails:function(y){var x=y.data;
if(typeof x.CreditDebitCardDetails!=="undefined"){x.CreditDebitCardDetails.SkipPreauth=true
}f.api({methodName:"UserManageCreditDebitCard",onSuccess:y.success,onFail:y.fail,requestData:x})
},setAccountInfoCookie:function(E,B){if(E.sessionInfo){i.cookie(E.sessionInfo.cookieName,E.sessionInfo.cookieValue,{path:"/"})
}E=this._parseAccountInfoObject(E);
this.accountInfo=E;
if(B&&B.setCookieExpiry&&B.setCookieExpiry==true&&E.data&&E.data.validated=="0"){var x=new Date();
var D=i(".site-header").attr("data-registrationCookieExpiry");
var C=D?D:n;
var z=x.getTime()+(C*24*60*60*1000);
x.setTime(z);
i.cookie(v,JSON.stringify(E),{path:"/",expires:x});
i.cookie(g,x.getTime(),{path:"/",expires:x})
}else{if(i.cookie(g)!=null&&E.data&&E.data.validated=="0"){var y=i.cookie(g);
var A=new Date();
A.setTime(y);
i.cookie(v,JSON.stringify(E),{path:"/",expires:A})
}else{var A=new Date();
var y=-1;
if(E.data&&E.data.subscriptionStatus=="inactive"){y=A.getTime()+(25*365*24*60*60*1000);
A.setTime(y);
i.cookie(v,JSON.stringify(E),{path:"/",expires:A})
}else{if(E.data&&E.data.subscriptionStatus=="active"){y=new Date(E.data.subscriptionExpiry).getTime();
A.setTime(y);
i.cookie(v,JSON.stringify(E),{path:"/",expires:A})
}}}}},updateAccountInfo:function(x){r.getAccountInfo({complete:i.proxy(function(y){this.setAccountInfoCookie(y);
x(y)
},this)})
},_init:function(){r.on("onLogoutGigya",this._onLogoutGigya,this);
this.setUserProperties();
if(this.isLoggedIn){this._refreshLoginToken()
}return this
},setUserProperties:function(){if(!i.cookie(v)){this.isLoggedIn=false;
this.isPremium=false;
this.accountInfo=false;
this.subscriptionSource=false;
if(!e.isEditMode){j.deauthenticate()
}}else{this.isLoggedIn=true;
this.accountInfo=JSON.parse(i.cookie(v));
this.isPremium=(this.accountInfo.data&&this.accountInfo.data.subscriptionStatus&&this.accountInfo.data.subscriptionStatus==="active");
if(this.accountInfo.data&&this.accountInfo.data.subscriptionSource&&this.accountInfo.data.subscriptionSource==="subscriptionSourceApp"){this.subscriptionSource="app"
}else{this.subscriptionSource="web"
}}},_refreshLoginToken:function(){if(!j.hasLoginToken){j.authenticate(this.accountInfo,function(x){if(x.status===403){return
}else{o.location.reload()
}},500)
}else{j.validate(i.proxy(function(x){if(!x){j.deauthenticate();
j.authenticate(this.accountInfo,function(){o.location.reload()
},500)
}},this))
}},_serverStatusCheck:function(z){var x=function(A){if(!A){z(false)
}A.canLogin=A.canLogin==="true";
if(A.canLogin){z(true)
}else{if(A.blockProportion&&Math.random()>A.blockProportion){z(true)
}else{z(false,A)
}}},y=function(A){z(false)
};
if(i.cookie(h)){return z(false)
}i.ajax({dataType:"json",error:y,success:x,type:"GET",url:s})
},_setLoginThrottleCookie:function(y,z){var x=new Date(),B=x.getTime(),A=0;
if(i.cookie(h)){return false
}y=y||0;
z=z||y;
y*=1000;
z*=1000;
if(y===z){x.setTime(B+y)
}else{A=Math.floor(Math.random()*(z-y+1))+y;
x.setTime(B+A)
}i.cookie(h,this._getDigitalTimeFromDate(x),{path:"/",expires:x})
},_getDigitalTimeFromDate:function(y){var x=y.getUTCHours(),z=y.getUTCMinutes();
if(x<10){x=["0",x].join("")
}if(z<10){z=["0",z].join("")
}return[x,z].join(":")
},_parseAccountInfoObject:function(x){return{UID:x.UID,UIDSignature:x.UIDSignature,signatureTimestamp:x.signatureTimestamp,data:{acceptContactF1:x.data.acceptContactF1,acceptContactThirdParty:x.data.acceptContactThirdParty,acceptTerms:x.data.acceptTerms,subscriptionExpiry:x.data.subscriptionExpiry,subscriptionSource:x.data.subscriptionSource,subscriptionStatus:x.data.subscriptionStatus,subscriptionToken:x.data.subscriptionToken,validated:x.data.validated},profile:{country:x.profile.country,email:x.profile.email,firstName:x.profile.firstName,lastName:x.profile.lastName}}
},_onLoginAuthSuccess:function(){this._onLoginAuthComplete()
},_onLoginAuthFail:function(){this._doPageReload=false;
this._onLoginAuthComplete(false)
},_onLoginGigya:function(y){if(y&&y.data&&y.data.validated=="0"){this.setResendEmailInfoCookie(y);
var x=i(".site-header").attr("data-emailvalidationerrorpage");
return o.location=x?x:c
}this.setAccountInfoCookie(y);
this._authLogin()
},setResendEmailInfoCookie:function(x){var y={UID:x.UID,UIDSignature:x.UIDSignature,signatureTimestamp:x.signatureTimestamp};
var z=new Date();
z.setTime(z.getTime()+(p*24*60*60*1000));
i.cookie(q,JSON.stringify(y),{path:"/",expires:z})
},_authLogin:function(){j.authenticate(this.accountInfo,i.proxy(this._onLoginAuthComplete,this))
},_onLoginAuthComplete:function(x){if(x.status===503){t.loginServerBusy();
this._doPageReload=false;
this.logout();
return
}if(this._doPageReload){this._pageReload()
}else{if(!this._doPageReload){if(this._onLoginUrl){o.location=this._onLoginUrl
}else{o.location.reload()
}}}},_onLogoutGigya:function(x){o.location=e.homeUrl
},_pageReload:function(){if(e.queryString.get("pwrt")){e.queryString.remove(["apiKey","pwrt"],true)
}else{o.location.reload()
}}},w.object);
return r?b._init():{}
})(jQuery,fom.modules.gigya,fom.modules.gigyaRaas,fom.modules.mpp,fom.utils.eventDispatcher,fom.modules.modals,fom.utils,fom.tracking,fom.modules.authenticator,window);
fom.modules.premiumOverlay=(function(g,h){var e={},a=false,d={BODY:"body",PREMIUM_CONTENT:".is-premium-content",FREEMIUM_CONTENT:".is-freemium-content"},c={IS_PREMIUM_USER:"is-premium-user",IS_FREEMIUM_USER:"is-freemium-user"},b={CLICK:"click"},f=g(d.BODY);
e.applyTo=function(i){if(h.isLoggedIn){if(h.isPremium){i.addClass(c.IS_PREMIUM_USER)
}else{i.addClass(c.IS_FREEMIUM_USER)
}}};
return e
}(jQuery,fom.modules.user));
fom.modules.autosetprice=(function(f,q,c){var k=f(".autosetprice"),b=["","$","",""],o,h,s,r=f.cookie("CountryCode"),m=function(u){return f.trim(u)
},g=function(w){for(var v=0,u=b.length;
v<u;
v++){s=w.indexOf(b[v]);
if(s>-1){return(w.split(b[v])).slice(-1).pop()
}}},p=function(v,x){var u=g(v)*12,y=g(x),w=(u-y).toFixed(2);
return(x).charAt(s)+w
},d=function(w,x){if(!x){x=k
}var v=c.getPrice(w,"month"),A=c.getPrice(w,"year"),u=m(v.string),y=m(A.string),z=p(v.string,A.string);
if(!x.hasClass("upgrade")){u=f.trim(u).replace(" ","<br/>");
y=f.trim(y).replace(" ","<br/>")
}f(".monthly .price",x).html(u);
f(".yearly .price",x).html(y);
f(".yearly .saved",x).html(z)
},t=function(v,u){if(!u){u=k
}u.find('.country-dropdown .form-input--select option[value="'+v+'"]').prop("selected",true);
u.find(".country-dropdown .form-input--select").trigger("change")
},a=function(){console.error("Failed to load autosetprice")
},e=function(x){if(x){var u=new Date(),y=30,w=x.trim(),v=w;
u.setTime(u.getTime()+(y*24*60*60*1000));
f.cookie("CountryCode",w,{path:"/",expires:u})
}},j=function(w,x){var v=w.find('option[data-iso2="'+x+'"]');
var u=f("select[name='js-country-hidden']");
if(v.length==0&&u){v=u.find('option[data-iso2="'+x+'"]')
}return v
},i=function(w,u){var x=u.trim();
var v=j(w,x);
o="GBP";
h="Other";
if(v.length>0){h=f(v[0]).val();
o=f(v[0]).data("currency")
}else{console.error("Not able to set country and currency")
}if(!w.hasClass("custom")){d(o,w);
t(h,w)
}},n=function(u){for(var v=0;
v<k.length;
v++){var w=f(k[v]);
i(w,u)
}},l=function(){if(!k.length){return
}else{if(!r){q.getISO2().done(function(u){e(u);
n(u)
}).fail(function(){n("GB")
})
}else{n(r)
}}};
f(window).on("load",function(){if(k.length){c.ready({onSuccess:l,onFail:a})
}});
return{setPrice:d}
})(jQuery,fom.utils,fom.modules.mpp);
fom.components.adaptiveimage={config:{mediaQueries:[{name:"thin.medium",src:".img.320.medium.",media:"(min-width: 1px)"},{name:"thin.high",src:".img.320.medium.",media:"(min-width: 320px)"},{name:"thinX2.medium",src:".img.640.medium.",media:"(min-width: 320px)"},{name:"medium.medium",src:".img.768.medium.",media:"(min-width: 768px)"},{name:"mediumX2.medium",src:".img.1536.medium.",media:"(min-width: 768px)"},{name:"wide.medium",src:".img.1024.medium.",media:"(min-width: 1024px)"},{name:"full.medium",src:".img.1920.medium.",media:"(min-width: 1440px)"},{name:"xwide.medium",src:".img.2048.medium.",media:"(min-width: 1921px)"}]}};
(function(d){var b=d.event,a,c;
a=b.special.debouncedresize={setup:function(){d(this).on("resize",a.handler)
},teardown:function(){d(this).off("resize",a.handler)
},handler:function(i,e){var h=this,g=arguments,f=function(){i.type="debouncedresize";
b.dispatch.apply(h,g)
};
if(c){clearTimeout(c)
}e?f():c=setTimeout(f,a.threshold)
},threshold:150}
})(jQuery);
/*! matchMedia() polyfill - Test a CSS media type/query in JS. Authors & copyright (c) 2012: Scott Jehl, Paul Irish, Nicholas Zakas. Dual MIT/BSD license */
if(!window.matchMedia||!(window.matchMedia.toString().indexOf("[native code]")>-1)){window.matchMedia=(function(i,d){var c=i.documentElement,g=c.firstElementChild||c.firstChild,e=i.createElement("body"),a=i.createElement("div");
a.id="mq-test-1";
a.style.cssText="position:absolute;top:-100em";
e.style.background="none";
e.appendChild(a);
var f=function(k){a.innerHTML='&shy;<style media="'+k+'"> #mq-test-1 { width: 42px; }</style>';
c.insertBefore(e,g);
bool=a.offsetWidth===42;
c.removeChild(e);
return{matches:bool,media:k}
},h=function(){var m,k=c.body,l=false;
a.style.cssText="position:absolute;font-size:1em;width:1em";
if(!k){k=l=i.createElement("body");
k.style.background="none"
}k.appendChild(a);
c.insertBefore(k,c.firstChild);
if(l){c.removeChild(k)
}else{k.removeChild(a)
}m=j=parseFloat(a.offsetWidth);
return m
},j,b=f("(min-width: 0px)").matches;
return function(p){if(b){return f(p)
}else{var o=p.match(/\(min\-width[\s]*:[\s]*([\s]*[0-9\.]+)(px|em)[\s]*\)/)&&parseFloat(RegExp.$1)+(RegExp.$2||""),m=p.match(/\(max\-width[\s]*:[\s]*([\s]*[0-9\.]+)(px|em)[\s]*\)/)&&parseFloat(RegExp.$1)+(RegExp.$2||""),q=o===null,l=m===null,k=i.body.offsetWidth,n="em";
if(!!o){o=parseFloat(o)*(o.indexOf(n)>-1?(j||h()):1)
}if(!!m){m=parseFloat(m)*(m.indexOf(n)>-1?(j||h()):1)
}bool=(!q||!l)&&(q||k>=o)&&(l||k<=m);
return{matches:bool,media:p}
}}
}(document))
}(function(c,b){function a(f){var h=fom.components.adaptiveimage.config.mediaQueries,j=h.length,d,g="",e;
for(e=0;
e<j;
e+=1){d=h[e];
g+=('<span data-name="'+d.name+'" data-src="'+d.src+'" data-media="'+d.media+'"></span>')
}f.append(g);
return f
}b.picturefill=function(d){if(typeof d==="undefined"){d=c("body")
}c(".fom-adaptiveimage",d).each(function(){var i=this,j=c(this),h=[],g=j.data("alt")||"",k=j.data("path")||"",m=j.data("extension")||"",l=j.data("suffix")||"",n=j.data("class")||"",e=c("<img/>"),f={};
if(!j.find("span").length){a(j)
}f=c("span[data-media]",i);
if(f.length===0){return
}f.each(function(){var o=c(this).attr("data-media");
if(!o||(b.matchMedia&&b.matchMedia(o).matches)){h.push(this)
}});
if(h.length>0){e.attr({src:k+h.pop().getAttribute("data-src")+m+l,alt:g}).addClass(n)
}j.find("img").remove();
j.prepend(e);
j.find("img").removeAttr("width height")
})
};
c(function(){b.picturefill()
});
c(b).on("debouncedresize",function(){b.picturefill()
})
}(jQuery,this));
fom.components.siteheader=fom.components.siteheader||{};
fom.components.siteheader.views=fom.components.siteheader.views||{};
fom.components.siteheader.views.base=(function(){var d=function(){},e=d.prototype,c={PREMIUM:".premium",NAVIGATION:".navigation-component",BODY:"body"},b={CLICK:"click",OPEN:"menu-open",CLOSE:"menu-close"},a={SITEHEADER_OPEN:"siteheader-open",OPEN:"open",ANIMATE:"animate"};
e.$elements={};
e.animate=true;
e.init=function(){this.cacheElements();
this.setAnimation(this.animate);
this.close();
this.attachListeners()
};
e.cacheElements=function(){this.$elems={premium:$(c.PREMIUM),body:$(c.BODY),navigation:$(c.NAVIGATION)}
};
e.attachListeners=function(){if(!this.$elems.premium.hasClass(a.ANIMATE)){this.clearListeners();
this.$elems.premium.on(b.CLICK,$.proxy(this.toggleMenu,this));
this.$elems.premium.on(b.OPEN,$.proxy(this.onOpenComplete,this));
this.$elems.premium.on(b.CLOSE,$.proxy(this.onCloseComplete,this))
}};
e.clearListeners=function(){if(this.$elems.premium.length>0){if($._data(this.$elems.premium[0],"events")){this.$elems.premium.off(b.CLICK,$.proxy(this.toggleMenu,this));
this.$elems.premium.off(b.OPEN,$.proxy(this.onOpenComplete,this));
this.$elems.premium.off(b.CLOSE,$.proxy(this.onCloseComplete,this))
}}};
e.open=function(){this.$elems.navigation.trigger(b.CLOSE);
this.$elems.premium.trigger(b.OPEN)
};
e.close=function(){this.$elems.premium.trigger(b.CLOSE)
};
e.toggleMenu=function(f){if(this.$elems.premium.hasClass(a.OPEN)){this.close()
}else{this.open()
}};
e.onOpenComplete=function(){this.$elems.premium.addClass(a.OPEN);
this.$elems.body.addClass(a.SITEHEADER_OPEN)
};
e.onCloseComplete=function(){this.$elems.premium.removeClass(a.OPEN);
this.$elems.body.removeClass(a.SITEHEADER_OPEN)
};
e.setAnimation=function(f){if(!f){this.$elems.premium.removeClass(a.ANIMATE)
}else{this.$elems.premium.addClass(a.ANIMATE)
}};
e.destroy=function(){this.clearListeners()
};
return d
})();
fom.components.siteheader=fom.components.siteheader||{};
fom.components.siteheader.views=fom.components.siteheader.views||{};
fom.components.siteheader.views.desktop=(function(c,b){var a=function(){};
a.prototype=c.extend({},new b());
return a
})(jQuery,fom.components.siteheader.views.base);
fom.components.siteheader=fom.components.siteheader||{};
fom.components.siteheader.views=fom.components.siteheader.views||{};
fom.components.siteheader.views.mobile=(function(c,a){var b=function(){};
b.prototype=c.extend(new a(),{animate:false});
return b
})(jQuery,fom.components.siteheader.views.base);
fom.components.siteheader=(function(e,i,f,c,d,h,a){var j={HOLDER:".site-header",ACCESS_TOGGLE:".f1-access-toggle",PREMIUM:".premium",PREMIUM_EXPAND:".premium-expanded",SIGN_IN:".sign-in",SIGN_OUT:".sign-out",USERNAME:".username"},b={IS_VISIBLE:"is-visible",IS_SIGNED_IN:"is-signed-in",IS_PREMIUM_CONTENT:"is-premium-content",IS_LIVE_SESSION:"is-live-session",OPEN:"open",ANIMATE:"animate",SITEHEADER_OPEN:"siteheader-open"},g={},k={init:function(){if(this.cacheElements()){this.initPremium();
this.switchView();
this.attachListeners()
}return this
},cacheElements:function(){var l=e(j.HOLDER);
if(l.length<=0){return false
}return this._elements={$holder:l,$premium:l.find(j.PREMIUM),$username:l.find(j.USERNAME)}
},initPremium:function(){this._elements.$premium.addClass(b.IS_VISIBLE);
if(i.isLoggedIn){this._elements.$premium.addClass(b.IS_SIGNED_IN);
this._elements.$username.text(i.accountInfo.profile.firstName)
}if(i.isPremium){this._elements.$premium.addClass(b.IS_PREMIUM_CONTENT)
}if(i.isLiveSession){this._elements.$premium.addClass(b.IS_LIVE_SESSION)
}},attachListeners:function(){this._elements.$holder.on("click",j.SIGN_IN,e.proxy(this.onSignInClick,this));
this._elements.$holder.on("click",j.SIGN_OUT,e.proxy(this.onSignOutClick,this));
c.on("change",this.switchView,this);
var l=e(this._elements.$holder).data("blacklistcountrypage");
e(".invalid-country a").attr("href",l)
},onSignInClick:function(l){l.preventDefault();
i.login()
},onSignOutClick:function(l){l.preventDefault();
i.logout()
},switchView:function(){var l=a.width();
if(g&&g.destroy){g.destroy()
}if(l>1024){g=new h();
g.init()
}else{g=new d();
g.init()
}}};
return k.init()
})(jQuery,fom.modules.user,fom.modules.gigya,fom.utils.resizeManager,fom.components.siteheader.views.mobile,fom.components.siteheader.views.desktop,$(window));
fom.components.searchbar=(function(c,b,d){var a=[],f={};
f.OPEN_CLASS="open";
f.selectors={COMPONENT:".searchbar",TOGGLE:".navigation-toggle--search",FORM:".searchbar-form",INPUT:".searchbar-form-input",SUBMIT:".searchbar-form-submit"};
f.init=function(g){this._$holder=c(g);
this._$toggle=this._$holder.find(this.selectors.TOGGLE);
this._$form=this._$holder.find(this.selectors.FORM);
this._$input=this._$holder.find(this.selectors.INPUT);
this._$submit=this._$holder.find(this.selectors.SUBMIT);
this.attachListeners()
};
f.attachListeners=function(){this._$holder.on("click"+this.selectors.TOGGLE,this.selectors.TOGGLE,c.proxy(this.onToggleClick,this));
this._$input.on("keyup blur",c.proxy(this.validateInputField,this))
};
f.validateInputField=function(){var g=this._$input.val().length,h=(g>=2);
if(h){this._$submit.removeProp("disabled")
}else{this._$submit.prop("disabled","disabled")
}};
f.onToggleClick=function(){if(this._$holder.hasClass(this.OPEN_CLASS)){return this.close()
}this.open()
};
f.open=function(){this.onOpen(c.proxy(function(){this.isOpen=true;
this._$holder.addClass(this.OPEN_CLASS)
},this))
};
f.onOpen=function(g){g()
};
f.close=function(){var g=c.proxy(function(){this._$holder.off(b.CONST.TRANSITION_END_EVENT);
this.isOpen=false;
if(this.onCloseComplete){this.onCloseComplete();
this.onCloseComplete=undefined
}},this);
if(d.csstransitions){this._$holder.on(b.CONST.TRANSITION_END_EVENT,g)
}else{g()
}this._$holder.removeClass(this.OPEN_CLASS);
this._$toggle.blur()
};
(function e(){c(f.selectors.COMPONENT).each(function(h,i){var g=c.extend({},f);
g.init(i);
a.push(g)
})
})();
return a[0]
})(jQuery,fom.utils,Modernizr);
fom.components.cookieNotification=(function(h,q,b,d,e){var m={COOKIE_NOTIFICATION_DELAY:2000,COOKIE_NAME:"cookies_accepted"},f=b("#cookie-notification-wrapper"),i=b(f).data("version"),o=b(".site-header"),a=b(".page-header"),r=a.find(".breadcrumb"),l=b(".site-header-navigation"),c=false,g=function(){b("body").trigger("notifyNavOfScreenChange")
},k=function(){f.remove();
g()
},j=function(){b.cookie(m.COOKIE_NAME,i,{expires:364,path:"/",})
},n=function(){var s=b.cookie(m.COOKIE_NAME);
if(!b.cookie(m.COOKIE_NAME)||s!=i){b("body").prepend(f);
h.setTimeout(function(){if(!e.csstransitions){f.css({display:"block"});
f.css({marginTop:-(f.outerHeight())+"px"});
f.animate({marginTop:0},{duration:"slow",complete:g})
}else{f.css({display:"block",position:"absolute"});
f.css({marginTop:-(f.outerHeight())+"px"});
f.one(q.CONST.TRANSITION_END_EVENT,g);
setTimeout(function(){f.attr("style","display: block");
f.addClass("animate show-cookie")
},1)
}},m.COOKIE_NOTIFICATION_DELAY)
}else{b.removeCookie(m.COOKIE_NAME,{path:"/"});
j();
return f.remove()
}b(".close-notification").click(function(t){t.preventDefault();
if(!e.csstransitions){f.animate({marginTop:-(f.outerHeight())+"px"},{duration:"slow",complete:k})
}else{f.css({marginTop:-(f.outerHeight())+"px"});
f.one(q.CONST.TRANSITION_END_EVENT,k)
}j()
})
},p=function(){c=true
};
b(h).on("load",function(){if(!c){n()
}});
return{disableCookie:p}
}(window,fom.utils,jQuery,fom.utils.resizeManager,Modernizr));
fom.components.login=(function(d,g,f,c,a){var b={COMPONENT:".login-component"},e={init:function(){if(!this.cacheElements()){return false
}if(!a){setTimeout(d.proxy(function(){this.init()
},this),1000);
return
}if(g.isLoggedIn){g.logout(this.onReady)
}else{f.deauthenticate();
this.onReady()
}return this
},onReady:function(){var h=c.getQueryStringVariable(window.location.href,"resource")||c.homeUrl;
h=decodeURIComponent(h);
setTimeout(function(){g.login(false,{},h,function(){window.location=c.homeUrl
})
},500)
},cacheElements:function(){var h=d(b.COMPONENT);
if(!h.length){return false
}return this._elements={$component:h}
}};
e.init();
return e
})(jQuery,fom.modules.user,fom.modules.authenticator,fom.utils,window.gigya);
fom.components.navigation||(fom.components.navigation={});
fom.components.navigation.BaseView=(function(c,b){var a={OPEN_SPEED:500,OPEN_CLASS:"open",EXPANDABLE_CLASS:"expandable",selectors:{COMPONENT:".navigation-component",PREMIUM:".premium",NAVIGATION_WRAP:".navigation-list-wrap",MOBILE_WRAP:".navigation-wrap",PARENT_LIST:".navigation-list--parent",PARENT_ITEM:".navigation-list-item--parent",PARENT_LINK:".navigation-list-link--parent",CHILD_WRAP:".navigation-list-wrap--child",CHILD_LIST:".navigation-list--child",CHILD_ITEM:".navigation-list-item--child",CHILD_LINK:".navigation-list-link--child",MENU_TOGGLE:".navigation-toggle--nav",SEARCH_TOGGLE:".navigation-toggle--search"}};
a.init=function(d,e){this._$holder=c(d);
this._$menuToggle=this._$holder.find(this.selectors.MENU_TOGGLE);
this._$navigation=this._$holder.find(this.selectors.MOBILE_WRAP);
this._$body=c("body");
this._$html=c("html");
this._openOnHover=!b.isTouch;
if(!e){this.cacheElements()
}else{this._elements=e
}this.attachListeners()
};
a.cacheElements=function(){var d;
this._elements=[];
d=c.proxy(function(e,f){var g=c(f);
return{$firstLevelItem:g,$firstLevelLink:g.find(this.selectors.PARENT_LINK),$secondLevelWrap:g.find(this.selectors.CHILD_WRAP)}
},this);
this._elements=this._$holder.find(this.selectors.PARENT_ITEM).map(d)
};
a.attachListeners=function(){throw new Error("fom.components.navigation.BaseView.attachListeners() should be overidden")
};
a.close=function(e,d){this._currentlyOpen=undefined;
this._currentlyClosing=e;
if(this.onClose){this.onClose(e)
}};
a.open=function(e,d){if(e.$secondLevelWrap.length<=0){return true
}if(this.onShow){this.onShow(e)
}this._currentlyOpen=e
};
a.onFirstLevelClick=function(d){var e=this.getMenuItemFromFirstLevelLink(d.target);
if(e.$secondLevelWrap.length>0){if(this._currentlyOpen){if(this._currentlyOpen===e){this.close(e)
}else{this.close(this._currentlyOpen,c.proxy(this.open,this,e))
}}else{this.open(e)
}d.preventDefault();
d.stopPropagation();
return false
}return true
};
a.getMenuItemFromFirstLevelLink=function(e){var d=this._elements.length;
while(d--){if(this._elements[d].$firstLevelLink[0]===e){return this._elements[d]
}}};
a.getMenuItemFromSecondLevelWrap=function(e){var d=this._elements.length;
while(d--){if(this._elements[d].$secondLevelWrap[0]===e){return this._elements[d]
}}};
a.destroy=function(){this._$holder.off(this.selectors.PARENT_LINK);
this._$holder.off(this.selectors.PARENT_ITEM)
};
return a
})(jQuery,fom.utils);
fom.components.navigation||(fom.components.navigation={});
fom.components.navigation.NarrowView=(function(d,f,e,c){var a=f.extend({ACTIVE_CLASS:"active",BODY_MENU_OPEN_CLASS:"main-navigation-open",MENU_ITEM_IS_EXPANDED:"menu-item-is-expanded",EXPANDED:"expanded",REFRESH_RATE:100},d),b=0;
a.init=function(g,h){d.init.call(this,g,h);
this._isOpen=false
};
a.attachListeners=function(){this._$holder.on("menu-open",f.proxy(this.openMenu,this));
this._$holder.on("menu-close",f.proxy(this.closeMenu,this));
this._$holder.on("click"+this.selectors.MENU_TOGGLE,this.selectors.MENU_TOGGLE,f.proxy(this.onHamburgerClick,this));
this._$holder.on("click"+this.selectors.PARENT_LINK,"."+this.EXPANDABLE_CLASS+" "+this.selectors.PARENT_LINK,f.proxy(this.onFirstLevelClick,this))
};
a.onHamburgerClick=function(g){this._$holder.off(e.CONST.TRANSITION_END_EVENT);
this._$navigation.css("opacity","");
if(this._isOpen){this._$holder.trigger("menu-close")
}else{this._$holder.trigger("menu-open")
}};
a.resizeScrollArea=function(){var g=20+this._$navigation.offset().top;
this._elements[this._elements.length-1].$firstLevelItem.css("paddingBottom",g)
};
a.openMenu=function(){var h=f(window).width(),g=f(this.selectors.PREMIUM);
this.resizeScrollArea();
this._$body.on("notifyNavOfScreenChange",f.proxy(function(i){this.resizeScrollArea()
},this));
this._isOpen=true;
this._$menuToggle.addClass(this.ACTIVE_CLASS);
this._$holder.on(e.CONST.TRANSITION_END_EVENT,f.proxy(function(i){if(i.target!==this._$navigation[0]){return
}this._$holder.off(e.CONST.TRANSITION_END_EVENT);
this._$body.addClass(this.BODY_MENU_OPEN_CLASS);
b=this._$body.scrollTop();
this._$body.css({width:h+"px",top:-b+"px"})
},this));
this._$navigation.addClass(this.OPEN_CLASS);
this.windowResized=e.debounce(this.windowResized,this.REFRESH_RATE);
c.on(c.events.RESIZE,this.windowResized,this);
this.windowResized();
g.removeClass(this.OPEN_CLASS)
};
a.closeMenu=function(g){this._isOpen=false;
this._$menuToggle.removeClass(this.ACTIVE_CLASS);
if(g){return this.onCloseMenuComplete()
}this._$holder.on(e.CONST.TRANSITION_END_EVENT,f.proxy(function(h){if(h.target!==this._$navigation[0]){return
}this.onCloseMenuComplete()
},this));
this._$navigation.css("opacity","0")
};
a.onCloseMenuComplete=function(){this._$holder.off(e.CONST.TRANSITION_END_EVENT);
if(this._currentlyOpen){this._currentlyOpen.$secondLevelWrap.removeClass(this.OPEN_CLASS).css("max-height","").css("opacity","")
}this._$body.removeClass(this.BODY_MENU_OPEN_CLASS);
this._$navigation.removeClass(this.OPEN_CLASS).css("opacity","");
c.off(c.events.RESIZE,this.windowResized);
this.closeParents();
this._$body.scrollTop(b);
this._$body.attr("style","");
this._$body.off("notifyNavOfScreenChange")
};
a.close=function(i,h){var j=f.proxy(function(){this._currentlyClosing=undefined;
i.$secondLevelWrap.removeClass(this.OPEN_CLASS).css("max-height","").css("opacity","");
if(h){h()
}},this),g=i.$firstLevelItem.parent();
d.close.call(this,i,h);
i.$secondLevelWrap.css("max-height",i.$secondLevelWrap[0].scrollHeight+"px");
i.$secondLevelWrap.animate({"max-height":0,opacity:0},j);
i.$firstLevelItem.removeClass(this.EXPANDED);
g.removeClass(this.MENU_ITEM_IS_EXPANDED)
};
a.open=function(j,i){var h=f.proxy(function(){j.$secondLevelWrap.addClass(this.OPEN_CLASS).css("max-height","").css("opacity","")
},this),g=j.$firstLevelItem.parent();
d.open.call(this,j,i);
j.$secondLevelWrap.animate({"max-height":j.$secondLevelWrap[0].scrollHeight+"px",opacity:1},h);
j.$firstLevelItem.addClass(this.EXPANDED);
g.addClass(this.MENU_ITEM_IS_EXPANDED)
};
a.closeParents=function(){var g;
if(this._currentlyOpen){g=this._currentlyOpen.$firstLevelItem.parent();
this._currentlyOpen.$secondLevelWrap.removeClass(this.OPEN_CLASS).css("max-height","").css("opacity","");
this._currentlyOpen.$firstLevelItem.removeClass(this.EXPANDED);
g.removeClass(this.MENU_ITEM_IS_EXPANDED);
this._currentlyOpen=undefined
}};
a.destroy=function(){d.destroy.call(this);
this._$holder.off(this.selectors.MENU_TOGGLE);
this._$holder.off(e.CONST.TRANSITION_END_EVENT);
this.closeParents();
this.closeMenu(true)
};
a.windowResized=function(){var g=f(window).width();
if(!e.hasCssvhunit){this._$navigation.css({height:f(window).height()+"px"})
}this._$body.css({width:g+"px"})
};
return a
})(fom.components.navigation.BaseView,jQuery,fom.utils,fom.utils.resizeManager);
fom.components.navigation||(fom.components.navigation={});
fom.components.navigation.MediumView=(function(a,c,b,e){var d=c.extend({ACTIVE_CLASS:"active",MENU_ITEM_IS_EXPANDED:"menu-item-is-expanded",EXPANDED:"expanded"},a);
d.init=function(f,g){a.init.call(this,f,g);
e.onOpen=c.proxy(this.onSearchBarOpen,this)
};
d.attachListeners=function(){this._$body.on("click"+this.selectors.COMPONENT,c.proxy(this.onBodyClick,this));
if(this._openOnHover){this.attachHoverListeners()
}else{this.attachClickListeners()
}};
d.attachHoverListeners=function(){this._$holder.on("mouseleave"+this.selectors.PARENT_ITEM,this.selectors.PARENT_ITEM,c.proxy(this.onFirstLevelMouseOut,this));
this._$holder.on("mouseenter"+this.selectors.PARENT_LINK,this.selectors.PARENT_LINK,c.proxy(this.onFirstLevelMouseOver,this))
};
d.attachClickListeners=function(){this._$holder.on("click"+this.selectors.PARENT_LINK,this.selectors.PARENT_LINK,c.proxy(this.onFirstLevelClick,this))
};
d.onBodyClick=function(f){if(this._editMode||c(f.target).parents(this.selectors.COMPONENT).length>0){return
}if(this._currentlyOpen){this.close(this._currentlyOpen)
}else{if(e.isOpen){e.close()
}}};
d.onFirstLevelMouseOut=function(f){if(this._currentlyOpen){this.close(this._currentlyOpen)
}};
d.onSearchBarOpen=function(f){if(this._currentlyOpen){this.close(this._currentlyOpen,f)
}else{f()
}};
d.onFirstLevelMouseOver=function(f){var g=this.getMenuItemFromFirstLevelLink(f.target);
if(g.$secondLevelWrap.length>0){if(this._currentlyClosing){this.onItemCloseComplete=c.proxy(this.open,this,g)
}else{this.open(g)
}}};
d.open=function(h,g){a.open.call(this,h,g);
var f=c.proxy(function(){this.onItemCloseComplete=undefined;
h.$secondLevelWrap.stop().animate({height:h.$secondLevelWrap[0].scrollHeight+"px"},250,c.proxy(this.onTransitionComplete,this,h.$secondLevelWrap,g))
},this);
h.$firstLevelItem.addClass(this.ACTIVE_CLASS);
h.$firstLevelItem.addClass(this.EXPANDED).parent().addClass(this.MENU_ITEM_IS_EXPANDED);
if(this._currentlyClosing){return
}if(e.isOpen){e.onCloseComplete=c.proxy(f,this);
e.close()
}else{f()
}};
d.close=function(g,f){a.close.call(this,g,f);
g.$firstLevelItem.removeClass(this.ACTIVE_CLASS);
g.$secondLevelWrap.stop().css("height",g.$secondLevelWrap.height()+"px").animate({height:"0"},250,c.proxy(this.onTransitionComplete,this,g.$secondLevelWrap,f));
g.$firstLevelItem.removeClass(this.EXPANDED).parent().removeClass(this.MENU_ITEM_IS_EXPANDED)
};
d.onTransitionComplete=function(f,h){var g;
if(f){f.css("height","");
f.css("opacity","")
}if(this._currentlyOpen){this._currentlyOpen.$firstLevelItem.addClass(this.OPEN_CLASS);
this._currentlyOpen.$secondLevelWrap.addClass(this.OPEN_CLASS)
}else{g=this._currentlyClosing;
g.$firstLevelItem.removeClass(this.OPEN_CLASS);
g.$secondLevelWrap.removeClass(this.OPEN_CLASS)
}if(this._currentlyClosing){this._currentlyClosing=undefined;
if(this.onItemCloseComplete){this.onItemCloseComplete()
}}if(h){h()
}};
d.destroy=function(){a.destroy.call(this);
this._$body.off(this.selectors.COMPONENT);
if(this._currentlyOpen){this._currentlyOpen.$secondLevelWrap.removeClass(this.OPEN_CLASS).css("height","");
this._currentlyOpen.$firstLevelItem.removeClass([this.ACTIVE_CLASS,this.OPEN_CLASS,this.EXPANDED].join(" ")).parent().removeClass(this.MENU_ITEM_IS_EXPANDED)
}};
return d
})(fom.components.navigation.BaseView,jQuery,fom.utils,fom.components.searchbar);
fom.components.navigation||(fom.components.navigation={});
fom.components.navigation.controller=(function(c,b){var a={events:{VIEW_CHANGE:"viewChange"},selectors:{COMPONENT:".navigation-component"}};
a.init=function(){var e=this.getView(),d,f;
this._components=[];
f=c.proxy(function(g,h){d=c.extend({},e);
d.init(h);
this._components.push({view:d,element:h})
},this);
c(this.selectors.COMPONENT).each(f);
b.on(b.events.CHANGE,this.updateViews,this);
return this
};
a.updateViews=function(){var f=this._components.length,g=this.getView(),e,h,d;
while(f--){d=this._components[f];
e=d.view;
h=c.extend({},g);
e.destroy();
h.init(d.element);
this._components[f].view=h
}this.trigger(this.events.VIEW_CHANGE)
};
a.getView=function(){switch(b.size){case b.sizes.NARROW:return fom.components.navigation.NarrowView;
default:return fom.components.navigation.MediumView
}};
a.on=function(f,e,d){this._events=this._events||[];
if(!this._events[f]){this._events[f]=[]
}this._events[f].push({handler:e,scope:d})
};
a.trigger=function(e){var d=0;
if(!this._events||!this._events[e]){return
}d=this._events[e].length;
while(d--){this._events[e][d].handler.call(this._events[e][d].scope)
}};
return a.init()
})(jQuery,fom.utils.resizeManager);
fom.components.pageHeaderImage=(function(b){var a=b(".page-header-image");
a.find(".parallax").simpleParallax({scrollFactor:0.5,bg:false});
return{}
})(jQuery);
(function(k,j,e,d,g,i,c){var f=g(),h=".advertisingimage picture",l=".advertisingimage .advertisingimage-link",a;
function b(o){a.map(function(){var r=e("source[data-viewport="+o+"]",this).attr("srcset"),p=e("img",this),q=p.attr("src");
if(q!==r){return p.attr("src",r)
}})
}function n(){var o=e(l);
o.on("click",function(p){c.fireCustomEvent("adClicked")
})
}function m(){a=e(h);
if(a.length>0){n();
if(!i.hasPictureElement){b(d.size);
d.on(d.events.CHANGE,b)
}}}m();
f.update(h,function(){m()
})
}(window,window.document,jQuery,fom.utils.resizeManager,fom.utils.adobeCampaignManager,fom.utils,fom.tracking));
(function(j,d,r,l,f){var h=l(),m={component:".advertisingimageextended",ad:{img:".img-advert",swf:".swf-advert"},swf:"div.swf-target",img:{expanded:".expanded-image",minimised:".minimised-image"},iconlink:".adcontrol",adlinks:".img-advert, .swf-link"},k={ad:{opened:"opened"},icon:{open:"expand",close:"collapse"}},b={version:"16.0.0",params:{menu:"false",wmode:"transparent",allowFullScreen:"false"},attributes:{styleclass:"swf-target",align:"center"}},p;
function c(A){var w={},y,z,v,x;
y=(A&&typeof(A)==="string")?A.split(","):"";
v=y.length;
if(v>0){for(x=0;
x<v;
x+=1){z=y[x].split(":");
w[z[0]]=z[1]
}}return w
}function e(v){if(v===r.sizes.WIDE){d(m.component).map(function(){var z=d(m.swf,this),x=c(z.data("attrs")),y=z.data("width"),w=z.data("height");
swfobject.embedSWF(z.data("src"),z.attr("id"),y,w,b.version,null,x,b.params,b.attributes)
})
}}function a(){p.map(function(){d(m.img.expanded+","+m.img.minimised,this).addClass("desktop-flash")
})
}function t(v){if(v.hasClass("swf-link")){return v.closest(m.component).find(m.ad.swf+","+m.ad.img)
}return v
}function q(v){t(v).addClass(k.ad.opened);
f.fireCustomEvent("extendedAdOpened")
}function u(v){t(v).removeClass(k.ad.opened);
f.fireCustomEvent("extendedAdClosed")
}function n(v){return t(v).hasClass(k.ad.opened)
}function i(v){if(v.hasClass(k.icon.open)){v.removeClass(k.icon.open).addClass(k.icon.close)
}else{v.addClass(k.icon.open).removeClass(k.icon.close)
}}function o(){var v=d(m.iconlink,p),x,w;
v.on("click",function(y){x=d(this);
w=x.closest(m.component).find(m.adlinks);
y.preventDefault();
i(x);
if(n(w)){u(w)
}else{q(w)
}})
}function g(){var x=d(m.adlinks,p),w,v;
x.on("click",function(y){w=d(this);
v=w.closest(m.component).find(m.iconlink);
if(!n(w)){y.preventDefault();
q(w);
i(v)
}else{f.fireCustomEvent("extendedAdClicked")
}})
}function s(v){p=(v)?d(m.component,v):d(m.component);
if(p.length>0){o();
g();
if(d(m.swf,p).length>0){a();
if(j.swfobject&&j.swfobject.getFlashPlayerVersion().major>0){e(r.size);
r.on(r.events.CHANGE,e)
}}}}s();
h.update(m.component,function(){s(h.elements)
})
}(window,jQuery,fom.utils.resizeManager,fom.utils.adobeCampaignManager,fom.tracking));
fom.components.countryDropdown=(function(d,g,f,b){var c=function(){},a=function(){};
c.prototype=new f.eventDispatcher.prototypal();
c.prototype.selectors={HOLDER:".country-dropdown",SELECT:".form-input--select",INVALID_COUNTRY:".invalid-country"};
c.prototype.classes={HIDE:"hide",ERROR:"error",OTHER:"Other"};
c.prototype.events={CHANGE:"change",INVALID_COUNTRY_SELECT:"invalidCountry"};
c.prototype.init=function(h){this.cacheElements(h);
this.attachListeners();
return this
};
c.prototype.cacheElements=function(h){var i=g(h);
this._elements={$holder:i,$select:i.find(this.selectors.SELECT),$error:i.find(this.selectors.INVALID_COUNTRY)}
};
c.prototype.attachListeners=function(){this._elements.$select.on("onchange change",g.proxy(this.onCountryChange,this))
};
c.prototype.onCountryChange=function(){var h=this._elements.$select.find(":selected").data("currency");
this.trigger(this.events.CHANGE,[h]);
if(this._elements.$select.val()===this.classes.OTHER){this.trigger(this.events.INVALID_COUNTRY_SELECT);
this._elements.$select.parent().addClass(this.classes.ERROR);
this._elements.$error.removeClass(this.classes.HIDE);
if(g(".template-registration-forms").length>0){this._elements.$select.parent().parent().addClass(this.classes.ERROR)
}}else{this._elements.$error.addClass(this.classes.HIDE);
if(g(".template-registration-forms").length>0){this._elements.$select.parent().removeClass(this.classes.ERROR);
this._elements.$select.parent().parent().removeClass(this.classes.ERROR)
}}};
a.prototype=new f.eventDispatcher.prototypal();
a.prototype.init=function(){var i=g(c.prototype.selectors.HOLDER),h=function(){this.onCountryDropdownChange(dropdown)
},j=function(l){var m=g(c.prototype.selectors.HOLDER),n=[];
m.each(g.proxy(function(o,p){var q=new c();
q.on(c.prototype.events.CHANGE,g.proxy(function(){this.onCountryDropdownChange(q)
},this),this);
q.on(c.prototype.events.INVALID_COUNTRY_SELECT,g.proxy(function(){this.onInvalidCountrySelect()
},this),this);
q.init(p);
n.push(q)
},this));
this._controllers=n;
if(this._initPriceCallback){this.onPriceInit(this._initPriceCallback);
this._initPriceCallback=null
}},k=function(l){if(this._initPriceCallback){this.onPriceInit(this._initPriceCallback);
this._initPriceCallback=null
}};
if(i.length>0){b.ready({onSuccess:g.proxy(j,this),onFail:g.proxy(k,this)})
}return this
};
a.prototype.onInvalidCountrySelect=function(){this.trigger(c.prototype.events.INVALID_COUNTRY_SELECT)
};
a.prototype.onCountryDropdownChange=function(l){var m={currency:e(l),target:l},k=l._elements.$select.val(),j=this._controllers.length,h={};
this.trigger(c.prototype.events.CHANGE,[m])
};
a.prototype.onPriceInit=function(h){if(this._controllers&&this._controllers.length>0){b.ready({onSuccess:g.proxy(function(){h({currency:e(this._controllers[0]),target:this._controllers[0]})
},this),onFail:g.proxy(function(){},this)})
}else{this._initPriceCallback=h
}};
function e(h){return h._elements.$select.find(":selected").data("currency")
}return new a().init()
})(fom.components,jQuery,fom.utils,fom.modules.mpp);
fom.components.manualGallery=(function(c,g){var e={autoplay:0,changeSpeed:500,easing:"linear",previewSpeed:500,previewWidth:90,loop:true,isAdBlock:false};
function b(L,h){var N=200;
var Q=0;
var A=false;
var u=false;
var i={};
var M;
var l={};
var m={};
var k={};
var t={};
var T={};
var o={};
function H(W){var V=W.length;
if(V>1){L.addClass("multi-image")
}else{L.addClass("single-image")
}return V
}function O(){var W={};
var X={};
var V=0;
W=L.find(".gallery-descriptions-container");
X=W.find(".gallery-description");
setTimeout(function(){X.each(function(){var Y=$(this).height();
if(Y>V){V=Y
}});
W.height(V)
},1)
}function n(){if(!U()&&z()){R()
}E();
O()
}function C(){y()
}function s(V){V.preventDefault();
if(A){return
}A=true;
M.stopAutoplay();
if($(V.target).hasClass("gallery-next")){M.swipeNext()
}else{M.swipePrev()
}}function v(W){var V=$(W.target);
if(!V.hasClass("mousein")){V.addClass("mousein");
i=setTimeout(function(){K(V.hasClass("gallery-next"))
},N)
}}function G(W){var V=$(W.target);
clearTimeout(i);
if(V.hasClass("mousein")){V.removeClass("mousein");
r()
}}function E(){var V=0;
var X=16/9;
var W=0;
W=l.width();
V=Math.floor(W/X);
l.css("height",V);
if(T.length){T.css("height",V)
}if(M){M.resizeFix();
I()
}}function y(V){m=o.children(".swiper-slide");
m.each(function(){var Y=0;
var X=0;
var W=0;
var aa=0;
var Z={};
var ab=$(this);
if(V||typeof ab.data("adjusted")==="undefined"){Z=ab.children(".image");
W=parseInt(ab.height(),10);
Y=parseInt(Z.data("height"),10);
X=parseInt(Z.data("width"),10);
if(X>Y){ab.addClass("landscape");
if(!c.hasCssTransitions){aa=-Math.round(W/4);
Z.css(aa,aa+"px")
}}else{ab.addClass("portrait")
}ab.data("adjusted",aa)
}})
}function D(){var V=0;
m.children(".image").each(function(){var W=$(this);
V=parseInt(W.data("width"),10)/parseInt(W.data("height"),10);
if(V>1){W.css("width",l.width()+"px")
}else{W.css("height",l.height()+"px")
}});
if(M){M.resizeFix()
}}function J(){A=true;
S();
if(!c.hasCssTransitions()){o.animate({marginLeft:0},h.previewSpeed)
}}function x(){I();
M.startAutoplay();
A=false;
setTimeout(function(){if(A){return
}if(k.filter(".gallery-next").hasClass("mousein")){K(true)
}if(k.filter(".gallery-prev").hasClass("mousein")){K(false)
}},150)
}function S(){var X={};
var W={};
var V={};
X=L.find(".gallery-caption");
X.find(".current-image-num").text(M.activeLoopIndex+1);
V=X.find(".gallery-description");
if(V.length){V.removeClass("current").addClass("hidden");
W=V.eq(M.activeLoopIndex);
W.removeClass("hidden");
window.requestAnimationFrame(function(){setTimeout(function(){W.addClass("current")
},0)
})
}}function I(){Q=M.getWrapperTranslate("x")
}function q(V,W){V.css("transition-duration",W+"ms")
}function z(){return $("main").hasClass("go-full-width")
}function U(){return(!L.hasClass("breakout-none"))
}function R(){var X=1440;
var W=0;
var Z=L.find(".swiper-container");
var V=$("html");
var Y=$(window);
W=Math.min(Y.width(),X);
T=L.find(".image-placeholder");
if(!T.length){T=$('<div class="image-placeholder"></div>')
}Z.addClass("full-width");
if($("main").hasClass("template-informationfeature")||$("main").hasClass("template-feature")||$("main").hasClass("template-article")){Z.css("width","100%")
}else{Z.css("width",W)
}if(V.hasClass("lt-ie10")){Z.css({marginLeft:-Math.ceil(W/2)+"px","ms-transform":"translate(0,0)"})
}T.css("height",Z.height());
Z.after(T)
}function F(X){var W={};
var V=$(M.activeSlide());
W=(!X)?V.prev():V.next();
if(!W.length){M.swipeTo(M.activeLoopIndex,0,false);
I()
}}function K(X){var Y=0;
var V={};
var W={};
if(A){return
}M.stopAutoplay();
M.resizeFix();
I();
F(X);
Y=(X)?-h.previewWidth:h.previewWidth;
if(c.hasCssTransitions()){Y+=Q;
q(o,h.previewSpeed);
o.one(c.getTransitionEndEventName(),function(){q(o,0)
});
M.setWrapperTranslate(Y)
}else{o.animate({marginLeft:Y+"px"},h.previewSpeed)
}}function r(V){if(A){return
}M.setWrapperTranslate(Q);
if(c.hasCssTransitions()){q(o,h.previewSpeed);
o.one(c.getTransitionEndEventName(),function(){q(o,0);
M.startAutoplay()
})
}else{o.animate({marginLeft:0},h.previewSpeed,function(){M.startAutoplay()
})
}}function w(){c.resizeManager.on(c.resizeManager.events.RESIZE,function(){n();
y(true);
D()
})
}function p(){t.on("play",M.startAutoplay);
t.on("stop",M.stopAutoplay);
t.on("caption",O)
}function B(){var V=L.find(".gallery-enlarge");
if(k.length){k.on("click",s);
if(!c.isTouch){k.on({mouseover:v,mouseout:G})
}}if(h.enlarge){V.on("click",function(W){W.preventDefault();
if(M){t.trigger("open-modal",M.activeLoopIndex)
}else{t.trigger("open-modal",1)
}})
}else{V.remove()
}}function j(){t=L.parent(".manual-gallery");
l=L.find(".swiper-container");
o=l.find(".swiper-wrapper");
m=o.children(".swiper-slide");
k=l.children(".gallery-next, .gallery-prev")
}function P(){var V=0;
j();
V=H(m);
if(V>1){u=true;
M=new Swiper(l[0],{autoplay:h.autoplay,mode:"horizontal",keyboardControl:true,loop:(V>1)?h.loop:false,onSlideChangeEnd:x,onSlideChangeStart:J,simulateTouch:false,speed:h.changeSpeed});
I();
p()
}else{u=false
}n();
D();
C();
B();
w()
}P();
return $.extend(M,{isCarousel:u,updateGalleryCaption:S,updateCarouselPosition:I})
}function a(j,z){var i={};
var u=$("body");
var n={};
var l={};
var v={};
var w={};
var s={};
function C(){w.find("picture div").each(function(){var D={};
$.each($(this)[0].attributes,function(F,E){D[E.nodeName]=E.value||E.nodeValue
});
$(this).replaceWith(function(){D.text=$(this).text();
return $("<source />",D)
})
})
}function t(D){if(i.isCarousel){i.swipeTo(D,0,false);
i.updateGalleryCaption();
j.one(c.getTransitionEndEventName(),function(){i.updateCarouselPosition()
}).addClass("gallery-modal-open")
}else{j.addClass("gallery-modal-open")
}setTimeout(function(){j.addClass("gallery-mobile-open-animate")
},1)
}function q(E,D){s.trigger("stop");
t(D);
u.addClass("modal_active")
}function r(D){if(D&&D.preventDefault){D.preventDefault()
}j.removeClass("gallery-modal-open gallery-mobile-open-animate");
s.trigger("start");
u.removeClass("modal_active")
}function A(D){if(D&&D.preventDefault){D.preventDefault()
}if(v.hasClass("icon-info-off")){v.addClass("icon-info-on").removeClass("icon-info-off");
s.trigger("caption");
n.addClass("visible")
}else{v.addClass("icon-info-off").removeClass("icon-info-on");
n.removeClass("visible")
}}function m(){if(c.resizeManager.isNarrow()){y()
}else{p()
}}function p(){var D=w.find(".gallery-modal-wrapper");
l.prependTo(D);
n.appendTo(D)
}function y(){l.prependTo(w);
n.appendTo(j)
}function h(){w=j.find(".gallery-modal-container");
n=w.find(".gallery-caption");
l=w.find(".gallery-modal-close-link");
v=w.find(".gallery-modal-info-link");
s=j.parent(".manual-gallery")
}function o(){s.on("open-modal",q)
}function B(){c.resizeManager.on(c.resizeManager.events.CHANGE,function(){m()
})
}function k(){l.on("click",r);
v.on("click",A);
j.on("click",function(D){if($(D.target).hasClass("gallery-modal")){r()
}})
}function x(){i=new b(j,$.extend({},z,{autoplay:0,enlarge:false,fullWidth:false}));
h();
C();
m();
k();
B();
o()
}x();
return{init:x}
}function d(i,k){function h(l,m){l.html(m.html())
}function j(){var o={};
var m={};
var l=i.find(".gallery-inpage");
var n={};
if(!l.length&&!l.hasClass("size-1")){return
}if(k.enlarge){n=i.find(".gallery-modal");
h(n.find(".gallery-modal-wrapper"),l)
}m=new b(l,k);
if(k.enlarge){o=new a(n,k)
}}return{init:j}
}$.fn.manualGallery=function(h){h=$.extend({},e,h);
this.each(function(){var i=new d($(this),h);
i.init()
});
return this
};
(function f(){var h=$(".manual-gallery");
h.each(function(){var i=$(this);
i.manualGallery({autoplay:5000,changeSpeed:700,enlarge:!!(i.children(".gallery-modal").length),previewSpeed:300})
})
}());
return{SlideShow:b,Modal:a,ManualGallery:d}
})(fom.utils);
fom.components.logo=(function(c,d){var b="/etc/designs/fom-website/images/f1_logo_fallback.png",a="/etc/designs/fom-website/images/logo-tata.png";
if(!d.svg){c(".logo img").attr("src",b);
c(".logo-tata img").attr("src",a)
}})($,Modernizr,window);
fom.components.tabs=(function(d,b,a,h){var k=300,f=function(o,n){var m,l=function(){o.hide();
n()
};
o.addClass("transparent");
if(a.csstransitions){m=setTimeout(l,k)
}else{l()
}},i=function(l){var m=l.find(".responsive-element").get(0);
l.show();
if(m){b.responsiveElements.recalculate(m)
}l.removeClass("transparent")
},g=function(o,m,l){var n;
l=l||0,n=m.eq(l);
f(m,function(){i(n)
});
o.removeClass("selected");
o.eq(l).addClass("selected")
},c=function(r,q,n){var p,o,m,l;
n.each(function(s){l=d(this);
p=l.data("tab-title");
o=l.data("tab-title-mobile")||p;
m=['<a class="desktop ',h.slugify(p),'-link" href="#">',p,'</a><a class="mobile ',h.slugify(p),'-link" href="#">',o,"</a>"].join("");
q.eq(s).append(m)
});
r.on("click",{tabItems:q,contentSections:n},e)
},e=function(m){m.preventDefault();
m.stopPropagation();
var l=d(m.target).closest("li").index();
g(m.data.tabItems,m.data.contentSections,l,m.data.$responsiveElems);
return false
},j=function(){var l=d(".tab-wrapper");
l.each(function(n){var q=d(this),p=q.find(".tab-list"),o=q.find(".tab"),m=q.find(".tab-content");
c(p,o,m);
g(o,m)
})
};
j();
return{}
})(jQuery,fom.modules,Modernizr,fom.utils);
(function(){var a=function(){};
a.VISIBLE_CLASSNAME="isVisible";
a.OBSCURED_CLASSNAME="obscured";
a.ANIMATION_OFFSET=75;
a.SCROLL_TOLERANCE=200;
a.prototype={checkScrollIntoView:function(b){var c=b-a.SCROLL_TOLERANCE;
this.obscuredComponents().each($.proxy(function(e,g){var d=$(g),f=d.offset().top,h;
if(c>=f){h=d.find("."+a.OBSCURED_CLASSNAME).filter($.proxy(this.scrollAnimationFilter,this));
d.addClass(a.VISIBLE_CLASSNAME);
this.animateObscuredItems(h)
}},this));
return this.hasNoRemainingItems()
},obscuredComponents:function(){return this.$components.not("."+a.VISIBLE_CLASSNAME)
},hasNoRemainingItems:function(){return this.obscuredComponents().length===0
},animateObscuredItems:function(b){this.shuffle(b).each(function(c){(function(d,e){setTimeout(function(){d.removeClass(a.OBSCURED_CLASSNAME)
},e)
}($(this),a.ANIMATION_OFFSET*c))
})
},scrollAnimationFilter:function(){return true
},shuffle:function(b){return b
},destroy:function(){}};
fom.components.latestNews||(fom.components.latestNews={});
fom.components.latestNews.BaseView=a
}());
(function(){var b=fom.components.latestNews.BaseView;
var a=function(d){var c=$.proxy(this.showMore,this);
this.$components=d;
this.$components.each(function(){var e=$(this);
e.one("click",".show-more a",e,c)
})
};
a.ADDITIONAL_CLASSNAME="additional";
a.MORE_CLASSNAME="more";
a.FOLLOW_CLASSNAME="follow";
a.prototype=$.extend(new b(),{showMore:function(e){var d=$(e.currentTarget),c=e.data,f;
d.find("."+a.MORE_CLASSNAME).hide();
d.find("."+a.FOLLOW_CLASSNAME).show();
f=c.find("."+a.ADDITIONAL_CLASSNAME).removeClass(a.ADDITIONAL_CLASSNAME);
setTimeout($.proxy(this.animateObscuredItems,this,f),a.ANIMATION_OFFSET);
e.preventDefault()
},scrollAnimationFilter:function(c,d){return !$(d).hasClass(a.ADDITIONAL_CLASSNAME)
},destroy:function(){this.$components.off("click")
}});
fom.components.latestNews||(fom.components.latestNews={});
fom.components.latestNews.DesktopView=a
}());
(function(){var a=fom.components.latestNews.BaseView;
var b=function(d,c){this.$components=d;
this.initializeSwiper(c||b.SWIPER)
};
b.SWIPER="tablet-swiper";
b.SWIPER_WRAPPER="articles";
b.SWIPER_SLIDE="tablet-swiper-slide";
b.prototype=$.extend(new a(),{initializeSwiper:function(c){this.swipers=[];
this.$components.each($.proxy(function(f,g){var e=$(g),d=e.find("."+c).get(0);
this.swipers.push({plugin:new Swiper(d,this.swiperOptions()),container:d})
},this));
this.fixAdditionalItems()
},fixAdditionalItems:function(c){this.$components.filter("."+a.VISIBLE_CLASSNAME).find("."+a.OBSCURED_CLASSNAME).removeClass(a.OBSCURED_CLASSNAME)
},swiperOptions:function(){return{scrollContainer:true,wrapperClass:b.SWIPER_WRAPPER,slideClass:b.SWIPER_SLIDE}
},destroy:function(){$.each(this.swipers,$.proxy(function(d,c){c.plugin.destroy();
this.resetSwiper(c)
},this));
this.swipers.length=0
},resetSwiper:function(c){var d=$(c.container),e=this.swiperOptions();
d.removeClass("swiper-free-mode");
d.find("."+e.slideClass).removeClass(function(f,g){var h=[];
$.each(g.split(" "),function(j,k){if(/swiper-slide-.*/.test(k)){h.push(k)
}});
return h.join(" ")
});
d.find(["."+e.wrapperClass,"."+e.slideClass].join(",")).removeAttr("style")
},shuffle:function(g){var c=[g.get(0)],f=g.length-1,e=1,d=Math.ceil((f/2)+1);
while(d<=f){c.push(g.get(e));
c.push(g.get(d));
e+=1;
d+=1
}return $(c)
}});
fom.components.latestNews||(fom.components.latestNews={});
fom.components.latestNews.TabletView=b
}());
(function(a){var d=fom.components.latestNews.TabletView;
var c=a.resizeManager;
var b=function(e){d.call(this,e,b.SWIPER)
};
b.SWIPER="mobile-swiper";
b.SWIPER_WRAPPER="mobile-swiper-wrapper";
b.SWIPER_SLIDE="mobile-swiper-slide";
b.prototype=$.extend({},d.prototype,{shuffle:function(e){return e
},swiperOptions:function(){if($(".template-home").length>0){return{centeredSlides:false,slidesPerView:"auto",slidesPerViewFit:false,wrapperClass:b.SWIPER_WRAPPER,slideClass:b.SWIPER_SLIDE}
}else{return{centeredSlides:true,slidesPerView:1,wrapperClass:b.SWIPER_WRAPPER,slideClass:b.SWIPER_SLIDE}
}},});
fom.components.latestNews||(fom.components.latestNews={});
fom.components.latestNews.MobileView=b
}(fom.utils));
(function(c){var b=fom.components.latestNews;
var f=c.resizeManager;
var e=$(".latest-news");
function a(g){switch(g){case f.sizes.NARROW:return b.MobileView;
case f.sizes.MEDIUM:if($(".template-home").length>0){return b.MobileView
}else{return b.TabletView
}default:return b.DesktopView
}}function d(h){var g;
if(b.activeView){b.activeView.destroy();
c.scrollWatcher.remove(b.activeView)
}g=a(h);
b.activeView=new g(e);
c.scrollWatcher.add(b.activeView)
}if(e.length){f.on("change",d);
d(f.size)
}}(fom.utils));
fom.components.tweetembed=(function(d){var b={apiUri:"//platform.twitter.com/widgets.js",element:".tweet"},a;
function e(){a=d(b.element+" blockquote");
if(a.length>0){c()
}}function c(g){var f;
f=document.createElement("script");
f.id="twitter-wjs";
f.type="text/javascript";
f.src=b.apiUri;
f.charset="utf-8";
document.body.appendChild(f)
}return e()
}(jQuery));
fom.components.filter||(fom.components.filter={});
fom.components.filter.BaseView=(function(c){var a=function(){},b=a.prototype;
a.SHOW_CLASS="show";
a.HIDE_CLASS="hide";
a.SELECTED_CLASS="selected";
a.selectors={TOGGLE:".filter-toggle",filters:{CATEGORY:"filter-wrapper--type",DATE:"filter-wrapper--date"},filterLists:{YEAR_LIST:".filter-list.year",MONTH_LIST:".filter-list.month",TYPE_LIST:".filter-list.type"},LIST:".filter-list",LIST_ITEM:".filter-list-item",LIST_ITEM_BUTTON:".filter-list-item-button",EARLIER_BUTTON:".filter-list-item--earlier",formFields:{YEAR:"#year",MONTH:"#month",DATE:"#date",TYPE:"#type"},FORM:".filter-form",SELECT:".filter-select"};
b.init=function(d){this._$element=c(d);
this._elements=this.cacheElements();
this.attachListeners()
};
b.cacheElements=function(){throw new Error("fom.components.filter.BaseView.cacheElements() must be overidden.")
};
b.attachListeners=function(){throw new Error("fom.components.filter.BaseView.attachListeners() must be overidden.")
};
b.destroy=function(){throw new Error("fom.components.filter.BaseView.destroy() must be overidden.")
};
return a
})(jQuery);
fom.components.filter||(fom.components.filter={});
fom.components.filter.WideView=(function(e){var a=function(){},b=fom.components.filter.BaseView,c=a.prototype=new b(),d=b.prototype;
a.OPEN_SPEED=500;
a.ITEM_SHOW_DELAY=40;
a.ANIMATE_BETWEEN_FILTERS=true;
c.init=function(g,f,h){d.init.call(this,g);
if(this._elements[b.selectors.filters.CATEGORY].$toggle.hasClass(b.SHOW_CLASS)){this._openTarget=this._elements[b.selectors.filters.CATEGORY]
}else{if(this._elements[b.selectors.filters.DATE].$toggle.hasClass(b.SHOW_CLASS)){this._openTarget=this._elements[b.selectors.filters.DATE]
}else{this._openTarget=undefined
}}this._rowCount=0;
this._columnCount=h;
if(this._elements[b.selectors.filters.DATE].$holder){this.initialiseRows(f)
}};
c.cacheElements=function(){var h,g={},f;
for(f in b.selectors.filters){if(b.selectors.filters.hasOwnProperty(f)){h=this._$element.find("."+b.selectors.filters[f]);
g[b.selectors.filters[f]]={$holder:h,$list:h.find(b.selectors.LIST),$select:h.find(b.selectors.SELECT),$toggle:this._$element.find("[data-target="+b.selectors.filters[f]+"]"),$earlierButton:h.find(b.selectors.EARLIER_BUTTON)}
}}return g
};
c.attachListeners=function(){this._$element.on(["click",b.selectors.TOGGLE].join(""),b.selectors.TOGGLE,e.proxy(this.onToggleClick,this));
this._$element.on(["click",b.selectors.EARLIER_BUTTON].join(""),b.selectors.EARLIER_BUTTON,e.proxy(this.onEarlierButtonClick,this));
this._$element.on(["click",b.selectors.LIST_ITEM_BUTTON].join(""),b.selectors.LIST_ITEM_BUTTON,e.proxy(this.onListItemClick,this))
};
c.onListItemClick=function(r){var h=e(r.currentTarget),q=h.closest("ol"),t=q.find("span"),f=h.find("span").eq(h.index()),u=e(b.selectors.FORM),i=e(b.selectors.formFields.DATE),k=e(b.selectors.formFields.TYPE),j="",l="",n="",p="",s={},o={},g=[];
if(h.parent().hasClass("filter-list-item--earlier")){return
}t.removeClass(b.SELECTED_CLASS);
f.addClass(b.SELECTED_CLASS);
for(var m in b.selectors.filterLists){s=e(b.selectors.filterLists[m]);
o=s.find("."+b.SELECTED_CLASS);
n=o.data("value");
g.push(n)
}j=g[0];
l=g[1];
p=g[2];
i.val(j+"-"+l);
k.val(p);
u.submit()
};
c.onEarlierButtonClick=function(){this._openTarget.$earlierButton.addClass(b.HIDE_CLASS);
this._rowCount++;
this.fillMissingColumns()
};
c.onToggleClick=function(f){var h=this._elements[f.target.getAttribute("data-target")],g;
if(this._openTarget===h){this.close(h)
}else{if(this._openTarget&&this._openTarget!==h){this._openTarget.$toggle.removeClass(b.SHOW_CLASS);
g=function(){this.open(h,!a.ANIMATE_BETWEEN_FILTERS)
};
this.close(this._openTarget,!a.ANIMATE_BETWEEN_FILTERS,e.proxy(g,this))
}else{this.open(h)
}}};
c.initialiseRows=function(g){var h=this._elements[b.selectors.filters.DATE].$list.first(),f=this._elements[b.selectors.filters.DATE].$yearItems=h.children(b.selectors.LIST_ITEM);
if(g){this.initialiseDOM(f)
}else{this.updateInitialisedDOM(f)
}};
c.initialiseDOM=function(h){var g,f,i;
g=h.find("."+b.SELECTED_CLASS).parent().index();
f=Math.floor(g/this._columnCount);
if((g+1)%this._columnCount===0){f++
}if((f+1)*this._columnCount>h.length-1){this._elements[b.selectors.filters.DATE].$earlierButton.hide()
}i=(this._columnCount*f)+this._columnCount-1;
h.slice(i).addClass(b.HIDE_CLASS);
this._rowCount=f
};
c.updateInitialisedDOM=function(g){var f;
f=(g.length)-g.filter("."+b.HIDE_CLASS).length;
this._rowCount=(f+1)/this._columnCount;
if(this._rowCount%1!==0){this.fillMissingColumns();
this._rowCount=Math.ceil(this._rowCount)
}this._rowCount-=1
};
c.fillMissingColumns=function(){var f=this._elements[b.selectors.filters.DATE].$yearItems,h=(this._rowCount*this._columnCount)-1,g=((Math.floor(this._rowCount)+1)*this._columnCount)-1;
if(g>=f.length-1){this._elements[b.selectors.filters.DATE].$earlierButton.hide();
g++
}this.animateListItems(f,h,g)
};
c.animateListItems=function(j,i,h){var g,f;
f=function(k,l){if(k===0){e(l).removeClass(b.HIDE_CLASS)
}else{setTimeout(function(){e(l).removeClass(b.HIDE_CLASS)
},k*a.ITEM_SHOW_DELAY)
}};
g=function(){if(this._openTarget&&this._openTarget.$earlierButton){this._openTarget.$earlierButton.removeClass(b.HIDE_CLASS)
}};
j=j.slice(i,h);
j.each(e.proxy(f,this));
setTimeout(e.proxy(g,this),j.length*a.ITEM_SHOW_DELAY)
};
c.open=function(h,g,f){this._openTarget=h;
h.$toggle.addClass(b.SHOW_CLASS);
if(g){this.onTransitionComplete(h.$holder,f)
}else{this.transitionToHeight(h.$holder,h.$holder[0].scrollHeight,f)
}};
c.close=function(h,g,f){this._openTarget.$holder.stop();
this._openTarget=undefined;
h.$toggle.removeClass(b.SHOW_CLASS).blur();
if(g){this.onTransitionComplete(h.$holder,f)
}else{this.transitionToHeight(h.$holder,0,f)
}};
c.transitionToHeight=function(h,g,k){var i=Math.abs(h.height()-g),f=(i/a.OPEN_SPEED)*1000,l=[g,"px"].join(""),j=e.proxy(this.onTransitionComplete,this,h,k);
h.stop().animate({height:l},f,"swing",j)
};
c.onTransitionComplete=function(f,g){if(g){g()
}if(this._openTarget&&this._openTarget.$holder===f){f.addClass(b.SHOW_CLASS)
}else{f.removeClass(b.SHOW_CLASS)
}f.css("height","")
};
c.destroy=function(){if(this._openTarget){this._openTarget.$holder.stop();
this.onTransitionComplete(this._openTarget.$holder)
}this._$element.off(b.selectors.TOGGLE);
this._$element.off(b.selectors.EARLIER_BUTTON)
};
return a
})(jQuery);
fom.components.filter||(fom.components.filter={});
fom.components.filter.NarrowView=(function(){var a=function(){},b=fom.components.filter.BaseView,c=a.prototype=new b();
c.cacheElements=function(){return{$form:this._$element.find(b.selectors.FORM),$yearSelectField:this._$element.find(b.selectors.formFields.YEAR),$monthSelectField:this._$element.find(b.selectors.formFields.MONTH),$dateInputField:this._$element.find(b.selectors.formFields.DATE)}
};
c.attachListeners=function(){this._elements.$form.on("change",$.proxy(this.onFormChange,this))
};
c.onFormChange=function(d){var f=this._elements.$yearSelectField.val(),e=this._elements.$monthSelectField.val();
this._elements.$dateInputField.val(f+"-"+e);
this._elements.$form.submit()
};
c.destroy=function(){this._elements.$form.off("change")
};
return a
})();
fom.components.filter||(fom.components.filter={});
fom.components.filter.controller=(function(d,c){var a=function(){this._components=[];
this._isFirstInit=true;
this.init()
},b=a.prototype;
a.WIDE_COLUMN_COUNT=12;
a.MEDIUM_COLUMN_COUNT=6;
a.selectors={COMPONENT:".filter-component"};
b.init=function(){var g=this.getView(),e,h,f;
h=function(i,j){e=new g();
e.init(j,this._isFirstInit,this.getColumnCount());
this._components.push({view:e,element:j})
};
f=d(a.selectors.COMPONENT);
if(f.length<=0){return false
}f.each(d.proxy(h,this));
if(g===fom.components.filter.WideView){this._isFirstInit=false
}c.on(c.events.CHANGE,this.updateViews,this)
};
b.updateViews=function(){var f=this._components.length,h=this.getView(),g,j,e;
while(f--){e=this._components[f];
g=e.view;
j=new h();
g.destroy();
j.init(e.element,this._isFirstInit,this.getColumnCount());
this._components[f].view=j
}if(h===fom.components.filter.WideView){this._isFirstInit=false
}};
b.getColumnCount=function(){if(c.size===c.sizes.MEDIUM){return a.MEDIUM_COLUMN_COUNT
}return a.WIDE_COLUMN_COUNT
};
b.getView=function(){switch(c.size){case c.sizes.NARROW:return fom.components.filter.NarrowView;
default:return fom.components.filter.WideView
}};
return new a()
})(jQuery,fom.utils.resizeManager);
fom.components.articleSelection=(function(h,i,g){var e={wrapperClass:"js-swipe-wrap",slideClass:"js-slide"};
var j,s,a,l,o,r,m=function(u){j=new Swiper(r[0],u);
j.swipeTo(0)
},k=function(){return(h.extend({},e,{scrollContainer:true,freeMode:true,freeModeFluid:true,slidesPerView:"auto"}))
},f=function(){return(h.extend({},e,{visibilityFullFit:true,slidesPerView:"auto",autoResize:false}))
},n=function(u){if(j){j.destroy(true);
j=undefined
}if(u===i.sizes.MEDIUM){m(k());
b();
return
}if(u===i.sizes.NARROW){d(u);
m(f());
return
}b();
l.removeAttr("style")
},d=function(u){var v=0;
if(u===i.sizes.NARROW){v=parseInt(o.innerWidth()*0.9,10);
s.css({height:v,width:v});
l.css({height:"auto",width:v*(s.length+1)});
if(j){j.resizeFix()
}}else{l.css("height",parseInt(s.height(),10))
}},b=function(){s.add(l).css({height:"",width:""})
},t=function(){fom.utils.resizeManager.on(i.events.CHANGE,n,this);
fom.utils.resizeManager.on(i.events.RESIZE,d,this)
},p=function(){if(g.isLoggedIn){if(g.isPremium){a.addClass("is-premium-user")
}}},c=function(){o=h(window);
r=h(".js-slide-container");
l=r.find("."+e.wrapperClass);
s=r.find("."+e.slideClass);
a=h(".selected-article-container")
},q=function(){c();
p();
if(r.length&&s.length>1){n(i.size);
t()
}};
return q()
}(jQuery,fom.utils.resizeManager,fom.modules.user));
fom.components.teaser=(function(f,g,b,c){var e=f(".fom-teaser"),h=function(){a();
d();
c.applyTo(e)
},a=function(){if(b.isTouch){e.removeClass("animate")
}},d=function(){if(b.ieVersion===8){e.addClass("lt480")
}};
h();
return{}
}(jQuery,Modernizr,fom.utils,fom.modules.premiumOverlay));
fom.components.videoTeaser=(function(i,j,g,c,l){var d="video-teaser",e="."+d,o=function(){return this
},b=[],h=i(document.body);
o.prototype.init=function(){this.updateTeasers();
if(j.isTouch){this.initModalPlayers()
}this.handleTeaserImageQuality();
this.handleHomePageLayout();
if(j.ieVersion==8){return false
}this._players={};
this.attachListeners();
return this
};
o.prototype.get$teasers=function(){return b
};
o.prototype.cacheTeasers=function(){b=i(e)
};
o.prototype.updateTeasers=function(){var p=this;
p.cacheTeasers();
p.initEmbeddedPlayers();
p.handlePremiumVideoTeasers()
};
o.prototype.handleHomePageLayout=function(){g.on("resize",a);
a()
};
o.prototype.handleTeaserImageQuality=function(){n();
g.on("change",n)
};
function a(p){var s=i(".video-teaser.latest"),q=i(".video-teaser-tile"),r=s.width();
q.height(r)
}function n(){if(!k(b)){return
}var r=i(".video-teaser.embed"),s=r.find(".video-preview"),p=s.css("background-image"),q="";
switch(g.size){case g.sizes.WIDE:q=p.replace("img.320.high","img.768.medium");
s.css("background-image",q);
break;
case g.sizes.MEDIUM:q=p.replace("img.768.medium","img.320.high");
s.css("background-image",q);
break
}}function f(p){return i(".video-aggregator").find(p).find(".video-player").not(".initialised")
}o.prototype.initEmbeddedPlayers=function(){var p=f(".embed");
this.initTeaserVideoPlayers(p,false,true)
};
o.prototype.initModalPlayers=function(){var p=f(".standard, .highlight");
this.initTeaserVideoPlayers(p,false,false)
};
o.prototype.initTeaserVideoPlayers=function(r,q,p){if(j.ieVersion==8){return false
}r.addClass("initialised");
c.initPlayers(r,{autoplay:q,preload:p},i.proxy(function(t){i.extend(this._players,t);
var s=c.players.length;
while(s--){c.players[s].on("video-playing",this.onPlay,this)
}},this))
};
o.prototype.attachListeners=function(){var q=".video-teaser-link";
var p=".close-btn";
h.on("click"+q,q,i.proxy(this.onTeaserClick,this));
h.on("click"+p,p,i.proxy(this.onTeaserClose,this))
};
o.prototype.onPlay=function(q){var p=q.parents(".video-teaser");
p.addClass("video-is-playing")
};
o.prototype.handlePremiumVideoTeasers=function(){if(l.isLoggedIn&&l.isPremium){b.addClass("is-premium-user")
}};
o.prototype.onTeaserClick=function(u){var p={},v={},t={},s={},r={},q=0;
p=i(u.currentTarget);
v=p.parents(".video-teaser");
if(!l.isPremium&&p.hasClass("video-premium-link")){return true
}if(p.parents(".js-swipe-wrap").length){return true
}switch(g.size){case g.sizes.NARROW:return true;
case g.sizes.MEDIUM:case g.sizes.WIDE:if(!i(".template-home").length){if(k(v)&&(g.size==g.sizes.WIDE)){q=m(v);
r=this._players[q];
r.hidePreview();
r.playVideo();
return false
}else{if(j.ieVersion==9){return true
}}}v.css("transform","");
s=v.find(".video-modal-window");
t=s.find(".video-player").not(".initialised");
if(t.length>0){this.initTeaserVideoPlayers(t,true)
}else{if(this._players){q=m(s);
r=this._players[q];
r.playVideo()
}}s.addClass("isVisible");
return false
}};
o.prototype.onTeaserClose=function(r){var s=i(r.currentTarget).parents(".video-teaser"),q=s.find(".video-modal-window"),p=this._players[m(q)];
if(p){p.resetVideoPlayback()
}q.removeClass("isVisible")
};
function m(p){return p.find(".video-player").find(".video-display").first().attr("id")
}function k(p){return p.hasClass("embed")
}return new o().init()
})(jQuery,fom.utils,fom.utils.resizeManager,fom.modules.videoPlayer,fom.modules.user);
(function(e,A,s,g,m){var o={aggregator:".article-aggregator",container:".promoted-articles",wrapper:".swiper-wrapper",slide:".slide",imgpanel:".imgpanel",loadmore:".load-more",timedelay:"data-carouseltime"},E={animationspeed:1000,slidedelay:5000,nudgeTimeout:250,nudgeDistance:90},C={START:16,COUNT:4},i,D,y,f=e(o.aggregator),l=e(o.loadmore,f),q=e(o.imgpanel),n=2,x,k=true,p;
fom.components.articleaggregator={};
function j(){var I=l.attr("data-linktext")||"Load more",G=l.attr("data-errormessage")||"Something went wrong. Try again later",H='<p><a href="#load-more">'+I+'<span class="errormessage">'+G+'</span><span class="icon-arrow"></span></a></p>';
c(l);
l.append(H);
x=l.height();
p=e("a",l).on("click",function(J){J.preventDefault();
J.stopPropagation();
v();
return false
})
}function c(H){var G=H.attr("data-globalpartnerblockenabled");
if(typeof G!==typeof undefined&&G!==false){C.START=C.START-1
}C.currentStart=C.START;
C.TOTAL_RESULTS=H.attr("data-totalresults")||C.START;
C.NODEPATH=H.attr("data-ajax-path");
C.COUNT=parseInt(H.attr("data-loadnum"),10)||C.COUNT;
i=h()
}function h(){return(C.NODEPATH+".more.html")
}function b(G){if(G){l.addClass("loading").removeClass("error")
}else{l.removeClass("loading")
}}function r(){if(C.TOTAL_RESULTS>C.currentStart){l.hide().appendTo(f).fadeIn("fast")
}}function t(J){var H=100,G=e(".loaded-item",J).not(".in-view"),I;
G.each(function(){I=e(this);
I.css({"-webkit-transition-delay":H+"ms","transition-delay":H+"ms"});
H+=100
});
setTimeout(function(){G.addClass("in-view")
},10);
setTimeout(function(){r()
},(H*C.COUNT)-H)
}function v(){var G="start="+C.currentStart+"&count="+C.COUNT+"&date="+A.queryString.get("date")+"&type="+A.queryString.get("type");
b(true);
e.ajax({type:"GET",url:i,processData:false,data:G}).done(function(I,H,J){F(a(J))
}).fail(function(H){d(H)
})
}function F(G){b(false);
l.detach();
C.currentStart+=C.COUNT;
u(G)
}function d(G){b(false);
l.addClass("error");
throw new Error("Load more failed: "+G.statusText)
}function u(I){var H=e(".article-columns .column",f).last(),J=e(".loaded-item",I).length/n,G;
G=(J>=2)?H.height()*J:H.height();
if(C.TOTAL_RESULTS>C.currentStart){if(k){G+=x
}k=false
}f.animate({height:"+="+G},function(){f.append(I);
m.recalculate$Elements(e(".loaded-item").find(".fom-teaser"));
t(e(".loaded-group",f).last())
})
}function a(H){var G=e(H.responseText);
G.find("script, .editmode-helper, .editmode").remove();
return G
}function z(G){if(G==="narrow"||G==="medium"){if(y){y.destroy();
y=null
}if(!D){D=fom.components.articleaggregator.mobile;
D.setOptions(o,E);
D.init()
}}if(G==="wide"){if(D){D.destroy();
D=null
}if(!y){y=fom.components.articleaggregator.desktop;
y.setOptions(o,E);
y.init()
}}}function w(){if(l.length>0){j()
}if(e(o.container).length>0){z(fom.utils.resizeManager.size);
fom.utils.resizeManager.on(fom.utils.resizeManager.events.CHANGE,z)
}g.applyTo(q)
}function B(){n=s.isWide()?2:1
}s.on("change",B);
B();
e(document).ready(function(){return w()
})
}(jQuery,fom.utils,fom.utils.resizeManager,fom.modules.premiumOverlay,fom.modules.responsiveElements));
fom.components.articleaggregator.mobile=(function(h){var k={},j={},s={},b,a={mode:"horizontal",loop:true,loopAdditionalSlides:0,centeredSlides:true,slidesPerView:1,initialSlide:0,grabCursor:false,keyboardControl:true,autoplayDisableOnInteraction:true,pagination:".js-pagination",paginationElement:"div",createPagination:true,onSlideChangeEnd:function(){i()
}},l,n,o,t=false;
function p(u,v){h.extend(j,u);
h.extend(s,v);
l=h(j.container);
n=h(j.wrapper,l);
o=h(j.slide,l);
s.slidedelay=parseInt(l.attr(j.timedelay),10)||s.slidedelay;
a.speed=s.animationspeed;
a.autoplay=s.slidedelay
}function i(){var u=h(b.activeSlide()),v=o.length-1;
if(u.next().length===0){b.swipeTo((0+a.loopAdditionalSlides),0,false)
}if(u.prev().length===0){b.swipeTo((v+a.loopAdditionalSlides),0,false)
}}function q(u){n.animate({marginLeft:u},s.animationspeed*0.5)
}function e(){b.stopAutoplay();
setTimeout(function(){q((s.nudgeDistance*-1))
},s.nudgeTimeout)
}function f(){if(!t){b.startAutoplay()
}setTimeout(function(){q(0)
},s.nudgeTimeout)
}function c(){b.stopAutoplay();
setTimeout(function(){q(s.nudgeDistance)
},s.nudgeTimeout)
}function d(){if(!t){b.startAutoplay()
}setTimeout(function(){q(0)
},s.nudgeTimeout)
}function g(){if(h(".slide-btn",l).length===0){l.append('<p class="slide-btn btn-prev"><a href="#prev"><span>Previous</span></a></p><p class="slide-btn btn-next"><a href="#next"><span>Next</span></a></p>');
h(".btn-next a, .btn-prev a",l).css("width",s.nudgeDistance).on({click:function(v){var u=h(v.target);
v.preventDefault();
q(0);
t=true;
if(u.closest(".btn-next").length>0){b.swipeNext()
}if(u.closest(".btn-prev").length>0){b.swipePrev()
}}});
h(".btn-next span",l).on({mouseenter:function(u){e()
},mouseleave:function(u){f()
}});
h(".btn-prev span",l).on({mouseenter:function(u){c()
},mouseleave:function(u){d()
}})
}}function m(){var u=o.length;
if(!fom.utils.isEditMode){if(u>1){l.addClass("swiper-container slides-"+u);
b=new Swiper(".swiper-container",a),g()
}}}function r(){if(b){b.destroy()
}fom.utils.removeSwiperClasses(o);
n.removeAttr("style");
l.removeClass("swiper-container")
}k.setOptions=p;
k.init=m;
k.destroy=r;
return k
}(jQuery));
fom.components.articleaggregator.desktop=(function(e,o){var n={},k={},D={},c=4,r,y,z,d,v,C,p,A,g=0,q,f;
function x(G,H){e.extend(k,G);
e.extend(D,H);
k.accordion=".accordion ul";
k.modifier="desktop";
k.promoArticles="promoted-articles";
k.premiumOverlayText=".imgpanel .premium-overlay p";
k.item="stack-item";
k.textpanel="textpanel";
k.active="is-active"
}function a(){r=e(k.container);
y=e(k.slide,r);
z=e(k.accordion,r);
D.slidedelay=parseInt(r.attr(k.timedelay),10)||D.slidedelay
}function F(){if(o.size!==o.sizes.NARROW){p=d.width();
f=v.width();
C.width(f-p)
}}function w(){var G="";
u();
y.each(function(){G+='<li class="'+k.item+'"><div class="'+k.textpanel+'">'+e(this).find("."+k.textpanel).html()+"</div></li>"
});
z.append(G);
d=e("."+k.item,r);
A=d.length;
C=e(k.premiumOverlayText);
v=e("."+k.promoArticles);
F();
j();
return z
}function u(){return z.empty()
}function j(){var K='<li class="stack-item-empty"><div class="'+k.textpanel+'"></div></li>',I=A,G=c,J,H;
if(I<G){J=G-I;
for(H=0;
H<J;
H+=1){z.append(K)
}}}function i(G){d.eq(G).addClass(k.active);
y.eq(G).addClass(k.active)
}function E(G){d.eq(G).removeClass(k.active);
y.eq(G).removeClass(k.active)
}function m(G){var H=g;
g=G;
E(H);
i(g)
}function b(){var G=g;
g=(g<(A-1))?g+1:0;
E(G);
i(g)
}function h(){q=setInterval(function(){b()
},D.slidedelay)
}function l(){clearInterval(q)
}function t(){z.on("click","a",function(H){var G=e(this).closest("."+k.item);
if(!G.hasClass(k.active)){H.preventDefault();
l();
m(G.index())
}})
}function s(){if(!fom.utils.isEditMode){fom.utils.removeSwiperClasses(e(k.slide,k.container));
a();
r.addClass(k.modifier);
if(y.length>0){w();
m(0);
o.on("resize",F);
if(y.length>1){t();
h()
}}}}function B(){l();
m(0);
u();
r.removeClass(k.modifier);
d.removeClass(k.active);
y.removeClass(k.active)
}n.setOptions=x;
n.init=s;
n.destroy=B;
return n
}(jQuery,fom.utils.resizeManager));
fom.components.videoIndexAggregator=(function(f,e,g,d){var c=function(){};
c.selectors={AGGREGATOR:".video-aggregator",TEASER:".video-teaser",TEASER_HOLDER:".article-columns",LOAD_MORE:".load-more",RESULTS_HOLDER:".results-container"};
c.classes={LOADING:"loading",ERROR:"error"};
c.prototype.params={START:16,COUNT:8};
c.prototype.init=function(){if(this.cacheElements()){if(e.ieVersion==8){this.initLoadMore();
return false
}this.initPackery();
this.initLoadMore();
d.on(d.events.RESIZE,this.onResize,this);
return this
}return false
};
c.prototype.onResize=function(){e.debounce(this._elements.$teaserHolder.packery,1000)
};
c.prototype.cacheElements=function(){var h=f(c.selectors.AGGREGATOR);
if(h.length<=0){return false
}this._elements={$holder:h,$teaserHolder:h.find(c.selectors.TEASER_HOLDER),$loadMoreButton:h.find(c.selectors.LOAD_MORE),$resultsHolder:h.find(c.selectors.RESULTS_HOLDER)};
return true
};
c.prototype.initPackery=function(){this._elements.$teaserHolder.packery({itemSelector:c.selectors.TEASER,transitionDuration:0,gutter:0})
};
c.prototype.initLoadMore=function(){this.createLoadMore()
};
c.prototype.createLoadMore=function(){var h={},k=this._elements.$loadMoreButton.attr("data-linktext")||"Load more",i=this._elements.$loadMoreButton.attr("data-errormessage")||"Something went wrong. Try again later",j='<p><a href="#load-more">'+k+'<span class="errormessage">'+i+'</span><span class="icon-arrow"></span></a></p>';
this.getEditorSetParams(this._elements.$loadMoreButton);
this._elements.$loadMoreButton.append(j);
h=f("a",this._elements.$loadMoreButton).on("click",f.proxy(function(l){l.preventDefault();
l.stopPropagation();
this.getMoreResults();
return false
},this))
};
c.prototype.getEditorSetParams=function(i){var h=i.attr("data-globalpartnerblockenabled");
if(typeof h!==typeof undefined&&h!==false){this.params.START=this.params.START-1
}this.params.currentStart=this.params.START;
this.params.TOTAL_RESULTS=i.attr("data-totalresults")||this.params.START;
this.params.NODEPATH=i.attr("data-ajax-path");
this.params.COUNT=parseInt(i.attr("data-loadnum"),10)||this.params.COUNT;
this.ENDPOINT=this.createEndpoint()
};
c.prototype.createEndpoint=function(){return(this.params.NODEPATH+".more.html")
};
c.prototype.getMoreResults=function(){this.displayLoader(true);
f.ajax({type:"GET",url:this.ENDPOINT,data:{start:this.params.currentStart,count:this.params.COUNT}}).done(f.proxy(function(i,h,j){this.handleSuccess(a(j))
},this)).fail(f.proxy(function(h){this.handleFailure(h)
},this))
};
c.prototype.displayLoader=function(h){if(h){this._elements.$loadMoreButton.addClass(c.classes.LOADING).removeClass(c.classes.ERROR)
}else{this._elements.$loadMoreButton.removeClass(c.classes.LOADING)
}};
c.prototype.handleSuccess=function(h){this.displayLoader(false);
this._elements.$loadMoreButton.detach();
this.params.currentStart+=this.params.COUNT;
this.appendResults(h)
};
c.prototype.handleFailure=function(h){this.displayLoader(false);
console.log("An Error has occured!")
};
c.prototype.appendResults=function(i){var h=i.find(c.selectors.TEASER);
$teaserWrap={},targetHeight=0;
if(e.ieVersion==8){this._elements.$teaserHolder.append(h);
this.reinstateLoadMoreLink();
return
}$teaserWrap=h.wrap('<div class="hide"></div>');
this._elements.$teaserHolder.append($teaserWrap);
targetHeight=this._elements.$teaserHolder.outerHeight()+$teaserWrap.height()+"px";
$teaserWrap.remove();
this._elements.$teaserHolder.animate({height:targetHeight},f.proxy(function(){this._elements.$teaserHolder.append(h);
h.hide(0).fadeIn();
this._elements.$teaserHolder.packery("appended",h);
this.reinstateLoadMoreLink();
g.updateTeasers()
},this))
};
c.prototype.reinstateLoadMoreLink=function(){if(this.params.TOTAL_RESULTS>this.params.currentStart){this._elements.$loadMoreButton.hide().appendTo(this._elements.$holder).fadeIn("fast")
}};
function b(i){var h=0;
i.each(function(){var j=f(this).height();
h=(j>h)?j:h
});
return h
}function a(i){var h=f(i.responseText);
h.find("script, .editmode-helper, .editmode").remove();
return h
}return new c().init()
})(jQuery,fom.utils,fom.components.videoTeaser,fom.utils.resizeManager);
(function(c,a){c.raceCalendar||(c.raceCalendar={});
var d=function(f,e){this.$el=$(f);
this.$slides=this.$el.find("."+d.SLIDE_CLASSNAME);
this.$wrapper=this.$el.find("."+d.WRAPPER_CLASSNAME);
this.$parallax=this.$el.find("."+d.PARALLAX_CLASSNAME);
this.isActive=false;
this._events=[];
this._addSwiperShim();
this.swiper=new Swiper(f,{freeMode:true,freeModeFluid:true,slidesPerView:"auto",wrapperClass:d.WRAPPER_CLASSNAME,slideClass:d.SLIDE_CLASSNAME});
this.$el.on("click","."+d.SLIDE_CLASSNAME,$.proxy(this.showRace,this))
};
c.raceCalendar.RaceCalendarSwiper=d;
d.WRAPPER_CLASSNAME="race-list";
d.SLIDE_CLASSNAME="race";
d.SLIDE_DETAILS_CLASSNAME="race-details";
d.CURRENT_RACE_CLASSNAME="current";
d.PARALLAX_CLASSNAME="parallax";
d.ANIMATION_STEP_CLASSNAMES=["step-1","step-2","step-3"];
d.ANIMATION_STEP_CLASS_LIST=d.ANIMATION_STEP_CLASSNAMES.join(" ");
d.ANIMATION_STEP_DURATION=400;
d.PARALLAX_MOVEMENT_RANGE=300;
d.ACTIVE_SLIDE_WIDTHS={};
d.ACTIVE_SLIDE_WIDTHS[a.resizeManager.sizes.WIDE]=625;
d.ACTIVE_SLIDE_WIDTHS[a.resizeManager.sizes.MEDIUM]=475;
d.prototype={on:function(f,e){this._events[f]=e
},trigger:function(h,e){var g=this._events[h],f;
if($.isFunction(g)){if(h==="beforeraceopen"){f=[this.createRolexContainer(e),this.raceIndex(e),this.clockScale()]
}g.apply(null,f||[])
}},createRolexContainer:function(e){var f=a.resizeManager.isWide()?"last":"first",g=e.find(".rolex-clock:"+f);
return g.off("timeupdate").on("timeupdate",$.proxy(this.updateRaceTimes,this))
},updateRaceTimes:function(f,e){$(f.currentTarget).closest("."+d.SLIDE_DETAILS_CLASSNAME).find("time").each(function(h,j){var g=$(j);
if(!g.attr("datetime")){return
}var n=new Date(g.attr("datetime"));
var m="";
var l=g.closest("div").find("#cityText").attr("zone").toUpperCase();
var k=(n.dst()===new Date().dst())?0:(60*60*1000);
if(e!=0&&l==="AUSTRALIA"){n.setTime(+n+e*60*1000+k)
}else{n.setTime(+n+e*60*1000)
}if(g.hasClass("clock-24")){m=b(n,"HH:MM")
}else{if(g.hasClass("month")){m=b(n,"MMM")
}else{if(g.hasClass("date")){m=b(n,"DD")
}else{if(g.hasClass("day")){m=b(n,"ddd")
}else{if(g.hasClass("date-full")){m=b(n,"DD MMM YYYY")
}}}}}g.text(m)
})
},raceIndex:function(e){return this.$slides.index(e)
},clockScale:function(){switch(a.resizeManager.size){case a.resizeManager.sizes.NARROW:return 47;
case a.resizeManager.sizes.NARROW:return 70;
default:return 90
}},_addSwiperShim:function(){var e=$("<div />"),f=d.ANIMATION_STEP_CLASS_LIST+" "+d.SLIDE_CLASSNAME;
e.addClass(f);
this.$wrapper.append(e);
this.$slides.add(e)
},checkScrollIntoView:function(e){if(this.$el.offset().top+200<=e){setTimeout($.proxy(function(){this.showRace({currentTarget:this.findNextRace()})
},this),0);
return true
}return false
},findNextRace:function(){var e;
this.$slides.each(function(h,j){var g=$(j),m=g.find(".race-date-full"),f=+new Date;
var l=+new Date(m.find(".from").attr("datetime"));
var k=+new Date(m.find(".to").attr("datetime"));
if(!l){l=+new Date(m.find(".from").text())
}if(!k){k=+new Date(m.find(".to").text())
}if((l<f&&k>f)||l>f){e=g;
return false
}});
return e||this.$slides.last()
},currentRaceSlide:function(){return this.$slides.filter("."+d.ANIMATION_STEP_CLASSNAMES.join("."))
},isActiveSlide:function(e){return e.hasClass(d.ANIMATION_STEP_CLASS_LIST)
},slideWidth:function(){var e=a.resizeManager.size;
return d.ACTIVE_SLIDE_WIDTHS[e]
},leftOffset:function(){if(a.resizeManager.isNarrow()){return 0
}return(this.slideWidth()/2)-(this.$el.innerWidth()/2)
},alignSwiperToRace:function(e){var f=e.position()||{left:0},g=-(this.swiper.getWrapperTranslate("x"))+f.left+this.leftOffset();
this.swiper.setWrapperTranslate(-g,0,0);
this.parallaxBackground(-g)
},animateRaceIntoView:function(e){var g=this,f=d.ANIMATION_STEP_CLASSNAMES.length-1;
this.trigger("beforeraceopen",e);
this.alignSwiperToRace(e);
$.each(d.ANIMATION_STEP_CLASSNAMES,function(j,h){var k=j*d.ANIMATION_STEP_DURATION;
setTimeout(function(){e.addClass(h);
if(j===f){g.isActive=false
}},k)
})
},showRace:function(f){var e=$(f.currentTarget);
if(this.isActive||this.isActiveSlide(e)){return true
}this.isActive=true;
this.closeActiveSlide($.proxy(this.animateRaceIntoView,this,e))
},closeActiveSlide:function(i){var e=this,f=this.$slides,g=d.ANIMATION_STEP_CLASSNAMES,h=g.length-1;
f.removeClass(g[h]);
setTimeout(function(){var j=g.slice(0,h).join(" ");
f.removeClass(j);
setTimeout(function(){e.trigger("afterraceclose");
i.call(null)
},d.ANIMATION_STEP_DURATION)
},d.ANIMATION_STEP_DURATION)
},parallaxBackground:function(f){var g=f/this.$el.width(),e=d.PARALLAX_MOVEMENT_RANGE*g;
e=(e<=0)?e:0;
this.$parallax.css("transform","translate3d("+e+"px, 0px, 0px)")
},update:function(){this.$wrapper.css({width:"",height:""});
setTimeout($.proxy(function(){var e=this.currentRaceSlide();
this.trigger("afterraceclose");
this.swiper.reInit();
this.trigger("beforeraceopen",e);
this.alignSwiperToRace(e)
},this),500)
}};
var b=(function(){var j=function(l){if(l<10){return"0"+l
}return l+""
};
var i=function(l){return j(l.getHours())+":"+j(l.getMinutes())
};
var h=function(l){return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][l.getMonth()]
};
var e=function(l){return j(l.getDate())
};
var f=function(l){return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][l.getDay()]
};
var k=function(l){return[e(l),h(l),l.getFullYear()].join(" ")
};
var g=function(l,m){switch(m){case"HH:MM":return i(l);
case"MMM":return h(l);
case"DD":return e(l);
case"ddd":return f(l);
case"DD MMM YYYY":return k(l)
}throw new Error("DateTime format not recognised for "+m)
};
return function(l,m){return g(l,m)
}
}())
}(fom.components,fom.utils));
(function(b){b.raceCalendar||(b.raceCalendar={});
var d=function(i){this.template=i
};
b.raceCalendar.Timepiece=d;
d.prototype={inject:function(k,i,j){if(k.length===0){return
}this.$el=$(this.template);
this.raceEvent=Events[i||0];
this.$container=k;
k.html(this.$el);
this.tickingBomb=k.rolexClock(this.settings(j),i||0)
},settings:function(j){var i=h[j];
return $.extend({},f,{globalXcenter:i.width/2,globalYcenter:i.height/2,globalXscale:i.scale,globalYscale:i.scale,onclickCity:$.proxy(this._onClickCity,this),onclickYourtime:$.proxy(this._onClickYourTime,this)})
},remove:function(){if(this.$el){if($.isFunction(this.tickingBomb)){this.tickingBomb()
}this.$el.remove()
}},_onClickCity:function(){this.$container.trigger("timeupdate",0);
return false
},_onClickYourTime:function(i){this.$container.trigger("timeupdate",-i);
return false
}};
var c="en";
var h={47:{width:42,height:42,scale:0.47},60:{width:56,height:56,scale:0.6},65:{width:60,height:60,scale:0.65},70:{width:64,height:64,scale:0.7},75:{width:68,height:68,scale:0.75},80:{width:73,height:73,scale:0.8},90:{width:82,height:82,scale:0.95},100:{width:90,height:90,scale:1},110:{width:99,height:99,scale:1.1},120:{width:109,height:109,scale:1.2},300:{width:259,height:260,scale:2.2}};
var e=h[100];
var g={green:"/etc/designs/fom-website/images/rolex/hands/green/",black:"/etc/designs/fom-website/images/rolex/hands/black/"};
var a=g.green;
var f={LANG:c,contentWidth:365,contentHeight:90,clockWidth:e.width,clockHeight:e.height,trackingurl:"http://www.rolex.com/?cmpid=dw_Clocks_201500329",leadingZeros:true,amPm:false,time24hours:true,showText:true,showTime:false,showDay:false,globalXcenter:e.width/2,globalYcenter:e.height/2,globalXscale:e.scale,globalYscale:e.scale,handsFolder:a,clocktimeAtEvent:false,countdownNumbersOnly:false,showDefaultCity:false,dateList:undefined,selectedCityId:undefined,isCountdownClock:false}
}(fom.components));
(function(a){var c=fom.components.raceCalendar,e=$(".race-calendar");
c.$components=e;
c.swipers=[];
function b(){var f=$(this).parents(".race-details");
f.find(".js-calendar-your-link").removeClass("hidden");
f.find(".js-calendar-city-link").addClass("hidden")
}function d(){var f=$(this).parents(".race-details");
f.find(".js-calendar-city-link").removeClass("hidden");
f.find(".js-calendar-your-link").addClass("hidden")
}c.$components.each(function(k,l){var j=$(l),n=j.find(".js-calendar-your-link, .js-calendar-city-link"),h=c.RaceCalendarSwiper.SLIDE_CLASSNAME,g,f,m;
if(j.find("."+h).length){g=j.find(".rolex-clock-tmpl").html();
f=new c.RaceCalendarSwiper(l);
m=new c.Timepiece(g);
c.swipers.push(f);
f.on("afterraceclose",$.proxy(m.remove,m));
f.on("beforeraceopen",$.proxy(m.inject,m));
j.on("click",".race-calendar-link",function(i){i.stopPropagation();
i.preventDefault()
});
j.on("click","#local-link",d);
j.on("click","#city-link",b);
n.on("click",function(p){var o=$(this),i=o.parents(".race-details");
p.stopPropagation();
p.preventDefault();
if(i.length){if(o.hasClass("js-calendar-your-link")){i.find("#local-link").trigger("click")
}else{i.find("#city-link").trigger("click")
}}})
}});
a.scrollWatcher.add(c.swipers);
a.resizeManager.on("change",function(){$.each(c.swipers,function(g,f){f.update()
})
})
}(fom.utils));
fom.components.userform=(function(h,d,j,k,f,a,g,b){var i=function(){};
i.prototype.selectors={HOLDER:"undefined",FORM:".user-form",PROFILE:".form-fieldset--profile",BILLING:".form-fieldset--billing",PAYMENT:".form-fieldset--payment",PURCHASE_UPGRADE_LINK:".purchase-upgrade-link",INPUT:".form-input",TEXT:".form-input--text",SELECT:".form-input--select",CHECKBOX:".form-input--checkbox",SUBMIT:".form-input--submit",REDEMPTION_CODE:"#form-input-redemption-code",COUNTRY:"#form-input-country",FIRST_NAME:"#form-input-first-name",LAST_NAME:"#form-input-last-name",EMAIL:"#form-input-email",EMAIL_VERIFY:"#form-input-email-verify",PASSWORD:"#form-input-password",PASSWORD_VERIFY:"#form-input-password-verify",BILLING_LINE_1:"#form-input-billing-address-line-1",BILLING_LINE_2:"#form-input-billing-address-line-2",BILLING_TOWN:"#form-input-billing-town",BILLING_COUNTRY:"#form-input-billing-country",BILLING_POSTCODE:"#form-input-billing-postcode",BILLING_PHONE:"#form-input-billing-phone",CARD_TYPE:"#form-input-card-type",CARD_NAME:"#form-input-card-name",CARD_NUMBER:"#form-input-card-no",CARD_CVV:"#form-input-cvv",EXPIRY_MONTH:"#form-input-expiry-month",EXPIRY_YEAR:"#form-input-expiry-year",RADIO_MONTH:"#form-input-sub-month",RADIO_YEAR:"#form-input-sub-year",ACCEPT_CONTACT_THIRD_PARTY:"#form-input-accept-contact-third-party",ACCEPT_CONTACT_F1:"#form-input-accept-contact-f1",PRICE_MONTH:".price-month",PRICE_YEAR:".price-year",SUB_CANCEL_WRAPPER:".sub-cancel-wrapper",SUB_CANCEL_BUTTON:".cancel-subscription",SUB_CANCEL_PENDING:".cancel-pending",SUB_MONTH_WRAPPER:".sub-month-wrapper",SUB_YEAR_WRAPPER:".sub-year-wrapper",ERROR_PANEL:".form-error-panel",ERROR_PANEL_LIST:".form-error-panel-list",INVALID_COUNTRY:".invalid-country"};
i.prototype.events={FORM_LOAD:"userFormLoad",INVALID_COUNTRY_SELECT:"userFormInvalidCountrySelect",INVALID_COUNTRY_SUBMIT:"userFormInvalidCountrySubmit",INVALID_COUNTRY_CTA_CLICK:"userFormInvalidCountryCTAClick",CLIENT_VALIDATION_ERROR:"userFormClientValidationError",SERVER_VALIDATION_ERROR:"userFormServerValidationError",FORM_SUBMIT:"userFormSubmit",SUBMIT_SUCCESS:"userFormSubmitSuccess",VOUCHER_ERROR:"voucherError"};
i.prototype.validation=[{name:"country",rules:"callback_country_required|callback_check_country"},{name:"first-name",display:"first name",rules:"required|min_length[2]|max_length[100]"},{name:"last-name",display:"last name",rules:"required|min_length[2]|max_length[100]"},{name:"billing-phone",display:"phone number",rules:"numeric|max_length[20]"},{name:"billing-address-line-1",display:"billing address (line 1)",rules:"required"},{name:"card-type",display:"credit card type",rules:"required|default[default]"},{name:"card-name",display:"credit card name",rules:"required"},{name:"issue-number",display:"issue number",rules:"numeric|max_length[2]"},{name:"expiry-month",display:"expiry month",rules:"required|default[default]|callback_check_expiry"},{name:"expiry-year",display:"expiry year",rules:"required|default[default]|callback_check_expiry"}];
i.prototype.classes={HIDE:"hide",ERROR:"error",OTHER:"Other",INITIALISED:"initialised"};
i.prototype.init=function(){this.DEBUG=false;
if(!this.cacheElements()){return false
}if(!j.browserSupportsPremium()){window.fom.modules.modals.unsupportedBrowser(this.redirectUnsupportedBrowser);
return false
}this._elements.$purchaseUpgradeLink.hide();
this.validation=this.validation.concat(this.getExtraValidation());
return this
};
i.prototype.activate=function(){f.ready({onSuccess:$.proxy(function(){this.initPlaceholders();
this.initStyles();
this.attachListeners();
this.initPrices();
this.initValidator();
a.fireCustomEvent(this.events.FORM_LOAD);
if(this.DEBUG){this.initDebug()
}},this),onFail:$.proxy(function(){this.activate()
},this)})
};
i.prototype.redirectUnsupportedBrowser=function(){history.back()
};
i.prototype.initDebug=function(){};
i.prototype.getExtraValidation=function(){return[]
};
i.prototype.initPrices=function(l){k.onPriceInit($.proxy(this.onCountryChange,this))
};
i.prototype.cacheElements=function(){var n=$(this.selectors.HOLDER),l=n.find(this.selectors.FORM),m=l.find(this.selectors.ERROR_PANEL);
if(!n.length){return false
}return this._elements={$holder:n,$form:l,$input:l.find(this.selectors.INPUT),$text:l.find(this.selectors.TEXT),$select:l.find(this.selectors.SELECT),$checkbox:l.find(this.selectors.CHECKBOX),$radioMonth:l.find(this.selectors.RADIO_MONTH),$radioYear:l.find(this.selectors.RADIO_YEAR),$submit:l.find(this.selectors.SUBMIT),$country:l.find(this.selectors.COUNTRY),$cardNumber:l.find(this.selectors.CARD_NUMBER),$billingPhone:l.find(this.selectors.BILLING_PHONE),$expiryMonth:l.find(this.selectors.EXPIRY_MONTH),$expiryYear:l.find(this.selectors.EXPIRY_YEAR),$password:l.find(this.selectors.PASSWORD),$passwordVerify:l.find(this.selectors.PASSWORD_VERIFY),$redemptionCode:l.find(this.selectors.REDEMPTION_CODE),$purchaseUpgradeLink:l.find(this.selectors.PURCHASE_UPGRADE_LINK),$priceMonth:l.find(this.selectors.PRICE_MONTH),$priceYear:l.find(this.selectors.PRICE_YEAR),$subCancelWrapper:l.find(this.selectors.SUB_CANCEL_WRAPPER),$subCancelPending:l.find(this.selectors.SUB_CANCEL_PENDING),$subCancelButton:l.find(this.selectors.SUB_CANCEL_BUTTON),$subMonthWrapper:l.find(this.selectors.SUB_MONTH_WRAPPER),$subYearWrapper:l.find(this.selectors.SUB_YEAR_WRAPPER),$errorPanel:m,$errorPanelList:m.find(this.selectors.ERROR_PANEL_LIST),$errorPanelWrap:m.parent().parent(),$invalidCountry:l.find(this.selectors.INVALID_COUNTRY)}
};
i.prototype.initPlaceholders=function(){this._elements.$text.placeholder()
};
i.prototype.initStyles=function(){this._elements.$select.each($.proxy(function(l,m){this.onSelectChange.call(m)
},this));
this._elements.$form.addClass(this.classes.INITIALISED)
};
i.prototype.attachListeners=function(){this._elements.$form.on("input",$.proxy(this.onInputChange,this));
this._elements.$holder.on("click",this.selectors.INVALID_COUNTRY+" a",$.proxy(this.onInvalidCountryCTAClick,this));
this._elements.$checkbox.on("change",$.proxy(this.onCheckboxChange,this));
this._elements.$select.on("onchange change",this.onSelectChange);
this._elements.$expiryMonth.on("onchange change",$.proxy(this.onExpiryChange,this));
this._elements.$expiryYear.on("onchange change",$.proxy(this.onExpiryChange,this));
k.on("change",this.onCountryChange,this);
k.on("invalidCountry",this.onInvalidCountrySelect,this)
};
i.prototype.onInvalidCountryCTAClick=function(){a.fireCustomEvent(this.events.INVALID_COUNTRY_CTA_CLICK)
};
i.prototype.onInvalidCountrySelect=function(){a.fireCustomEvent(this.events.INVALID_COUNTRY_SELECT)
};
i.prototype.onCountryChange=function(l){this.updateCurrency(l.currency)
};
i.prototype.initValidator=function(){this._formValidator=new h(this._elements.$form.first()[0],this.validation,$.proxy(this.onValidation,this),$.proxy(this.onBeforeValidation,this));
this._formValidator.registerCallback("check_dropdown",$.proxy(this.checkDropdown,this));
this._formValidator.registerCallback("check_expiry",$.proxy(this.checkExpiry,this));
this._formValidator.registerCallback("check_country",$.proxy(this.checkCountry,this));
this._formValidator.registerCallback("country_required",function(l){return(l!==null&&l!==""&&l!=="default")
}).setMessage("country_required","Please select your country from the list");
this._formValidator.registerCallback("terms_required",function(){return $("#form-input-accept-terms").is(":checked")
}).setMessage("terms_required","You need to accept the Terms & Conditions before proceeding")
};
i.prototype.onBeforeValidation=function(o){var n={},p=this,r,l,m=false,q=false;
if(this._elements.$cardNumber.length>0){m=true;
r=this._elements.$cardNumber.val()
}if(this._elements.$billingPhone.length>0){q=true;
l=this._elements.$billingPhone.val()
}a.fireCustomEvent(this.events.FORM_SUBMIT);
if(this._elements.$form.prop("disabled")){return false
}this._elements.$input.each(function(s,t){n=$(t);
n.val($.trim(n.val()))
});
if(m){if(r.substr(0,15)!=="XXXX-XXXX-XXXX-"){this._elements.$cardNumber.val(j.stripSpacesHyphensBrackets(r))
}}return true
};
i.prototype.onValidation=function(m,l){if(l&&l.preventDefault){l.preventDefault()
}else{if(event){event.returnValue=false
}}if(m.length>0){a.fireCustomEvent(this.events.CLIENT_VALIDATION_ERROR);
this.handleErrors(m,"client-validation")
}else{this.postForm()
}return false
};
i.prototype.postForm=function(){var l=this.getMappedForm();
this._elements.$errorPanelWrap.addClass(this.classes.HIDE);
this._elements.$input.parent().removeClass(this.classes.ERROR);
this._elements.$select.parent().parent().removeClass(this.classes.ERROR);
this._elements.$checkbox.closest(".form-input-expand").parent().removeClass(this.classes.ERROR);
$(".error-message",this._elements.$form).remove();
this.disableForm();
this.disableSubmit();
this.hasVoucherCode=l["redemption-code"];
this.service.post(l,$.proxy(this.onPostSuccess,this),$.proxy(this.onPostFail,this))
};
i.prototype.onPostFail=function(l,m){a.fireCustomEvent(this.events.SERVER_VALIDATION_ERROR);
this.enableForm();
this.enableSubmit();
if(l.isVoucherError){this.handleVoucherError(l.voucherCode);
return
}if(!l||!m){return this.unknownError()
}this.showErrorFromPointOfFailure(l,m)
};
i.prototype.showErrorFromPointOfFailure=function(l,n){var m=[];
switch(n){case"mpp-manage-card-details":case"mpp-add-subscription":case"mpp-user-update":case"mpp-user-create":m=this.parseMPPErrors(l);
if(m){return this.handleErrors(m,n)
}return this.handleErrors([{message:l.ErrorMessage}],n);
case"gigya-account-create":case"gigya-account-update":m=this.parseGigyaErrors(l);
return this.handleErrors(m,n);
case"gigya-account-init":case"mpp-session-create":default:return this.unknownError(n)
}};
i.prototype.unknownError=function(l){return this.handleErrors([{message:"Unexpected error occurred."}],l)
};
i.prototype.parseMPPErrors=function(l){var n=l.ErrorMessage,m;
if(n){if(n.match("BillingPostcode had illegal characters.")){m=this.getInput("billing-postcode")
}else{if(n.match("BillingTownCity had illegal characters.")){m=this.getInput("billing-town")
}else{if(n.match("BillingStreet had illegal characters.")){m=this.getInput("billing-address-line-2")
}else{if(n.match("BillingHouseName had illegal characters.")){m=this.getInput("billing-address-line-1")
}else{if(n.match("FirstName had illegal characters.")){m=this.getInput("first-name")
}else{if(n.match("Surname had illegal characters.")){m=this.getInput("last-name")
}}}}}}if(m){return[{element:m,message:"Contains illegal characters.",showFieldName:true,code:l.ErrorNumber.toString()}]
}}if(l.ErrorNumber){switch(l.ErrorNumber.toString()){case"1018":return[{element:this.getInput("email"),message:"email already exists",showFieldName:true,code:l.ErrorNumber.toString()}]
}}return false
};
i.prototype.parseGigyaErrors=function(n){var l=0,m=[];
if(n.validationErrors){l=n.validationErrors.length;
while(l--){switch(n.validationErrors[l].fieldName){case"email":m.push({element:this.getInput("email"),message:n.validationErrors[l].message,showFieldName:true,code:n.validationErrors[l].errorCode});
break;
case"password":case"newPassword":m.push({element:this.getInput("password"),message:n.validationErrors[l].message,showFieldName:true,code:n.validationErrors[l].errorCode});
break
}}return m
}else{if(n.errorDetails){if(n.errorDetails.match("Invalid argument: Invalid email")){return[{element:this.getInput("email"),message:"Invalid email address.",code:n.errorCode}]
}else{if(n.errorDetails.match("'password' cannot be the same as 'newPassword'")){return[{element:this.getInput("password-confirm"),message:"Your new password cannot be the same as your previous password.",code:n.errorCode}]
}else{if(n.errorDetails.match("invalid loginID or password")){return[{element:this.getInput("password"),message:"Current password incorrect.",code:n.errorCode}]
}}}}}return[{message:"Invalid profile details entered."}]
};
i.prototype.handleErrors=function(m,l){l=this.pointOfFailureToErrorCode(l);
if($("main").hasClass("template-registration-forms")){this.newErrorMessageView(m,l)
}else{this.oldErrorMessageView(m,l)
}};
i.prototype.oldErrorMessageView=function(r,l){var m=0,n=r.length,p={},s={},t="",o="",q="";
l=this.pointOfFailureToErrorCode(l);
while(m<n){p=r[m];
q=['<span class="error-code">[Reference: ',l.toUpperCase(),(p.code||""),"]</span>"].join("");
if(p.element){s=$(p.element);
if(p.showFieldName){o=s.data("title");
if(p.message){o=[o,p.message].join(" - ")
}}else{o=p.message||""
}t+="<li>"+o+q+"</li>";
if(e(s)){s=s.parent()
}s.addClass(this.classes.ERROR)
}else{if(p.message){t+=["<li>",p.message,q,"</li>"].join("")
}}m++
}this._elements.$errorPanelList.html(t);
this._elements.$errorPanelWrap.removeClass(this.classes.HIDE);
setTimeout($.proxy(function(){var u=this._elements.$errorPanel.offset().top-1;
if(d.size==d.sizes.NARROW){u-=$(".site-header .site-header-wrap").height()
}$("html, body").animate({scrollTop:u},"slow")
},this),0)
};
i.prototype.newErrorMessageView=function(v,m){var n=0,q=v.length,s={},w={},x="",r="",u="",p="";
var t=this.classes.ERROR;
var l="success-el";
var o=this.validation;
while(n<q){s=v[n];
if(s.element){w=$(s.element);
p=['<div class="error-message">',s.message,"</div>"].join("");
if(e(w)){w=w.parent().parent()
}else{if(c(w)){w=w.closest(".form-input-expand").parent();
p=['<div class="error-message clearbottom">',s.message,"</div>"].join("")
}else{w=w.parent()
}}w.removeClass(l);
w.addClass(t);
$(".error-message",w).remove();
w.prepend(p)
}else{if(s.message){x+=["<li>",s.message,u,"</li>"].join("")
}}n++
}$.each(o,function(){var z=$("[name="+this.name+"]");
var y;
if(e(z)){y=z.parent().parent()
}else{if(c(z)){y=z.closest(".form-input-expand").parent()
}else{y=z.parent()
}}if(!y.hasClass(t)){y.addClass(l)
}});
if(typeof v[0].element!=="undefined"){$("html, body").animate({scrollTop:$(v[0].element).offset().top-30},"slow")
}else{this._elements.$errorPanelList.html(x);
this._elements.$errorPanelWrap.removeClass(this.classes.HIDE);
setTimeout($.proxy(function(){var y=this._elements.$errorPanel.offset().top-1;
if(d.size==d.sizes.NARROW){y-=$(".site-header .site-header-wrap").height()
}$("html, body").animate({scrollTop:y},"slow")
},this),0)
}};
i.prototype.pointOfFailureToErrorCode=function(n){var l=n.split("-"),m=0;
n="";
for(;
m<l.length;
m++){n+=l[m][0]
}return n
};
i.prototype.handleVoucherError=function(l){a.fireCustomEvent(this.events.VOUCHER_ERROR);
window.location=$(".js-account-management").first().attr("href")+"#"+l
};
i.prototype.onPostSuccess=function(){var m=this._elements.$form.data("complete-url"),l=this._elements.$form.data("voucher-complete-url");
a.fireCustomEvent(this.events.SUBMIT_SUCCESS);
this._elements.$input.val("");
this._elements.$select.val("default");
if(this.hasVoucherCode&&l){window.location=l
}else{window.location=m
}};
i.prototype.disableForm=function(){this._elements.$input.prop("disabled",true);
this._elements.$form.prop("disabled",true)
};
i.prototype.enableForm=function(){this._elements.$input.prop("disabled",false);
this._elements.$form.prop("disabled",false)
};
i.prototype.enableSubmit=function(){this._elements.$submit.removeClass("loading");
this._elements.$submit.prop("disabled",false)
};
i.prototype.disableSubmit=function(){this._elements.$submit.addClass("loading");
this._elements.$submit.prop("disabled",true)
};
i.prototype.onCheckboxChange=function(m){var l=$(m.target);
if(l.attr("id")==="form-input-reveal-password"){var o=this.getInput("password");
if(l.is(":checked")){o.attr("type","text")
}else{o.attr("type","password")
}}else{var n=l.closest(".form-input-expand").parent();
if(n.hasClass(this.classes.ERROR)){$(".error-message",n).remove();
n.removeClass(this.classes.ERROR)
}}};
i.prototype.onInputChange=function(m){var l=$(m.target);
if(e(l)){l=l.parent().parent()
}else{if(c(l)){l=l.closest(".form-input-expand").parent()
}else{l=l.parent()
}}l.removeClass(this.classes.ERROR);
$(".error-message",l).remove()
};
i.prototype.onSelectChange=function(l){var m=$(this),n=m.find(":selected");
if(n.val()==="default"){m.addClass("default-selected")
}else{m.removeClass("default-selected")
}};
i.prototype.onExpiryChange=function(l){this._elements.$expiryMonth.parent().removeClass(this.classes.ERROR);
this._elements.$expiryYear.parent().removeClass(this.classes.ERROR)
};
i.prototype.updateCurrency=function(m){var l=f.getPrice(m,"month"),o=f.getPrice(m,"year"),n=j.getCurrencySymbol(m);
this._elements.$priceMonth.text(l.string);
this._elements.$priceYear.text(o.string);
this._elements.$radioMonth.val(l.data.ServicePriceId);
this._elements.$radioYear.val(o.data.ServicePriceId)
};
i.prototype.getInput=function(l){return this._elements.$input.filter("[name="+l+"]")
};
i.prototype.checkCountry=function(l){var m=(l===this.classes.OTHER);
if(m){a.fireCustomEvent(this.events.INVALID_COUNTRY_SUBMIT)
}return !m
};
i.prototype.checkExpiry=function(){var l=new Date(),m=new Date().getTime(),o=Number(this._elements.$expiryMonth.val())-1,n=Number(this._elements.$expiryYear.find(":selected").text());
l.setMonth(o);
l.setFullYear(n);
l=l.getTime();
if(l<m){return false
}return true
};
i.prototype.getMappedForm=function(){var m={},l=this._elements.$form.serializeArray();
$.map(l,function(n){m[n.name]=n.value
});
return m
};
function e(l){return l.is("select")
}function c(l){return l.is(":checkbox")
}return i
})(FormValidator,fom.utils.resizeManager,fom.utils,fom.components.countryDropdown,fom.modules.mpp,fom.tracking,fom.modules.modals,fom.config);
fom.components.userSubscribeStep1Form=(function(h,d,i,k,f,a,g,b){var j=function(){};
j.prototype.selectors={HOLDER:"undefined",FORM:".subscribe-fullaccess-form-step1",NEXTFORMHOLDER:".subscribe-fullaccess-form-step2-holder",EDITFORM:".step-edit",PROFILE:".form-fieldset--profile",INPUT:".form-input",TEXT:".form-input--text",SELECT:".form-input--select",CHECKBOX:".form-input--checkbox",SUBMIT:".form-input--submit",COUNTRY:"#form-input-country",FIRST_NAME:"#form-input-first-name",LAST_NAME:"#form-input-last-name",EMAIL:"#form-input-email",EMAIL_VERIFY:"#form-input-email-verify",PASSWORD:"#form-input-password",ACCEPT_CONTACT_THIRD_PARTY:"#form-input-accept-contact-third-party",ACCEPT_CONTACT_F1:"#form-input-accept-contact-f1",ERROR_PANEL:".form-error-panel",ERROR_PANEL_LIST:".form-error-panel-list",INVALID_COUNTRY:".invalid-country"};
j.prototype.events={FORM_LOAD:"userSubscribeStep1FormLoad",INVALID_COUNTRY_SELECT:"userSubscribeStep1FormInvalidCountrySelect",INVALID_COUNTRY_SUBMIT:"userSubscribeStep1FormInvalidCountrySubmit",INVALID_COUNTRY_CTA_CLICK:"userSubscribeStep1FormInvalidCountryCTAClick",CLIENT_VALIDATION_ERROR:"userSubscribeStep1FormClientValidationError",SERVER_VALIDATION_ERROR:"userSubscribeStep1FormServerValidationError",FORM_SUBMIT:"userSubscribeStep1FormSubmit",SUBMIT_SUCCESS:"userSubscribeStep1FormSubmitSuccess"};
j.prototype.validation=[{name:"country",display:"country",rules:"callback_country_required|callback_check_country"},{name:"first-name",display:"first name",rules:"required|min_length[2]|max_length[100]"},{name:"last-name",display:"last name",rules:"required|min_length[2]|max_length[100]"}];
j.prototype.classes={HIDE:"hide",ERROR:"error",OTHER:"Other",INITIALISED:"initialised"};
j.prototype.init=function(){this.DEBUG=false;
if(!this.cacheElements()){return false
}if(!i.browserSupportsPremium()){window.fom.modules.modals.unsupportedBrowser(this.redirectUnsupportedBrowser);
return false
}this.validation=this.validation.concat(this.getExtraValidation());
return this
};
j.prototype.activate=function(){f.ready({onSuccess:$.proxy(function(){this.initPlaceholders();
this.initStyles();
this.attachListeners();
this.initValidator();
a.fireCustomEvent(this.events.FORM_LOAD);
if(this.DEBUG){this.initDebug()
}},this),onFail:$.proxy(function(){this.activate()
},this)})
};
j.prototype.redirectUnsupportedBrowser=function(){history.back()
};
j.prototype.initDebug=function(){};
j.prototype.getExtraValidation=function(){return[]
};
j.prototype.cacheElements=function(){var o=$(this.selectors.HOLDER),l=o.find(this.selectors.FORM),n=$(this.selectors.NEXTFORMHOLDER),m=l.find(this.selectors.ERROR_PANEL);
if(!o.length){return false
}return this._elements={$holder:o,$form:l,$nextformholder:n,$input:l.find(this.selectors.INPUT),$text:l.find(this.selectors.TEXT),$select:l.find(this.selectors.SELECT),$checkbox:l.find(this.selectors.CHECKBOX),$submit:l.find(this.selectors.SUBMIT),$country:l.find(this.selectors.COUNTRY),$password:l.find(this.selectors.PASSWORD),$editform:l.find(this.selectors.EDITFORM),$errorPanel:m,$errorPanelList:m.find(this.selectors.ERROR_PANEL_LIST),$errorPanelWrap:m.parent().parent(),$invalidCountry:l.find(this.selectors.INVALID_COUNTRY)}
};
j.prototype.initPlaceholders=function(){this._elements.$text.placeholder()
};
j.prototype.initStyles=function(){this._elements.$select.each($.proxy(function(l,m){this.onSelectChange.call(m)
},this));
this._elements.$form.addClass(this.classes.INITIALISED)
};
j.prototype.attachListeners=function(){this._elements.$form.on("input",$.proxy(this.onInputChange,this));
this._elements.$holder.on("click",this.selectors.INVALID_COUNTRY+" a",$.proxy(this.onInvalidCountryCTAClick,this));
this._elements.$checkbox.on("change",$.proxy(this.onCheckboxChange,this));
this._elements.$select.on("onchange change",this.onSelectChange);
k.on("invalidCountry",this.onInvalidCountrySelect,this)
};
j.prototype.onInvalidCountryCTAClick=function(){a.fireCustomEvent(this.events.INVALID_COUNTRY_CTA_CLICK)
};
j.prototype.onInvalidCountrySelect=function(){a.fireCustomEvent(this.events.INVALID_COUNTRY_SELECT)
};
j.prototype.initValidator=function(){this._formValidator=new h(this._elements.$form.first()[0],this.validation,$.proxy(this.onValidation,this),$.proxy(this.onBeforeValidation,this));
this._formValidator.registerCallback("check_dropdown",$.proxy(this.checkDropdown,this));
this._formValidator.registerCallback("check_expiry",$.proxy(this.checkExpiry,this));
this._formValidator.registerCallback("check_country",$.proxy(this.checkCountry,this));
this._formValidator.registerCallback("country_required",function(l){return(l!==null&&l!==""&&l!=="default")
}).setMessage("country_required","Please select your country from the list");
this._formValidator.registerCallback("terms_required",function(){return $("#form-input-accept-terms").is(":checked")
}).setMessage("terms_required","You need to accept the Terms & Conditions before proceeding")
};
j.prototype.onBeforeValidation=function(m){var l={},n=this;
a.fireCustomEvent(this.events.FORM_SUBMIT);
if(this._elements.$form.prop("disabled")){return false
}this._elements.$input.each(function(o,p){l=$(p);
l.val($.trim(l.val()))
});
return true
};
j.prototype.onValidation=function(m,l){if(l&&l.preventDefault){l.preventDefault()
}else{if(event){event.returnValue=false
}}if(m.length>0){a.fireCustomEvent(this.events.CLIENT_VALIDATION_ERROR);
this.handleErrors(m,"client-validation")
}else{this.postForm()
}return false
};
j.prototype.postForm=function(){var l=this.getMappedForm();
this._elements.$errorPanelWrap.addClass(this.classes.HIDE);
this._elements.$input.parent().removeClass(this.classes.ERROR);
this._elements.$select.parent().parent().removeClass(this.classes.ERROR);
this._elements.$checkbox.closest(".form-input-expand").parent().removeClass(this.classes.ERROR);
$(".error-message",this._elements.$form).remove();
this.disableForm();
this.disableSubmit();
this.service.post(l,$.proxy(this.onPostSuccess,this),$.proxy(this.onPostFail,this))
};
j.prototype.onPostFail=function(l,m){a.fireCustomEvent(this.events.SERVER_VALIDATION_ERROR);
this.enableForm();
this.enableSubmit();
if(!l||!m){return this.unknownError()
}this.showErrorFromPointOfFailure(l,m)
};
j.prototype.showErrorFromPointOfFailure=function(l,n){var m=[];
switch(n){case"mpp-manage-card-details":case"mpp-add-subscription":case"mpp-user-update":case"mpp-user-create":m=this.parseMPPErrors(l);
if(m){return this.handleErrors(m,n)
}return this.handleErrors([{message:l.ErrorMessage}],n);
case"gigya-account-create":case"gigya-account-update":m=this.parseGigyaErrors(l);
return this.handleErrors(m,n);
case"gigya-account-init":case"mpp-session-create":default:return this.unknownError(n)
}};
j.prototype.unknownError=function(l){return this.handleErrors([{message:"Unexpected error occurred."}],l)
};
j.prototype.parseMPPErrors=function(l){var n=l.ErrorMessage,m;
if(n){if(n.match("BillingPostcode had illegal characters.")){m=this.getInput("billing-postcode")
}else{if(n.match("BillingTownCity had illegal characters.")){m=this.getInput("billing-town")
}else{if(n.match("BillingStreet had illegal characters.")){m=this.getInput("billing-address-line-2")
}else{if(n.match("BillingHouseName had illegal characters.")){m=this.getInput("billing-address-line-1")
}else{if(n.match("FirstName had illegal characters.")){m=this.getInput("first-name")
}else{if(n.match("Surname had illegal characters.")){m=this.getInput("last-name")
}}}}}}if(m){return[{element:m,message:"Contains illegal characters.",showFieldName:true,code:l.ErrorNumber.toString()}]
}}if(l.ErrorNumber){switch(l.ErrorNumber.toString()){case"1018":return[{element:this.getInput("email"),message:"email already exists",showFieldName:true,code:l.ErrorNumber.toString()}]
}}return false
};
j.prototype.parseGigyaErrors=function(n){var l=0,m=[];
if(n.validationErrors){l=n.validationErrors.length;
while(l--){switch(n.validationErrors[l].fieldName){case"email":m.push({element:this.getInput("email"),message:n.validationErrors[l].message,showFieldName:true,code:n.validationErrors[l].errorCode});
break;
case"password":case"newPassword":m.push({element:this.getInput("password"),message:n.validationErrors[l].message,showFieldName:true,code:n.validationErrors[l].errorCode});
break
}}return m
}else{if(n.errorDetails){if(n.errorDetails.match("Invalid argument: Invalid email")){return[{element:this.getInput("email"),message:"Invalid email address.",code:n.errorCode}]
}else{if(n.errorDetails.match("'password' cannot be the same as 'newPassword'")){return[{element:this.getInput("password-confirm"),message:"Your new password cannot be the same as your previous password.",code:n.errorCode}]
}else{if(n.errorDetails.match("invalid loginID or password")){return[{element:this.getInput("password"),message:"Current password incorrect.",code:n.errorCode}]
}}}}}return[{message:"Invalid profile details entered."}]
};
j.prototype.handleErrors=function(v,m){var n=0,q=v.length,s={},w={},x="",r="",u="",p="";
var t=this.classes.ERROR;
var l="success-el";
var o=this.validation;
m=this.pointOfFailureToErrorCode(m);
while(n<q){s=v[n];
if(s.element){w=$(s.element);
p=['<div class="error-message">',s.message,"</div>"].join("");
if(e(w)){w=w.parent().parent()
}else{if(c(w)){w=w.closest(".form-input-expand").parent();
p=['<div class="error-message clearbottom">',s.message,"</div>"].join("")
}else{w=w.parent()
}}w.removeClass(l);
w.addClass(t);
$(".error-message",w).remove();
w.prepend(p)
}else{if(s.message){x+=["<li>",s.message,u,"</li>"].join("")
}}n++
}$.each(o,function(){var z=$("[name="+this.name+"]");
var y;
if(e(z)){y=z.parent().parent()
}else{if(c(z)){y=z.closest(".form-input-expand").parent()
}else{y=z.parent()
}}if(!y.hasClass(t)){y.addClass(l)
}});
if(typeof v[0].element!=="undefined"){$("html, body").animate({scrollTop:$(v[0].element).offset().top-30},"slow")
}else{this._elements.$errorPanelList.html(x);
this._elements.$errorPanelWrap.removeClass(this.classes.HIDE);
setTimeout($.proxy(function(){var y=this._elements.$errorPanel.offset().top-1;
if(d.size==d.sizes.NARROW){y-=$(".site-header .site-header-wrap").height()
}$("html, body").animate({scrollTop:y},"slow")
},this),0)
}};
j.prototype.pointOfFailureToErrorCode=function(n){var l=n.split("-"),m=0;
n="";
for(;
m<l.length;
m++){n+=l[m][0]
}return n
};
j.prototype.onPostSuccess=function(){var l=this._elements.$form.data("complete-url");
a.fireCustomEvent(this.events.SUBMIT_SUCCESS);
this._elements.$holder.addClass("step-hide");
this._elements.$nextformholder.removeClass("step-hide")
};
j.prototype.disableForm=function(){this._elements.$input.prop("disabled",true);
this._elements.$form.prop("disabled",true)
};
j.prototype.enableForm=function(){this._elements.$input.prop("disabled",false);
this._elements.$form.prop("disabled",false)
};
j.prototype.enableSubmit=function(){this._elements.$submit.removeClass("loading");
this._elements.$submit.prop("disabled",false)
};
j.prototype.disableSubmit=function(){this._elements.$submit.addClass("loading");
this._elements.$submit.prop("disabled",true)
};
j.prototype.onCheckboxChange=function(m){var l=$(m.target);
if(l.attr("id")==="form-input-reveal-password"){var o=this.getInput("password");
if(l.is(":checked")){o.attr("type","text")
}else{o.attr("type","password")
}}else{var n=l.closest(".form-input-expand").parent();
if(n.hasClass(this.classes.ERROR)){$(".error-message",n).remove();
n.removeClass(this.classes.ERROR)
}}};
j.prototype.onInputChange=function(m){var l=$(m.target);
if(e(l)){l=l.parent().parent()
}else{if(c(l)){l=l.closest(".form-input-expand").parent()
}else{l=l.parent()
}}l.removeClass(this.classes.ERROR);
$(".error-message",l).remove()
};
j.prototype.onSelectChange=function(l){var m=$(this),n=m.find(":selected");
if(n.val()==="default"){m.addClass("default-selected")
}else{m.removeClass("default-selected")
}};
j.prototype.getInput=function(l){return this._elements.$input.filter("[name="+l+"]")
};
j.prototype.checkCountry=function(l){var m=(l===this.classes.OTHER);
if(m){a.fireCustomEvent(this.events.INVALID_COUNTRY_SUBMIT)
}return !m
};
j.prototype.getMappedForm=function(){var m={isProfileData:true},l=this._elements.$form.serializeArray();
$.map(l,function(n){m[n.name]=n.value
});
return m
};
function e(l){return l.is("select")
}function c(l){return l.is(":checkbox")
}return j
})(FormValidator,fom.utils.resizeManager,fom.utils,fom.components.countryDropdown,fom.modules.mpp,fom.tracking,fom.modules.modals,fom.config);
fom.components.userSubscribeStep2Form=(function(h,d,i,l,f,a,g,b,k){var j=function(){};
j.prototype.selectors={HOLDER:"undefined",FORM:".subscribe-fullaccess-form-step2",BILLING:".form-fieldset--billing",PAYMENT:".form-fieldset--payment",INPUT:".form-input",TEXT:".form-input--text",SELECT:".form-input--select",CHECKBOX:".form-input--checkbox",SUBMIT:".form-input--submit",BILLING_LINE_1:"#form-input-billing-address-line-1",BILLING_LINE_2:"#form-input-billing-address-line-2",BILLING_TOWN:"#form-input-billing-town",BILLING_PROVINCE:"#form-input-billing-state",BILLING_COUNTRY:"#form-input-billing-country",MANDATORY_STATE_COUNTRIES:"#mandatory-state-country-list",BILLING_POSTCODE:"#form-input-billing-postcode",BILLING_PHONE:"#form-input-billing-phone",CARD_TYPE:"#form-input-card-type",CARD_NAME:"#form-input-card-name",CARD_NUMBER:"#form-input-card-no",CARD_CVV:"#form-input-cvv",EXPIRY_MONTH:"#form-input-expiry-month",EXPIRY_YEAR:"#form-input-expiry-year",RADIO_MONTH:"#form-input-sub-month",RADIO_YEAR:"#form-input-sub-year",PRICE_MONTH:".price-month",PRICE_YEAR:".price-year",SUB_CANCEL_WRAPPER:".sub-cancel-wrapper",SUB_CANCEL_BUTTON:".cancel-subscription",SUB_CANCEL_PENDING:".cancel-pending",SUB_MONTH_WRAPPER:".sub-month-wrapper",SUB_YEAR_WRAPPER:".sub-year-wrapper",ERROR_PANEL:".form-error-panel",ERROR_PANEL_LIST:".form-error-panel-list",INVALID_COUNTRY:".invalid-country"};
j.prototype.events={FORM_LOAD:"userSubscribeStep2FormLoad",INVALID_COUNTRY_SELECT:"userSubscribeStep2FormInvalidCountrySelect",INVALID_COUNTRY_SUBMIT:"userSubscribeStep2FormInvalidCountrySubmit",INVALID_STATE_SELECT:"userSubscribeStep2FormInvalidStateSelect",INVALID_STATE_SUBMIT:"userSubscribeStep2FormInvalidStateSubmit",INVALID_COUNTRY_CTA_CLICK:"userSubscribeStep2FormInvalidCountryCTAClick",CLIENT_VALIDATION_ERROR:"userSubscribeStep2FormClientValidationError",SERVER_VALIDATION_ERROR:"userSubscribeStep2FormServerValidationError",FORM_SUBMIT:"userSubscribeStep2FormSubmit",SUBMIT_SUCCESS:"userSubscribeStep2FormSubmitSuccess"};
j.prototype.validation=[{name:"billing-phone",display:"phone number",rules:"numeric|max_length[20]"},{name:"billing-address-line-1",display:"billing address (line 1)",rules:"required"},{name:"card-type",display:"credit card type",rules:"required|default[default]"},{name:"card-name",display:"credit card name",rules:"required"},{name:"issue-number",display:"issue number",rules:"numeric|max_length[2]"},{name:"expiry-month",display:"expiry month",rules:"required|default[default]|callback_check_expiry"},{name:"expiry-year",display:"expiry year",rules:"required|default[default]|callback_check_expiry"}];
j.prototype.classes={HIDE:"hide",ERROR:"error",OTHER:"Other",INITIALISED:"initialised"};
j.prototype.init=function(){this.DEBUG=false;
if(!$.fn.detachOptions){$.fn.detachOptions=function(m){var n=this;
return n.each(function(){var o=n.data("selectOptions")||[];
n.find(m).each(function(){o.push($(this).detach())
});
n.data("selectOptions",o)
})
}
}if(!$.fn.attachOptions){$.fn.attachOptions=function(m){var n=this;
return n.each(function(){var p=n.data("selectOptions")||[];
for(var o in p){if(p[o].is(m)){n.append(p[o])
}}})
}
}if(!this.cacheElements()){return false
}if(!i.browserSupportsPremium()){window.fom.modules.modals.unsupportedBrowser(this.redirectUnsupportedBrowser);
return false
}this.validation=this.validation.concat(this.getExtraValidation());
return this
};
j.prototype.activate=function(){f.ready({onSuccess:$.proxy(function(){this.initPlaceholders();
this.initStyles();
this.initValidator();
this.initPrices();
this.attachListeners();
this.initSubscriptionType();
a.fireCustomEvent(this.events.FORM_LOAD);
if(this.DEBUG){this.initDebug()
}},this),onFail:$.proxy(function(){this.activate()
},this)})
};
j.prototype.redirectUnsupportedBrowser=function(){history.back()
};
j.prototype.initDebug=function(){};
j.prototype.getExtraValidation=function(){return[]
};
j.prototype.initPrices=function(m){l.onPriceInit($.proxy(this.onCountryChange,this))
};
j.prototype.cacheElements=function(){var o=$(this.selectors.HOLDER),m=o.find(this.selectors.FORM),n=m.find(this.selectors.ERROR_PANEL);
if(!o.length){return false
}return this._elements={$holder:o,$form:m,$input:m.find(this.selectors.INPUT),$text:m.find(this.selectors.TEXT),$select:m.find(this.selectors.SELECT),$checkbox:m.find(this.selectors.CHECKBOX),$radioMonth:m.find(this.selectors.RADIO_MONTH),$radioYear:m.find(this.selectors.RADIO_YEAR),$submit:m.find(this.selectors.SUBMIT),$cardNumber:m.find(this.selectors.CARD_NUMBER),$billingPhone:m.find(this.selectors.BILLING_PHONE),$billingProvince:m.find(this.selectors.BILLING_PROVINCE),$billingCountry:m.find(this.selectors.BILLING_COUNTRY),$mandatoryStateCountries:m.find(this.selectors.MANDATORY_STATE_COUNTRIES),$expiryMonth:m.find(this.selectors.EXPIRY_MONTH),$expiryYear:m.find(this.selectors.EXPIRY_YEAR),$priceMonth:m.find(this.selectors.PRICE_MONTH),$priceYear:m.find(this.selectors.PRICE_YEAR),$subCancelWrapper:m.find(this.selectors.SUB_CANCEL_WRAPPER),$subCancelPending:m.find(this.selectors.SUB_CANCEL_PENDING),$subCancelButton:m.find(this.selectors.SUB_CANCEL_BUTTON),$subMonthWrapper:m.find(this.selectors.SUB_MONTH_WRAPPER),$subYearWrapper:m.find(this.selectors.SUB_YEAR_WRAPPER),$errorPanel:n,$errorPanelList:n.find(this.selectors.ERROR_PANEL_LIST),$errorPanelWrap:n.parent().parent(),$invalidCountry:m.find(this.selectors.INVALID_COUNTRY)}
};
j.prototype.initPlaceholders=function(){this._elements.$text.placeholder()
};
j.prototype.initStyles=function(){this._elements.$select.each($.proxy(function(m,n){this.onSelectChange.call(n)
},this));
this._elements.$form.addClass(this.classes.INITIALISED)
};
j.prototype.attachListeners=function(){this._elements.$form.on("input",$.proxy(this.onInputChange,this));
this._elements.$holder.on("click",this.selectors.INVALID_COUNTRY+" a",$.proxy(this.onInvalidCountryCTAClick,this));
this._elements.$checkbox.on("change",$.proxy(this.onCheckboxChange,this));
this._elements.$select.on("onchange change",this.onSelectChange);
this._elements.$expiryMonth.on("onchange change",$.proxy(this.onExpiryChange,this));
this._elements.$expiryYear.on("onchange change",$.proxy(this.onExpiryChange,this));
l.on("change",this.onCountryChange,this);
l.on("invalidCountry",this.onInvalidCountrySelect,this)
};
j.prototype.onInvalidCountryCTAClick=function(){a.fireCustomEvent(this.events.INVALID_COUNTRY_CTA_CLICK)
};
j.prototype.onInvalidCountrySelect=function(){a.fireCustomEvent(this.events.INVALID_COUNTRY_SELECT)
};
j.prototype.onCountryChange=function(n){this.updateCurrency(n.currency);
var o=-1,m=this._elements.$mandatoryStateCountries.val().split(",");
if($.inArray(this._elements.$billingCountry.val(),m)===-1){this._formValidator.RemoveField("billing-state");
this._elements.$billingProvince.parent().parent().removeClass(this.classes.ERROR);
$(".error-message",this._elements.$billingProvince.parent().parent()).remove()
}else{if($.inArray(this._elements.$billingCountry.val(),m)>-1){this._formValidator.AddField({name:"billing-state",display:"billing state/province",rules:"callback_state_required|callback_check_state"})
}}this.updateStateOptions(this._elements.$billingCountry.val())
};
j.prototype.updateStateOptions=function(p){var m=this._elements.$mandatoryStateCountries.val().split(","),n=$.inArray(p,m)>-1;
for(var o=0;
o<m.length;
o++){if(n){this._elements.$billingProvince.detachOptions("option");
this._elements.$billingProvince.attachOptions('option[data-country="'+m[o]+'"]');
this._elements.$billingProvince.attachOptions('option[value="default"]');
this._elements.$billingProvince.val("default")
}else{this._elements.$billingProvince.detachOptions("option");
this._elements.$billingProvince.attachOptions('option[value="Non-USA/Other"]');
this._elements.$billingProvince.val("Non-USA/Other")
}}};
j.prototype.initValidator=function(){this._formValidator=new h(this._elements.$form.first()[0],this.validation,$.proxy(this.onValidation,this),$.proxy(this.onBeforeValidation,this));
this._formValidator.registerCallback("check_dropdown",$.proxy(this.checkDropdown,this));
this._formValidator.registerCallback("check_expiry",$.proxy(this.checkExpiry,this));
this._formValidator.registerCallback("check_country",$.proxy(this.checkCountry,this));
this._formValidator.registerCallback("check_state",$.proxy(this.checkState,this));
this._formValidator.registerCallback("state_required",function(m){return(m!==null&&m!==""&&m!=="default")
}).setMessage("state_required","Please select your state from the list");
this._formValidator.registerCallback("country_required",function(m){return(m!==null&&m!==""&&m!=="default")
}).setMessage("country_required","Please select your country from the list")
};
j.prototype.initSubscriptionType=function(){var m=window.location.hash?window.location.hash.replace("#",""):"monthly";
if(m==="monthly"){this._elements.$radioMonth.prop("checked",true)
}else{if(m==="annually"){this._elements.$radioYear.prop("checked",true)
}}};
j.prototype.onBeforeValidation=function(p){var o={},q=this,s,m,n=false,r=false;
if(this._elements.$cardNumber.length>0){n=true;
s=this._elements.$cardNumber.val()
}if(this._elements.$billingPhone.length>0){r=true;
m=this._elements.$billingPhone.val()
}a.fireCustomEvent(this.events.FORM_SUBMIT);
if(this._elements.$form.prop("disabled")){return false
}this._elements.$input.each(function(t,u){o=$(u);
o.val($.trim(o.val()))
});
if(n){if(s.substr(0,15)!=="XXXX-XXXX-XXXX-"){this._elements.$cardNumber.val(i.stripSpacesHyphensBrackets(s))
}}return true
};
j.prototype.onValidation=function(n,m){if(m&&m.preventDefault){m.preventDefault()
}else{if(event){event.returnValue=false
}}if(n.length>0){a.fireCustomEvent(this.events.CLIENT_VALIDATION_ERROR);
this.handleErrors(n,"client-validation")
}else{this.postForm()
}return false
};
j.prototype.postForm=function(){var m=this.getMappedForm();
this._elements.$input.parent().removeClass(this.classes.ERROR);
this._elements.$select.parent().parent().removeClass(this.classes.ERROR);
this._elements.$checkbox.closest(".form-input-expand").parent().removeClass(this.classes.ERROR);
$(".error-message",this._elements.$form).remove();
this.disableForm();
this.disableSubmit();
this.service.post(m,$.proxy(this.onPostSuccess,this),$.proxy(this.onPostFail,this))
};
j.prototype.onPostFail=function(m,n){a.fireCustomEvent(this.events.SERVER_VALIDATION_ERROR);
this.enableForm();
this.enableSubmit();
if(!m||!n){return this.unknownError()
}this.showErrorFromPointOfFailure(m,n)
};
j.prototype.showErrorFromPointOfFailure=function(m,o){var n=[];
switch(o){case"mpp-manage-card-details":case"mpp-add-subscription":case"mpp-user-update":case"mpp-user-create":n=this.parseMPPErrors(m);
if(n){return this.handleErrors(n,o)
}return this.handleErrors([{message:m.ErrorMessage}],o);
case"gigya-account-create":case"gigya-account-update":n=this.parseGigyaErrors(m);
return this.handleErrors(n,o);
case"gigya-account-init":case"mpp-session-create":default:return this.unknownError(o)
}};
j.prototype.unknownError=function(m){return this.handleErrors([{message:"Unexpected error occurred."}],m)
};
j.prototype.parseMPPErrors=function(m){var o=m.ErrorMessage,n;
if(o){if(o.match("BillingPostcode had illegal characters.")){n=this.getInput("billing-postcode")
}else{if(o.match("BillingTownCity had illegal characters.")){n=this.getInput("billing-town")
}else{if(o.match("BillingStreet had illegal characters.")){n=this.getInput("billing-address-line-2")
}else{if(o.match("BillingHouseName had illegal characters.")){n=this.getInput("billing-address-line-1")
}else{if(o.match("FirstName had illegal characters.")){n=this.getInput("first-name")
}else{if(o.match("Surname had illegal characters.")){n=this.getInput("last-name")
}}}}}}if(n){return[{element:n,message:"Contains illegal characters.",showFieldName:true,code:m.ErrorNumber.toString()}]
}}if(m.ErrorNumber){switch(m.ErrorNumber.toString()){case"1018":return[{element:this.getInput("email"),message:"email already exists",showFieldName:true,code:m.ErrorNumber.toString()}]
}}return false
};
j.prototype.parseGigyaErrors=function(o){var m=0,n=[];
if(o.validationErrors){m=o.validationErrors.length;
while(m--){switch(o.validationErrors[m].fieldName){case"email":n.push({element:this.getInput("email"),message:o.validationErrors[m].message,showFieldName:true,code:o.validationErrors[m].errorCode});
break;
case"password":case"newPassword":n.push({element:this.getInput("password"),message:o.validationErrors[m].message,showFieldName:true,code:o.validationErrors[m].errorCode});
break
}}return n
}else{if(o.errorDetails){if(o.errorDetails.match("Invalid argument: Invalid email")){return[{element:this.getInput("email"),message:"Invalid email address.",code:o.errorCode}]
}else{if(o.errorDetails.match("'password' cannot be the same as 'newPassword'")){return[{element:this.getInput("password-confirm"),message:"Your new password cannot be the same as your previous password.",code:o.errorCode}]
}else{if(o.errorDetails.match("invalid loginID or password")){return[{element:this.getInput("password"),message:"Current password incorrect.",code:o.errorCode}]
}}}}}return[{message:"Invalid profile details entered."}]
};
j.prototype.handleErrors=function(x,n){var o=0,s=x.length,u={},y={},z="",t="",w="",r="";
var v=this.classes.ERROR;
var m="success-el";
var p=this.validation;
var q=false;
n=this.pointOfFailureToErrorCode(n);
while(o<s){u=x[o];
q=false;
if(u.element){y=$(u.element);
r=['<div class="error-message">',u.message,"</div>"].join("");
if(e(y)){q=y.attr("name")=="expiry-month"||y.attr("name")=="expiry-year";
y=y.parent().parent()
}else{if(c(y)){y=y.closest(".form-input-expand").parent();
r=['<div class="error-message clearbottom">',u.message,"</div>"].join("")
}else{y=y.parent()
}}y.removeClass(m);
y.addClass(v);
$(".error-message",y).remove();
if(q){y.append(r)
}else{y.prepend(r)
}if($(u.element).hasClass("hide-error-icon")){y.addClass("hide-error-icon")
}}else{if(u.message){z+=["<li>",u.message,w,"</li>"].join("")
}}o++
}$.each(p,function(){var B=$("[name="+this.name+"]");
var A;
if(e(B)){A=B.parent().parent()
}else{if(c(B)){A=B.closest(".form-input-expand").parent()
}else{A=B.parent()
}}if(!A.hasClass(v)){A.addClass(m)
}});
if(typeof x[0].element!=="undefined"){$("html, body").animate({scrollTop:$(x[0].element).offset().top-30},"slow")
}else{this._elements.$errorPanelList.html(z);
this._elements.$errorPanelWrap.removeClass(this.classes.HIDE);
setTimeout($.proxy(function(){var A=this._elements.$errorPanel.offset().top-1;
if(d.size==d.sizes.NARROW){A-=$(".site-header .site-header-wrap").height()
}$("html, body").animate({scrollTop:A},"slow")
},this),0)
}};
j.prototype.pointOfFailureToErrorCode=function(o){var m=o.split("-"),n=0;
o="";
for(;
n<m.length;
n++){o+=m[n][0]
}return o
};
j.prototype.onPostSuccess=function(){var m=this._elements.$form.data("complete-url");
a.fireCustomEvent(this.events.SUBMIT_SUCCESS);
this._elements.$input.val("");
this._elements.$select.val("default");
window.location=m
};
j.prototype.disableForm=function(){this._elements.$input.prop("disabled",true);
this._elements.$form.prop("disabled",true)
};
j.prototype.enableForm=function(){this._elements.$input.prop("disabled",false);
this._elements.$form.prop("disabled",false)
};
j.prototype.enableSubmit=function(){this._elements.$submit.removeClass("loading");
this._elements.$submit.prop("disabled",false)
};
j.prototype.disableSubmit=function(){this._elements.$submit.addClass("loading");
this._elements.$submit.prop("disabled",true)
};
j.prototype.onCheckboxChange=function(n){var m=$(n.target);
if(m.attr("id")==="form-input-reveal-password"){var p=this.getInput("password");
if(m.is(":checked")){p.attr("type","text")
}else{p.attr("type","password")
}}else{var o=m.closest(".form-input-expand").parent();
if(o.hasClass(this.classes.ERROR)){$(".error-message",o).remove();
o.removeClass(this.classes.ERROR)
}}};
j.prototype.onInputChange=function(n){var m=$(n.target);
if(e(m)){m=m.parent().parent()
}else{if(c(m)){m=m.closest(".form-input-expand").parent()
}else{m=m.parent()
}}m.removeClass(this.classes.ERROR);
$(".error-message",m).remove()
};
j.prototype.onSelectChange=function(m){var n=$(this),o=n.find(":selected");
if(o.val()==="default"){n.addClass("default-selected")
}else{n.removeClass("default-selected")
}};
j.prototype.onExpiryChange=function(m){this._elements.$expiryMonth.parent().removeClass(this.classes.ERROR);
this._elements.$expiryYear.parent().removeClass(this.classes.ERROR)
};
j.prototype.updateCurrency=function(n){var m=f.getPrice(n,"month"),p=f.getPrice(n,"year"),o=i.getCurrencySymbol(n);
this._elements.$priceMonth.text(m.string);
this._elements.$priceYear.text(p.string);
k.setPrice(n);
this._elements.$radioMonth.val(m.data.ServicePriceId);
this._elements.$radioYear.val(p.data.ServicePriceId)
};
j.prototype.getInput=function(m){return this._elements.$input.filter("[name="+m+"]")
};
j.prototype.checkCountry=function(m){var n=(m===this.classes.OTHER);
if(n){a.fireCustomEvent(this.events.INVALID_COUNTRY_SUBMIT)
}return !n
};
j.prototype.checkState=function(m){var n=(m==="Non-USA/Other");
if(n){a.fireCustomEvent(this.events.INVALID_STATE_SUBMIT)
}return !n
};
j.prototype.checkExpiry=function(){var m=new Date(),n=new Date().getTime(),p=Number(this._elements.$expiryMonth.val())-1,o=Number(this._elements.$expiryYear.find(":selected").text());
m.setMonth(p);
m.setFullYear(o);
m=m.getTime();
if(m<n){return false
}return true
};
j.prototype.getMappedForm=function(){var o={isBillingData:true},n=this._elements.$form.serializeArray(),m=JSON.parse($.cookie("account-info")),p=m?m.profile:{};
o=$.extend({},o,p);
$.map(n,function(q){o[q.name]=q.value
});
return o
};
function e(m){return m.is("select")
}function c(m){return m.is(":checkbox")
}return j
})(FormValidator,fom.utils.resizeManager,fom.utils,fom.components.countryDropdown,fom.modules.mpp,fom.tracking,fom.modules.modals,fom.config,fom.modules.autosetprice);
fom.components.registrationform||(fom.components.registrationform={});
fom.components.registrationform.service=(function(b,a,c,f,e){var d=function(){};
d.prototype.onFailHandler=function(){};
d.prototype.onSuccessHandler=function(){};
d.prototype.responseData={};
d.prototype.formValues={};
d.prototype.hasChangedProfileInfo=false;
d.prototype.hasChangedPaymentInfo=false;
d.prototype.hasChangedServicePriceId=false;
d.prototype.hasChangedEmail=false;
d.prototype.hasChangedPassword=false;
d.prototype.addedMPPSubscription=false;
d.prototype.createdGigyaProfile=false;
d.prototype.createdMPPSessionUnregisteredUser=false;
d.prototype.createdMPPSessionRegisteredUser=false;
d.prototype.createdMPPUser=false;
d.prototype.initialisedGigyaProfileCreate=false;
d.prototype.loggedUserIn=false;
d.prototype.reAuthedUser=false;
d.prototype.hasVoucherCode=false;
d.prototype.updatedPaymentInfo=false;
d.prototype.updatedProfileInfo=false;
d.prototype.updatedGigyaProfile=false;
d.prototype.appliedVoucherCode=false;
d.prototype.updatedMPPProfile=false;
d.prototype.updatedCookieSubscriptionStatus=false;
d.prototype.post=function(g,h,i){g=this.cleanFormData(g);
this.onFailHandler=i;
this.onSuccessHandler=h;
if(!this.responseData.gigya){this.responseData.gigya=b.extend({},f.accountInfo)
}this.hasChangedEmail=this.checkEmailChange(g);
this.hasChangedPassword=this.checkPasswordChange(g);
this.hasChangedPaymentInfo=this.checkPaymentInfoChange(g);
this.hasChangedProfileInfo=(!this.createdGigyaProfile||!this.createdMPPUser)?false:this.checkProfileChange(g);
this.hasChangedServicePriceId=this.checkServicePriceIdChange(g);
this.hasVoucherCode=this.checkVoucherCodeEntered(g);
this.updatedPaymentInfo=false;
this.updatedProfileInfo=false;
this.updatedMPPProfile=false;
this.updatedGigyaProfile=false;
this.appliedVoucherCode=false;
if(g.isFreemium&&g.isFreemium=="true"){this.postFromPreviousStateFreemium(g)
}else{if(g.isProfileData){this.postProfileDetails(g)
}else{if(g.isBillingData){this.postBillingDetails(g)
}}}};
d.prototype.cleanFormData=function(h){var g=50;
if(typeof h["card-name"]!=="undefined"){h["card-name"]=a.cleanIllegalCharacters(h["card-name"]);
h["billing-address-line-1"]=a.cleanIllegalCharacters(h["billing-address-line-1"]).substr(0,g);
h["billing-address-line-2"]=a.cleanIllegalCharacters(h["billing-address-line-2"]).substr(0,g);
h["billing-town"]=a.cleanIllegalCharacters(h["billing-town"]).substr(0,g);
h["billing-country"]=a.cleanIllegalCharacters(h["billing-country"]).substr(0,g);
h["billing-postcode"]=a.cleanIllegalCharacters(h["billing-postcode"]).substr(0,g)
}return h
};
d.prototype.postFromPreviousStateFreemium=function(g){if(!this.createdGigyaProfile){return this.createGigyaProfile(g)
}if(!this.loggedUserIn){return this.logUserIn(g)
}else{if(!this.reAuthedUser){return this.reAuthUser(g)
}}if(this.hasVoucherCode&&!this.appliedVoucherCode){this.loggedUserIn=false;
this.reAuthedUser=false;
return this.applyVoucherCode(g)
}return this.onSuccessHandler()
};
d.prototype.postProfileDetails=function(g){if(g.isFreemium&&g.isFreemium=="true"){return this.postFromPreviousStateFreemium(g)
}if(!this.createdGigyaProfile){return this.createGigyaProfile(g)
}if(!this.loggedUserIn){return this.logUserIn(g)
}else{if(!this.reAuthedUser){return this.reAuthUser(g)
}}return this.onSuccessHandler()
};
d.prototype.postBillingDetails=function(g){if(g.isFreemium&&g.isFreemium=="true"){return this.postFromPreviousStateFreemium(g)
}if(g.isProfileData){return this.postProfileDetails(g)
}if(!this.createdMPPSessionUnregisteredUser){return this.createMPPSessionUnregisteredUser(g)
}if(this.hasChangedProfileInfo&&!this.updatedGigyaProfile){return this.updateGigyaProfile(g)
}if(!this.updatedMPPProfile&&g["billing-phone"]){return this.updateMPPProfile(g)
}if(this.hasChangedPaymentInfo&&!this.updatedPaymentInfo){return this.manageMPPCardDetails(g)
}if(!this.createdMPPSessionRegisteredUser&&this.hasChangedServicePriceId){return this.createMPPSessionRegisteredUser(g)
}else{if(!this.addedMPPSubscription){return this.addMPPSubscription(g)
}else{if(!this.updatedCookieSubscriptionStatus){return this.updateCookieSubscriptionStatus(g)
}else{if(!this.reAuthedUser){return this.reAuthUser(g)
}}}}return this.onSuccessHandler()
};
d.prototype.postFromPreviousState=function(g){if(g.isFreemium&&g.isFreemium=="true"){return this.postProfileDetails(g)
}if(!this.createdGigyaProfile){return this.createGigyaProfile(g)
}if(!this.createdMPPSessionUnregisteredUser){return this.createMPPSessionUnregisteredUser(g)
}if(this.hasChangedProfileInfo&&!this.updatedGigyaProfile){return this.updateGigyaProfile(g)
}if(this.hasChangedPaymentInfo&&!this.updatedPaymentInfo){return this.manageMPPCardDetails(g)
}if(!this.loggedUserIn){return this.logUserIn(g)
}else{if(!this.createdMPPSessionRegisteredUser&&this.hasChangedServicePriceId){return this.createMPPSessionRegisteredUser(g)
}else{if(!this.addedMPPSubscription){return this.addMPPSubscription(g)
}else{if(!this.updatedCookieSubscriptionStatus){return this.updateCookieSubscriptionStatus(g)
}else{if(!this.reAuthedUser){return this.reAuthUser(g)
}}}}}return this.onSuccessHandler()
};
d.prototype.reAuthUser=function(g){var h=function(i){if(i.status===307||i.status===204){this.reAuthedUser=true
}else{return this.onFail(i,"aem-login-failure")
}return this.postBillingDetails(g)
};
e.authenticate(f.accountInfo,b.proxy(h,this))
};
d.prototype.updateCookieSubscriptionStatus=function(h,g){var i=function(j){if(j&&j.data&&j.data.subscriptionStatus&&j.data.subscriptionStatus==="active"){this.updatedCookieSubscriptionStatus=true;
return this.postBillingDetails(h)
}else{return this.updateCookieSubscriptionStatus(h,g*2)
}};
g=g||500;
setTimeout(b.proxy(function(){f.updateAccountInfo(b.proxy(i,this))
},this),g)
};
d.prototype.addMPPSubscription=function(h){var i=function(k){this.addedMPPSubscription=true;
return this.postBillingDetails(h)
},j=function(k){return this.onFail(k,"mpp-add-subscription")
},g={AddSubscriptionInfo:{ActivationCode:"",Cv2Number:h.cvv,MD:"",PaRes:"",RenewalDayOffset:"0",ServicePriceId:h["service-price-id"],TermUrl:""}};
f.addSubscription({data:g,fail:b.proxy(j,this),success:b.proxy(i,this)})
};
d.prototype.createMPPSessionRegisteredUser=function(h){var i=function(k){this.createdMPPSessionRegisteredUser=true;
this.updateFormValues(["service-price-id"],h);
return this.postBillingDetails(h)
},j=function(k){k=k.responseJSON||k.responseText||k;
return this.onFail(k,"mpp-session-create")
},g={Email:h.email,ServicePriceId:h["service-price-id"],ClientUserId:this.responseData.gigya.UID,UIDSignature:this.responseData.gigya.UIDSignature,signatureTimestamp:this.responseData.gigya.signatureTimestamp};
a.createSession(a.CREATE_SESSION_NEW_USER_URL,{data:g,onSuccess:b.proxy(i,this),onFail:b.proxy(j,this)})
};
d.prototype.manageMPPCardDetails=function(h){var i=function(k){this.updateFormValues(["card-name","card-no","card-type","cvv","expiry-month","expiry-year","issue-number","billing-address-line-1","billing-address-line-2","billing-town","billing-country","billing-postcode"],h);
this.updatedPaymentInfo=true;
return this.postBillingDetails(h)
},j=function(k){return this.onFail(k.responseJSON,"mpp-manage-card-details")
},g={CreditDebitCardDetails:{CardName:h["card-name"],CreditCardNumber:h["card-no"],CreditCardType:h["card-type"],Cv2Number:h.cvv,ExpiryDate:[h["expiry-month"],h["expiry-year"]].join("/"),IssueCode:h["issue-number"]||"",BillingHouseName:h["billing-address-line-1"].replace(/,/g,""),BillingStreet:h["billing-address-line-2"].replace(/,/g,""),BillingDistrict:h["billing-state"].replace(/,/g,""),BillingTownCity:h["billing-town"].replace(/,/g,""),BillingCountry:h["billing-country"].replace(/,/g,""),BillingPostcode:h["billing-postcode"]}};
f.manageCardDetails({success:b.proxy(i,this),fail:b.proxy(j,this),data:g})
};
d.prototype.updateGigyaProfile=function(h){var i=function(k){if(k&&k.status==="success"){this.updateFormValues(["email","email-confirm","country","first-name","last-name","accept-contact-f1","accept-contact-third-party"],h);
if(this.hasChangedPassword){this.updateFormValues(["password","password-confirm"],h)
}this.updatedGigyaProfile=true;
return this.postBillingDetails(h)
}else{return this.onFail(k,"gigya-account-update")
}},j=function(k){return this.onFail(k.responseJSON,"gigya-account-update")
},g={email:h.email,country:h.country,"first-name":h["first-name"],"last-name":h["last-name"],"accept-contact-f1":!!h["accept-contact-f1"],"accept-contact-third-party":!!h["accept-contact-third-party"],"accept-terms":!!h["accept-terms"],UID:this.responseData.gigya.UID,UIDSignature:this.responseData.gigya.UIDSignature,signatureTimestamp:this.responseData.gigya.signatureTimestamp};
if(this.hasChangedPassword){g.password=this.formValues.password;
g.newPassword=h.password
}f.setAccountInfoGigya({data:g,fail:b.proxy(j,this),success:b.proxy(i,this)})
};
d.prototype.updateMPPProfile=function(h){var i=function(k){this.updatedMPPProfile=true;
this.updateFormValues(["billing-phone"],h);
return this.postBillingDetails(h)
},j=function(k){return this.onFail(k.responseJSON,"mpp-user-update")
},g={UserAmendInfo:{MobilePhoneNumber:h["billing-phone"]}};
f.setAccountInfoMPP({data:g,fail:b.proxy(j,this),success:b.proxy(i,this)})
};
d.prototype.createMPPUser=function(h){var i=function(k){this.createdMPPUser=true;
this.updateFormValues(["billing-phone"],h);
return this.postFromPreviousState(h)
},j=function(k){return this.onFail(k.responseJSON,"mpp-user-create")
},g={UserCreateInfo:{ClientUserId:this.responseData.gigya.UID,EmailAddress:h.email,FirstName:a.cleanIllegalCharacters(h["first-name"]),MobilePhoneNumber:h["billing-phone"],Surname:a.cleanIllegalCharacters(h["last-name"]),Gender:"NotKnown",AccountTypeId:0}};
a.api({methodName:"UserCreate",onSuccess:b.proxy(i,this),onFail:b.proxy(j,this),requestData:g})
};
d.prototype.logUserIn=function(g){var h=function(j){this.loggedUserIn=true;
return this.postBillingDetails(g)
},i=function(j){return this.onFail(j.respnseJSON)
};
f.login(false,{password:g.password,email:g.email,setCookieExpiry:true,fail:b.proxy(i,this),success:b.proxy(h,this)})
};
d.prototype.applyVoucherCode=function(h){var i=function(k){this.appliedVoucherCode=true;
return this.postBillingDetails(h)
},j=function(k){if(!k.respnseJSON){k.respnseJSON={}
}k.respnseJSON.isVoucherError=true;
k.respnseJSON.voucherCode=h["redemption-code"];
return this.onFail(k.respnseJSON)
},g={voucher:h["redemption-code"]};
c.redeemVoucher({data:g,success:b.proxy(i,this),fail:b.proxy(j,this)})
};
d.prototype.createMPPSessionUnregisteredUser=function(h){var i=function(k){this.createdMPPSessionUnregisteredUser=true;
return this.postBillingDetails(h)
},j=function(k){k=k.responseJSON||k.responseText||k;
return this.onFail(k,"mpp-session-create")
},g={Email:h.email,ClientUserId:this.responseData.gigya.UID,ServicePriceId:h["service-price-id"],UIDSignature:this.responseData.gigya.UIDSignature,signatureTimestamp:this.responseData.gigya.signatureTimestamp};
a.createSession(a.CREATE_SESSION_NEW_USER_URL,{data:g,onSuccess:b.proxy(i,this),onFail:b.proxy(j,this)})
};
d.prototype.createGigyaProfile=function(h){var i=function(k){if(k.status==="success"&&k.UID){this.responseData.gigya=k;
this.createdGigyaProfile=true;
this.updatedGigyaProfile=true;
this.updateFormValues(["email","email-confirm","country","first-name","last-name","password","password-confirm","accept-contact-f1","accept-contact-third-party","accept-terms","mobile-phone"],h);
return this.postProfileDetails(h)
}return this.onFail(k,"gigya-account-create")
},j=function(k){return this.onFail(k.responseJSON,"gigya-account-create")
},g={regToken:this.responseData.regToken,email:h.email,password:h.password,country:h.country,"first-name":h["first-name"],"last-name":h["last-name"],"accept-contact-f1":!!h["accept-contact-f1"],"accept-contact-third-party":!!h["accept-contact-third-party"],"accept-terms":!!h["accept-terms"],"create-user":"true","mobile-phone":h["billing-phone"]};
c.createAccount({data:g,success:b.proxy(i,this),fail:b.proxy(j,this)})
};
d.prototype.initialiseGigyaProfileCreate=function(g){var h=function(j){if(j.status==="success"&&j.regToken){this.initialisedGigyaProfileCreate=true;
this.responseData.regToken=j.regToken;
return this.postProfileDetails(g)
}i(j)
},i=function(j){j=j.responseJSON||j.responseText||j;
this.onFail(j,"gigya-account-init")
};
c.initAccount({success:b.proxy(h,this),fail:b.proxy(i,this)})
};
d.prototype.updateFormValues=function(g,j){var h=g.length,k="";
while(h--){k=g[h];
this.formValues[k]=j[g[h]]
}};
d.prototype.fieldHasUpdated=function(g,h){return this.formValues[h]!==g[h]
};
d.prototype.checkServicePriceIdChange=function(g){return this.fieldHasUpdated(g,"service-price-id")
};
d.prototype.checkVoucherCodeEntered=function(g){return g["redemption-code"]
};
d.prototype.checkPaymentInfoChange=function(g){return(this.fieldHasUpdated(g,"card-no")||this.fieldHasUpdated(g,"card-name")||this.fieldHasUpdated(g,"cvv")||this.fieldHasUpdated(g,"issue-number")||this.fieldHasUpdated(g,"expiry-month")||this.fieldHasUpdated(g,"expiry-year")||this.fieldHasUpdated(g,"card-type")||this.fieldHasUpdated(g,"billing-address-line-1")||this.fieldHasUpdated(g,"billing-address-line-2")||this.fieldHasUpdated(g,"billing-town")||this.fieldHasUpdated(g,"billing-country")||this.fieldHasUpdated(g,"billing-postcode"))
};
d.prototype.checkPasswordChange=function(g){return(this.fieldHasUpdated(g,"password")||this.fieldHasUpdated(g,"password-confirm"))
};
d.prototype.checkEmailChange=function(g){return(this.fieldHasUpdated(g,"email")||this.fieldHasUpdated(g,"email-confirm"))
};
d.prototype.checkProfileChange=function(g){return(this.checkEmailChange(g)||this.checkPasswordChange(g)||this.fieldHasUpdated(g,"country")||this.fieldHasUpdated(g,"first-name")||this.fieldHasUpdated(g,"last-name")||this.fieldHasUpdated(g,"accept-terms")||this.fieldHasUpdated(g,"billing-phone")||this.fieldHasUpdated(g,"accept-contact-f1")||this.fieldHasUpdated(g,"accept-contact-third-party"))
};
d.prototype.onFail=function(g,h){if(g&&g.validationErrors&&typeof g.validationErrors==="string"){g.validationErrors=b.parseJSON(g.validationErrors)
}this.onFailHandler(g,h)
};
return d
})(jQuery,fom.modules.mpp,fom.modules.gigya,fom.modules.user,fom.modules.authenticator);
fom.components.registrationform.form=(function(a,d){var c=function(){},b=a.prototype;
c.prototype=new a();
c.prototype.selectors=$.extend(a.prototype.selectors,{HOLDER:".registration-form"});
c.prototype.events={FORM_LOAD:"registrationFormLoad",INVALID_COUNTRY_SELECT:"registrationFormInvalidCountrySelect",INVALID_COUNTRY_SUBMIT:"registrationFormInvalidCountrySubmit",INVALID_COUNTRY_CTA_CLICK:"registrationFormInvalidCountryCTAClick",CLIENT_VALIDATION_ERROR:"registrationFormClientValidationError",SERVER_VALIDATION_ERROR:"registrationFormServerValidationError",FORM_SUBMIT:"registrationFormSubmit",SUBMIT_SUCCESS:"registrationFormSubmitSuccess"};
c.prototype.getExtraValidation=function(){return[{name:"email",rules:"required|valid_email|min_length[3]|max_length[100]"},{name:"email-confirm",display:"email verification",rules:"required|matches[email]"},{name:"password",rules:"required|min_length[8]|max_length[50]"},{name:"password-confirm",display:"password verification",rules:"required|matches[password]"},{name:"card-no",display:"credit card number",rules:"required|valid_credit_card"},{name:"cvv",display:"CVV",rules:"required|numeric|exact_length[3]"},{name:"accept-terms",display:"terms and conditions agreement",rules:"callback_terms_required"}]
};
c.prototype.init=function(){if(!b.init.call(this)){return false
}this.service=new d();
this._elements.$subCancelWrapper.remove();
return this
};
return new c().init()
})(fom.components.userform,fom.components.registrationform.service);
fom.components.registrationform.subscribestep1form=(function(d,c){var b=function(){},a=d.prototype;
b.prototype=new d();
b.prototype.selectors=$.extend(d.prototype.selectors,{HOLDER:".subscribe-fullaccess-form-step1-holder"});
b.prototype.events={FORM_LOAD:"subscribeStep1FormLoad",INVALID_COUNTRY_SELECT:"subscribeStep1FormInvalidCountrySelect",INVALID_COUNTRY_SUBMIT:"subscribeStep1FormInvalidCountrySubmit",INVALID_COUNTRY_CTA_CLICK:"subscribeStep1FormInvalidCountryCTAClick",CLIENT_VALIDATION_ERROR:"subscribeStep1FormClientValidationError",SERVER_VALIDATION_ERROR:"subscribeStep1FormServerValidationError",FORM_SUBMIT:"subscribeStep1FormSubmit",SUBMIT_SUCCESS:"subscribeStep1FormSubmitSuccess"};
b.prototype.getExtraValidation=function(){return[{name:"email",rules:"required|valid_email|min_length[3]|max_length[100]"},{name:"email-confirm",display:"email verification",rules:"required|matches[email]"},{name:"password",rules:"required|min_length[8]|max_length[50]"},{name:"password-confirm",display:"password verification",rules:"required|matches[password]"},{name:"accept-terms",display:"terms and conditions agreement",rules:"callback_terms_required"}]
};
b.prototype.init=function(){if(!a.init.call(this)){return false
}this.service=new c();
return this
};
return new b().init()
})(fom.components.userSubscribeStep1Form,fom.components.registrationform.service);
fom.components.registrationform.subscribestep2form=(function(b,d){var a=function(){},c=b.prototype;
a.prototype=new b();
a.prototype.selectors=$.extend(b.prototype.selectors,{HOLDER:".subscribe-fullaccess-form-step2-holder"});
a.prototype.events={FORM_LOAD:"subscribeStep2FormLoad",INVALID_COUNTRY_SELECT:"subscribeStep2FormInvalidCountrySelect",INVALID_COUNTRY_SUBMIT:"subscribeStep2FormInvalidCountrySubmit",INVALID_STATE_SELECT:"userSubscribeStep2FormInvalidStateSelect",INVALID_STATE_SUBMIT:"userSubscribeStep2FormInvalidStateSubmit",INVALID_COUNTRY_CTA_CLICK:"subscribeStep2FormInvalidCountryCTAClick",CLIENT_VALIDATION_ERROR:"subscribeStep2FormClientValidationError",SERVER_VALIDATION_ERROR:"subscribeStep2FormServerValidationError",FORM_SUBMIT:"subscribeStep2FormSubmit",SUBMIT_SUCCESS:"subscribeStep2FormSubmitSuccess"};
a.prototype.getExtraValidation=function(){return[{name:"billing-country",display:"billing country",rules:"callback_country_required|callback_check_country"},{name:"card-no",display:"credit card number",rules:"required|valid_credit_card"},{name:"cvv",display:"CVV",rules:"required|numeric|exact_length[3]"},{name:"billing-town",display:"billing town/city",rules:"required|max_length[30]"},{name:"billing-state",display:"billing state/province",rules:"callback_state_required|callback_check_state"},{name:"billing-postcode",display:"billing post code",rules:"required|alphanumeric|max_length[7]"}]
};
a.prototype.init=function(){if(!c.init.call(this)){return false
}this.service=new d();
this._elements.$subCancelWrapper.remove();
return this
};
return new a().init()
})(fom.components.userSubscribeStep2Form,fom.components.registrationform.service);
fom.components.userAccountManagement=(function(i,d,j,f,a,h,b){var g=function(){};
g.prototype.selectors={HOLDER:".user-account",FORM:".user-form",PROFILE_PREVIEW:".profile-preview",BILLING_PREVIEW:".billing-preview",PAYMENT:".form-fieldset--payment",BILLING:".billing-info",TRANSACTIONS:".transactionlist",PREVIEW_NAME:".preview-name",PREVIEW_EMAIL:".preview-email",PREVIEW_EXPIRY:".preview-expiry",PREVIEW_RENEWAL_NOTE:".preview-renewal-note",PREVIEW_MEMBERSHIP:".preview-membership-number",PURCHASE_UPGRADE_LINK:".purchase-upgrade-link",INPUT:".form-input",TEXT:".form-input--text",SELECT:".form-input--select",CHECKBOX:".form-input--checkbox",SUBMIT:".btn-save",COUNTRY:"#form-input-country",FIRST_NAME:"#form-input-first-name",LAST_NAME:"#form-input-last-name",EMAIL:"#form-input-email",EMAIL_VERIFY:"#form-input-email-verify",PASSWORD:"#form-input-password",PASSWORD_VERIFY:"#form-input-password-new",BILLING_LINE_1:"#form-input-billing-address-line-1",PREVIEW_BILLING_LINE_1:"#preview-billing-address-line-1",BILLING_LINE_2:"#form-input-billing-address-line-2",PREVIEW_BILLING_LINE_2:"#preview-billing-address-line-2",BILLING_TOWN:"#form-input-billing-town",PREVIEW_BILLING_TOWN:"#preview-billing-town",BILLING_PROVINCE:"#form-input-billing-state",PREVIEW_BILLING_PROVINCE:"#preview-billing-province",BILLING_COUNTRY:"#form-input-billing-country",PREVIEW_BILLING_COUNTRY:"#preview-billing-country",BILLING_POSTCODE:"#form-input-billing-postcode",PREVIEW_BILLING_POSTCODE:"#preview-billing-postcode",BILLING_PHONE:"#form-input-billing-phone",PREVIEW_BILLING_PHONE:"#preview-billing-phone",CARD_TYPE:"#form-input-card-type",PREVIEW_CARD_TYPE:"#preview-card-type",CARD_NAME:"#form-input-card-name",PREVIEW_CARD_NAME:"#preview-card-name",CARD_NUMBER:"#form-input-card-no",PREVIEW_CARD_NUMBER:"#preview-card-no",CARD_CVV:"#form-input-cvv",EXPIRY_MONTH:"#form-input-expiry-month",PREVIEW_EXPIRY_MONTH:"#preview-expiry-month",EXPIRY_YEAR:"#form-input-expiry-year",PREVIEW_EXPIRY_YEAR:"#preview-expiry-year",RADIO_MONTH:"#form-input-sub-month",RADIO_YEAR:"#form-input-sub-year",MONTHLY_PRICE:".monthly .price",YEARLY_PRICE:".yearly .price",ACCEPT_CONTACT_THIRD_PARTY:"#form-input-accept-contact-third-party",ACCEPT_CONTACT_F1:"#form-input-accept-contact-f1",PRICE_MONTH:".price-month",PRICE_YEAR:".price-year",MANDATORY_STATE_COUNTRIES:"#mandatory-state-country-list",SUB_CANCEL_WRAPPER:".sub-cancel-wrapper",SUB_CANCEL_BUTTON:".cancel-subscription",SUB_CANCEL_PENDING:".cancel-pending",SUB_MONTH_WRAPPER:".sub-month-wrapper",SUB_YEAR_WRAPPER:".sub-year-wrapper",REDEEM_VOUCHER_LINK:"#redeemVoucherLink",REDEEM_VOUCHER_BUTTON:".redeem-code-button",VOUCHER_INPUT:"#form-input-redeem-code",ERROR:".error",ERROR_DIV:".server-error",ERROR_PANEL:".form-error-panel",ERROR_PANEL_LIST:".form-error-panel-list",INVALID_COUNTRY:".invalid-country",SUCCESS:".success"};
g.prototype.events={FORM_LOAD:"userFormLoad",INVALID_COUNTRY_SELECT:"userFormInvalidCountrySelect",INVALID_COUNTRY_SUBMIT:"userFormInvalidCountrySubmit",INVALID_STATE_SELECT:"userFormInvalidStateSelect",INVALID_STATE_SUBMIT:"userFormInvalidStateSubmit",INVALID_COUNTRY_CTA_CLICK:"userFormInvalidCountryCTAClick",CLIENT_VALIDATION_ERROR:"userFormClientValidationError",SERVER_VALIDATION_ERROR:"userFormServerValidationError",FORM_SUBMIT:"userFormSubmit",SUBMIT_SUCCESS:"userFormSubmitSuccess"};
g.prototype.validation=[{name:"first-name",display:"first name",rules:"required|min_length[2]|max_length[100]"},{name:"last-name",display:"last name",rules:"required|min_length[2]|max_length[100]"},{name:"redemption-code",display:"redemption code",rules:"min_length[2]|max_length[20]"}];
g.prototype.getBillingValidations=function(){return[{name:"billing-country",display:"billing country",rules:"callback_country_required|callback_check_country"},{name:"billing-phone",display:"phone number",rules:"numeric|max_length[20]"},{name:"billing-address-line-1",display:"billing address (line 1)",rules:"required"},{name:"billing-town",display:"billing town/city",rules:"required|max_length[30]"},{name:"billing-state",display:"billing state/province",rules:"callback_state_required|callback_check_state"},{name:"billing-postcode",display:"billing post code",rules:"required|alphanumeric|max_length[7]"},{name:"card-type",display:"credit card type",rules:"required|default[default]"},{name:"card-name",display:"credit card name",rules:"required"},{name:"issue-number",display:"issue number",rules:"numeric|max_length[2]"},{name:"expiry-month",display:"expiry month",rules:"required|default[default]|callback_check_expiry"},{name:"expiry-year",display:"expiry year",rules:"required|default[default]|callback_check_expiry"}]
};
g.prototype.classes={HIDE:"hide",ERROR:"error",SUCCESS:"success-el",OTHER:"Other",INITIALISED:"initialised"};
g.prototype.init=function(){this.DEBUG=false;
if(!$.fn.detachOptions){$.fn.detachOptions=function(k){var l=this;
return l.each(function(){var m=l.data("selectOptions")||[];
l.find(k).each(function(){m.push($(this).detach())
});
l.data("selectOptions",m)
})
}
}if(!$.fn.attachOptions){$.fn.attachOptions=function(k){var l=this;
return l.each(function(){var n=l.data("selectOptions")||[];
for(var m in n){if(n[m].is(k)){l.append(n[m])
}}})
}
}if(!this.cacheElements()){return false
}if(!j.browserSupportsPremium()){window.fom.modules.modals.unsupportedBrowser(this.redirectUnsupportedBrowser);
return false
}this._elements.$purchaseUpgradeLink.hide();
this.validation=this.validation.concat(this.getExtraValidation());
this.validation=this.validation.concat(this.getBillingValidations());
return this
};
g.prototype.activate=function(){f.ready({onSuccess:$.proxy(function(){this.initPlaceholders();
this.initStyles();
this.initValidator();
this.attachListeners();
this.initPrices();
a.fireCustomEvent(this.events.FORM_LOAD);
if(this.DEBUG){this.initDebug()
}},this),onFail:$.proxy(function(){this.activate()
},this)})
};
g.prototype.redirectUnsupportedBrowser=function(){history.back()
};
g.prototype.initDebug=function(){};
g.prototype.getExtraValidation=function(){return[]
};
g.prototype.cacheElements=function(){var n=$(this.selectors.HOLDER),l=n.find(this.selectors.FORM),k=n.find(this.selectors.ERROR_DIV),m=k.find(this.selectors.ERROR_PANEL);
if(!n.length){return false
}return this._elements={$holder:n,$form:l,$previewName:l.find(this.selectors.PREVIEW_NAME),$previewEmail:l.find(this.selectors.PREVIEW_EMAIL),$previewExpiry:l.find(this.selectors.PREVIEW_EXPIRY),$previewRenewalNote:l.find(this.selectors.PREVIEW_RENEWAL_NOTE),$previewMembership:l.find(this.selectors.PREVIEW_MEMBERSHIP),$input:l.find(this.selectors.INPUT),$text:l.find(this.selectors.TEXT),$select:l.find(this.selectors.SELECT),$checkbox:l.find(this.selectors.CHECKBOX),$radioMonth:l.find(this.selectors.RADIO_MONTH),$radioYear:l.find(this.selectors.RADIO_YEAR),$monthlyPrice:l.find(this.selectors.MONTHLY_PRICE),$yearlyPrice:l.find(this.selectors.YEARLY_PRICE),$submit:l.find(this.selectors.SUBMIT),$country:l.find(this.selectors.COUNTRY),$cardNumber:l.find(this.selectors.CARD_NUMBER),$previewCardNumber:l.find(this.selectors.PREVIEW_CARD_NUMBER),$billingPhone:l.find(this.selectors.BILLING_PHONE),$expiryMonth:l.find(this.selectors.EXPIRY_MONTH),$expiryYear:l.find(this.selectors.EXPIRY_YEAR),$previewExpiryMonth:l.find(this.selectors.PREVIEW_EXPIRY_MONTH),$previewExpiryYear:l.find(this.selectors.PREVIEW_EXPIRY_YEAR),$password:l.find(this.selectors.PASSWORD),$passwordVerify:l.find(this.selectors.PASSWORD_VERIFY),$purchaseUpgradeLink:l.find(this.selectors.PURCHASE_UPGRADE_LINK),$priceMonth:l.find(this.selectors.PRICE_MONTH),$priceYear:l.find(this.selectors.PRICE_YEAR),$mandatoryStateCountries:l.find(this.selectors.MANDATORY_STATE_COUNTRIES),$subCancelWrapper:l.find(this.selectors.SUB_CANCEL_WRAPPER),$subCancelPending:l.find(this.selectors.SUB_CANCEL_PENDING),$subCancelButton:l.find(this.selectors.SUB_CANCEL_BUTTON),$subMonthWrapper:l.find(this.selectors.SUB_MONTH_WRAPPER),$subYearWrapper:l.find(this.selectors.SUB_YEAR_WRAPPER),$errors:n.find(this.selectors.ERROR),$successes:n.find(this.selectors.SUCCESS),$serverError:k,$errorPanel:m,$errorPanelList:m.find(this.selectors.ERROR_PANEL_LIST),$errorPanelWrap:m.parent().parent().parent(),$invalidCountry:l.find(this.selectors.INVALID_COUNTRY)}
};
g.prototype.initPlaceholders=function(){this._elements.$text.placeholder()
};
g.prototype.initStyles=function(){this._elements.$select.each($.proxy(function(k,l){this.onSelectChange.call(l)
},this));
this._elements.$form.addClass(this.classes.INITIALISED)
};
g.prototype.attachListeners=function(){this._elements.$form.on("input",$.proxy(this.onInputChange,this));
this._elements.$holder.on("click",this.selectors.INVALID_COUNTRY+" a",$.proxy(this.onInvalidCountryCTAClick,this));
this._elements.$checkbox.on("change",$.proxy(this.onCheckboxChange,this));
this._elements.$select.on("onchange change",this.onSelectChange);
this._elements.$expiryMonth.on("onchange change",$.proxy(this.onExpiryChange,this));
this._elements.$expiryYear.on("onchange change",$.proxy(this.onExpiryChange,this));
if(fom.components.countryDropdown){fom.components.countryDropdown.on("change",this.onCountryChange,this).on("invalidCountry",this.onInvalidCountrySelect,this)
}};
g.prototype.onInvalidCountryCTAClick=function(){a.fireCustomEvent(this.events.INVALID_COUNTRY_CTA_CLICK)
};
g.prototype.onInvalidCountrySelect=function(){a.fireCustomEvent(this.events.INVALID_COUNTRY_SELECT)
};
g.prototype.onCountryChange=function(k){this.updateCurrency(k.currency);
this.onCountryChangeUpdateValidations(k,true);
this.updateStateOptions(this._elements.$billingCountry.val(),true)
};
g.prototype.onCountryChangeUpdateValidations=function(l,n){var m=-1,k=this._elements.$mandatoryStateCountries.val().split(",");
if($.inArray(this._elements.$billingCountry.val(),k)===-1){this._formValidator.RemoveField("billing-state");
this._elements.$billingProvince.parent().parent().removeClass(this.classes.ERROR);
$(".error-message",this._elements.$billingProvince.parent().parent()).remove()
}else{if($.inArray(this._elements.$billingCountry.val(),k)>-1){this._formValidator.AddField({name:"billing-state",display:"billing state/province",rules:"callback_state_required|callback_check_state"})
}}if(!n){this.updateStateOptions(this._elements.$billingCountry.val(),false)
}};
g.prototype.updateStateOptions=function(n,o){var k=this._elements.$mandatoryStateCountries.val().split(","),l=$.inArray(n,k)>-1;
for(var m=0;
m<k.length;
m++){if(l){this._elements.$billingProvince.attachOptions("option");
if(!o){this._elements.$billingProvince.val("default")
}}else{this._elements.$billingProvince.detachOptions("option");
this._elements.$billingProvince.attachOptions('option[value="Non-USA/Other"]');
this._elements.$billingProvince.val("Non-USA/Other")
}}};
g.prototype.initValidator=function(){this._formValidator=new i(this._elements.$form.first()[0],this.validation,$.proxy(this.onValidation,this),$.proxy(this.onBeforeValidation,this));
this._formValidator.registerCallback("check_dropdown",$.proxy(this.checkDropdown,this));
this._formValidator.registerCallback("check_expiry",$.proxy(this.checkExpiry,this));
this._formValidator.registerCallback("check_country",$.proxy(this.checkCountry,this));
this._formValidator.registerCallback("check_state",$.proxy(this.checkState,this));
this._formValidator.registerCallback("country_required",function(k){return(k!==null&&k!==""&&k!=="default")
}).setMessage("country_required","Please select your country from the list");
this._formValidator.registerCallback("state_required",function(k){return(k!==null&&k!==""&&k!=="default")
}).setMessage("state_required","Please select your state from the list");
this._formValidator.registerCallback("terms_required",function(){return $("#form-input-accept-terms").is(":checked")
}).setMessage("terms_required","You need to accept the Terms & Conditions before proceeding")
};
g.prototype.onBeforeValidation=function(n){var m={},o=this,q,k,l=false,p=false;
if(this._elements.$cardNumber.length>0){l=true;
q=this._elements.$cardNumber.val()
}if(this._elements.$billingPhone.length>0){p=true;
k=this._elements.$billingPhone.val()
}a.fireCustomEvent(this.events.FORM_SUBMIT);
if(this._elements.$form.prop("disabled")){return false
}this._elements.$input.each(function(r,s){m=$(s);
m.val($.trim(m.val()))
});
if(l){if(q.substr(0,15)!=="XXXX-XXXX-XXXX-"){this._elements.$cardNumber.val(j.stripSpacesHyphensBrackets(q));
this._elements.$previewCardNumber.val(j.stripSpacesHyphensBrackets(q))
}}return true
};
g.prototype.onValidation=function(l,k){if(k&&k.preventDefault){k.preventDefault()
}else{if(event){event.returnValue=false
}}if(l.length>0){a.fireCustomEvent(this.events.CLIENT_VALIDATION_ERROR);
this.handleErrors(l,"client-validation")
}else{this.postForm()
}return false
};
g.prototype.postForm=function(){var k=this.getMappedForm();
this._elements.$errorPanelWrap.addClass(this.classes.HIDE);
this._elements.$errors.addClass(this.classes.HIDE);
this._elements.$successes.addClass(this.classes.HIDE);
this._elements.$input.parent().removeClass(this.classes.ERROR);
this._elements.$select.parent().parent().removeClass(this.classes.ERROR);
this._elements.$checkbox.closest(".form-input-expand").parent().removeClass(this.classes.ERROR);
$(".error-message",this._elements.$form).remove();
this.disableForm();
this.disableSubmit();
this.service.post(k,$.proxy(this.onPostSuccess,this),$.proxy(this.onPostFail,this))
};
g.prototype.onPostFail=function(k,l){a.fireCustomEvent(this.events.SERVER_VALIDATION_ERROR);
this.enableForm();
this.enableSubmit();
if(!k||!l){return this.unknownError()
}this.showErrorFromPointOfFailure(k,l)
};
g.prototype.showErrorFromPointOfFailure=function(k,m){var l=[];
switch(m){case"mpp-manage-card-details":case"mpp-add-subscription":case"mpp-user-update":case"mpp-user-create":l=this.parseMPPErrors(k);
if(l){return this.handleErrors(l,m)
}return this.handleErrors([{message:k.ErrorMessage}],m);
case"gigya-account-create":case"gigya-account-update":case"gigya-voucher-redemption":l=this.parseGigyaErrors(k);
return this.handleErrors(l,m);
case"gigya-account-init":case"mpp-session-create":default:return this.unknownError(m)
}};
g.prototype.unknownError=function(k){return this.handleErrors([{message:"Unexpected error occurred."}],k)
};
g.prototype.parseMPPErrors=function(k){var m=k.ErrorMessage,l;
if(m){if(m.match("BillingPostcode had illegal characters.")){l=this.getInput("billing-postcode")
}else{if(m.match("BillingTownCity had illegal characters.")){l=this.getInput("billing-town")
}else{if(m.match("BillingStreet had illegal characters.")){l=this.getInput("billing-address-line-2")
}else{if(m.match("BillingHouseName had illegal characters.")){l=this.getInput("billing-address-line-1")
}else{if(m.match("FirstName had illegal characters.")){l=this.getInput("first-name")
}else{if(m.match("Surname had illegal characters.")){l=this.getInput("last-name")
}}}}}}if(l){return[{element:l,message:"Contains illegal characters.",showFieldName:true,code:k.ErrorNumber.toString()}]
}}if(k.ErrorNumber){switch(k.ErrorNumber.toString()){case"1018":return[{element:this.getInput("email"),message:"email already exists",showFieldName:true,code:k.ErrorNumber.toString()}]
}}return false
};
g.prototype.parseGigyaErrors=function(m){var k=0,l=[];
if(m.validationErrors){k=m.validationErrors.length;
while(k--){switch(m.validationErrors[k].fieldName){case"email":l.push({element:this.getInput("email"),message:m.validationErrors[k].message,showFieldName:true,code:m.validationErrors[k].errorCode});
break;
case"password":case"newPassword":l.push({element:this.getInput("password"),message:m.validationErrors[k].message,showFieldName:true,code:m.validationErrors[k].errorCode});
break
}}return l
}else{if(m.errorDetails){if(m.errorDetails.match("Invalid argument: Invalid email")){return[{element:this.getInput("email"),message:"Invalid email address.",code:m.errorCode}]
}else{if(m.errorDetails.match("'password' cannot be the same as 'newPassword'")){return[{element:this.getInput("password-confirm"),message:"Your new password cannot be the same as your previous password.",code:m.errorCode}]
}else{if(m.errorDetails.match("invalid loginID or password")){return[{element:this.getInput("password"),message:"Current password incorrect.",code:m.errorCode}]
}}}}}return[{message:"Invalid profile details entered."}]
};
g.prototype.handleErrors=function(l,k){k=this.pointOfFailureToErrorCode(k);
if($("main").hasClass("account-details-registered")){this.newErrorMessageView(l,k)
}else{this.oldErrorMessageView(l,k)
}};
g.prototype.oldErrorMessageView=function(q,k){var l=0,m=q.length,o={},r={},s="",n="",p="";
k=this.pointOfFailureToErrorCode(k);
while(l<3){o=q[l];
p=['<span class="error-code">[Reference: ',k.toUpperCase(),(o.code||""),"]</span>"].join("");
if(o.element){r=$(o.element);
if(o.showFieldName){n=r.data("title");
if(o.message){n=[n,o.message].join(" - ")
}}else{n=o.message||""
}s+="<li>"+n+p+"</li>";
if(e(r)){r=r.parent()
}r.addClass(this.classes.ERROR)
}else{if(o.message){s+=["<li>",o.message,p,"</li>"].join("")
}}l++
}this._elements.$errorPanelList.html(s);
this._elements.$errorPanelWrap.removeClass(this.classes.HIDE);
this._elements.$serverError.removeClass(this.classes.HIDE);
setTimeout($.proxy(function(){var t=this._elements.$errorPanel.offset().top-1;
if(d.size==d.sizes.NARROW){t-=$(".site-header .site-header-wrap").height()
}$("html, body").animate({scrollTop:t},"slow")
},this),0)
};
g.prototype.newErrorMessageView=function(v,l){var m=0,q=v.length,s={},w={},x="",r="",u="",p="";
var t=this.classes.ERROR;
var k="success-el";
var n=this.validation;
var o=false;
while(m<3){s=v[m];
o=false;
if(s&&s.element){w=$(s.element);
p=['<div class="error-message">',s.message,"</div>"].join("");
if(e(w)){o=w.attr("name")=="expiry-month"||w.attr("name")=="expiry-year";
w=w.parent().parent()
}else{if(c(w)){w=w.closest(".form-input-expand").parent();
p=['<div class="error-message clearbottom">',s.message,"</div>"].join("")
}else{w=w.parent();
o=w.parents(".change-password").length
}}w.removeClass(k);
w.addClass(t);
$(".error-message",w).remove();
if(o){w.append(p)
}else{w.prepend(p)
}}else{if(s&&s.message){x+=["<li>",s.message,u,"</li>"].join("")
}}m++
}$.each(n,function(){var z=$("[name="+this.name+"]");
var y;
if(e(z)){y=z.parent().parent()
}else{if(c(z)){y=z.closest(".form-input-expand").parent()
}else{y=z.parent()
}}if(!y.hasClass(t)){y.addClass(k)
}});
if(typeof v[0].element!=="undefined"){$("html, body").animate({scrollTop:$(v[0].element).offset().top-30},"slow")
}else{this._elements.$errorPanelList.html(x);
this._elements.$errorPanelWrap.removeClass(this.classes.HIDE);
this._elements.$serverError.removeClass(this.classes.HIDE);
setTimeout($.proxy(function(){var y=this._elements.$errorPanel.offset().top-1;
if(d.size==d.sizes.NARROW){y-=$(".site-header .site-header-wrap").height()
}$("html, body").animate({scrollTop:y},"slow")
},this),0)
}};
g.prototype.pointOfFailureToErrorCode=function(m){var k=m.split("-"),l=0;
m="";
for(;
l<k.length;
l++){m+=k[l][0]
}return m
};
g.prototype.onPostSuccess=function(){var k=this._elements.$form.data("complete-url");
a.fireCustomEvent(this.events.SUBMIT_SUCCESS);
this._elements.$input.val("");
this._elements.$select.val("default");
window.location=k
};
g.prototype.disableForm=function(){this._elements.$input.prop("disabled",true);
this._elements.$form.prop("disabled",true)
};
g.prototype.enableForm=function(){this._elements.$input.prop("disabled",false);
this._elements.$form.prop("disabled",false)
};
g.prototype.enableSubmit=function(){this._elements.$submit.removeClass("loading");
this._elements.$submit.prop("disabled",false)
};
g.prototype.disableSubmit=function(){this._elements.$submit.addClass("loading");
this._elements.$submit.prop("disabled",true)
};
g.prototype.onCheckboxChange=function(l){var k=$(l.target);
if(k.attr("id")==="form-input-reveal-password"){var n=this.getInput("password");
if(k.is(":checked")){n.attr("type","text")
}else{n.attr("type","password")
}}else{var m=k.closest(".form-input-expand").parent();
if(m.hasClass(this.classes.ERROR)){$(".error-message",m).remove();
m.removeClass(this.classes.ERROR)
}}};
g.prototype.onInputChange=function(l){var k=$(l.target);
if(e(k)){k=k.parent().parent()
}else{if(c(k)){k=k.closest(".form-input-expand").parent()
}else{k=k.parent()
}}k.removeClass(this.classes.ERROR);
$(".error-message",k).remove()
};
g.prototype.onSelectChange=function(k){var l=$(this),m=l.find(":selected");
if(m.val()==="default"){l.addClass("default-selected")
}else{l.removeClass("default-selected")
}};
g.prototype.onExpiryChange=function(k){this._elements.$expiryMonth.parent().removeClass(this.classes.ERROR);
this._elements.$expiryYear.parent().removeClass(this.classes.ERROR)
};
g.prototype.updateCurrency=function(l){var k=f.getPrice(l,"month"),n=f.getPrice(l,"year"),m=j.getCurrencySymbol(l);
this._elements.$priceMonth.text(k.string);
this._elements.$priceYear.text(n.string);
this._elements.$monthlyPrice.text(k.string),this._elements.$yearlyPrice.text(n.string),this._elements.$radioMonth.val(k.data.ServicePriceId);
this._elements.$radioYear.val(n.data.ServicePriceId)
};
g.prototype.getInput=function(k){return this._elements.$input.filter("[name="+k+"]")
};
g.prototype.checkCountry=function(k){var l=(k===this.classes.OTHER);
if(l){a.fireCustomEvent(this.events.INVALID_COUNTRY_SUBMIT)
}return !l
};
g.prototype.checkState=function(m){var k=this._elements.$mandatoryStateCountries.val().split(","),l=$.inArray(this._elements.$billingCountry.val(),k)>-1,n=(m==="Non-USA/Other"&&l);
if(n){a.fireCustomEvent(this.events.INVALID_STATE_SUBMIT)
}return !n
};
g.prototype.checkExpiry=function(){var k=new Date(),l=new Date().getTime(),n=Number(this._elements.$expiryMonth.val())-1,m=Number(this._elements.$expiryYear.find(":selected").text());
k.setMonth(n);
k.setFullYear(m);
k=k.getTime();
if(k<l){return false
}return true
};
g.prototype.getMappedForm=function(){var l={},k=this._elements.$form.serializeArray();
l.email=this._elements.$previewEmail.first().text();
$.map(k,function(m){l[m.name]=m.value
});
return l
};
function e(k){return k.is("select")
}function c(k){return k.is(":checkbox")
}g.prototype.activateBillingValidations=function(){var k=this.getBillingValidations();
for(var l=0;
l<k.length;
l++){this._formValidator.AddField(k[l])
}this.setEditingCardDetails(true);
this.setCardInfoChange(true)
};
g.prototype.deactivateBillingValidations=function(){var k=this.getBillingValidations();
for(var l=0;
l<k.length;
l++){this._formValidator.RemoveField(k[l].name)
}this.setEditingCardDetails(false);
this.setCardInfoChange(false)
};
return g
})(FormValidator,fom.utils.resizeManager,fom.utils,fom.modules.mpp,fom.tracking,fom.modules.modals,fom.config);
fom.components.accountmanagement||(fom.components.accountmanagement={});
fom.components.accountmanagement.service=(function(b,a,c,f,e){var d=function(){};
d.prototype.onFailHandler=function(){};
d.prototype.onSuccessHandler=function(){};
d.prototype.responseData={};
d.prototype.formValues={};
d.prototype.hasChangedProfileInfo=false;
d.prototype.hasChangedCardInfo=false;
d.prototype.hasChangedSubscriptionType=false;
d.prototype.hasChangedPassword=false;
d.prototype.hasChangedEmail=false;
d.prototype.hasChangedCVV=false;
d.prototype.hasActiveSubscription=true;
d.prototype.updatedGigyaProfile=false;
d.prototype.updatedMPPCardDetails=false;
d.prototype.userHadNoMPPAccount=false;
d.prototype.updatedMPPProfile=false;
d.prototype.createdMPPSession=false;
d.prototype.createdMPPUser=true;
d.prototype.createdMPPSubscriptionSession=false;
d.prototype.addedMPPSubscription=false;
d.prototype.updatedCookieSubscriptionStatus=false;
d.prototype.previousEmail="";
d.prototype.post=function(g,h,i){this.onFailHandler=i;
this.onSuccessHandler=h;
this.hasChangedProfileInfo=this.checkProfileChange(g);
this.hasChangedCardInfo=this.checkCardInfoChange(g);
this.hasChangedSubscriptionType=this.checkSubscriptionTypeChange(g);
this.hasChangedPassword=this.checkPasswordChange(g);
this.hasChangedEmail=this.checkEmailChange(g);
this.hasChangedCVV=this.checkCVVChange(g);
this.updatedGigyaProfile=false;
this.updatedMPPProfile=false;
this.createdMPPSession=false;
this.createdMPPSubscriptionSession=false;
this.updatedMPPCardDetails=false;
this.addedMPPSubscription=false;
this.updatedCookieSubscriptionStatus=false;
this.previousEmail=this.formValues.email;
if(g.isFreemium&&g.isFreemium=="true"){this.postFromPreviousStateFreemium(g)
}else{this.postFromPreviousState(g)
}};
d.prototype.postFromPreviousStateFreemium=function(g){if(this.hasChangedProfileInfo){if(!this.updatedGigyaProfile){return this.updateGigyaAccount(g)
}}return this.onSuccessHandler()
};
d.prototype.postFromPreviousState=function(g){if(g.isFreemium&&g.isFreemium=="true"){return this.postFromPreviousStateFreemium(g)
}if(this.hasChangedProfileInfo){if(!this.updatedGigyaProfile){return this.updateGigyaAccount(g)
}}if(this.userHadNoMPPAccount||(this.hasChangedSubscriptionType&&(this.hasChangedCardInfo||this.hasChangedCVV))){if(!this.createdMPPSubscriptionSession&&!this.userHadNoMPPAccount){return this.createMPPSubscriptionSession(g)
}else{if(!this.updatedMPPProfile&&g["billing-phone"]){return this.updateMPPProfile(g)
}else{if(this.hasChangedCardInfo&&!this.updatedMPPCardDetails){return this.updateMPPCardDetails(g)
}else{if(!this.addedMPPSubscription){return this.addMPPSubscription(g)
}else{if(!this.updatedCookieSubscriptionStatus){return this.updateCookieSubscriptionStatus(g)
}}}}}}else{if(this.hasChangedCardInfo){if(!this.updatedMPPCardDetails){return this.updateMPPCardDetails(g)
}}}return this.onSuccessHandler()
};
d.prototype.createUnregisteredUserMPPSession=function(h){var i=function(k){this.createdMPPSession=true;
this.updateFormValues(["service-price-id"],h);
return this.postFromPreviousState(h)
},j=function(k){k=k.responseJSON||k.responseText||k;
return this.onFail(k,"mpp-session-create")
},g={Email:h.email,ServicePriceId:h["service-price-id"],ClientUserId:fom.modules.user.accountInfo.UID,UIDSignature:fom.modules.user.accountInfo.UIDSignature,signatureTimestamp:fom.modules.user.accountInfo.signatureTimestamp};
a.createSession(a.CREATE_SESSION_NEW_USER_URL,{data:g,onSuccess:b.proxy(i,this),onFail:b.proxy(j,this)})
};
d.prototype.createMPPUser=function(h){var i=function(k){this.createdMPPUser=true;
this.updateFormValues(["billing-phone"],h);
this.userHadNoMPPAccount=true;
return this.postFromPreviousState(h)
},j=function(k){return this.onFail(k.responseJSON,"mpp-user-create")
},g={UserCreateInfo:{ClientUserId:fom.modules.user.accountInfo.UID,EmailAddress:h.email,FirstName:a.cleanIllegalCharacters(h["first-name"]),MobilePhoneNumber:h["billing-phone"],Surname:a.cleanIllegalCharacters(h["last-name"]),Gender:"NotKnown",AccountTypeId:0}};
a.api({methodName:"UserCreate",onSuccess:b.proxy(i,this),onFail:b.proxy(j,this),requestData:g})
};
d.prototype.applyVoucherCode=function(h,l,i){var g={voucher:h["redemption-code"]},j=function(){f.updateAccountInfo(b.proxy(function(){if(!this.reAuthedUser){return this.reAuthUser(l,i)
}},this))
},k=function(m){if(!m.respnseJSON){m.respnseJSON={}
}m.respnseJSON.isVoucherError=true;
m.respnseJSON.voucherCode=h["redemption-code"];
return i(m.respnseJSON)
};
this.reAuthedUser=false;
c.redeemVoucher({data:g,success:b.proxy(j,this),fail:b.proxy(k,this)})
};
d.prototype.reAuthUser=function(i,g){var h=function(j){if(j.status===307||j.status===204){this.reAuthedUser=true;
return i()
}else{return g(j,"aem-login-failure")
}};
e.authenticate(f.accountInfo,b.proxy(h,this))
};
d.prototype.createMPPSession=function(g){var h=function(j){this.createdMPPSession=true;
return this.postFromPreviousState(g)
},i=function(j){j=j.responseJSON||j.responseText||j;
return this.onFail(j,"mpp-session-create")
};
a.createSession(a.CREATE_SESSION_EXISTING_USER_URL,{data:{ClientUserId:f.accountInfo.UID,UIDSignature:f.accountInfo.UIDSignature,signatureTimestamp:f.accountInfo.signatureTimestamp},onSuccess:b.proxy(h,this),onFail:b.proxy(i,this)})
};
d.prototype.createMPPSubscriptionSession=function(h){var i=function(k){return this.postFromPreviousState(h)
},j=function(k){k=k.responseJSON||k.responseText||k;
return this.onFail(k,"mpp-session-create")
},g={Email:h.email,ServicePriceId:h["service-price-id"],ClientUserId:f.accountInfo.UID,UIDSignature:f.accountInfo.UIDSignature,signatureTimestamp:f.accountInfo.signatureTimestamp};
this.createdMPPSubscriptionSession=true;
a.createSession(a.CREATE_SESSION_NEW_USER_URL,{data:g,onSuccess:b.proxy(i,this),onFail:b.proxy(j,this)})
};
d.prototype.updateMPPCardDetails=function(h){var i=function(k){this.updateFormValues(["card-name","card-no","card-type","cvv","expiry-month","expiry-year","issue-number","billing-address-line-1","billing-address-line-2","billing-town","billing-country","billing-postcode"],h);
this.responseData.mppUserManageCreditDebitCard=k;
return this.postFromPreviousState(h)
},j=function(k){return this.onFail(k.responseJSON,"mpp-manage-card-details")
},g={CreditDebitCardDetails:{CardName:h["card-name"],CreditCardNumber:h["card-no"],CreditCardType:h["card-type"],Cv2Number:h.cvv,ExpiryDate:[h["expiry-month"],h["expiry-year"]].join("/"),IssueCode:h["issue-number"]||"",BillingHouseName:h["billing-address-line-1"].replace(/,/g,""),BillingStreet:h["billing-address-line-2"].replace(/,/g,""),BillingDistrict:h["billing-state"].replace(/,/g,""),BillingTownCity:h["billing-town"].replace(/,/g,""),BillingCountry:h["billing-country"].replace(/,/g,""),BillingPostcode:h["billing-postcode"]}};
this.updatedMPPCardDetails=true;
f.manageCardDetails({data:g,fail:b.proxy(j,this),success:b.proxy(i,this)})
};
d.prototype.updateMPPProfile=function(h){var i=function(k){this.updatedMPPProfile=true;
this.updateFormValues(["billing-phone"],h);
return this.postFromPreviousState(h)
},j=function(k){return this.onFail(k.responseJSON,"mpp-user-update")
},g={UserAmendInfo:{MobilePhoneNumber:h["billing-phone"]}};
f.setAccountInfoMPP({data:g,fail:b.proxy(j,this),success:b.proxy(i,this)})
};
d.prototype.updateCookieSubscriptionStatus=function(h,g){var i=function(j){if(j&&j.data&&j.data.subscriptionStatus&&j.data.subscriptionStatus==="active"){this.updatedCookieSubscriptionStatus=true;
e.authenticate(f.accountInfo,b.proxy(function(){return this.postFromPreviousState(h)
},this),500)
}else{return this.updateCookieSubscriptionStatus(h,g*2)
}};
g=g||500;
setTimeout(b.proxy(function(){f.updateAccountInfo(b.proxy(i,this))
},this),g)
};
d.prototype.addMPPSubscription=function(h){var i=function(k){return this.postFromPreviousState(h)
},j=function(k){k=k.responseJSON||k.responseText||k;
return this.onFail(k,"mpp-add-subscription")
},g={AddSubscriptionInfo:{ActivationCode:"",Cv2Number:h.cvv,MD:"",PaRes:"",RenewalDayOffset:"0",ServicePriceId:h["service-price-id"],TermUrl:""}};
this.addedMPPSubscription=true;
f.addSubscription({data:g,fail:b.proxy(j,this),success:b.proxy(i,this)})
};
d.prototype.updateMPPAccount=function(h){var i=function(k){this.updateFormValues(["billing-phone"],h);
if(this.hasChangedEmail){this.updateFormValues(["email","email-confirm"],h)
}return this.postFromPreviousState(h)
},j=function(k){k=k.responseJSON||k.responseText||k;
return this.onFail(k,"mpp-user-update")
},g={UserAmendInfo:{MobilePhoneNumber:h["billing-phone"],FirstName:h["first-name"],Surname:h["last-name"]}};
if(this.hasChangedEmail&&!this.userHadNoMPPAccount){g.UserAmendInfo["EmailAddress"]=this.previousEmail;
g.UserAmendInfo["NewEmailAddress"]=h.email
}this.updatedMPPProfile=true;
if(this.checkMPPRequiresUpdate(h)){f.setAccountInfoMPP({data:g,fail:b.proxy(j,this),success:b.proxy(i,this)})
}else{i.call(this)
}};
d.prototype.updateGigyaAccount=function(h){var i=function(k){if(k&&k.status==="success"){this.updateFormValues(["email","country","first-name","last-name","accept-contact-f1","accept-contact-third-party","mobile-phone"],h);
if(this.hasChangedPassword){this.updateFormValues(["password","password-confirm"],h)
}this.updateUserCookie();
return this.postFromPreviousState(h)
}else{return this.onFail(k,"gigya-account-update")
}},j=function(k){return this.onFail(k.responseJSON,"gigya-account-update")
},g={email:h.email,country:h.country,"first-name":h["first-name"],"last-name":h["last-name"],"accept-contact-f1":!!h["accept-contact-f1"],"accept-contact-third-party":!!h["accept-contact-third-party"],"accept-terms":true,UID:f.accountInfo.UID,UIDSignature:f.accountInfo.UIDSignature,signatureTimestamp:f.accountInfo.signatureTimestamp,"mobile-phone":h["billing-phone"]};
if(this.hasChangedPassword){g.password=h.password;
g.newPassword=h["password-confirm"]
}this.updatedGigyaProfile=true;
localStorage.setItem("userSubscriptionStatus",f.accountInfo.data.subscriptionStatus);
f.setAccountInfoGigya({data:g,fail:b.proxy(j,this),success:b.proxy(i,this)})
};
d.prototype.setFormValues=function(g){this.formValues=b.extend({},g)
};
d.prototype.updateUserCookie=function(){var g=f.accountInfo;
g.profile.firstName=this.formValues["first-name"];
g.profile.lastName=this.formValues["last-name"];
g.profile.email=this.formValues.email;
g.profile.country=this.formValues.country;
g.data.acceptContactF1=!!this.formValues["accept-contact-f1"];
g.data.acceptContactThirdParty=!!this.formValues["accept-contact-third-party"];
f.setAccountInfoCookie(g)
};
d.prototype.updateFormValues=function(g,j){var h=g.length,k="";
while(h--){k=g[h];
this.formValues[k]=j[g[h]]
}};
d.prototype.fieldHasUpdated=function(g,h){return this.formValues[h]!==g[h]
};
d.prototype.checkSubscriptionTypeChange=function(g){return this.fieldHasUpdated(g,"service-price-id")||!this.hasActiveSubscription
};
d.prototype.checkCardInfoChange=function(g){var h=this.fieldHasUpdated(g,"card-no")+this.fieldHasUpdated(g,"card-name")+this.fieldHasUpdated(g,"cvv")+this.fieldHasUpdated(g,"issue-number")+this.fieldHasUpdated(g,"expiry-month")+this.fieldHasUpdated(g,"expiry-year")+this.fieldHasUpdated(g,"card-type")+this.fieldHasUpdated(g,"billing-address-line-1")+this.fieldHasUpdated(g,"billing-address-line-2")+this.fieldHasUpdated(g,"billing-town")+this.fieldHasUpdated(g,"billing-state")+this.fieldHasUpdated(g,"billing-country")+this.fieldHasUpdated(g,"billing-postcode");
if((h===1&&this.fieldHasUpdated(g,"cvv"))||!this.editingCardDetails){return false
}return !!h
};
d.prototype.checkMPPRequiresUpdate=function(g){return(this.fieldHasUpdated(g,"first-name")||this.fieldHasUpdated(g,"last-name")||this.fieldHasUpdated(g,"billing-phone")||this.hasChangedEmail)
};
d.prototype.checkCVVChange=function(g){return this.fieldHasUpdated(g,"cvv")
};
d.prototype.checkPasswordChange=function(g){return(this.fieldHasUpdated(g,"password")||this.fieldHasUpdated(g,"password-confirm"))
};
d.prototype.checkEmailChange=function(g){return(this.fieldHasUpdated(g,"email")||this.fieldHasUpdated(g,"email-confirm"))
};
d.prototype.checkProfileChange=function(g){return(this.checkEmailChange(g)||this.checkPasswordChange(g)||this.fieldHasUpdated(g,"country")||this.fieldHasUpdated(g,"first-name")||this.fieldHasUpdated(g,"last-name")||this.fieldHasUpdated(g,"billing-phone")||this.fieldHasUpdated(g,"accept-contact-f1")||this.fieldHasUpdated(g,"accept-contact-third-party"))
};
d.prototype.getServiceInfoAll=function(h){var g=function(i){h.onSuccess(i)
};
a.getServiceInfoAll({onSuccess:b.proxy(g,this),onFail:h.onFail})
};
d.prototype.setUserHasActiveSubscription=function(g){if(!this.createdMPPUser||!g.responseData.mppActiveSubscription){this.hasActiveSubscription=false
}else{this.hasActiveSubscription=g.responseData.mppActiveSubscription.ServiceInformation[0].ServiceStatus==="active"
}};
d.prototype.onFail=function(g,h){if(g&&g.validationErrors&&typeof g.validationErrors==="string"){g.validationErrors=b.parseJSON(g.validationErrors)
}this.onFailHandler(g,h)
};
return d
})(jQuery,fom.modules.mpp,fom.modules.gigya,fom.modules.user,fom.modules.authenticator);
fom.components.accountmanagement||(fom.components.accountmanagement={});
fom.components.accountmanagement.appsubscriberservice=(function(a,b,e,d){var c=function(){};
c.prototype.onFailHandler=function(){};
c.prototype.onSuccessHandler=function(){};
c.prototype.formValues={};
c.prototype.hasChangedProfileInfo=false;
c.prototype.hasChangedPassword=false;
c.prototype.hasChangedEmail=false;
c.prototype.updatedGigyaProfile=false;
c.prototype.previousEmail="";
c.prototype.post=function(f,g,h){this.onFailHandler=h;
this.onSuccessHandler=g;
this.hasChangedProfileInfo=this.checkProfileChange(f);
this.hasChangedPassword=this.checkPasswordChange(f);
this.hasChangedEmail=this.checkEmailChange(f);
this.updatedGigyaProfile=false;
this.previousEmail=this.formValues.email;
this.postFromPreviousState(f)
};
c.prototype.postFromPreviousState=function(f){if(!this.updatedGigyaProfile){return this.updateGigyaAccount(f)
}return this.onSuccessHandler()
};
c.prototype.updateGigyaAccount=function(g){var h=function(j){if(j&&j.status==="success"){this.updateFormValues(["email","country","first-name","last-name","accept-contact-f1","accept-contact-third-party"],g);
if(this.hasChangedPassword){this.updateFormValues(["password","password-confirm"],g)
}this.updateUserCookie();
return this.postFromPreviousState(g)
}else{return this.onFail(j,"gigya-account-update")
}},i=function(j){return this.onFail(j.responseJSON,"gigya-account-update")
},f={email:g.email,country:g.country,"first-name":g["first-name"],"last-name":g["last-name"],"accept-contact-f1":!!g["accept-contact-f1"],"accept-contact-third-party":!!g["accept-contact-third-party"],"accept-terms":true,UID:e.accountInfo.UID,UIDSignature:e.accountInfo.UIDSignature,signatureTimestamp:e.accountInfo.signatureTimestamp};
if(this.hasChangedPassword){f.password=g.password;
f.newPassword=g["password-confirm"]
}this.updatedGigyaProfile=true;
e.setAccountInfoGigya({data:f,fail:a.proxy(i,this),success:a.proxy(h,this)})
};
c.prototype.setFormValues=function(f){this.formValues=a.extend({},f)
};
c.prototype.updateUserCookie=function(){var f=e.accountInfo;
f.profile.firstName=this.formValues["first-name"];
f.profile.lastName=this.formValues["last-name"];
f.profile.email=this.formValues.email;
f.profile.country=this.formValues.country;
f.data.acceptContactF1=!!this.formValues["accept-contact-f1"];
f.data.acceptContactThirdParty=!!this.formValues["accept-contact-third-party"];
e.setAccountInfoCookie(f)
};
c.prototype.updateFormValues=function(f,h){var g=f.length,j="";
while(g--){j=f[g];
this.formValues[j]=h[f[g]]
}};
c.prototype.fieldHasUpdated=function(f,g){return this.formValues[g]!==f[g]
};
c.prototype.checkPasswordChange=function(f){return(this.fieldHasUpdated(f,"password")||this.fieldHasUpdated(f,"password-confirm"))
};
c.prototype.checkEmailChange=function(f){return(this.fieldHasUpdated(f,"email")||this.fieldHasUpdated(f,"email-confirm"))
};
c.prototype.checkProfileChange=function(f){return(this.checkEmailChange(f)||this.checkPasswordChange(f)||this.fieldHasUpdated(f,"country")||this.fieldHasUpdated(f,"first-name")||this.fieldHasUpdated(f,"last-name")||this.fieldHasUpdated(f,"billing-phone")||this.fieldHasUpdated(f,"accept-contact-f1")||this.fieldHasUpdated(f,"accept-contact-third-party"))
};
c.prototype.onFail=function(f,g){if(f&&f.validationErrors&&typeof f.validationErrors==="string"){f.validationErrors=a.parseJSON(f.validationErrors)
}this.onFailHandler(f,g)
};
return c
})(jQuery,fom.modules.gigya,fom.modules.user,fom.modules.authenticator);
fom.components.accountmanagement.retrievedataservice=(function(c,b,a,e){var d=c.extend({MPP_SESSION_FAIL:"mppSessionFail",ACCOUNT_INFO_LOADED:"accountInfoLoaded",ACCOUNT_INFO_FAILED:"accountInfoFailed",TRANSACTIONS_LOADED:"transactionsLoaded",TRANSACTIONS_FAILED:"transactionsFailed",responseData:{},init:function(){this.createMPPSession()
},createMPPSession:function(){var f=function(h){this.responseData.mppSession=h;
return this.getMPPAccountInfo()
},g=function(h){return this.onFail(h.responseJSON,"mpp-session-create")
};
a.createSession(a.CREATE_SESSION_EXISTING_USER_URL,{data:{ClientUserId:e.accountInfo.UID,UIDSignature:e.accountInfo.UIDSignature,signatureTimestamp:e.accountInfo.signatureTimestamp},onSuccess:c.proxy(f,this),onFail:c.proxy(g,this)})
},getMPPAccountInfo:function(){var f=function(h){this.responseData.mppAccountInfo=h;
this.getMPPActiveSubscription()
},g=function(h){this.trigger(this.ACCOUNT_INFO_FAILED,[h.responseJSON])
};
a.api({methodName:"UserInfo",onSuccess:c.proxy(f,this),onFail:c.proxy(g,this)})
},getMPPActiveSubscription:function(){var f=function(h){this.responseData.mppActiveSubscription=h;
this.getMPPTransactionInfo();
this.trigger(this.ACCOUNT_INFO_LOADED,[h])
},g=function(h){this.trigger(this.ACCOUNT_INFO_FAILED,[h.responseJSON]);
this.getMPPTransactionInfo()
};
a.api({methodName:"UserServices",onSuccess:c.proxy(f,this),onFail:c.proxy(g,this)})
},getMPPTransactionInfo:function(){var g=function(i){this.responseData.transactionData=i;
this.trigger(this.TRANSACTIONS_LOADED,[i])
},h=function(i){this.responseData.transactionData=false;
if(i&&i.responseJSON){this.trigger(this.TRANSACTIONS_FAILED,[i.responseJSON])
}},f={UserOrderHistoryDetails:{FromDate:"/Date(0+0000)/",ToDate:"/Date("+new Date().getTime()+"+0000)/",SortAscending:false,NumOrdersInPage:100,PageNum:1}};
a.api({methodName:"UserOrderHistory",requestData:f,onSuccess:c.proxy(g,this),onFail:c.proxy(h,this)})
},onFail:function(f,g){this.trigger(this.MPP_SESSION_FAIL,[f])
}},b);
return d
})(jQuery,fom.utils.eventDispatcher.object,fom.modules.mpp,fom.modules.user);
fom.components.accountmanagement.form=(function(g,k,b,j,e,n,m,a,i,f,h){var c=function(){},l=g.prototype;
c.prototype=new g();
c.prototype.selectors=$.extend(g.prototype.selectors,{HOLDER:".user-account",LOADER:".user-form-loader",CONTENT:".user-form-content",TRANSACTION_LIST_TABLE:".transaction-list-table",TRANSACTION_LIST_BODY_EXPANDED:".mobile-hide .transaction-list-body",TRANSACTION_LIST_BODY_COLLAPSED:".mobile-view .transaction-list-body",TRANSACTION_LIST_EMPTY:".transaction-list-empty",APP_SUBSCRIBER_MESSAGE:".app-subscriber-message",CANCEL_FORM:".cancel-button",UPDATE_BUTTON:".update-button"});
c.prototype.events={FORM_LOAD:"accountManagementFormLoad",INVALID_COUNTRY_SELECT:"accountManagementFormInvalidCountrySelect",INVALID_COUNTRY_SUBMIT:"accountManagementFormInvalidCountrySubmit",INVALID_COUNTRY_CTA_CLICK:"accountManagementFormInvalidCountryCTAClick",CLIENT_VALIDATION_ERROR:"accountManagementFormClientValidationError",SERVER_VALIDATION_ERROR:"accountManagementFormServerValidationError",FORM_SUBMIT:"accountManagementFormSubmit",SUBMIT_SUCCESS:"accountManagementFormSubmitSuccess",CANCEL_SUBSCRIPTION_CLICK:"accountManagementCancelSubscriptionClick",CANCEL_SUBSCRIPTION_CONFIRM:"accountManagementCancelSubscriptionConfirm"};
c.prototype.getExtraValidation=function(){return[{name:"email",rules:"required|valid_email|min_length[3]|max_length[100]",depends:$.proxy(this.checkEmailChange,this)},{name:"email-confirm",display:"email verification",rules:"required|matches[email]",depends:$.proxy(this.checkEmailChange,this)},{name:"password",display:"current password",rules:"required|min_length[8]|max_length[50]",depends:$.proxy(this.checkPasswordChange,this)},{name:"password-confirm",display:"new password",rules:"required|min_length[8]|max_length[50]",depends:$.proxy(this.checkPasswordChange,this)},{name:"card-no",display:"credit card number",rules:"required|valid_credit_card",depends:$.proxy(this.checkCardInfoChange,this)},{name:"cvv",display:"CVV",rules:"required|numeric|exact_length[3]",depends:$.proxy(this.checkCardInfoOrCVVChange,this)}]
};
c.prototype.appSubscriberValidation=function(){return[{name:"email",rules:"required|valid_email|min_length[3]|max_length[100]",depends:$.proxy(this.checkEmailChange,this)},{name:"email-confirm",display:"email verification",rules:"required|matches[email]",depends:$.proxy(this.checkEmailChange,this)},{name:"password",display:"current password",rules:"required|min_length[8]|max_length[50]",depends:$.proxy(this.checkPasswordChange,this)},{name:"password-confirm",display:"new password",rules:"required|min_length[8]|max_length[50]",depends:$.proxy(this.checkPasswordChange,this)},{name:"first-name",display:"first name",rules:"required|min_length[2]|max_length[100]"},{name:"last-name",display:"last name",rules:"required|min_length[2]|max_length[100]"}]
};
c.prototype.init=function(){if(!l.init.call(this)||(!j.isLoggedIn&&!i.isEditMode)){return false
}if(i.isEditMode){this.initTransactionView();
this.initFormView();
return
}e.ready({onSuccess:$.proxy(this.retrieveUserData,this),onFail:function(){}});
this._elements.$purchaseUpgradeLink.hide();
this._elements.$updateBtn.prop("disabled","true");
return this
};
c.prototype.retrieveUserData=function(){j.updateAccountInfo($.proxy(function(){j.setUserProperties();
if(j.subscriptionSource==="app"){this.service=new b()
}else{this.service=new k()
}if(j.subscriptionSource==="web"||!j.subscriptionSource){n.on("accountInfoLoaded",this.initFormView,this).on("transactionsLoaded",this.initTransactionView,this).on("accountInfoFailed",this.initFormView,this).on("transactionsFailed",this.initTransactionView,this).on("mppSessionFail",this.onMPPSessionFail,this).init(e.CREATE_SESSION_EXISTING_USER_URL)
}else{this.initTransactionView();
this.initFormView()
}},this))
};
c.prototype.initValidator=function(){if(j.subscriptionSource==="app"){this._formValidator=new FormValidator(this._elements.$form.first()[0],this.appSubscriberValidation(),$.proxy(this.onValidation,this),$.proxy(this.onBeforeValidation,this));
return
}else{l.initValidator.call(this)
}};
c.prototype.onMPPSessionFail=function(o){if(o&&o.message&&o.message.indexOf("Account cannot be found")>-1){this.service.createdMPPUser=false
}this.initTransactionView();
this.initFormView()
};
c.prototype.cacheElements=function(){var p=l.cacheElements.call(this),q=this.selectors,o=p?p.$input:undefined,r=this._elements.$holder;
if(!p){return false
}return this._elements=$.extend(p,{$loader:p.$holder.find(q.LOADER),$content:p.$holder.find(q.CONTENT),$updateBtn:p.$holder.find(q.UPDATE_BUTTON),$firstName:o.filter(q.FIRST_NAME),$lastName:o.filter(q.LAST_NAME),$email:o.filter(q.EMAIL),$emailVerify:o.filter(q.EMAIL_VERIFY),$purchaseUpgradeLink:p.$holder.find(q.PURCHASE_UPGRADE_LINK),$billingLine1:o.filter(q.BILLING_LINE_1),$billingLine2:o.filter(q.BILLING_LINE_2),$billingTown:o.filter(q.BILLING_TOWN),$billingProvince:o.filter(q.BILLING_PROVINCE),$billingCountry:o.filter(q.BILLING_COUNTRY),$billingPostcode:o.filter(q.BILLING_POSTCODE),$billingPhone:o.filter(q.BILLING_PHONE),$previewBillingLine1:p.$holder.find(q.PREVIEW_BILLING_LINE_1),$previewBillingLine2:p.$holder.find(q.PREVIEW_BILLING_LINE_2),$previewBillingTown:p.$holder.find(q.PREVIEW_BILLING_TOWN),$previewBillingProvince:p.$holder.find(q.PREVIEW_BILLING_PROVINCE),$previewBillingCountry:p.$holder.find(q.PREVIEW_BILLING_COUNTRY),$previewBillingPostcode:p.$holder.find(q.PREVIEW_BILLING_POSTCODE),$previewBillingPhone:p.$holder.find(q.PREVIEW_BILLING_PHONE),$cardType:o.filter(q.CARD_TYPE),$cardName:o.filter(q.CARD_NAME),$previewCardType:p.$holder.find(q.PREVIEW_CARD_TYPE),$previewCardName:p.$holder.find(q.PREVIEW_CARD_NAME),$paymentFieldset:p.$holder.find(q.PAYMENT),$billingFieldset:p.$holder.find(q.BILLING),$transactions:p.$holder.find(q.TRANSACTIONS),$acceptContactThirdParty:o.filter(q.ACCEPT_CONTACT_THIRD_PARTY),$acceptContactF1:o.filter(q.ACCEPT_CONTACT_F1),$redeemVoucherButton:o.filter(q.REDEEM_VOUCHER_BUTTON),$redeemVoucherInput:o.filter(q.VOUCHER_INPUT),$transactionListTable:p.$holder.find(q.TRANSACTION_LIST_TABLE),$transactionListBodyExpanded:p.$holder.find(q.TRANSACTION_LIST_BODY_EXPANDED),$transactionListBodyCollapsed:p.$holder.find(q.TRANSACTION_LIST_BODY_COLLAPSED),$transactionListEmpty:p.$holder.find(q.TRANSACTION_LIST_EMPTY),$appSubscriberMessage:p.$holder.find(q.APP_SUBSCRIBER_MESSAGE)})
};
c.prototype.attachListeners=function(){if(!l.listenersAttached){l.attachListeners.call(this);
l.listenersAttached=true;
this._elements.$form.on("change input",$.proxy(this.onFormChange,this));
this._elements.$cardType.one("onchange change",$.proxy(this.onCardTypeChange,this));
this._elements.$holder.on("click",this.selectors.CANCEL_FORM,this.onCancelFormClick);
this._elements.$holder.on("click",this.selectors.SUB_CANCEL_BUTTON,$.proxy(this.onSubscriptionCancelClick,this));
this._elements.$holder.on("click",this.selectors.REDEEM_VOUCHER_BUTTON,$.proxy(this.onRedeemVoucherClick,this))
}};
c.prototype.onFormChange=function(o){if(d(this._firstForm,this.getMappedForm())){this._elements.$updateBtn.prop("disabled","true")
}else{this._elements.$updateBtn.prop("disabled",false)
}};
c.prototype.onBeforeValidation=function(o){if(!l.onBeforeValidation.call(this)){return false
}return !d(this._firstForm,this.getMappedForm())
};
function d(q,p){function o(t,s){for(var r in t){if(r==="service-price-id"){continue
}if(t.hasOwnProperty(r)){if(!s.hasOwnProperty(r)){return false
}if(t[r]!=s[r]){return false
}}}return true
}return o(q,p)&&o(p,q)
}c.prototype.onCancelFormClick=function(o){o.preventDefault();
if(!j.isPremium&&window.location.search&&window.location.search.indexOf("upsell=true")!=-1){window.location=window.location.pathname
}else{window.location.reload()
}};
c.prototype.onSubscriptionCancelClick=function(o){o.preventDefault();
a.fireCustomEvent(this.events.CANCEL_SUBSCRIPTION_CLICK);
f.confirmCancelSubscription({confirm:$.proxy(this.cancelSubscription,this),cancel:function(){}})
};
c.prototype.onRedeemVoucherClick=function(o){o.preventDefault();
a.fireCustomEvent(this.events.REDEEM_VOUCHER_CLICK);
$(".error-message",this._elements.$redeemVoucherInput.parent()).remove();
this._elements.$redeemVoucherInput.parent().removeClass("error");
this._elements.$holder.find(this.selectors.REDEEM_VOUCHER_BUTTON).addClass("loading");
if(this._elements.$redeemVoucherInput.val()){this.redeemVoucher()
}else{this.redeemVoucherFailure({isVoucherError:true})
}};
c.prototype.redeemVoucher=function(){this.service.applyVoucherCode(this.getMappedForm(),$.proxy(this.redeemVoucherSuccess,this),$.proxy(this.redeemVoucherFailure,this))
};
c.prototype.redeemVoucherSuccess=function(o){if(!j.isPremium){i.localStorage.setItem("accountManagementMessage","freeVoucherSuccess")
}else{i.localStorage.setItem("accountManagementMessage","paidVoucherSuccess")
}a.fireCustomEvent(this.events.VOUCHER_REDEMPTION_SUCCESS);
if(window.location.href.indexOf("#")>-1){window.location=window.location.href.substr(0,window.location.href.indexOf("#"))
}else{window.location.reload()
}};
c.prototype.redeemVoucherFailure=function(p,q){if(p.isVoucherError){var o='<div class="error-message">Invalid or expired voucher code entered</div>';
this._elements.$redeemVoucherInput.parent().addClass("error");
this._elements.$redeemVoucherInput.parent().append(o);
this._elements.$holder.find(this.selectors.REDEEM_VOUCHER_BUTTON).removeClass("loading");
return
}};
c.prototype.cancelSubscription=function(){var p=this.getMappedForm()["service-price-id"],o=e.getServiceIdFromServicePriceId(p);
e.cancelSubscription({data:{ServiceId:o,subscriptionToken:j.accountInfo.data.subscriptionToken,ClientUserId:j.accountInfo.UID,UIDSignature:j.accountInfo.UIDSignature,signatureTimestamp:j.accountInfo.signatureTimestamp,userExpiry:n.responseData.mppActiveSubscription.ServiceInformation[0].ExpiryDateUTC.slice(6,-7)},onSuccess:$.proxy(this.onCancelSubscriptionComplete,this),onFail:function(){}})
};
c.prototype.onCancelSubscriptionComplete=function(o){var p=function(q){if(q&&q.data){i.localStorage.setItem("accountManagementMessage","cancelSuccess");
a.fireCustomEvent(this.events.CANCEL_SUBSCRIPTION_CONFIRM);
window.location.reload()
}else{return this.onCancelSubscriptionComplete(o*2)
}};
o=o||500;
setTimeout($.proxy(function(){j.updateAccountInfo($.proxy(p,this))
},this),o)
};
c.prototype.onCardTypeChange=function(){this._currentFormValues=this.getMappedForm();
if(this.checkCardInfoChange()){this._elements.$cardName.val("");
this._elements.$cardNumber.val("");
this._elements.$expiryMonth.val("default").addClass("default-selected");
this._elements.$expiryYear.val("default").addClass("default-selected")
}};
c.prototype.initFormView=function(){if(this.service&&this.service.setUserHasActiveSubscription){this.service.setUserHasActiveSubscription(n)
}this._elements.$previewExpiry.text("Free F1 Access membership");
this.initProfileView();
if((j.subscriptionSource==="web"||!j.subscriptionSource)&&j.isPremium){this.initBillingView();
this.initPaymentView()
}else{if(!j.isPremium&&window.location.search&&window.location.search.indexOf("upsell=true")!=-1){this.initBillingView();
this.initPaymentView();
this._elements.$purchaseUpgradeLink.hide()
}else{if(!j.isPremium&&window.location.search.indexOf("upsell=true")===-1){this._elements.$purchaseUpgradeLink.show();
this.initAppSubscriberView()
}else{this.initAppSubscriberView()
}}}this.initAgreementsView();
if(!i.isEditMode){this.service.setFormValues(this.getMappedForm());
this._currentFormValues=this.getMappedForm();
this._firstForm=this.getMappedForm()
}this._elements.$input.parent().removeClass(this.classes.ERROR);
this._elements.$select.parent().parent().removeClass(this.classes.ERROR);
this._elements.$checkbox.closest(".form-input-expand").parent().removeClass(this.classes.ERROR);
$(".error-message",this._elements.$form).remove();
this._elements.$input.parent().removeClass(this.classes.SUCCESS);
this._elements.$select.parent().parent().removeClass(this.classes.SUCCESS);
this._elements.$checkbox.closest(".form-input-expand").parent().removeClass(this.classes.SUCCESS);
if(this.failedVoucher){var o='<div class="error-message">Invalid or expired voucher code entered</div>';
this._elements.$redeemVoucherInput.parent().addClass("error");
this._elements.$redeemVoucherInput.parent().append(o);
this.failedVoucher=false
}this.activate()
};
c.prototype.initAppSubscriberView=function(){this._elements.$billingFieldset.remove();
this._elements.$transactions.remove();
this._elements.$paymentFieldset.remove()
};
c.prototype.initAgreementsView=function(){if(i.isEditMode||!j.accountInfo.data){return
}if(j.accountInfo.data.acceptContactF1){this._elements.$acceptContactF1.prop("checked",(j.accountInfo.data.acceptContactF1.toString())==="true"?"checked":"")
}if(j.accountInfo.data.acceptContactThirdParty){this._elements.$acceptContactThirdParty.prop("checked",(j.accountInfo.data.acceptContactThirdParty.toString())==="true"?"checked":"")
}};
c.prototype.initProfileView=function(p,q){i=p||i;
j=q||j;
if(i.isEditMode){return
}if(!!j.accountInfo.profile.country&&!!this._elements.$country.find('option[value="'+j.accountInfo.profile.country+'"]')[0]){this._elements.$country.val(j.accountInfo.profile.country)
}else{if(!!j.accountInfo.profile.country&&!this._elements.$country.find('option[value="'+j.accountInfo.profile.country+'"]')[0]){this._elements.$country.val("Other")
}}if(!!j.accountInfo.data.subscriptionExpiry&&Date.parse(j.accountInfo.data.subscriptionExpiry.replace(" ","T"))){var o=new Date(j.accountInfo.data.subscriptionExpiry.replace(" ","T"));
if(j.subscriptionSource==="app"){this._elements.$previewExpiry.text("App subscription expires "+[o.getDate(),"/",String(o.getMonth()+1),"/",o.getFullYear()].join(""))
}else{this._elements.$previewExpiry.text("Web subscription expires "+[o.getDate(),"/",String(o.getMonth()+1),"/",o.getFullYear()].join(""))
}}this._elements.$previewName.text(j.get("fullName"));
this._elements.$previewMembership.text(j.accountInfo.UID.substr(0,12));
this._elements.$firstName.val(j.accountInfo.profile.firstName);
this._elements.$lastName.val(j.accountInfo.profile.lastName);
this._elements.$previewEmail.text(j.accountInfo.profile.email);
this._elements.$password.val("");
this._elements.$passwordVerify.val("");
this._elements.$password.prop("placeholder","Current password");
this._elements.$passwordVerify.prop("placeholder","New password")
};
c.prototype.initBillingView=function(){var q=n.responseData.mppAccountInfo,s=n.responseData.mppActiveSubscription.ServiceInformation[0];
if(q){var o=new Date();
o.setTime(s.ExpiryDateUTC.slice(6,-7));
q.BillingAddress.Country=q.BillingAddress.Country?q.BillingAddress.Country:"";
var p=this._elements.$billingCountry.find("option").filter(function(){return this.value.toLowerCase()===q.BillingAddress.Country.toLowerCase()
}).attr("value")||"Other";
q.BillingAddress.District=q.BillingAddress.District?q.BillingAddress.District:"";
var r=this._elements.$billingProvince.find("option").filter(function(){return this.value.toLowerCase()===q.BillingAddress.District.toLowerCase()
}).attr("value")||"Non-USA/Other";
this._elements.$billingLine1.val(q.BillingAddress.HouseName);
this._elements.$billingLine2.val(q.BillingAddress.Street);
this._elements.$billingTown.val(q.BillingAddress.TownCity);
this._elements.$billingCountry.val(p);
this._elements.$billingProvince.val(r);
this._elements.$billingPostcode.val(q.BillingAddress.PostCode);
this._elements.$billingPhone.val(q.PhoneNumbers.MobilePhoneNumber);
this._elements.$previewBillingLine1.text(q.BillingAddress.HouseName);
this._elements.$previewBillingLine2.text(q.BillingAddress.Street);
this._elements.$previewBillingTown.text(q.BillingAddress.TownCity);
this._elements.$previewBillingProvince.text(r);
this._elements.$previewBillingCountry.text(p);
this._elements.$previewBillingPostcode.text(q.BillingAddress.PostCode);
if(q.PhoneNumbers.MobilePhoneNumber!=null){this._elements.$previewBillingPhone.text(q.PhoneNumbers.MobilePhoneNumber)
}}};
c.prototype.initPaymentView=function(){var r=n.responseData.mppAccountInfo,s={},q=[],p=false,o="";
if(r&&!r.CreditCard){this._elements.$subCancelWrapper.remove();
this.initAppSubscriberView();
return false
}if(r){s=n.responseData.mppActiveSubscription;
q=r.CreditCard.ExpiryDate.split("/");
p=e.hasActiveSubscription(s);
this._elements.$cardType.val(r.CreditCard.CreditCardType);
this._elements.$cardName.val(r.CreditCard.CardName);
this._elements.$cardNumber.val("XXXX-XXXX-XXXX-"+r.CreditCard.LastFourDigits);
this._elements.$expiryMonth.val(q[0]);
this._elements.$expiryYear.val(q[1]);
this._elements.$previewCardType.text(r.CreditCard.CreditCardType);
this._elements.$previewCardName.text(r.CreditCard.CardName);
this._elements.$previewCardNumber.text(r.CreditCard.LastFourDigits);
this._elements.$previewExpiryMonth.text(q[0]);
this._elements.$previewExpiryYear.text(q[1])
}if(j.isPremium){p=p[0];
this._cancelPriceUpdates=true;
this._elements.$subCancelWrapper.show();
if(p){o=e.getCategoryById(p.SubscriptionInformation["ServicePriceId"]);
switch(p.SubscriptionInformation["AutoRenew"].toString()){case"true":this._elements.$subCancelPending.hide();
this._elements.$previewRenewalNote.text("Your subscription is set to renew on the expiry date.");
this._elements.$previewRenewalNote.show();
break;
case"false":this._elements.$subCancelButton.hide();
this._elements.$previewRenewalNote.hide();
break
}}if(o==="month"){this._elements.$radioMonth.prop("checked",true);
this._elements.$subYearWrapper.remove()
}else{if(o==="year"){this._elements.$radioYear.prop("checked",true);
this._elements.$subMonthWrapper.remove()
}}}else{this._elements.$subCancelWrapper.remove()
}};
c.prototype.onPostSuccess=function(){a.fireCustomEvent(this.events.SUBMIT_SUCCESS);
i.localStorage.setItem("accountManagementMessage","updateSuccess");
window.location.reload()
};
c.prototype.initPrices=function(){m.onPriceInit($.proxy(this.onCountryChange,this));
if(this._cancelPriceUpdates){m.off("change",this.onCountryChange);
m.on("change",$.proxy(this.onCountryChangeUpdateValidations,this));
this.updateCurrency(n.responseData.mppActiveSubscription.ServiceInformation[0]["SubscriptionInformation"]["Currency"]);
this.service.setFormValues(this.getMappedForm())
}};
c.prototype.onBeforeValidation=function(o){if(!l.onBeforeValidation.call(this,o)){return false
}this._currentFormValues=this.getMappedForm();
return true
};
c.prototype.checkCardInfoOrCVVChange=function(){return this.checkCardInfoChange()||this.service.checkCVVChange(this._currentFormValues)
};
c.prototype.checkCardInfoChange=function(){return this.cardInfoChanged&&this.service.checkCardInfoChange(this._currentFormValues)
};
c.prototype.setEditingCardDetails=function(o){this.service.editingCardDetails=o
};
c.prototype.setCardInfoChange=function(o){this.cardInfoChanged=o
};
c.prototype.checkPasswordChange=function(){return this.passwordChanged||this.service.checkPasswordChange(this._currentFormValues)
};
c.prototype.setPasswordChanged=function(o){this.passwordChanged=o
};
c.prototype.setVoucherError=function(p){this.failedVoucher=p;
if(this.failedVoucher){var o='<div class="error-message">Invalid or expired voucher code entered</div>';
this._elements.$redeemVoucherInput.parent().addClass("error");
this._elements.$redeemVoucherInput.parent().append(o);
this._elements.$redeemVoucherInput.val(this.failedVoucher)
}};
c.prototype.checkEmailChange=function(){return this.service.checkEmailChange(this._currentFormValues)
};
c.prototype.initTransactionView=function(){var q="",p="",o={},u=0,r=new Date(),t={};
if(i.isEditMode){return this.activatePage()
}if(j.subscriptionSource==="app"||!j.subscriptionSource){this._elements.$transactionListTable.remove();
this._elements.$transactionListEmpty.remove();
this._elements.$holder.find(this.selectors.REDEEM_VOUCHER_LINK).remove()
}else{if(!n.responseData.transactionData||!n.responseData.transactionData.TotalNumberOfOrders){this._elements.$appSubscriberMessage.remove();
this._elements.$transactionListTable.remove()
}else{o=n.responseData.transactionData;
u=o.TotalNumberOfOrders;
for(var s=0;
s<u;
s++){t=o.Baskets[s].Basket[0];
r.setTime(t.OrderDateUTC.slice(6,-7));
q+=["<tr><td>",r.getUTCDate(),"/",String(r.getUTCMonth()+1),"/",r.getUTCFullYear(),"</td>"].join("");
q+=["<td>",t.OrderDescription,"</td>"].join("");
q+=["<td>",i.getCurrencySymbol(t.Currency),Number(t.TaxResult.GrossAmount).toFixed(2),"</td></tr>"].join("");
p+=['<tr><td colspan="2"><div class="pull-left">',r.getUTCDate(),"/",String(r.getUTCMonth()+1),"/",r.getUTCFullYear(),'</div><div class="pull-right">',i.getCurrencySymbol(t.Currency),Number(t.TaxResult.GrossAmount).toFixed(2),'</div><div style="clear:both;font-weight:normal;">',t.OrderDescription,"</div></td></tr>"].join("")
}this._elements.$transactionListBodyExpanded.html(q);
this._elements.$transactionListBodyCollapsed.html(p);
this._elements.$appSubscriberMessage.remove();
this._elements.$transactionListEmpty.remove()
}}return this.activatePage()
};
c.prototype.activatePage=function(){this._elements.$content.removeClass("hide");
this._elements.$loader.addClass("hide")
};
return new c()
})(fom.components.userAccountManagement,fom.components.accountmanagement.service,fom.components.accountmanagement.appsubscriberservice,fom.modules.user,fom.modules.mpp,fom.components.accountmanagement.retrievedataservice,fom.components.countryDropdown,fom.tracking,fom.utils,fom.modules.modals,fom.modules.authenticator);
(function(g,h,d){var b="LB_Sentinel_{:id}.js";
var a="LBSentinelCallback_{:id}";
var f="LiveBlogCallback_{:id}";
var c=(function(){if(d.isPremium){return"LiveBlog_{:id}.js"
}return"LB_Free_{:id}.js"
}());
var i="live_comms";
var e=function(k,j){this.options=$.extend({pollInterval:1000*5,feedUrl:"http://f1tata.bc.cdn.bitgravity.com/commentary/",queueLimit:5},j);
this.blogId=k;
this._dataId=null;
this._callbacks=[];
this._queue=[];
window[this.sentinelCallback()]=$.proxy(this._checkForUpdateHandler,this);
window[this.dataCallback()]=$.proxy(this._fetchHandler,this)
};
g.liveCommentary||(g.liveCommentary={});
g.liveCommentary.DeltatreService=e;
e.prototype={onData:function(j){this._callbacks.push(j)
},_notify:function(j){$.each(this._callbacks,function(k,l){l.call(null,j)
})
},start:function(){if(this._isPolling){throw new Error("Attempted to start current Deltatre service")
}this.startWithStoredData();
this._startPolling()
},startWithStoredData:function(){var k;
try{k=h.localStorage.getItem(i)
}catch(j){}if(!k){return
}if(k.blogId===this.blogId&&k.premium===d.isPremium){this._dataId=k.ts;
this._notify(k.data)
}else{h.localStorage.removeItem(i)
}},stop:function(){this._isPolling=false;
clearInterval(this._pollTimer)
},_startPolling:function(){var j=$.proxy(this._checkForUpdate,this);
this._pollTimer=setInterval(j,this.options.pollInterval);
this._isPolling=true;
j()
},_checkForUpdate:function(){this._makeRequest(this.sentinelUrl())
},_fetch:function(){this._makeRequest(this.dataUrl())
},_makeRequest:function(k){var j;
if(this.hasSpaceInQueue()){j=$.ajax({url:k,dataType:"jsonp",cache:false});
j.always($.proxy(this._removeFromQueue,this));
this._queue.push(j)
}},_checkForUpdateHandler:function(j){if(j.ts!==this._dataId){this._dataId=j.ts;
this._fetch()
}},_fetchHandler:function(j){this._notify(j);
h.localStorage.setItem(i,{ts:this._dataId,blogId:this.blogId,premium:d.isPremium,data:j})
},hasSpaceInQueue:function(){return this._queue.length<this.options.queueLimit
},dataUrl:function(){return h.interpolate(this.options.feedUrl+c,{id:this.blogId})
},dataCallback:function(){return h.interpolate(f,{id:this.blogId})
},sentinelUrl:function(){return h.interpolate(this.options.feedUrl+b,{id:this.blogId})
},sentinelCallback:function(){return h.interpolate(a,{id:this.blogId})
},_removeFromQueue:function(j){var k=$.inArray(j,this._queue);
if(k!==-1){this._queue.splice(k,1)
}},destroy:function(){var j=function(){};
this.stop();
window[this.sentinelCallback()]=j;
window[this.dataCallback()]=j
}}
}(fom.components,fom.utils,fom.modules.user));
(function(b){var a={YELLOW_FLAG:"flag yellow",GREEN_FLAG:"flag green",RED_FLAG:"flag red",BLUE_FLAG:"flag blue",SC_DEPLOYED:"safety_car yellow",CHEQUERED_FLAG:"checkered_flag",DRS_ENABLED:"drs green",DRS_DISABLED:"drs red",ERROR:"error yellow",OVERTAKING:"overtake blue",RECAP:"repost",TV_IMAGE:"tv_image"};
b.liveCommentary||(b.liveCommentary={});
b.liveCommentary.templates={};
b.liveCommentary.templates.Base=(function(){var c=function(){};
c.prototype.iconType=function(d){return a[d]
};
c.prototype.cleanTags=function(e){var d=new RegExp(b.liveCommentary.TAG_REGEX,"gi");
return $.trim(e.replace(d,""))
};
c.prototype.stripHtml=function(d){return d.replace(/<[^>]+>/g,"")
};
c.prototype.wrap=function(e,d){return'<div class="post-content '+(d||"text").toLowerCase()+'">'+e+"</div>"
};
c.prototype.findDataNode=function(f,d){var e;
$.each(f,function(h,g){if(g.Name===d){e=g;
return false
}});
return e
};
return{extend:function(d){var e=function(){};
e.prototype=new c();
$.extend(e.prototype,d);
return new e()
}}
}())
}(fom.components));
(function(a){a.templates.mainPost=a.templates.Base.extend({render:function(e,c,f){var d=[],b=f==="RECAP";
if(this.hasCustomTags(c)){d.push('<div class="post-meta ',(b?"recap":""),'">');
if(b){d.push('<span class="post-type">Recap</span>')
}if(c.l){d.push('<span class="post-tag lap-number">L',c.l,"</span>")
}else{if(c.t){d.push('<span class="post-tag custom">',c.t,"</span>")
}}d.push("</div>")
}d.push('<ol class="posts">');
[].push.apply(d,$.map(e,function(g){if(g){return'<li class="content-item">'+g+"</li>"
}return""
}));
d.push("</ol>");
return d.join("")
},hasCustomTags:function(b){var c=false;
$.each(a.CUSTOM_TAGS,function(e,d){if(b[d]){c=true;
return false
}});
return c
}})
}(fom.components.liveCommentary));
(function(a){a.text=a.Base.extend({render:function(c,e){var d=this.cleanTags(c.Text),b="";
if(d){b=this.cleanTags(c.Html);
b=this.wrap('<i class="icon icon-'+(this.iconType(e)||"text")+'"></i>'+b)
}return b
}})
}(fom.components.liveCommentary.templates));
(function(a){String.prototype.parseURL=function(){return this.replace(/(http|https|ftp|ftps)\:\/\/[a-zA-Z0-9\-\.]+\.[a-zA-Z]{2,3}(\/\S*)?/g,function(b){return b.link(b)
})
};
String.prototype.parseUsername=function(){return this.replace(/[@]+[A-Za-z0-9-_]+/g,function(b){var c=b.replace("@","");
return b.link("https://twitter.com/"+c)
})
};
String.prototype.parseHashtag=function(){return this.replace(/[#]+[A-Za-z0-9-_]+/g,function(c){var b=c.replace("#","");
return c.link("https://twitter.com/hashtag/"+b)
})
};
a.twitter=a.Base.extend({render:function(b){return this.wrap('<i class="icon icon-twitter"></i>'+this.rebuild(b),"tweet")
},rebuild:function(b){var g="",e=$(b.Html),d=e.find(".twitter-tweet"),c=d.find("p").html(),h="- "+b.ContentAuthorName.replace(/\+/g," ")+" ("+("@"+b.ContentAuthor).parseUsername()+")",f=d.find("a[data-datetime]");
c=c.parseURL().parseUsername().parseHashtag();
g="<p>"+c+"</p>";
g=g+h+" "+$("<output>").append(f.clone()).html();
d.html(g);
d.find("a").attr("target","_blank");
return $("<div>").append(e.clone()).html()
}})
}(fom.components.liveCommentary.templates));
(function(b,a){b.raceFeed=b.Base.extend({render:function(c,d){return this.wrap(this.iconHtml(d)+c.Html,"race-feed")
},iconHtml:function(e){var d=this.iconType(e),c="";
if(d){c=a.interpolate('<i class="icon icon-{:classNames}"></i>',{classNames:d})
}return c
}})
}(fom.components.liveCommentary.templates,fom.utils));
(function(a){a.facebook=a.Base.extend({render:function(b){return this.wrap('<i class="icon icon-facebook"></i>'+b.Html,"facebook")
}})
}(fom.components.liveCommentary.templates));
(function(b,a){b.audio=b.Base.extend({render:function(c){return this.wrap('<i class="icon icon-audio"></i>'+this.html(c),"audio")
},html:function(d){var c=d.Html;
var e={audioUrl:c.replace(/^.*href=(?:"|')([^"']+)(?:"|').*$/,"$1"),description:this.stripHtml(c.replace(/^.*<a[^>]+>(.*?)<\/a>.*$/,"$1")),playerId:(+new Date)+Math.floor(Math.random()*1000)};
e.audioUrl="//"+e.audioUrl.replace(/^https?:\/\//,"");
return a.interpolate(['<div id="jp_player_{:playerId}" class="jp-jplayer" data-url="{:audioUrl}" data-title="{:description}" data-player-id="{:playerId}"></div>','<div id="jp_container_{:playerId}" class="jp-audio" role="application" aria-label="media player">','<div class="jp-type-single">','<div class="jp-details">','<div class="jp-title" aria-label="title">&nbsp;</div>',"</div>",'<div class="jp-interface-wrapper">','<div class="jp-gui jp-interface">','<div class="jp-progress">','<div class="jp-seek-bar">','<div class="jp-play-bar"></div>',"</div>","</div>","</div>",'<div class="jp-controls">','<button class="jp-play" role="button" tabindex="0">','<i class="icon-play3"></i>','<span class="assistive-text">play</span>',"</button>","</div>",'<div class="jp-time-holder">','<div class="jp-current-time" role="timer" aria-label="time">&nbsp;</div>',"</div>","</div>",'<div class="jp-no-solution">',"<span>Update Required</span>",'To play the media you will need to either update your browser to a recent version or update your <a href="http://get.adobe.com/flashplayer/" target="_blank">Flash plugin</a>.',"</div>","</div>","</div>"].join(""),e)
}})
}(fom.components.liveCommentary.templates,fom.utils));
(function(a){a.youtube=a.Base.extend({render:function(b){return this.wrap('<i class="icon icon-youtube"></i>'+b.Html,"youtube")
}})
}(fom.components.liveCommentary.templates));
(function(b,a){b.image=b.Base.extend({render:function(d,f,e){var c=this.imageTemplate(e);
if(!c){return""
}return a.interpolate(this.wrap('<i class="icon icon-{:icon}"></i>'+c,"image"),{icon:this.iconType(f)||"tv_image"})
},imageTemplate:function(g){var d=this,i=d.getGallaryParams(g),j=[320,640,768,1024,1536],h=function(){var o="",q=j,m=i.urlSections,k="//"+m.host+m.directory+m.filename,p=m.extention,n=j.length-1,l=0;
for(;
n>=0;
n--){l=j[n];
o=o+'<span data-media="(max-width: '+l+'px)" data-src="'+k+"_"+l+p+'"></span>'
}return o
},f=function(){return('<div class="manual-gallery"><div class="gallery-inpage"><div class="swiper-container"><div class="swiper-wrapper"><figure class="swiper-slide"><div class="image fom-adaptiveimage"><span data-media="" data-src="{:imageUrl}"></span>'+h()+'</div></figure></div><a href="#" class="gallery-enlarge gallery-enlarge-link" title="Enlarge"><span class="icon-enlarge"></span></a><a href="#" class="gallery-enlarge gallery-enlarge-hitarea"><span>Enlarge</span></a></div></div><div class="gallery-modal"><div class="gallery-modal-container"><a class="gallery-modal-close-link icon-close"><span>Close</span></a><div class="gallery-modal-wrapper"></div></div></div></div>')
},e=function(){return('<div class="manual-gallery"><div class="gallery-inpage"><div class="swiper-container"><div class="swiper-wrapper"><figure class="swiper-slide"><div class="image"><img src="{:imageUrl}" alt=""></div></figure></div><a href="#" class="gallery-enlarge gallery-enlarge-link" title="Enlarge"><span class="icon-enlarge"></span></a><a href="#" class="gallery-enlarge gallery-enlarge-hitarea"><span>Enlarge</span></a></div></div><div class="gallery-modal"><div class="gallery-modal-container"><a class="gallery-modal-close-link icon-close"><span>Close</span></a><div class="gallery-modal-wrapper"></div></div></div></div>')
},c;
if(i.imageUrl){c=i.isLegacy?e():f();
return a.interpolate(c,i)
}},extractImageUrl:function(d){var c=this.findDataNode(d,"ImageLink");
if(c){return c.Value
}},getGallaryParams:function(f){var c=this,d=c.extractImageUrl(f),g=d.indexOf("/f1tata/tv_images")===-1,e={isLegacy:g,imageUrl:d};
if(!g){e.urlSections=a.parseUri(d)
}return e
}})
}(fom.components.liveCommentary.templates,fom.utils));
(function(c,a){var b=c.PostTypes={Text:"TEXT",Race:"RACECONTROLFEED",Tweet:"TWITTER",Facebook:"FACEBOOK",Audio:"AUDIOFEED",Image:"TVIMAGESFEED",GalleryImage:"AKQA GALLERIES",MediaManager:"MEDIA MANAGER",Video:"MRSS",YouTube:"YOUTUBE"};
c.CUSTOM_TAGS=["l","t"];
c.TAG_REGEX="@(\\w+)\\(([^)]+)\\);";
c.CUSTOM_TAG_REGEX=a.interpolate("@({:tags})\\(([^)]+)\\);",{tags:c.CUSTOM_TAGS.join("|")});
c.Renderer={render:function(f){var e=this.parsePost(f),d=this.renderPosts(e.posts,f);
return c.templates.mainPost.render(d,e.tags,f.PostSubType)
},renderPosts:function(d,g){var f=g.PostSubType,e=g.PostData||[];
if(g.ExternalResourceType=="503"){return[c.templates.audio.render(d[0])]
}return $.map(d,function(h){switch(h.TypeName){case b.Race:return c.templates.raceFeed.render(h,f);
case b.Tweet:return c.templates.twitter.render(h);
case b.Audio:return c.templates.audio.render(h);
case b.Facebook:return c.templates.facebook.render(h);
case b.YouTube:return c.templates.youtube.render(h);
case b.Image:case b.GalleryImage:return c.templates.image.render(h,f,e);
case b.MediaManager:case b.Video:return"";
default:return c.templates.text.render(h,f)
}})
},parsePost:function(e){var f=new RegExp(c.CUSTOM_TAG_REGEX),d={tags:{},posts:[]};
$.each(e.Text,$.proxy(function(g,h){if(h.TypeName===b.Text&&f.test(h.Text)){$.extend(d.tags,this.extractCustomTags(h.Text))
}h.ContentAuthor=e.ContentAuthor;
h.ContentAuthorName=e.ContentAuthorName;
h.OriginalContentDateTime=e.OriginalContentDateTime;
d.posts.push(h)
},this));
return d
},extractCustomTags:function(d){return this.extractTags(d,c.CUSTOM_TAG_REGEX)
},extractTags:function(h,f){var e={},g=new RegExp(f||c.TAG_REGEX,"gi"),d;
while((d=g.exec(h))!==null){e[d[1].toLowerCase()]=d[2].toLowerCase()
}return e
}}
}(fom.components.liveCommentary,fom.utils));
(function(d,c,a){var e="/etc/designs/fom-website/libs/scripts/libs/jplayer/";
var b=function(f,g){this.$el=$(f);
this.$feed=this.$el.find(".feed");
this.$notification=this.$el.find(".new-post-notification");
this.$newPostCount=this.$notification.find(".new-post-count");
this.$newPostText=this.$notification.find(".post-text");
this.dataService=g;
this.numberOfPosts=0;
this._notifyForNewPosts=false;
this._newPostBuffer=[];
this._audioPlayers=[];
this.$notification.on("click",$.proxy(this.showNewPosts,this));
this.$el.one("newposts",function(){$(this).find(".load-more").remove()
});
g.onData($.proxy(this.newPosts,this));
g.start()
};
b.prototype={checkScrollIntoView:function(f,h){var g=this.$el.offset().top<h;
if(!this._notifyForNewPosts&&g){this._notifyForNewPosts=true
}else{if(this._notifyForNewPosts&&!g){this._notifyForNewPosts=false;
this._flush()
}}return false
},_flush:function(){this._newPostBuffer.reverse();
this.renderPosts(this._newPostBuffer);
this._newPostBuffer.length=0;
this.hideNotification()
},newPosts:function(h){var f=this.numberOfPosts!==0,g=h.TotalPosts-this.numberOfPosts,i=h.Posts.slice(0,g);
this.numberOfPosts=h.TotalPosts;
this.$el.trigger("newposts",g);
if(f&&this._notifyForNewPosts){[].push.apply(this._newPostBuffer,i);
this.notifyNewPosts()
}else{this.renderPosts(i)
}},notifyNewPosts:function(){var f=this._newPostBuffer.length,g=f>1?"textPlural":"textSingular";
this.$newPostCount.text(f);
this.$newPostText.text(this.$notification.data(g)||"");
this.showNotification()
},showNewPosts:function(f){f.preventDefault();
this.hideNotification();
$("body, html").animate({scrollTop:this.$el.offset().top-100},400)
},showNotification:function(){this.$notification.addClass("active")
},hideNotification:function(){this.$notification.removeClass("active")
},renderPosts:function(f){var g=document.createDocumentFragment();
$.each(f,function(k,j){var h=document.createElement("li");
h.className="post pending";
h.innerHTML=c.liveCommentary.Renderer.render(j);
g.appendChild(h)
});
this.$feed.prepend(g);
this.instantiatePosts()
},instantiatePosts:function(){var f=this;
this.$feed.find(".pending").each(function(h,j){var g=$(j);
g.find(".post-content").each(function(m,l){var k=$(l);
if(k.is(".audio")){f.initAudio(k)
}else{if(k.is(".image")){d.picturefill(k);
k.find(".manual-gallery").manualGallery({enlarge:true})
}}});
g.removeClass("pending")
})
},initAudio:function(f){var h=f.find(".jp-jplayer"),g=h.data();
this._audioPlayers.push(h);
h.jPlayer({ready:function(){h.jPlayer("setMedia",{title:g.title,mp3:g.url})
},cssSelectorAncestor:"#jp_container_"+g.playerId,swfPath:e,supplied:"mp3",useStateClassSkin:true,autoBlur:false,smoothPlayBar:true,keyEnabled:true})
},getBufferSize:function(){return this._newPostBuffer.length
},destroy:function(){this.dataService.destroy();
$.each(this._audioPlayers,function(f,g){g.jPlayer("destroy")
});
this._audioPlayers.length=0;
return this
}};
c.liveCommentary.attach=function(f,h,g){var j=new c.liveCommentary.DeltatreService(h,g);
var i=new b(f,j);
a.scrollWatcher.add(i);
return i
}
}(window,fom.components,fom.utils));
(function(d,f){var e=80;
var b="fom-adaptiveimage";
var a=800;
var c="HOME_PAGE";
d.HomepageSlide=function(g,h){this.$slides=g;
this.$raceStatus=g.find(".race-status");
this.$lapNumber=this.$raceStatus.find(".lap-number");
this.$adaptiveImage=g.find("."+b);
this.$post=g.find(".post");
this.dataService=h;
this._sticky={};
this._postHeight=0;
this._defaultImageSrc=this.$adaptiveImage.find("img").attr("src");
h.onData($.proxy(this.update,this));
h.start();
f.on("resize",this.resetPostHeight,this)
};
d.HomepageSlide.prototype={update:function(g){var h=this.findStickyPost(g.Posts);
if(h&&h.Id!==this._sticky.Id){this._sticky=h;
this.newPost(h)
}},findStickyPost:function(g){var h;
$.each(g,function(k,j){if(j.PostSubType===c){h=j;
return false
}});
return h
},newPost:function(g){var h=this.extractPostItems(g),i=h.imageUrl||this._defaultImageSrc;
if(i){this.switchImage(i)
}if(h.lap){this.$lapNumber.text("L"+h.lap)
}else{this.$raceStatus.hide()
}if(h.text){this.updateText(h.text)
}},switchImage:function(j){var h="fader",k=a/2,g=$('<img class="fader next" src="'+j+'">'),i=this.$adaptiveImage.find("img");
g.prependTo(this.$adaptiveImage);
i.addClass(h);
setTimeout(function(){g.removeClass(h);
setTimeout(function(){i.remove();
g.removeClass("next")
},k)
},k);
this.$adaptiveImage.removeClass(b)
},updateText:function(j){var h=this.$post.find(".old"),i=$('<div class="post-content next-up">'+j+"</div>"),g;
h.remove();
this.$post.find(".post-content").addClass("old");
this.$post.append(i);
setTimeout($.proxy(function(){g=i.outerHeight();
if(g>this._postHeight){this.$post.height(g);
this._postHeight=g
}i.removeClass("next-up")
},this),0)
},resetPostHeight:function(){var g=this.$post.find(".post-content").not(".old").outerHeight();
this._postHeight=g;
this.$post.height(g)
},extractPostItems:function(h){var g={};
$.each(h.Text,$.proxy(function(k,l){var j;
switch(l.TypeName){case d.PostTypes.Text:j=this.extractText(l);
g.text=j.text;
g.lap=j.lap;
break;
case d.PostTypes.Image:case d.PostTypes.GalleryImage:g.imageUrl=this.extractImage(h.PostData);
break
}},this));
return g
},extractText:function(h){var g=new RegExp(d.TAG_REGEX,"g");
return{lap:d.Renderer.extractCustomTags(h.Text).l,text:this.truncate(h.Text.replace(g,""))}
},extractImage:function(g){return d.templates.image.extractImageUrl(g)
},truncate:function(h){var g=0;
if(h.length<=e){return h
}return $.trim($.map(h.split(/\s+/),function(i){g+=i.length+1;
if(g<e){return i
}return""
}).join(" "))+"&hellip;"
}}
}(fom.components.liveCommentary,fom.utils.resizeManager));
fom.components||(fom.components={});
fom.components.searchresults=(function(i,u,j,m){var h={filter:".searchbar-form-input",genericTeaser:".generic-teaser",teaserDescription:".teaser-description",searchbarButton:".search-results-template .navigation-toggle--search",responsiveElement:".responsive-element",resultsContainer:".ResultsContainer",queryTextContainer:".QueryText",loadMore:".LoadMore"},v={loading:"loading",animate:"animate",error:"error"},b={loadStart:"loadstartnum",loadNum:"loadnum",totalResults:"totalresults",query:"query-text",ajaxPath:"ajax-path"},g=i(h.resultsContainer),p=g.find(h.loadMore),o=g.data(b.query);
function k(y){return y+".results.html"
}function n(){i("a",p).on("click",function(y){y.preventDefault();
w(i(y.currentTarget).parents(h.loadMore))
})
}function c(z,y){if(z){y.addClass(v.loading).removeClass(v.error)
}else{y.removeClass(v.loading)
}}function x(A,y){var B=y.data(b.loadStart),z=y.data(b.loadNum);
y.fadeOut(0);
c(false,y);
y.data(b.loadStart,B+z);
l(A,y)
}function f(z,y){c(false,y);
y.addClass(v.error)
}function a(y){return i(y.responseText).find("script, .editmode-helper, .editmode").remove().end()
}function w(y){c(true,y);
i.ajax({type:"GET",url:k(y.data(b.ajaxPath)),data:{q:o,start:y.data(b.loadStart),count:y.data(b.loadNum)}}).done(function(A,z,B){x(a(B),y)
}).fail(function(z){f(z,y)
})
}function r(y){if(y.data(b.totalResults)>y.data(b.loadStart)){y.fadeIn("fast")
}}function l(z,y){y.before(z);
i(z).hide(0).slideDown("fast");
q(z);
r(y)
}function q(z){var y=i(z).find(h.responsiveElement);
if(z&&y.length>0){i.each(y,function(A,B){m.recalculate(B)
})
}e();
s();
j.applyTo(g.find(h.genericTeaser))
}function s(){var y=g.find(h.genericTeaser);
if(i(window).width()>=768){var z=0;
i.each(y,function(A,B){var C=i(B).height();
if(C>z){z=C
}});
y.height(z)
}else{y.css({height:"auto"})
}}function d(A,B){var z=A.split(" "),y=(z.length>B)?"...":"";
return z.splice(0,B).join(" ")+y
}function e(){var y=g.find(h.teaserDescription),z=new RegExp(o,"gi");
y.each(function(C,B){var A=i(B),D=d(A.text(),45);
A.html(D.replace(z,"<strong>"+o+"</strong>"))
})
}function t(){var y=u.resizeManager;
i(h.filter).val(o);
i(h.searchbarButton).attr("disabled","disabled");
y.on(y.events.RESIZE,s,window);
if(p.length>0){n()
}if(u.isTouch){g.find(h.genericTeaser).removeClass(v.animate)
}q()
}i(t);
return{}
})(jQuery,fom.utils,fom.modules.premiumOverlay,fom.modules.responsiveElements);
fom.components.subscribecta=(function(b,h,c,f,g){var d=b(".subscribe-cta");
function e(j){g.setPrice(j.currency)
}function i(){h.on("change",e)
}function a(){}if(d.length){c.ready({onSuccess:i,onFail:a});
if(f.isLoggedIn){d.find(".js-hide-if-loggedin").hide();
if(f.isPremium){d.find(".js-hide-if-subscribed").hide()
}}else{d.find(".sign-in").on("click",function(j){j.preventDefault();
f.login();
return false
})
}}})(jQuery,fom.components.countryDropdown,fom.modules.mpp,fom.modules.user,fom.modules.autosetprice);
fom.components.signupoffering=(function(c,e){var a=c(".sign-up-offerings");
var b=c(".site-header").attr("data-upsellPage");
if(a.length){d()
}function d(){if(e.isLoggedIn){a.find(".js-hide-if-loggedin").hide();
if(e.isPremium){a.find(".js-hide-if-subscribed").hide()
}else{if(b){a.find(".js-hide-if-subscribed.js-monthly").attr("href",b+"#monthly");
a.find(".js-hide-if-subscribed.js-annualy").attr("href",b+"#annually")
}}}}})(jQuery,fom.modules.user);
fom.components.featureCategory1=(function(b,d){var a=b(".features.free-feature");
if(a.length){c()
}function c(){if(d.isLoggedIn){a.find(".js-hide-if-loggedin").hide()
}}})(jQuery,fom.modules.user);
fom.components.feature_category_2=(function(c,e){var a=c(".premium-feature");
var b=c(".site-header").attr("data-upsellPage");
if(a.length){d()
}function d(){if(e.isLoggedIn){if(e.isPremium){a.find(".js-hide-if-subscribed").hide()
}else{if(b){a.find(".js-hide-if-subscribed.js-monthly").attr("href",b+"#monthly");
a.find(".js-hide-if-subscribed.js-annualy").attr("href",b+"#annually")
}}}}})(jQuery,fom.modules.user);
(function(b,a,d){var c=function(f,e){this.$el=b(f);
this.$slides=this.$el.find(".swiper-slide");
this.options=b.extend(true,this.defaultOptions(),e);
this.setSwiperNode().setSwiperNav();
this.init()
};
c.prototype={defaultOptions:function(){return{swiper:{loop:true,onSlideChangeEnd:b.proxy(this._onSlideChange,this),slideClass:"swiper-slide"},containerSelector:".swiper-nudge-container",navSelector:".swipe-nav",navItemSelector:".nav-item",nextPrevSelector:".nudge",navActiveItem:"active",nextClassName:"next",prevClassName:"prev",revealOnHover:true}
},initLivePromo:function(){var f=this.$el.find(".slide-livepromo"),g=fom.components.liveCommentary,e={},h;
if(this.options.blogId&&f.length){if(this.options.feedUrl){e.feedUrl=this.options.feedUrl
}h=new g.DeltatreService(this.options.blogId,e);
this.promoSlide=new g.HomepageSlide(f,h)
}},setSwiperNode:function(){this.$swiperContainer=this.$el.find(this.options.containerSelector);
if(!this.$swiperContainer.length){this.$swiperContainer=this.$el
}return this
},setSwiperNav:function(){this.$nav=this.$el.find(this.options.navSelector);
this.$navItems=this.$nav.find(this.options.navItemSelector);
this.$nav.on("click","a",b.proxy(this._onNavClick,this));
this.setActiveNavItem(this.$navItems.first());
if(this.options.revealOnHover&&!fom.utils.isTouch&&!this.isSingle()){this.$el.find(this.options.nextPrevSelector).on("focus blur mouseenter mouseleave",b.proxy(this._onNextPrevHover,this))
}return this
},goToIndex:function(e){this.swiper.swipeTo(e);
return this
},setActiveNavItem:function(e){this.$navItems.removeClass(this.options.navActiveItem);
e.addClass(this.options.navActiveItem);
return this
},setupVideo:function(){var e={};
var g=b(".swiper-slide",this.$el);
var f=b("video:visible",g);
if(f.length){f.each(function(){this.pause()
})
}e=b("video:visible",g.filter(".swiper-slide-active")).get(0);
if(e){e.play()
}},setupRaceCountdown:function(){var e=b(".swiper-slide",this.$el);
e.filter(":not('.swiper-slide-countdown-initialised')").each(function(){var f=b(this);
f.find(".countdown-container").each(function(){d.initOnEl(this);
f.addClass("swiper-slide-countdown-initialised")
})
})
},init:function(){if(!this.isSingle()&&!fom.utils.isEditMode){this.swiper=new Swiper(this.$swiperContainer.get(0),this.options.swiper)
}if(this.isLivePromo()){this.initLivePromo()
}else{this.setupVideo();
this.setupRaceCountdown()
}return this
},isLivePromo:function(){return this.isSingle()&&this.$slides.find(".slide-livepromo").length===1
},isSingle:function(){return this.$slides.length===1
},_onNavClick:function(f){var g=b(f.currentTarget),e=this.$navItems.index(g);
this.setActiveNavItem(g).goToIndex(e);
this.swiper.stopAutoplay();
f.preventDefault()
},_onSlideChange:function(e){var f=this.$navItems.eq(this.swiper.activeLoopIndex);
this.setActiveNavItem(f);
this.setupVideo();
this.setupRaceCountdown()
},_onNextPrevHover:function(g){var f=b(g.currentTarget),e=g.type==="mouseenter"||g.type==="focus",h;
clearTimeout(this._nudgeTimer);
if(e){h=f.hasClass(this.options.nextClassName)?"Next":"Prev";
f.not(".clickadded").on("click",b.proxy(function(j){var i="swipe"+h;
this.swiper[i]();
this.swiper.stopAutoplay()
},this)).addClass("clickadded")
}else{f.off("click").removeClass("clickadded")
}this._nudgeTimer=setTimeout(b.proxy(function(){this.$swiperContainer.removeClass("nudge-prev nudge-next");
if(e){this.$swiperContainer.addClass("nudge-"+h.toLowerCase())
}},this),150)
}};
fom.components.carousel={create:function(f,e){return new c(f,e)
}};
b(function(){var e=b(".carousel");
if(e.length){e.each(function(j,k){var h=b(k),n=h.find(".swiper-slide"),m=(n.length===1),l=h.data(),g={blogId:l.blogId,feedUrl:l.feedUrl},f=+l.slideTimeout;
if(f&&!m){g.swiper={autoplay:f,autoplayDisableOnInteraction:true}
}fom.components.carousel.create(k,g)
})
}})
}(jQuery,fom.utils.resizeManager,fom.components.raceCountdown));
(function(c,b,a){var d=function(f,e){this.$el=c(f);
this.$slides=this.$el.find(".swiper-slide");
this.options=c.extend(true,this.defaultOptions(),e);
this.setSwiperNode().setSwiperNav();
this.init()
};
d.prototype={defaultOptions:function(){return{swiper:{loop:true,onSlideChangeEnd:c.proxy(this._onSlideChange,this),slideClass:"swiper-slide",autoplayDisableOnInteraction:false},containerSelector:".device-screen",navSelector:".swiper-pagination",navItemSelector:".nav-item",navActiveItem:"active",nextClassName:"next",prevClassName:"prev",revealOnHover:true,progressbartimer:null}
},setSwiperNode:function(){this.$swiperContainer=this.$el.find(this.options.containerSelector);
if(!this.$swiperContainer.length){this.$swiperContainer=this.$el
}return this
},setSwiperNav:function(){this.$nav=this.$el.find(this.options.navSelector);
this.$navItems=this.$nav.find(this.options.navItemSelector);
this.$nav.on("click","a",c.proxy(this._onNavClick,this));
this.setActiveNavItem(this.$navItems.first());
return this
},goToIndex:function(e){this.swiper.swipeTo(e);
return this
},setActiveNavItem:function(g){var e=this;
e.$navItems.removeClass(e.options.navActiveItem);
g.addClass(e.options.navActiveItem);
var f=0;
clearInterval(e.options.progressbartimer);
c(this.$navItems).find(".progress").width(0+"%");
e.options.progressbartimer=setInterval(h,50);
function h(){if(f>=100){clearInterval(e.options.progressbartimer)
}else{f++;
c(g).find(".progress").width(f+"%")
}}return e
},init:function(){if(!this.isSingle()&&!fom.utils.isEditMode){this.swiper=new Swiper(this.$swiperContainer.get(0),this.options.swiper)
}return this
},isSingle:function(){return this.$slides.length===1
},_onNavClick:function(f){var g=c(f.currentTarget),e=this.$navItems.index(g);
this.goToIndex(e);
this.swiper.stopAutoplay();
f.preventDefault()
},_onSlideChange:function(e){var f=this.$navItems.eq(this.swiper.activeLoopIndex);
this.setActiveNavItem(f)
}};
fom.components.carouselfeature={create:function(f,e){return new d(f,e)
}};
c(function(){var e=c(".swiper-container-feature");
if(e.length){e.each(function(j,k){var h=c(k),n=h.find(".swiper-slide"),m=(n.length===1),l=h.data(),g={blogId:l.blogId,feedUrl:l.feedUrl},f=+l.slideTimeout;
if(f&&!m){g.swiper={autoplay:f,autoplayDisableOnInteraction:false}
}fom.components.carouselfeature.create(k,g)
})
}})
}(jQuery,fom.utils.resizeManager,fom.components.carousel));
(function(f,d){var e=".share-component",a=".share-trigger",c=".share-options",g={name:"shareWindow",width:550,height:400,resizable:1,status:1},b="width="+g.width+",height="+g.height+",resizable="+g.resizable+",status="+g.status;
$shareComps=f(e),init=function(){$shareComps.each(function(){var k=f(this),i=k.find(a),h=k.find(c),j=h.find("a");
i.on("click",function(l){l.preventDefault();
k.toggleClass("open")
});
j.on("click",function(m){var l=f(this).attr("href");
m.preventDefault();
m.stopPropagation();
d.open(l,g.name,b)
})
})
};
init()
})(jQuery,window);
fom.components.autoreload=(function(f,h){var i={SYNC_CONTENT_FLAG:".enable-auto-refersh",SYNC_CONTENT_INTERVAL:".auto-refresh-interval",},c="",b=0,e="cq_lastModified",d=60000,g=null,a={init:function(){if(!this.cacheElements()){return this
}if(!h.isEditMode){this.initView()
}return this
},getMetadataForPage:function(){var j=this;
c=window.location.href.replace(/\.?\d*.html/g,".ts.html");
f.ajax({url:c}).success(function(k){if(k){j.metadataReceived(JSON.parse(k))
}}).fail(function(){window.location.reload()
})
},metadataReceived:function(k){var j=parseInt(k[e]);
if(b&&b<j){this.reload(j)
}else{if(!b){b=j
}}},getNewUrl:function(j){b=j;
return window.location.href.replace(/\.?\d*.html/g,"."+b+".html")
},reload:function(j){if(g){clearInterval(g)
}window.location=this.getNewUrl(j)
},cacheElements:function(){var k=f(i.SYNC_CONTENT_FLAG),l=f(i.SYNC_CONTENT_INTERVAL),j=l.length&&l.val()?parseInt(l.val()):60;
if(!k.length||!l.length){return false
}d=parseInt(j)*1000;
if(d<60000){d=60000
}return true
},initView:function(){var j=this;
b=window.location.href.match(/\.?\d*.html/g)[0].replace(".html","").replace(".","");
if(!b){b=0;
j.getMetadataForPage()
}else{b=parseInt(b)
}g=setInterval(function(){j.getMetadataForPage()
},d)
}};
return a.init()
})(jQuery,fom.utils);
(function(b,a){if(b(".template-video-item").length){a.initPlayers(b(".ooyalaplayer"))
}})(jQuery,fom.modules.videoPlayer);
(function(e,i,d,f){var l=d(".last-race-wrapper"),a=d(".next-race-wrapper"),c=a.find(".info"),j=d(".template-home").length,h=c.find(".links").length,b=100,g=["one","two","three","four"][h-1]||"one",k=function(){var m=l.outerHeight(),n=a.outerHeight();
if(m<n){l.css({height:n+"px"})
}else{if(m>n){a.css({height:m+"px"})
}}};
if(l.length&&a.length&&j){if(!i.hasFlexbox){d(e).on("load",function(){k();
k=i.debounce(k,b);
f.on(f.events.RESIZE,k)
})
}else{c.addClass(g+"-links")
}}}(window,fom.utils,jQuery,fom.utils.resizeManager));
fom.templates=fom.templates||{};
fom.templates.accountmanagement=(function(c,b,f,e){var a={TEMPLATE:".account-details-registered",TITLE:".page-title-premium",NAME:".name",PREVIEW_MODE:"#previewMode",EXPIRED_SUBSCRIPTION:".expired-subscription",CANCEL_SUCCESS:".cancel-success",VOUCHER_FREEMIUM_SUCCESS:".voucher-freemium-success",VOUCHER_PREMIUM_SUCCESS:".voucher-premium-success",UPDATE_SUCCESS:".update-success",UPGRADE_SUCCESS:".upgrade-success"},d={init:function(){if(!this.cacheElements()){return this
}if(f.isLoggedIn||b.isEditMode||this.isPreviewMode){this.initView()
}else{if(!b.isStaticServer){this.redirectToHome()
}}return this
},redirectToHome:function(){window.location=b.homeUrl
},cacheElements:function(){var g=c(a.TEMPLATE),h=g.find(a.TITLE),i=c(a.PREVIEW_MODE);
if(!g.length){return false
}this.isPreviewMode=i.length>0;
return this._elements={$template:g,$title:h,$cancelSuccess:g.find(a.CANCEL_SUCCESS),$updateSuccess:g.find(a.UPDATE_SUCCESS),$freeVoucherSuccess:g.find(a.VOUCHER_FREEMIUM_SUCCESS),$paidVoucherSuccess:g.find(a.VOUCHER_PREMIUM_SUCCESS),$name:h.find(a.NAME),$expiredSubscription:g.find(a.EXPIRED_SUBSCRIPTION),$upgradeSuccess:g.find(a.UPGRADE_SUCCESS)}
},reset:function(){if(!this.isPreviewMode){fom.components.accountmanagement.form.initFormView();
this.setPasswordChanged(false);
this.setVoucherError(false)
}},setPasswordChanged:function(g){fom.components.accountmanagement.form.setPasswordChanged(g)
},setVoucherError:function(g){fom.components.accountmanagement.form.setVoucherError(g)
},setBillingValidations:function(g){if(g){fom.components.accountmanagement.form.activateBillingValidations()
}else{fom.components.accountmanagement.form.deactivateBillingValidations()
}},initView:function(){var k=window.location.hash?window.location.hash.replace("#",""):"";
var h="",g=this;
c(".tab--link").on("click",function(n){n.preventDefault();
c(".tab--content").hide();
var m=c(this).attr("rel"),l="."+c(this).attr("rel");
c(l).show();
if(c(l).hasClass("hide-profile-preview")){c(".profile-preview").hide()
}else{c(".profile-preview").show()
}g.reset();
g.setBillingValidations(false);
c(".billing-edit .btn-cancel").trigger("click");
g.setPasswordChanged(m==="change-password")
});
c(".btn-edit").on("click",function(l){l.preventDefault();
c(this).parent().toggleClass("active");
g.setBillingValidations(false);
g.reset()
});
c("#edit").on("click",function(l){l.preventDefault();
c(".tab--content").hide();
c(".profile-preview").show();
c(".billing-preview").hide();
c(".billing-edit").show();
c(this).hide();
g.reset();
g.setBillingValidations(true)
});
c(".btn-cancel").on("click",function(l){l.preventDefault();
c(this).closest(".tab--content").hide();
c(".profile-preview").show();
c("#edit").show();
g.reset()
});
c(".billing-edit .btn-cancel").on("click",function(l){l.preventDefault();
c(this).closest(".billing-edit").hide();
c(".billing-preview").show();
g.setBillingValidations(false)
});
c("#form-input-reveal-password").on("change",function(){if(c(this).is(":checked")){c("#form-input-password").attr("type","text");
c("#form-input-password-new").attr("type","text")
}else{c("#form-input-password").attr("type","password");
c("#form-input-password-new").attr("type","password")
}});
fom.components.accountmanagement.form.init();
if(!g.isPreviewMode){this._elements.$name.text(f.get("fullName"));
h=f.accountInfo.data.subscriptionStatus
}else{fom.components.accountmanagement.form.activatePage()
}var j=localStorage.getItem("userSubscriptionStatus");
var i=b.localStorage.getItem("accountManagementMessage");
this._elements.$updateSuccess.addClass("hide");
this._elements.$cancelSuccess.addClass("hide");
this._elements.$expiredSubscription.addClass("hide");
this._elements.$upgradeSuccess.addClass("hide");
this._elements.$paidVoucherSuccess.addClass("hide");
this._elements.$freeVoucherSuccess.addClass("hide");
this._elements.$expiredSubscription.addClass("hide");
if(f.isPremium&&j&&j!=h&&i!="cancelSuccess"){this._elements.$cancelSuccess.addClass("hide");
this._elements.$expiredSubscription.addClass("hide");
this._elements.$updateSuccess.addClass("hide");
this._elements.$upgradeSuccess.removeClass("hide");
this._elements.$paidVoucherSuccess.addClass("hide");
this._elements.$freeVoucherSuccess.addClass("hide")
}else{switch(i){case"cancelSuccess":this._elements.$cancelSuccess.removeClass("hide");
this._elements.$expiredSubscription.addClass("hide");
break;
case"updateSuccess":this._elements.$updateSuccess.removeClass("hide");
break;
case"paidVoucherSuccess":this._elements.$paidVoucherSuccess.removeClass("hide");
break;
case"freeVoucherSuccess":this._elements.$freeVoucherSuccess.removeClass("hide");
break
}}b.localStorage.removeItem("accountManagementMessage");
b.localStorage.removeItem("userSubscriptionStatus");
if(k){g.setVoucherError(k);
c(".tab--content").hide();
c(".voucher").show();
c(".profile-preview").show()
}}};
return d.init()
})(jQuery,fom.utils,fom.modules.user,fom.components.accountmanagement);
(function(c,d,b,f){var a={TEMPLATE:".template-registration"},e={init:function(){if(!this.cacheElements()){return false
}if(f.isLoggedIn&&!b.isEditMode){this.redirectToAccountManagement()
}else{this.initForm()
}return this
},redirectToAccountManagement:function(){window.location=c(".js-account-management").first().attr("href")||b.homeUrl
},cacheElements:function(){var g=c(a.TEMPLATE);
if(!g.length){return false
}return this._elements={$template:g}
},initForm:function(){d.form.activate()
}};
e.init()
})(jQuery,fom.components.registrationform,fom.utils,fom.modules.user);
(function(c,d,b,f){var a={TEMPLATE:".template-subscribe-fullaccess",UPSELL:"#is-upsell-journey"},e={init:function(){if(!this.cacheElements()){return false
}if(f.isLoggedIn&&!b.isEditMode&&!b.isStaticServer&&!this._elements.$upsell.length){this.redirectToAccountManagement()
}else{if(!f.isLoggedIn&&!b.isStaticServer&&this._elements.$upsell.length){this.redirectToHome()
}else{this.initForm()
}}return this
},redirectToAccountManagement:function(){window.location=c(".js-account-management").first().attr("href")||b.homeUrl
},redirectToHome:function(){window.location=b.homeUrl
},cacheElements:function(){var g=c(a.TEMPLATE);
if(!g.length){return false
}return this._elements={$template:g,$upsell:g.find(a.UPSELL)}
},initForm:function(){d.subscribestep1form.activate();
d.subscribestep2form.activate()
}};
e.init()
})(jQuery,fom.components.registrationform,fom.utils,fom.modules.user);
fom.templates||(fom.templates={});
fom.templates.resultsarchive=(function(c,a,e,d){var f={};
var b=true;
f.selectors={templateWrapper:".ResultArchiveWrapper",templateContainer:".ResultArchiveContainer",sectionTitle:".ResultsArchiveTitle",filter:".ResultFilterScrollable",form:".ResultsArchiveForm",filterTrigger:".FilterTrigger",tableLinkTrigger:".ArchiveLink",scrollUpTrigger:".ScrollUpTrigger",scrollDownTrigger:".ScrollDownTrigger",activeClass:"active",selectedClass:"selected",loadingClass:"loading"};
f.config={animationTime:500,ajaxAllowed:!!c.history.pushState};
f.init=function(){var g=this;
g.alignFilters(true);
g.attachFilterSelectionHandlers(g);
g.attachLinksHandlers(g);
g.attachFilterScrollHandlers(g);
d.on(d.events.CHANGE,g.alignFilters,g);
return g
};
f.attachFilterSelectionHandlers=function(g){e(g.selectors.form).find("select").on("change",function(i){var h=e(i.currentTarget);
g.updateContent(h.attr("name"),h.val())
});
e(g.selectors.filterTrigger).on("click",function(i){i.preventDefault();
var h=e(i.currentTarget);
if(h.hasClass(g.selectors.selectedClass)){return
}var j=h.parent().parent();
j.find("."+g.selectors.selectedClass).removeClass(g.selectors.selectedClass);
h.addClass(g.selectors.selectedClass);
g.alignFilters();
g.updateContent(h.data("name"),h.data("value"))
})
};
f.attachBrowserBackForwardhandlers=function(g){if(e(".ResultArchiveWrapper").length>0&&b){b=false;
e(c).bind("popstate",function(l){if(e("body").hasClass("historypushed")){var k=e(g.selectors.templateWrapper),i=e(g.selectors.form,k),n=(new Date).getTime(),j=location.href.split("/results.html");
if(j[1]==null||j[1]==""){return
}var h=i.data("ajax-path")+j[1],o=g.config.animationTime-((new Date).getTime()-n);
if(g.config.ajaxAllowed){e.ajax({type:"GET",url:h,beforeSend:function(){k.addClass(g.selectors.loadingClass)
}}).success(function(p){c.setTimeout(function(){e(g.selectors.templateContainer,k).html(p);
if(e(".race-header-sponsor a").length>0){e(".race-header-sponsor a").attr("target","_blank")
}g.changePageTitle(k);
g.init();
k.removeClass(g.selectors.loadingClass)
},o<0?0:o)
}).fail(function(){var p=g.getURL(g.getFilterParams(i),"action");
c.location.href=p
})
}else{var m=g.getURL(g.getFilterParams(i),"action");
c.location.href=m
}}})
}};
f.attachLinksHandlers=function(g){var h=e(g.selectors.templateWrapper);
e(g.selectors.tableLinkTrigger,h).on("click",function(l){var i=e(l.currentTarget),j=i.attr("href"),k=i.data("ajax-url");
l.preventDefault();
if(i.hasClass(g.selectors.selectedClass)){return
}h.addClass(g.selectors.loadingClass);
if(g.config.ajaxAllowed){e.ajax({url:k}).success(function(m){g.updateContentAjaxHandler(m,(new Date).getTime())
}).fail(function(){c.location.href=j
})
}else{c.location.href=j
}})
};
f.attachFilterScrollHandlers=function(g){e(g.selectors.scrollUpTrigger+","+g.selectors.scrollDownTrigger).on("click",function(i){i.preventDefault();
var h=e(i.currentTarget),j=h.is(g.selectors.scrollUpTrigger)?"up":"down";
if(h.hasClass(g.selectors.activeClass)){g.scrollFilter(h.parent().parent(),j)
}});
e(g.selectors.filter).each(function(h,i){i.addEventListener("mousewheel",g.mouseWheelHandler());
i.addEventListener("DOMMouseScroll",g.mouseWheelHandler())
})
};
f.mouseWheelHandler=function(){var g=this;
return function(h){h.preventDefault();
var i=e(h.currentTarget).parent(),j=Math.max(-1,Math.min(1,(h.wheelDelta||-h.detail)));
j<0?g.scrollFilter(i,"down"):g.scrollFilter(i,"up")
}
};
f.updateContent=function(g,m){var i=this,j=e(i.selectors.templateWrapper),h=e(i.selectors.form,j),l=(new Date).getTime();
h.find("[name="+g+"]").val(m);
j.addClass(i.selectors.loadingClass);
if(i.config.ajaxAllowed){e.ajax({type:"GET",url:i.getURL(i.getFilterParams(h),"ajax")}).success(function(n){i.updateContentAjaxHandler(n,l)
}).fail(function(){var n=i.getURL(i.getFilterParams(h),"action");
c.location.href=n
})
}else{var k=i.getURL(i.getFilterParams(h),"action");
c.location.href=k
}};
f.updateContentAjaxHandler=function(j,i){var g=this,h=e(g.selectors.templateWrapper),k=g.config.animationTime-((new Date).getTime()-i);
c.setTimeout(function(){e(g.selectors.templateContainer,h).html(j);
if(e(".race-header-sponsor a").length>0){e(".race-header-sponsor a").attr("target","_blank")
}g.changePageTitle(h);
g.init();
h.removeClass(g.selectors.loadingClass);
var l=e(g.selectors.form,h),m=g.getFilterParams(e(g.selectors.form,h));
c.history.pushState(m,"",g.getURL(m,"action"));
e("body").addClass("historypushed");
g.attachBrowserBackForwardhandlers(g)
},k<0?0:k)
};
f.getFilterParams=function(h){var g=h.find("select"),i={};
e.each(g,function(j,k){if(e(k).val()===""){return false
}i[e(k).attr("name")]=e(k).val()
});
return i
};
f.getURL=function(m,n){var j=this,k=e(j.selectors.templateWrapper),i=e(j.selectors.form,k),h;
if(n==="ajax"){h=i.data("ajax-path")
}if(n==="action"){h=i.attr("action")
}var g=e.map(m,function(p,o){return o
}).length;
var l=0;
e.each(m,function(p,o){l=l+1;
if(l===g){(o==="all"||o==="")?h+=".html":h+="/"+o+".html"
}else{h+="/"+o
}});
return h
};
f.scrollFilter=function(j,n){var p=this,m=j.children().first(),k=e(p.selectors.scrollUpTrigger,j),h=e(p.selectors.scrollDownTrigger,j),g=m.outerHeight()-j.innerHeight(),o=m.children().first().innerHeight()*3,l=m.position().top,i;
if(g<=0){return
}if(n==="up"){h.addClass(p.selectors.activeClass);
i=l+o;
if(i>=0){i=0;
k.removeClass(p.selectors.activeClass)
}}else{k.addClass(p.selectors.activeClass);
i=l-o;
if(i<=-(g)){i=-(g);
h.removeClass(p.selectors.activeClass)
}}m.css({top:i+"px"})
};
f.alignFilters=function(h){var g=this;
e.each(e(g.selectors.filter),function(o,m){var q=e(m),n=q.parent(),l=n.innerHeight(),j=q.find("."+g.selectors.selectedClass).parent(),k=-(q.outerHeight()-l),p=-(j.position().top-(l/2-j.innerHeight()/2)),i=n.find(g.selectors.scrollUpTrigger),r=n.find(g.selectors.scrollDownTrigger);
if(p>=0){p=0;
i.removeClass(g.selectors.activeClass);
r.addClass(g.selectors.activeClass)
}else{i.addClass(g.selectors.activeClass);
if(p<=k){p=k;
r.removeClass(g.selectors.activeClass)
}else{r.addClass(g.selectors.activeClass)
}}if(q.outerHeight()<=n.innerHeight()){i.removeClass(g.selectors.activeClass);
r.removeClass(g.selectors.activeClass);
q.css({top:"0px"})
}else{q.css({top:p+"px"})
}if(h){setTimeout(function(){q.css({transition:"top 0.5s"})
},10)
}})
};
f.changePageTitle=function(g){a.title=e(this.selectors.sectionTitle,g).text()
};
return f.init()
})(window,document,jQuery,fom.utils.resizeManager);
(function(c,d){var a={TEMPLATE:".user-authenticated"},b={init:function(){if(!this.cacheElements()){return false
}if(!d.isLoggedIn){d.login(true,{hideCloseIcon:true});
return this
}},cacheElements:function(){var e=c(a.TEMPLATE);
if(!e.length){return false
}return this._elements={$template:e}
}};
c(window).load(function(){b.init()
})
})(jQuery,fom.modules.user);
(function(d,c){var b={TEMPLATE:".email-validation-error",RESEND_COOKIE:"resend-email-info",IS_AUTHOR_MODE:"#is-author-mode"},a={init:function(){if(!this.cacheElements()){return false
}else{if(d(b.IS_AUTHOR_MODE).length){return false
}}if(!d.cookie(b.RESEND_COOKIE)&&!c.isStaticServer){window.location=c.homeUrl
}},cacheElements:function(){var e=d(b.TEMPLATE);
if(!e.length){return false
}return this._elements={$template:e}
}};
d(window).load(function(){a.init()
})
})(jQuery,fom.utils);
fom.utils.trackingExtended=(function(c,e,a,f){var d={};
var b={};
d.initialise=function(){var g=d.getTemplate();
switch(g){case"driverdetails":d.setPageType("driver");
d.setDriverTemplate();
break;
case"teamdetails":d.setPageType("team");
d.setTeamTemplate();
break;
case"racedetails":d.setPageType("track");
d.setTracktemplate();
break;
case"article":case"feature":case"informationfeature":case"informationtechnical":case"informationinterview":d.setPageType("content");
d.setContentTemplate();
break;
case"ooyala-video":d.setPageType("video");
d.setContentOoyalaTemplate();
break;
case"dashboard":d.setPageType("dashboard");
break;
case"homepage":d.setPageType("homepage");
break;
default:d.setPageType("other")
}d.setAllTemplate();
d.setproperty()
};
d.readCookie=function(h){var k=h+"=";
var g=document.cookie.split(";");
for(var j=0;
j<g.length;
j++){var l=g[j];
while(l.charAt(0)==" "){l=l.substring(1,l.length)
}if(l.indexOf(k)==0){return l.substring(k.length,l.length)
}}return null
};
d.createCookie=function(i,j,k){if(k){var h=new Date();
h.setTime(h.getTime()+(k*24*60*60*1000));
var g="; expires="+h.toGMTString()
}else{var g=""
}document.cookie=i+"="+j+g+"; path=/"
};
d.eraseCookie=function(g){d.createCookie(g,"",-1)
};
d.getAge=function(j,i,n){var l=new Date(),m=l.getFullYear(),g=l.getMonth(),k=l.getDate(),h=m-n;
if(g<(j-1)){h--
}if(((j-1)==g)&&(k<i)){h--
}return h
};
d.getTemplate=function(){var g=c("#gtm-template").val();
if(g!==""){return g
}else{return""
}};
d.setCid=function(){var j=d.readCookie("_ga"),h=".",k=2;
if(typeof j!=="undefined"&&j!==null){var i=j.split(h).slice(k),g=i.join(h);
b.cid=g
}};
d.setPageType=function(g){b.pageType=g;
b.userType=d.getUserType()
};
d.getUserType=function(){var k=c.cookie("account-info");
var l="freemium";
var j="premium";
var g="anonymous";
if(k){try{var h=JSON.parse(k);
if(h.data&&h.data.subscriptionStatus){if(h.data.subscriptionStatus=="active"){return j
}else{return l
}}else{return l
}}catch(i){console.error("Error parsing account info object : "+i);
return
}}else{return g
}};
d.setDriverTemplate=function(){d.setDriverNames();
d.setDriverTeams();
d.setDriverAge();
d.setDriverPoints();
d.setDriverCountry()
};
d.setTeamTemplate=function(){d.setTeamName();
d.setTeamFullName();
d.setDriverNames();
d.setTeamPolePosition();
d.setTeamPoints()
};
d.setTracktemplate=function(){d.setTrackCountry();
d.setTrackCity();
d.setTrackName()
};
d.setContentTemplate=function(){d.setContentPageType();
d.setVideoCount();
d.setWordCount();
d.setImageCount();
d.setPageTitle();
d.setContentTags();
d.setDatePublished();
d.setContentAge()
};
d.setContentOoyalaTemplate=function(){};
d.setAllTemplate=function(){d.setCid();
d.setUserObject();
d.setSocialSharing()
};
d.setDriverAge=function(){var g=c(".stats-list-component.driver-stats span.text");
if(g.length>0){g.each(function(){var k=c(this).text();
if(c.trim(k)==="Date of birth"){var i=c(this).parent().next().text();
var j=i.split("/");
var h=d.getAge(j[1],j[0],j[2]);
b.driverAge=h
}})
}else{b.driverAge=""
}};
d.setDriverCountry=function(){var g=c(".stats-list-component.driver-stats span.text");
if(g.length>0){g.each(function(){var i=c(this).text();
if(c.trim(i)==="Country"){var h=c(this).parent().next().text();
b.driverCountry=h
}})
}else{b.driverCountry=""
}};
d.setDriverNames=function(){var i=c("h1.driver-name");
var g=i.length;
var h="";
if(g){i.each(function(j){var k=c(this).text();
if((g-1)!==j){h+=c.trim(k)+"|"
}else{h+=c.trim(k)
}})
}b.driverNames=h
};
d.setDriverPoints=function(){var g=c(".stats-list-component.driver-stats span.text");
if(g.length>0){g.each(function(){var i=c(this).text();
if(c.trim(i)==="Points"){var h=c(this).parent().next().text();
b.driverPoints=h
}})
}else{b.driverPoints=""
}};
d.setDriverTeams=function(){var h=c("p.driver-team span");
var i=h.length;
var j="";
if(i>0){h.each(function(k){var l=c(this).text();
if((i-1)!==k){j+=c.trim(l)+"|"
}else{j+=c.trim(l)
}});
b.driverTeam=j
}else{var g=c(".stats-list-component.driver-stats span.text");
if(g.length>0){g.each(function(){var l=c(this).text();
if(c.trim(l)==="Team"){var k=c(this).parent().next().text();
b.driverTeam=c.trim(k)
}})
}else{b.driverTeam=""
}}};
d.setTeamNames=function(){var g=c(".teamteaser-details .teamteaser-title");
var h=g.length;
var i="";
if(h>0){g.each(function(j){var k=c(this).text();
if((h-1)!==j){i+=c.trim(k)+"|"
}else{i+=c.trim(k)
}});
b.teamFullNames=i
}else{}};
d.setTeamName=function(){var g=c("h1.headline").text();
var h=c.trim(g);
if(h.length>0){b.teamName=h
}else{b.teamName=""
}};
d.setTeamFullName=function(){var g=c(".stats-list-component.team-stats span.text");
if(g.length>0){g.each(function(){var i=c(this).text();
if(c.trim(i)==="Full Team Name"){var h=c(this).parent().next().text();
b.teamFullNames=c.trim(h)
}})
}else{b.teamFullNames=""
}};
d.setTeamPolePosition=function(){var g=c(".stats-list-component.team-stats span.text");
if(g.length>0){g.each(function(){var i=c(this).text();
if(c.trim(i)==="Pole Positions"){var h=c(this).parent().next().text();
b.teamPolePosition=c.trim(h)
}})
}else{b.teamPolePosition=""
}};
d.setTrackCountry=function(){var g=c("#gtm-page-title").val();
var h=c.trim(g);
if(h!==""){b.trackCountry=h
}else{b.trackCountry=""
}};
d.setTrackCity=function(){var g=c("h2.race-header-country").text();
var h=c.trim(g);
if(h!==""){b.trackCity=h
}else{b.trackCity=""
}};
d.setTrackName=function(){var g=c("h2.circuit-info-header").text();
var h=c.trim(g);
if(h!==""){b.trackName=h
}else{b.trackName=""
}};
d.setDriverCurrentPosition=function(){};
d.setTeamPoints=function(){};
d.setContentPageType=function(){var g=c(".category-title").text();
var h=c.trim(g).split("/");
if(h.length>0){b.contentPageType=c.trim(h.slice(-1).pop())
}else{b.contentPageType=""
}};
d.setVideoCount=function(){var g=c(".ooyala_video").length;
if(g>0){b.contentVideoCount=g
}else{b.contentVideoCount=""
}};
d.setWordCount=function(){var g=c(".article-content p");
var h=0;
g.each(function(){var k=c(this);
if(k.closest(".ooyala_video").length>0){return
}if(k.closest(".related-content").length>0){return
}if(k.hasClass("date")||k.hasClass("share")||k.hasClass("gallery-description")){return
}var l=k.text();
if(l===" "){return
}var j=d.getWords(c.trim(l));
h+=j
});
b.contentWordCount=h
};
d.setImageCount=function(){var h=0;
var g=c(".article-content picture img");
if(g.length>0){g.each(function(){var i=c(this);
if(i.closest(".gallery-modal-container").length>0){return true
}if(i.closest(".ooyala_video").length>0){return true
}if(i.closest(".related-content").length>0){return true
}h++
});
b.contentImageCount=h
}else{b.contentImageCount=""
}};
d.setPageTitle=function(){var g=c("title").text();
var h=c.trim(g);
if(h!==""){b.contentPageTitle=h
}else{b.contentPageTitle=h
}};
d.setContentTags=function(){var h=c('meta[name="keywords"]').attr("content");
var g=c.trim(h);
if(g!==""){b.contentTags=d.getPipeString(g)
}else{b.contentTags=""
}};
d.setDatePublished=function(){var h=c(".article-title .date");
if(h.length>0){var i=h.text();
var g=c.trim(i);
b.contentPublishedDate=g
}};
d.setContentAge=function(){var i=c(".article-title .date");
if(i.length>0){var l=i.text();
var k=c.trim(l);
var h=new Date(k);
var g=new Date();
var j=d.dateDiff("d",h,g);
b.contentAge=j
}};
d.setUserObject=function(){var i=d.readCookie("account-info");
if(i===null||i==="undefined"){return
}var h=i.replace(/\\n/g,"\\n").replace(/\\'/g,"\\'").replace(/\\"/g,'\\"').replace(/\\&/g,"\\&").replace(/\\r/g,"\\r").replace(/\\t/g,"\\t").replace(/\\b/g,"\\b").replace(/\\f/g,"\\f");
h=decodeURIComponent(h);
h=h.replace(/[\u0000-\u0019]+/g,"");
var g=JSON.parse(h);
b.userUID=g.UID;
b.subscriptionSource=g.data.subscriptionSource;
b.userCountry=g.profile.country
};
d.setSocialSharing=function(){var h=".share-component",g=c(h);
g.each(function(){var l=c(this),k=".share-options",i=l.find(k),j=i.find("a");
j.on("click",function(q){var m=a.location.href,n=c(this).attr("title"),o=c.trim(c("title").text())+"|"+m;
var p={};
p.event="socialInteraction";
p.socialNetwork=n;
p.socialAction="Share";
p.socialTarget=o;
f.addProperty(p)
})
})
};
d.getWords=function(h){var g=h;
g=g.replace(/(^\s*)|(\s*$)/gi,"");
g=g.replace(/[ ]{2,}/gi," ");
g=g.replace(/\n /,"\n");
return g.split(" ").length
};
d.getPipeString=function(j){var h=c.trim(j);
if(h.length>0){var i=h.replace(/,/g,"|");
var g=i.length-1;
var k=i.lastIndexOf("|");
if(k===g){i=i.slice(0,-1)
}return i
}else{return""
}};
d.dateDiff=function(i,j,h){var i=i.toLowerCase();
var k=h-j;
var g={w:604800000,d:86400000,h:3600000,n:60000,s:1000};
return Math.floor(k/g[i])
};
d.setproperty=function(){f.addProperty(b)
};
return d.initialise()
})($,Modernizr,window,fom.tracking);
fom.init=(function(i,q,l,s,t,k,e){var m=t();
var v={adRaceHeaderSponsorLink:i(".race-header-sponsor a"),articleTitle:i(".article-title"),headline:i(".article-title .headline"),sponserWrapper:i(".article-title .sponser-wrapper"),notApply:i(".template-feature"),globalAdComponent:i(".globalpartner-block"),picElement:".global-ad-image .img-wrapper"},f=false,A,w={},u,b=1000,j=10,z=function(){fom.utils.resizeManager.on(l.events.CHANGE,c,this);
fom.utils.resizeManager.on(l.events.RESIZE,c,this)
},c=function(E){if(E!==l.sizes.NARROW){var B=i(v.articleTitle).width()-210;
i(v.headline).width(B);
var D=i(v.headline).outerHeight(true);
var G=84;
var C=D-G;
C=(C<0)?0:C/2;
var F=i(v.headline).position().top+C;
i(v.sponserWrapper).css("top",F)
}},h=function(){var F=i(".partner-image-modal-container .video-player");
var D=i(".partner-image-modal-wrapper");
var E=i(".partner-image-modal-window").height();
var C=D.height();
var B=E-C;
i(".partner-image-modal-container").css({top:B/2});
if(F.length>0){setTimeout(function(){if(!F.hasClass("full-screen-mode")){var G=i(".partner-image-modal-window").height();
var H=i(".partner-image-modal-wrapper").height();
var I=G-H;
F.height(H);
i(".partner-image-modal-container").css({top:I/2})
}},50)
}},r=function(){var D=i(".partner-image-modal-container").find(".video-player").length>0?true:false;
i(".partner-image-modal-link").on("click",function(F){F.preventDefault();
var E=i("#"+i(this).data("id"));
x(E)
});
i(".partner-image-modal-close-link").on("click",function(F){F.preventDefault();
if(!f){return
}var E=i(this).closest(".partner-image-modal-window");
p(E)
});
i(".partner-image-enlarged").on("click",function(F){if(!f){return
}var E=i(this).closest(".partner-image-modal-window");
p(E)
});
i(".partner-image-modal-window").on("click",function(G){if(!f){return
}var E=i(this);
var F=E.find(".video-player").length>0?true:false;
if(F){if(i(G.target).closest(".video-section").length>0){return
}else{p(i(this))
}}else{p(i(this))
}});
var C=i("#partner-image-modal-window").closest(".tablet-swiper");
if(C.length>0){i(i("#partner-image-modal-window").detach()).appendTo(C)
}if(D){var B=i(".partner-image-modal-container").find(".video-player").not(".initialised");
B.addClass("initialised");
e.initPlayers(B,{},i.proxy(function(F){i.extend(w,F);
var E=e.players.length;
while(E--){}}))
}fom.utils.resizeManager.on(l.events.CHANGE,h,this);
fom.utils.resizeManager.on(l.events.RESIZE,h,this)
},x=function(D){var H=i(D).find(".partner-image-modal-container");
var B=H.find(".video-player").length>0?true:false;
var I=i(D).height();
var C=H.height();
var F=I-C;
i(D).addClass("partner-image-modal-open partner-image-mobile-open-animate");
i("body").addClass("modal_active");
H.css({top:F/2});
f=true;
var G=d();
if(G!==false){var E=fom.utils.parseUri(G.attr("src"));
var K={event:"AdModalOpened",event_category:"expand_ad",event_action:G.data("gatitle"),event_label:E.filename+"|"+G.width()+"X"+G.height()};
k.addProperty(K)
}else{var K={event:"partnerPromotionClick",ecommerce:{promoClick:{promotions:[]}}},J=i(".partner-image-modal-window .video-section > div");
A.creative="video";
K.ecommerce.promoClick.promotions.push(A);
k.addProperty(K)
}},p=function(B){var F=d();
if(F!==false){var H=fom.utils.parseUri(F.attr("src"));
var C={event:"AdModalClosed",event_category:"close_ad",event_action:F.data("gatitle"),event_label:H.filename+"|"+F.width()+"X"+F.height()};
k.addProperty(C)
}var E=i(B).find(".partner-image-modal-container");
var G=E.find(".video-player").length>0?true:false;
if(G){var I=E.find(".video-player").find(".video-display").first().attr("id");
var D=w[I];
if(D){D.resetVideoPlayback()
}}E.removeAttr("style");
i(B).removeClass("partner-image-modal-open partner-image-mobile-open-animate");
i("body").removeClass("modal_active");
f=false
},g=function(){if(i(".article-sup-content section > div").length>0){return
}if(l.size!==l.sizes.NARROW){setTimeout(function(){o()
},50)
}else{i(".globalpartner-block").removeAttr("style")
}},o=function(){i(".globalpartner-block").css({right:0});
var C=i(".globalpartner-block").offset().left;
var B=i(q).width();
var D=300;
var E;
if(B>1440){E=i(".globalpartner-block").closest(".inner-wrap").outerWidth()-i(".site-header-wrap").width();
E=E/2-20
}else{if(B>800){E=((C+D)-B)+20
}else{E=-20
}}i(".globalpartner-block").css({right:E});
u=setInterval(a,b)
},a=function(){var B=i(".globalpartner-block");
if(B.length){if((B.offset().left+B.width()+50)<q.innerWidth){i(q).trigger("resize");
j=0
}}else{j=0
}if(j--<=0){clearInterval(u)
}},y=function(){var D={event:"promoView",ecommerce:{promoView:{promotions:[]}}};
var B=i(".globalpartner-block");
var C=B.length;
B.each(function(G,I){var H;
var F;
if(i("img.frame-1",i(this)).is(":visible")){H=i("img.frame-1",i(this));
F="494X400"
}else{if(i("img.frame-2",i(this)).is(":visible")){H=i("img.frame-2",i(this));
F="494X400"
}else{H=i(".partner-small-image",i(this));
F="300X90"
}}if(H.length>0){var J=fom.utils.parseUri(H.attr("src"));
var E={};
E.id=J.filename;
E.name=H.data("gatitle");
E.position=F;
D.ecommerce.promoView.promotions.push(E);
A=E;
if(G==C-1){if(D.ecommerce.promoView.promotions.length>0){k.addProperty(D)
}}if(i(".template-feature").length>0||i(".template-article").length>0){i(".article-title").addClass("fix-partner-small-image");
g()
}}});
if(i(".globalpartner-block").length>0){s.recalculate$Elements(i(".responsive-element"));
if(i(".template-article").length>0&&i(".article-sup-content section > div").length>0){i(".article-sup-content").addClass("has-partner-block");
i(".globalpartner-block").parent().addClass("has-article-sup-content")
}if(i(".template-feature").length>0||i(".template-article").length>0){fom.utils.resizeManager.on(l.events.CHANGE,g,this);
fom.utils.resizeManager.on(l.events.RESIZE,g,this)
}}if(i(".partner-image-modal-window").length>0){r()
}i(".partner-link").on("click",function(I){var E={event:"partnerPromotionClick",ecommerce:{promoClick:{promotions:[]}}};
var G=d();
if(G!==false){var H=fom.utils.parseUri(G.attr("src"));
var F={id:H.filename,name:G.data("gatitle"),position:G.width()+"X"+G.height()};
E.ecommerce.promoClick.promotions.push(F);
k.addProperty(E)
}});
if(i(v.picElement).length>0){setTimeout(function(){i(".frame-2",i(v.picElement)).addClass("active")
},2000)
}},d=function(){if(i(".partner-image-modal-window").hasClass("partner-image-mobile-open-animate")){if(i(".partner-image-modal-window img").length>0){return i(".partner-image-modal-window img")
}else{return false
}}else{if(i(".partner-small-image").is(":visible")){return i(".partner-small-image")
}else{if(i(".globalpartner-block .img-fix.frame-2").length>0){return i(".globalpartner-block .img-fix.frame-2")
}else{if(i(".globalpartner-block .img-fix.frame-1").length>0){return i(".globalpartner-block .img-fix.frame-1")
}else{return false
}}}}},n=function(){if(i(v.adRaceHeaderSponsorLink).length>0){i(v.adRaceHeaderSponsorLink).attr("target","_blank");
var C={event:"promoView",ecommerce:{promoView:{promotions:[]}}};
i(".race-header-sponsor").each(function(){var E=i("img",i(this));
var F=fom.utils.parseUri(E.attr("src"));
var D={};
D.id=F.filename;
D.name=E.data("gatitle");
D.position=E.width()+"X"+E.height();
C.ecommerce.promoView.promotions.push(D)
});
k.addProperty(C);
i(v.adRaceHeaderSponsorLink).on("click",function(H){var G=i("img",i(this));
var F=fom.utils.parseUri(G.attr("src"));
var E={event:"promotionClick",ecommerce:{promoClick:{promotions:[]}}};
var D={};
D.id=F.filename;
D.name=G.data("gatitle");
D.position=G.width()+"X"+G.height();
E.ecommerce.promoClick.promotions.push(D);
k.addProperty(E)
})
}m.update(".globalpartner-block",function(){if(i(".globalpartner-block").length>0){y()
}else{var D=setInterval(function(){if(i(".globalpartner-block").length){y();
clearInterval(D)
}},100)
}});
if(i(v.notApply).length===0&&i(v.articleTitle).length>0&&i(v.sponserWrapper).length>0){var B=i(q).width();
if(B>=768){z();
c("medium")
}}};
return n()
})(jQuery,window,fom.utils.resizeManager,fom.modules.responsiveElements,fom.utils.adobeCampaignManager,fom.tracking,fom.modules.videoPlayer);